{"content": "Nguồn : Topcoder .\nCó rất nhiều bài_toán được áp_dụng quy_hoạch_động (QHĐ) ( Dynamic_Programming ) .\nQHĐ là một trong những kĩ_thuật quan_trọng .\nBài viết này sẽ giúp bạn hiểu được QHĐ thông_qua các ví_dụ cụ_thể .\nNote : Trong bài này có_thể có nhiều phần bạn đã biết , bạn hoàn_toàn có_thể chuyển qua đọc phần khác .\nBeginner_QHĐ là gì ?\nQHĐ là kĩ_thuật được được dùng khi có_một công_thức và một (hoặc một vài) trạng_thái bắt_đầu .\nMột bài_toán được tính bởi các bài_toán nhỏ hơn đã tìm_ra trước đó .\nQHĐ có độ phức_tạp đa_thức nên sẽ chạy nhanh hơn quay lui và duyệt trâu .\nĐể hiểu rõ hơn hãy xem ví_dụ sau : Cho_N đồng xu và giá tiền_của mỗi đồng (V_0 , V_1 , . . . , V_N-1~) , và số S .\nTìm số đồng xu nhỏ nhất để tổng_giá trị của chúng bằng S (số lượng đồng xu không giới hạn) .\nBây_giờ chúng_ta sẽ xây_dựng thuật_giải : Đầu_tiên , cần tìm một trạng_thái của bài_toán .\nTrạng_thái là gì ?\nTrạng_thái là một trường_hợp , một bài_toán con của bài_toán lớn .\nVí_dụ , trạng_thái trong bài này là số_lượng xu nhỏ nhất để tổng_bằng i , với i \\le S .\nĐể tìm_ra trạng_thái i , cần phải tìm tất_cả các trạng_thái j mà (j lt; i) .\nMột_khi đã tìm_ra trạng_thái i , ta có_thể dễ_dàng tìm_ra trạng_thái của i+1 .\nLàm thế_nào để tìm được ?\nVới mỗi j , V_j \\le i , tìm số đồng xu nhỏ nhất để tổng_bằng i-V_j .\nGiả_sử nó bằng m .\nNếu m+1 nhỏ hơn số_lượng đồng xu hiện_tại cho tổng i thì ta_cập nhập nó bằng m+1 .\nSau_đây là ví_dụ : Cho các đồng xu với giá tiền 1 , 3 và 5 .\nVà_S = 11 .\nĐầu_tiên , ta bắt_đầu_từ trạng_thái 0 , chúng_ta có f0 = 0 .\nXét đến tổng 1 .\nCó duy_nhất đồng xu 1 nhỏ hơn hoặc bằng tổng 1 , nên ta có f1 = f1-V_0 + 1 = f0 + 1 = 1 .\nXét đến tổng 2 .\nCũng giống_như tổng trước , chỉ_có 1 đổng_xu \\le 2 , có f2 = f2-V_0 + 1 = f1+1 = 2 Đến tổng 3 .\nLần này có 2 đồng xu \\le 3 là 1 và 3 .\n- Nếu ta chọn đồng 1 , ta có f3 = f3-V_0 + 1 = f2 + 1 = 3 - Nếu ta chọn đồng 3 , ta có f3 = f3-V_1 + 1 = f0 + 1 = 1 Rõ_ràng là 1 \\le 3 nên ta chọn đồng 3 và f3 = 1 Xét tiếp đến tổng 4 , rồi đến 11 bằng cách như_trên .\nMã giả : Gán_Mini bằng dương vô_cùng với mọi i Min0=0_For i = 1 to S_For j = 0 to N - 1 If (Vjlt;=i AND_Mini-Vj+1lt;Mini)_Then_Mini=Mini-Vj+1_Output_MinS_Đây là lời_giải cho tất_cả các tổng : Tổng_Lượng xu nhỏ nhất Xu được chọn (tổng còn lại) 0 0 - 1 1 1 (0) 2 2 1 (1) 3 1 3 (0) 4 2 1 (3) 5 1 5 (0) 6 2 3 (3) 7 3 1 (6) 8 2 3 (5) 9 3 1 (8) 10 2 5 (5) 11 3 1 (10) Vậy là chúng_ta đã tìm được_lời giải cho 3 đồng xu tổng_bằng 11 .\nDựa vào bảng trên , ta có_thể truy vết lại được những đồng xu nào được chọn để tối_ưu bài_toán .\nBài_QHĐ trên còn có_một cách tiếp_cận khác nữa .\nLần này , ta sẽ không tính liên_tiếp các tổng .\nBắt_đầu_từ trạng_thái 0 .\nThử nhét đồng xu thứ 1 vào các tổng đã tính .\nNếu_như tổng t có_số đồng xu ít_hơn số đồng xu hiện_tại thì tiến_hành cập_nhật .\nRồi tiếp_tục thử với đồng thứ 2 , 3 cho_đến khi thử hết các đồng .\nVí_dụ , nhét đồng 1 (giá trị 1) vào tổng 0 ta có tổng 1 .\nVì ta chưa tính tổng 1 nên S1 = 1 .\nNhét đồng 1 vào tổng 1 ta có S2 = 2 .\nTiếp_tục làm như_vậy với các tổng_còn lại .\nSau đồng 1 , ta nhét đồng 2(giá trị 3) vào tổng 0 ta được 1 , mà S3 = 3 gt; 1 , ta_cập nhật S3 = 1 .\nTiếp_tục nhét đồng 2 vào các tổng_còn lại , cũng nhứ thử nhét các đồng xu khác .\nElementary Bây_giờ , chúng_ta cùng đến một khái_niệm mới , công_thức truy_hồi (recurrent relation) , mối liên_hệ giữa những trạng_thái .\nVí_dụ : Cho một dãy N số - A1 , A2 , . . . , AN .\nTìm dãy con không giảm dài nhất .\nTa quy_định trạng_thái Si là dãy con không giảm dài nhất kết_thúc tại Ai . Với igt;1 và jlt;i , tính được i khi tồn_tại Aj \\le Ai (vì đây là dãy không giảm) .\nKhi đó Si = Max(Si , Sj + 1) .\nTiếp_tục tính như_vậy cho_đến khi đến được trạng_thái SN .\nHãy xem bảng sau với dãy : 5 , 3 , 4 , 8 , 6 , 7 : I Độ_dài dãy con không giảm dài nhất của i số đầu_tiên Vị_trí của kí_tự cuối trong dãy 1 1 1 2 1 2 3 2 2 4 3 3 5 3 3 6 4 5 Bài luyện_tập : Cho đồ_thị vô_hướng G có N đỉnh (N \\le 1000) và các cạnh có trọng số_dương .\nTìm đường_đi ngắn nhất từ đỉnh 1 đến đỉnh N hoặc thông_báo không tồn_tại đường_đi .\nGợi_ý : Tại mỗi bước , chọn ra trong số các đỉnh chưa thăm mà có đường_đi từ 1 , chọn ra đỉnh có đường_đi ngắn nhất .\nCác bài ví_dụ khác : ZigZag – 2003 TCCC_Semifinals 3 .\nBadNeighbors – 2004 TCCC_Round 4 .\nFlowerGarden – 2004 TCCC_Round 1 .\nIntermediate_Tới đây bạn sẽ được làm_quen với QHĐ 2 chiều .\nBài_toán : Cho một bảng M_N , mỗi ô có_một lượng táo .\nBắt_đầu_từ ô trái trên , mỗi bước có_thể đi sang phải hoặc xuống dưới .\nBạn có_thể ăn được nhiều nhất bao_nhiêu quả táo ?\nCách giải bài này cũng tương_tự như những bài trước .\nĐầu_tiên là phải xác_định trạng_thái là gì .\nỞ mỗi ô có nhiều nhất 2 cách có_thể tới được ô đó , từ ô bên trái và ô phía trên .\nDo_vậy , để tìm trạng_thái hiện_tại , ta phải tính trước các ô có_thể đến được nó .\nTa có_công thức truy_hồi sau : Sij=Aij + max(Si-1j , if igt;0 ; Sij-1 , if jgt;0) (trong đó , i là hàng , j là cột , Aij là số táo ở ô i , j) Sij có_thể được tính_từ trái sang phải , từ trên xuống dưới , hoặc từ trên xuống , từ trái sang .\nMã giả : For i = 0 to N - 1 For j = 0 to M - 1 Sij = Aij + max(Sij-1 , if jgt;0 ; Si-1j , if igt;0 ; 0) Output_Sn-1m-1 Ví_dụ khác : AvoidRoads – 2003 TCO_Semifinals 4 ChessMetric – 2003 TCCC_Round 4 Upper-Intermediate_Phần này sẽ giới_thiệu với bạn những bài_toán cùng_với một_số điều_kiện .\nĐây là một ví_dụ cụ_thể : Cho đồ_thị vô_hướng G có trọng số_dương và N đỉnh .\nBan_đầu bạn có_số tiền là M .\nĐể đi_qua đỉnh i , bạn phải trả số tiền là Si . Và đương_nhiên , nếu_không đủ tiền thì bạn không đi được .\nTìm đường_đi ngắn nhất từ 1 tới N thỏa_mãn tiêu_chí trên .\nNếu có nhiều đường ngắn nhất , in ra đường với chi_phí nhỏ nhất .\nGiới_hạn : 1lt;N \\le 100 ; 0 \\le M \\le 100; 0 \\le Si \\le 100 .\nCó_thể dễ_dàng thấy đây là một bài Dijkstra cơ_bản , tuy_nhiên chỉ khác ở chỗ nó có thêm một điều_kiện .\nTrong bài_toán Dijkstra cơ_bản ta có Mini , là độ_dài đường_đi ngắn nhất từ 1 tới i .\nCòn ở đây , chúng_ta cần phải quan_tâm đến số tiền còn_lại .\nDo_đó chúng_ta có_thể mở_rộng mảng này thành Minij , là độ_dài đường_đi ngắn nhất tới i , và còn_lại số tiền là j .\nBằng cách này bài_toán đã được đưa về bài_toán Dijkstra quen_thuộc .\nTại mỗi bước_ta tìm trạng_thái (i , j) có quãng đường ngắn nhất , đánh_dấu là đã thăm rồi update cho các trạng_thái cạnh nó .\nĐáp_án sẽ là MinNj có_giá trị nhỏ nhất (và j lớn nhất trong số các MinNj có cùng giá trị) .\nMã giả : Gán mọi(i , j) là chưa thăm Gán_Minij bằng dương vô_cùng với mọi (i , j) Min0M=0_While(TRUE)_Trong số những trạng_thái chưa thăm (i , j) tìm cái có Minij nhỏ nhất .\nGiải sử nó là (k , l) .\nNếu_không tìm được (k , l) nào mà Minkl nhỏ hơn dương vô_cùng - thoát vòng_lặp .\nĐánh_dấu (k , l) đã thăm For_All_Neighbors p of Vertex k .\nIf (l-Spgt;=0 AND_Minpl-Spgt;Minkl+Distkp)_Then_Minpl-Sp=Minkl+Distkp i . e . Nếu tại (i , j) có đủ tiền để đi_qua p (l-Sp là số tiền còn_lại sau khi đi_qua p) , và đường_đi ngắn nhất của (p , l-Sp) lớn hơn đường_đi ngắn nhất tới (k , l) + khoảng_cách từ k tới p) , thì gán (i , j) bằn tổng_này .\nEnd_For_End_While_Tìm số nhỏ nhất trong các MinN-1j (for all j , 0lt;=jlt;=M); Nếu có nhiều hơn một trạng_thái , lấy trạng_thái nào có j lớn nhất .\nNếu_không có (N-1 , j) nào nhỏ hơn dương vô_cùng - không tồn_tại đường_đi .\nCác bài luyện_tập : Jewelry – 2003 TCO_Online_Round 4 StripePainter – SRM 150 Div 1 QuickSums – SRM 197 Div 2 ShortPalindromes – SRM 165 Div 2 Advanced_Những bài sau_đây sẽ cần một_chút kĩ_năng phân_tích để có_thể tối_ưu chúng thành bài QHĐ .\nProblem_StarAdventure – SRM 208 Div 1 : Cho ma_trận M hàng , N cột (N M) .\nMỗi ô có_một lượng táo .\nBạn đang ở ô góc trái trên .\nBạn chỉ_có thể đi xuống hoặc sang phải .\nBạn cần tới ô góc phải dưới .\nRồi quay_lại ô trái trên bằng cách lên hoặc sang trái .\nCuối_cùng , bạn quay_lại ô phải dưới .\nTìm số táo nhiều nhất mà bạn có_thể ăn được .\nKhi đi_qua một ô , toàn_bộ táo của ô đấy sẽ bị ăn hết .\nGiới_hạn : 1 lt; N , M \\le 50 mỗi ô có từ 0 đến 1000 quả táo .\nĐọc đến đây , hẳn bạn sẽ thấy cái đề này quen_quen , nó chính là bài mở_rộng của bài_toán phần Intermediate .\nTa có_thể thử đưa bài_toán này về thành bài_toán trên .\nĐể_ý thấy đường_đi từ ô góc phải dưới lên trái trên cũng có_thể coi là một đường_đi từ góc trái trên xuống .\nNhư_vậy , chúng_ta phải xử_lý bài_toán với 3 đường_đi từ trái trên xuống .\nGọi 3 đường này là trái , giữa và phải .\nKhi 2 đường giao nhau (như hình dưới) : thì nó cũng tương_đương với hình sau : Bằng cách này , chúng_ta đã có_một cái nhìn khác về bài_toán .\nCác đường này sẽ không giao nhau (trừ ô góc trái trên và phải dưới) .\nVới mỗi hàng y (không phải hàng_đầu và cuối) , tọa_độ x ở mỗi đường sẽ là (x1y , x2y và x3y ) : x1y lt; x2y lt; x3y .\nTa xét hàng thứ y .\nGiả_sử , ta xét x1y-1 , x2y-1 and x3y-1 và số táo hiện_giờ thu được là nhiều nhất .\nTừ_đó ta có_thể tối_ưu cho hàng y .\nChúng_ta cần tìm cách chuyển trạng_thái .\nGọi_Maxijk là lượng táo nhiều nhất thu được đến hàng y-1 với 3 đường đang dừng ở cột i , j , và k .\nVới hàng y , thêm vào Maxijk số_lượng táo ở các ô (y , i) , (y , j) and (y , k) .\nVì chúng_ta đang đi xuống .\nSau_đó , chúng_ta xét đến những đường có_thể sang phải .\nĐể tránh việc giao nhau , ta xét lần_lượt các bước ở trái , phải_rồi giữa .\nBài luyện_tập thêm : MiniPaint – SRM 178 Div 1 Note : Khi gặp một bài_toán , hãy để_ý xem nó có được giải trong thời_gian đa_thức không .\nNếu có , thử xác_định trạng_thái của nó , cách chuyển trạng_thái , và nếu_không chuyển được trạng_thái , hãy thử tối_ưu nó về một bài QHĐ (như ví_dụ ở trên) .\nNhững bài đã đề_cập ở trên : TCCC ’03 Semifinals 3 Div_I_Easy – ZigZag_TCCC ’04 Round 4 Div_I_Easy – BadNeighbors_TCCC ’04 Round 1 Div_I_Med – FlowerGarden_TCO ’03 Semifinals 4 Div_I_Easy – AvoidRoads_TCCC ’03 Round 4 Div_I_Easy – ChessMetric_TCO ’03 Round 4 Div_I_Med – Jewelry_SRM 150 Div_I_Med – StripePainter_SRM 197 Div_II_Hard – QuickSums_SRM 165 Div_II_Hard – ShortPalindromes_SRM 208 Div_I_Hard – StarAdventure_SRM 178 Div_I_Hard – MiniPaint\n", "tagged": "Nguồn/N :/CH Topcoder/Np ./CH\nCó/V rất/R nhiều/A bài_toán/N được/V áp_dụng/V quy_hoạch_động/Np (QHĐ)/Np (/CH Dynamic_Programming/Np )/CH ./CH\nQHĐ/Np là/V một/M trong/E những/L kĩ_thuật/N quan_trọng/A ./CH\nBài/N viết/V này/P sẽ/R giúp/V bạn/N hiểu/V được/V QHĐ/Np thông_qua/V các/L ví_dụ/C cụ_thể/A ./CH\nNote/Np :/CH Trong/E bài/N này/P có_thể/R có/V nhiều/A phần/N bạn/N đã/R biết/V ,/CH bạn/N hoàn_toàn/A có_thể/R chuyển/V qua/V đọc/V phần/N khác/A ./CH\nBeginner_QHĐ/Np là/V gì/P ?/CH\nQHĐ/Np là/V kĩ_thuật/N được/V được/V dùng/V khi/N có_một/Np công_thức/N và/Cc một/M (hoặc/Np một/M vài)/Np trạng_thái/N bắt_đầu/V ./CH\nMột/M bài_toán/N được/V tính/V bởi/E các/L bài_toán/N nhỏ/A hơn/A đã/R tìm_ra/Np trước/E đó/P ./CH\nQHĐ/Np có/V độ/N phức_tạp/A đa_thức/Np nên/C sẽ/R chạy/V nhanh/A hơn/A quay/V lui/V và/Cc duyệt/V trâu/N ./CH\nĐể/E hiểu/V rõ/A hơn/A hãy/R xem/V ví_dụ/C sau/E :/CH Cho_N/Np đồng/Nu xu/N và/Cc giá/N tiền_của/Np mỗi/L đồng/Nu (V_0/Np ,/CH V_1/Np ,/CH ./CH ./CH ./CH ,/CH V_N-1~)/Np ,/CH và/Cc số/N S/Y ./CH\nTìm/V số/N đồng/Nu xu/N nhỏ/A nhất/A để/E tổng_giá/Np trị/V của/E chúng/P bằng/E S/Y (số/Np lượng/N đồng/Nu xu/N không/R giới/N hạn)/Np ./CH\nBây_giờ/P chúng_ta/P sẽ/R xây_dựng/V thuật_giải/Np :/CH Đầu_tiên/A ,/CH cần/V tìm/V một/M trạng_thái/N của/E bài_toán/N ./CH\nTrạng_thái/N là/V gì/P ?/CH\nTrạng_thái/N là/V một/M trường_hợp/N ,/CH một/M bài_toán/N con/Nc của/E bài_toán/N lớn/A ./CH\nVí_dụ/C ,/CH trạng_thái/N trong/E bài/N này/P là/V số_lượng/N xu/N nhỏ/A nhất/A để/E tổng_bằng/Np i/M ,/CH với/E i/M \\le/Np S/Y ./CH\nĐể/E tìm_ra/Np trạng_thái/N i/M ,/CH cần/V phải/V tìm/V tất_cả/P các/L trạng_thái/N j/Np mà/C (j/Np lt;/Np i)/Np ./CH\nMột_khi/X đã/R tìm_ra/Np trạng_thái/N i/M ,/CH ta/P có_thể/R dễ_dàng/A tìm_ra/Np trạng_thái/N của/E i+1/Np ./CH\nLàm/V thế_nào/P để/E tìm/V được/V ?/CH\nVới/E mỗi/L j/Np ,/CH V_j/Np \\le/Np i/M ,/CH tìm/V số/N đồng/Nu xu/N nhỏ/A nhất/A để/E tổng_bằng/Np i-V_j/Np ./CH\nGiả_sử/Np nó/P bằng/E m/Nu ./CH\nNếu/C m+1/Np nhỏ/A hơn/A số_lượng/N đồng/Nu xu/N hiện_tại/N cho/E tổng/N i/M thì/C ta_cập/Np nhập/V nó/P bằng/E m+1/Np ./CH\nSau_đây/Np là/V ví_dụ/C :/CH Cho/E các/L đồng/Nu xu/N với/E giá/N tiền/N 1/M ,/CH 3/M và/Cc 5/M ./CH\nVà_S/Np =/CH 11/M ./CH\nĐầu_tiên/A ,/CH ta/P bắt_đầu_từ/Np trạng_thái/N 0/M ,/CH chúng_ta/P có/V f0/Np =/CH 0/M ./CH\nXét/V đến/E tổng/N 1/M ./CH\nCó/V duy_nhất/A đồng/Nu xu/N 1/M nhỏ/A hơn/A hoặc/Cc bằng/E tổng/N 1/M ,/CH nên/C ta/P có/V f1/Ny =/CH f1-V_0/Np +/CH 1/M =/CH f0/Np +/CH 1/M =/CH 1/M ./CH\nXét/V đến/E tổng/N 2/M ./CH\nCũng/R giống_như/Np tổng/N trước/E ,/CH chỉ_có/Np 1/M đổng_xu/Np \\le/Np 2/M ,/CH có/V f2/Ny =/CH f2-V_0/Np +/CH 1/M =/CH f1+1/Np =/CH 2/M Đến/E tổng/N 3/M ./CH\nLần/N này/P có/V 2/M đồng/Nu xu/N \\le/Np 3/M là/V 1/M và/Cc 3/M ./CH\n-/CH Nếu/C ta/P chọn/V đồng/Nu 1/M ,/CH ta/P có/V f3/Ny =/CH f3-V_0/Np +/CH 1/M =/CH f2/Ny +/CH 1/M =/CH 3/M -/CH Nếu/C ta/P chọn/V đồng/Nu 3/M ,/CH ta/P có/V f3/Ny =/CH f3-V_1/Np +/CH 1/M =/CH f0/Np +/CH 1/M =/CH 1/M Rõ_ràng/A là/V 1/M \\le/Np 3/M nên/C ta/P chọn/V đồng/Nu 3/M và/Cc f3/Ny =/CH 1/M Xét/V tiếp/V đến/E tổng/N 4/M ,/CH rồi/C đến/E 11/M bằng/E cách/N như_trên/Np ./CH\nMã/N giả/A :/CH Gán_Mini/Np bằng/E dương/A vô_cùng/R với/E mọi/L i/M Min0=0_For/Np i/M =/CH 1/M to/A S_For/Np j/Np =/CH 0/M to/A N/Ny -/CH 1/M If/Np (Vjlt;=i/Np AND_Mini-Vj+1lt;Mini)_Then_Mini=Mini-Vj+1_Output_MinS_Đây/Np là/V lời_giải/Np cho/E tất_cả/P các/L tổng/N :/CH Tổng_Lượng/N xu/N nhỏ/A nhất/A Xu/N được/V chọn/V (tổng/Np còn/R lại)/Np 0/M 0/M -/CH 1/M 1/M 1/M (0)/Np 2/M 2/M 1/M (1)/Np 3/M 1/M 3/M (0)/Np 4/M 2/M 1/M (3)/Np 5/M 1/M 5/M (0)/Np 6/M 2/M 3/M (3)/Np 7/M 3/M 1/M (6)/Np 8/M 2/M 3/M (5)/Np 9/M 3/M 1/M (8)/Np 10/M 2/M 5/M (5)/Np 11/M 3/M 1/M (10)/Np Vậy/P là/V chúng_ta/P đã/R tìm/V được_lời/Np giải/N cho/E 3/M đồng/Nu xu/N tổng_bằng/Np 11/M ./CH\nDựa/V vào/E bảng/N trên/E ,/CH ta/P có_thể/R truy/V vết/N lại/R được/V những/L đồng/Nu xu/N nào/P được/V chọn/V để/E tối_ưu/A bài_toán/N ./CH\nBài_QHĐ/Np trên/E còn/R có_một/Np cách/N tiếp_cận/V khác/A nữa/R ./CH\nLần/N này/P ,/CH ta/P sẽ/R không/R tính/V liên_tiếp/A các/L tổng/N ./CH\nBắt_đầu_từ/Np trạng_thái/N 0/M ./CH\nThử/V nhét/V đồng/Nu xu/N thứ/N 1/M vào/E các/L tổng/N đã/R tính/V ./CH\nNếu_như/C tổng/N t/Nu có_số/Np đồng/Nu xu/N ít_hơn/Np số/N đồng/Nu xu/N hiện_tại/N thì/C tiến_hành/V cập_nhật/V ./CH\nRồi/C tiếp_tục/V thử/V với/E đồng/Nu thứ/N 2/M ,/CH 3/M cho_đến/E khi/N thử/V hết/V các/L đồng/Nu ./CH\nVí_dụ/C ,/CH nhét/V đồng/Nu 1/M (giá/Np trị/V 1)/Np vào/E tổng/N 0/M ta/P có/V tổng/N 1/M ./CH\nVì/E ta/P chưa/R tính/V tổng/N 1/M nên/C S1/Np =/CH 1/M ./CH\nNhét/V đồng/Nu 1/M vào/E tổng/N 1/M ta/P có/V S2/Np =/CH 2/M ./CH\nTiếp_tục/V làm/V như_vậy/X với/E các/L tổng_còn/Np lại/R ./CH\nSau/E đồng/Nu 1/M ,/CH ta/P nhét/V đồng/Nu 2(giá/Np trị/V 3)/Np vào/E tổng/N 0/M ta/P được/V 1/M ,/CH mà/C S3/Np =/CH 3/M gt;/Np 1/M ,/CH ta_cập/Np nhật/N S3/Np =/CH 1/M ./CH\nTiếp_tục/V nhét/V đồng/Nu 2/M vào/E các/L tổng_còn/Np lại/R ,/CH cũng/R nhứ/Np thử/V nhét/V các/L đồng/Nu xu/N khác/A ./CH\nElementary/Np Bây_giờ/P ,/CH chúng_ta/P cùng/A đến/E một/M khái_niệm/N mới/R ,/CH công_thức/N truy_hồi/Np (recurrent/Np relation)/Np ,/CH mối/N liên_hệ/V giữa/N những/L trạng_thái/N ./CH\nVí_dụ/C :/CH Cho/E một/M dãy/Nc N/Ny số/N -/CH A1/Np ,/CH A2/Np ,/CH ./CH ./CH ./CH ,/CH AN/A ./CH\nTìm/V dãy/Nc con/Nc không/R giảm/V dài/A nhất/A ./CH\nTa/P quy_định/N trạng_thái/N Si/Ny là/V dãy/Nc con/Nc không/R giảm/V dài/A nhất/A kết_thúc/V tại/E Ai/P ./CH Với/E igt;1/Np và/Cc jlt;i/Np ,/CH tính/V được/V i/M khi/N tồn_tại/V Aj/Np \\le/Np Ai/P (vì/Np đây/P là/V dãy/Nc không/R giảm)/Np ./CH\nKhi/N đó/P Si/Ny =/CH Max(Si/Np ,/CH Sj/Np +/CH 1)/Np ./CH\nTiếp_tục/V tính/V như_vậy/X cho_đến/E khi/N đến/E được/V trạng_thái/N SN/Ny ./CH\nHãy/R xem/V bảng/N sau/E với/E dãy/Nc :/CH 5/M ,/CH 3/M ,/CH 4/M ,/CH 8/M ,/CH 6/M ,/CH 7/M :/CH I/M Độ_dài/Np dãy/Nc con/Nc không/R giảm/V dài/A nhất/A của/E i/M số/N đầu_tiên/A Vị_trí/N của/E kí_tự/Np cuối/N trong/E dãy/Nc 1/M 1/M 1/M 2/M 1/M 2/M 3/M 2/M 2/M 4/M 3/M 3/M 5/M 3/M 3/M 6/M 4/M 5/M Bài/N luyện_tập/V :/CH Cho/E đồ_thị/Np vô_hướng/Np G/Nu có/V N/Ny đỉnh/N (N/Np \\le/Np 1000)/Np và/Cc các/L cạnh/N có/V trọng/Np số_dương/Np ./CH\nTìm/V đường_đi/Np ngắn/A nhất/A từ/E đỉnh/N 1/M đến/E đỉnh/N N/Ny hoặc/Cc thông_báo/V không/R tồn_tại/V đường_đi/Np ./CH\nGợi_ý/V :/CH Tại/E mỗi/L bước/V ,/CH chọn/V ra/V trong/E số/N các/L đỉnh/N chưa/R thăm/V mà/C có/V đường_đi/Np từ/E 1/M ,/CH chọn/V ra/V đỉnh/N có/V đường_đi/Np ngắn/A nhất/A ./CH\nCác/L bài/N ví_dụ/C khác/A :/CH ZigZag/Np –/CH 2003/M TCCC_Semifinals/Np 3/M ./CH\nBadNeighbors/Np –/CH 2004/M TCCC_Round/Np 4/M ./CH\nFlowerGarden/Np –/CH 2004/M TCCC_Round/Np 1/M ./CH\nIntermediate_Tới/Np đây/P bạn/N sẽ/R được/V làm_quen/V với/E QHĐ/Np 2/M chiều/N ./CH\nBài_toán/N :/CH Cho/E một/M bảng/N M_N/Np ,/CH mỗi/L ô/N có_một/Np lượng/N táo/Np ./CH\nBắt_đầu_từ/Np ô/N trái/Nc trên/E ,/CH mỗi/L bước/V có_thể/R đi/V sang/V phải/V hoặc/Cc xuống/V dưới/E ./CH\nBạn/N có_thể/R ăn/V được/V nhiều/A nhất/A bao_nhiêu/P quả/N táo/Np ?/CH\nCách/N giải/N bài/N này/P cũng/R tương_tự/A như/C những/L bài/N trước/E ./CH\nĐầu_tiên/A là/V phải/V xác_định/V trạng_thái/N là/V gì/P ./CH\nỞ/E mỗi/L ô/N có/V nhiều/A nhất/A 2/M cách/N có_thể/R tới/E được/V ô/N đó/P ,/CH từ/E ô/N bên/N trái/Nc và/Cc ô/N phía/N trên/E ./CH\nDo_vậy/C ,/CH để/E tìm/V trạng_thái/N hiện_tại/N ,/CH ta/P phải/V tính/V trước/E các/L ô/N có_thể/R đến/E được/V nó/P ./CH\nTa/P có_công/Np thức/V truy_hồi/Np sau/E :/CH Sij=Aij/Np +/CH max(Si-1j/Np ,/CH if/Np igt;0/Np ;/CH Sij-1/Np ,/CH if/Np jgt;0)/Np (trong/Np đó/P ,/CH i/M là/V hàng/N ,/CH j/Np là/V cột/N ,/CH Aij/Np là/V số/N táo/Np ở/E ô/N i/M ,/CH j)/Np Sij/Np có_thể/R được/V tính_từ/Np trái/Nc sang/V phải/V ,/CH từ/E trên/E xuống/V dưới/E ,/CH hoặc/Cc từ/E trên/E xuống/V ,/CH từ/E trái/Nc sang/V ./CH\nMã/N giả/A :/CH For/Np i/M =/CH 0/M to/A N/Ny -/CH 1/M For/Np j/Np =/CH 0/M to/A M/Nu -/CH 1/M Sij/Np =/CH Aij/Np +/CH max(Sij-1/Np ,/CH if/Np jgt;0/Np ;/CH Si-1j/Np ,/CH if/Np igt;0/Np ;/CH 0)/Np Output_Sn-1m-1/Np Ví_dụ/C khác/A :/CH AvoidRoads/Np –/CH 2003/M TCO_Semifinals/Np 4/M ChessMetric/Np –/CH 2003/M TCCC_Round/Np 4/M Upper-Intermediate_Phần/Np này/P sẽ/R giới_thiệu/V với/E bạn/N những/L bài_toán/N cùng_với/C một_số/L điều_kiện/N ./CH\nĐây/P là/V một/M ví_dụ/C cụ_thể/A :/CH Cho/E đồ_thị/Np vô_hướng/Np G/Nu có/V trọng/Np số_dương/Np và/Cc N/Ny đỉnh/N ./CH\nBan_đầu/N bạn/N có_số/Np tiền/N là/V M/Nu ./CH\nĐể/E đi_qua/Np đỉnh/N i/M ,/CH bạn/N phải/V trả/V số/N tiền/N là/V Si/Ny ./CH Và/Cc đương_nhiên/Np ,/CH nếu_không/Np đủ/A tiền/N thì/C bạn/N không/R đi/V được/V ./CH\nTìm/V đường_đi/Np ngắn/A nhất/A từ/E 1/M tới/E N/Ny thỏa_mãn/V tiêu_chí/N trên/E ./CH\nNếu/C có/V nhiều/A đường/N ngắn/A nhất/A ,/CH in/V ra/V đường/N với/E chi_phí/N nhỏ/A nhất/A ./CH\nGiới_hạn/V :/CH 1lt;N/Np \\le/Np 100/M ;/CH 0/M \\le/Np M/Nu \\le/Np 100;/Np 0/M \\le/Np Si/Ny \\le/Np 100/M ./CH\nCó_thể/R dễ_dàng/A thấy/V đây/P là/V một/M bài/N Dijkstra/Np cơ_bản/A ,/CH tuy_nhiên/C chỉ/R khác/A ở/E chỗ/N nó/P có/V thêm/V một/M điều_kiện/N ./CH\nTrong/E bài_toán/N Dijkstra/Np cơ_bản/A ta/P có/V Mini/A ,/CH là/V độ_dài/Np đường_đi/Np ngắn/A nhất/A từ/E 1/M tới/E i/M ./CH\nCòn/R ở/E đây/P ,/CH chúng_ta/P cần/V phải/V quan_tâm/V đến/E số/N tiền/N còn_lại/Np ./CH\nDo_đó/C chúng_ta/P có_thể/R mở_rộng/V mảng/N này/P thành/V Minij/Np ,/CH là/V độ_dài/Np đường_đi/Np ngắn/A nhất/A tới/E i/M ,/CH và/Cc còn_lại/Np số/N tiền/N là/V j/Np ./CH\nBằng/E cách/N này/P bài_toán/N đã/R được/V đưa/V về/E bài_toán/N Dijkstra/Np quen_thuộc/A ./CH\nTại/E mỗi/L bước_ta/Np tìm/V trạng_thái/N (i/Np ,/CH j)/Np có/V quãng/N đường/N ngắn/A nhất/A ,/CH đánh_dấu/V là/V đã/R thăm/V rồi/C update/Np cho/E các/L trạng_thái/N cạnh/N nó/P ./CH\nĐáp_án/N sẽ/R là/V MinNj/Np có_giá/Np trị/V nhỏ/A nhất/A (và/Np j/Np lớn/A nhất/A trong/E số/N các/L MinNj/Np có/V cùng/A giá/N trị)/Np ./CH\nMã/N giả/A :/CH Gán/V mọi(i/Np ,/CH j)/Np là/V chưa/R thăm/V Gán_Minij/Np bằng/E dương/A vô_cùng/R với/E mọi/L (i/Np ,/CH j)/Np Min0M=0_While(TRUE)_Trong/Np số/N những/L trạng_thái/N chưa/R thăm/V (i/Np ,/CH j)/Np tìm/V cái/Nc có/V Minij/Np nhỏ/A nhất/A ./CH\nGiải/N sử/Np nó/P là/V (k/Np ,/CH l)/Np ./CH\nNếu_không/Np tìm/V được/V (k/Np ,/CH l)/Np nào/P mà/C Minkl/Np nhỏ/A hơn/A dương/A vô_cùng/R -/CH thoát/V vòng_lặp/Np ./CH\nĐánh_dấu/V (k/Np ,/CH l)/Np đã/R thăm/V For_All_Neighbors/Np p/Ny of/E Vertex/Np k/N ./CH\nIf/Np (l-Spgt;=0/Np AND_Minpl-Spgt;Minkl+Distkp)_Then_Minpl-Sp=Minkl+Distkp/Np i/M ./CH e/Ni ./CH Nếu/C tại/E (i/Np ,/CH j)/Np có/V đủ/A tiền/N để/E đi_qua/Np p/Ny (l-Sp/Np là/V số/N tiền/N còn_lại/Np sau/E khi/N đi_qua/Np p)/Np ,/CH và/Cc đường_đi/Np ngắn/A nhất/A của/E (p/Np ,/CH l-Sp)/Np lớn/A hơn/A đường_đi/Np ngắn/A nhất/A tới/E (k/Np ,/CH l)/Np +/CH khoảng_cách/N từ/E k/N tới/E p)/Np ,/CH thì/C gán/V (i/Np ,/CH j)/Np bằn/Np tổng_này/Np ./CH\nEnd_For_End_While_Tìm/Np số/N nhỏ/A nhất/A trong/E các/L MinN-1j/Np (for/Np all/Np j/Np ,/CH 0lt;=jlt;=M);/Np Nếu/C có/V nhiều/A hơn/A một/M trạng_thái/N ,/CH lấy/V trạng_thái/N nào/P có/V j/Np lớn/A nhất/A ./CH\nNếu_không/Np có/V (N-1/Np ,/CH j)/Np nào/P nhỏ/A hơn/A dương/A vô_cùng/R -/CH không/R tồn_tại/V đường_đi/Np ./CH\nCác/L bài/N luyện_tập/V :/CH Jewelry/Np –/CH 2003/M TCO_Online_Round/Np 4/M StripePainter/Np –/CH SRM/Np 150/M Div/Np 1/M QuickSums/Np –/CH SRM/Np 197/Np Div/Np 2/M ShortPalindromes/Np –/CH SRM/Np 165/M Div/Np 2/M Advanced_Những/Np bài/N sau_đây/Np sẽ/R cần/V một_chút/L kĩ_năng/N phân_tích/V để/E có_thể/R tối_ưu/A chúng/P thành/V bài/N QHĐ/Np ./CH\nProblem_StarAdventure/Np –/CH SRM/Np 208/Np Div/Np 1/M :/CH Cho/E ma_trận/N M/Nu hàng/N ,/CH N/Ny cột/N (N/Np M)/Np ./CH\nMỗi/L ô/N có_một/Np lượng/N táo/Np ./CH\nBạn/N đang/R ở/E ô/N góc/N trái/Nc trên/E ./CH\nBạn/N chỉ_có/Np thể/N đi/V xuống/V hoặc/Cc sang/V phải/V ./CH\nBạn/N cần/V tới/E ô/N góc/N phải/V dưới/E ./CH\nRồi/C quay_lại/Np ô/N trái/Nc trên/E bằng/E cách/N lên/V hoặc/Cc sang/V trái/Nc ./CH\nCuối_cùng/A ,/CH bạn/N quay_lại/Np ô/N phải/V dưới/E ./CH\nTìm/V số/N táo/Np nhiều/A nhất/A mà/C bạn/N có_thể/R ăn/V được/V ./CH\nKhi/N đi_qua/Np một/M ô/N ,/CH toàn_bộ/L táo/Np của/E ô/N đấy/P sẽ/R bị/V ăn/V hết/V ./CH\nGiới_hạn/V :/CH 1/M lt;/Np N/Ny ,/CH M/Nu \\le/Np 50/M mỗi/L ô/N có/V từ/E 0/M đến/E 1000/M quả/N táo/Np ./CH\nĐọc/V đến/E đây/P ,/CH hẳn/R bạn/N sẽ/R thấy/V cái/Nc đề/V này/P quen_quen/Np ,/CH nó/P chính/T là/V bài/N mở_rộng/V của/E bài_toán/N phần/N Intermediate/Np ./CH\nTa/P có_thể/R thử/V đưa/V bài_toán/N này/P về/E thành/V bài_toán/N trên/E ./CH\nĐể_ý/V thấy/V đường_đi/Np từ/E ô/N góc/N phải/V dưới/E lên/V trái/Nc trên/E cũng/R có_thể/R coi/V là/V một/M đường_đi/Np từ/E góc/N trái/Nc trên/E xuống/V ./CH\nNhư_vậy/X ,/CH chúng_ta/P phải/V xử_lý/V bài_toán/N với/E 3/M đường_đi/Np từ/E trái/Nc trên/E xuống/V ./CH\nGọi/V 3/M đường/N này/P là/V trái/Nc ,/CH giữa/N và/Cc phải/V ./CH\nKhi/N 2/M đường/N giao/V nhau/N (như/Np hình/N dưới)/Np :/CH thì/C nó/P cũng/R tương_đương/A với/E hình/N sau/E :/CH Bằng/E cách/N này/P ,/CH chúng_ta/P đã/R có_một/Np cái/Nc nhìn/V khác/A về/E bài_toán/N ./CH\nCác/L đường/N này/P sẽ/R không/R giao/V nhau/N (trừ/Np ô/N góc/N trái/Nc trên/E và/Cc phải/V dưới)/Np ./CH\nVới/E mỗi/L hàng/N y/N (không/Np phải/V hàng_đầu/N và/Cc cuối)/Np ,/CH tọa_độ/Np x/CH ở/E mỗi/L đường/N sẽ/R là/V (x1y/Np ,/CH x2y/Np và/Cc x3y/Np )/CH :/CH x1y/Np lt;/Np x2y/Np lt;/Np x3y/Np ./CH\nTa/P xét/V hàng/N thứ/N y/N ./CH\nGiả_sử/Np ,/CH ta/P xét/V x1y-1/Np ,/CH x2y-1/Np and/Np x3y-1/Np và/Cc số/N táo/Np hiện_giờ/N thu/V được/V là/V nhiều/A nhất/A ./CH\nTừ_đó/Np ta/P có_thể/R tối_ưu/A cho/E hàng/N y/N ./CH\nChúng_ta/P cần/V tìm/V cách/N chuyển/V trạng_thái/N ./CH\nGọi_Maxijk/Np là/V lượng/N táo/Np nhiều/A nhất/A thu/V được/V đến/E hàng/N y-1/Np với/E 3/M đường/N đang/R dừng/V ở/E cột/N i/M ,/CH j/Np ,/CH và/Cc k/N ./CH\nVới/E hàng/N y/N ,/CH thêm/V vào/E Maxijk/Np số_lượng/N táo/Np ở/E các/L ô/N (y/Np ,/CH i)/Np ,/CH (y/Np ,/CH j)/Np and/Np (y/Np ,/CH k)/Np ./CH\nVì/E chúng_ta/P đang/R đi/V xuống/V ./CH\nSau_đó/Np ,/CH chúng_ta/P xét/V đến/E những/L đường/N có_thể/R sang/V phải/V ./CH\nĐể/E tránh/V việc/N giao/V nhau/N ,/CH ta/P xét/V lần_lượt/R các/L bước/V ở/E trái/Nc ,/CH phải_rồi/Np giữa/N ./CH\nBài/N luyện_tập/V thêm/V :/CH MiniPaint/Np –/CH SRM/Np 178/Np Div/Np 1/M Note/Np :/CH Khi/N gặp/V một/M bài_toán/N ,/CH hãy/R để_ý/V xem/V nó/P có/V được/V giải/N trong/E thời_gian/N đa_thức/Np không/R ./CH\nNếu/C có/V ,/CH thử/V xác_định/V trạng_thái/N của/E nó/P ,/CH cách/N chuyển/V trạng_thái/N ,/CH và/Cc nếu_không/Np chuyển/V được/V trạng_thái/N ,/CH hãy/R thử/V tối_ưu/A nó/P về/E một/M bài/N QHĐ/Np (như/Np ví_dụ/C ở/E trên)/Np ./CH\nNhững/L bài/N đã/R đề_cập/V ở/E trên/E :/CH TCCC/Np ’03/Np Semifinals/Np 3/M Div_I_Easy/Np –/CH ZigZag_TCCC/Np ’04/Np Round/Np 4/M Div_I_Easy/Np –/CH BadNeighbors_TCCC/Np ’04/Np Round/Np 1/M Div_I_Med/Np –/CH FlowerGarden_TCO/Np ’03/Np Semifinals/Np 4/M Div_I_Easy/Np –/CH AvoidRoads_TCCC/Np ’03/Np Round/Np 4/M Div_I_Easy/Np –/CH ChessMetric_TCO/Np ’03/Np Round/Np 4/M Div_I_Med/Np –/CH Jewelry_SRM/Np 150/M Div_I_Med/Np –/CH StripePainter_SRM/Np 197/Np Div_II_Hard/Np –/CH QuickSums_SRM/Np 165/M Div_II_Hard/Np –/CH ShortPalindromes_SRM/Np 208/Np Div_I_Hard/Np –/CH StarAdventure_SRM/Np 178/Np Div_I_Hard/Np –/CH MiniPaint/Np\n", "title": "Nhập môn Quy hoạch động\n", "link": "http://vnoi.info/wiki/translate/topcoder/dynamic-programming\n"}