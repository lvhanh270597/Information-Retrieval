{"content": "Nơi tổng_hợp và chia_sẻ những kiến_thức liên_quan tới giải_thuật nói_chung và lý_thuyết khoa_học máy_tính nói_riêng .\nin Chúng_ta đã tìm_hiểu thuật_toán Floyd-Warshall tìm đường_đi ngắn nhất giữa mọi cặp đỉnh trong thời_gian .\nThuật_toán này áp_dụng được cho cả trường_hợp đồ_thị và không có chu_trình âm .\nCho_đến nay vẫn chưa có thuật_toán nào thực_sự nhanh hơn (xem lại phần Remark cuối_cùng của bài ) .\nVới đồ_thị , chúng_ta cũng đã biết rằng áp_dụng thuật_toán Dijkstra (với Fibonacci_Heap) lần , ta sẽ thu được thuật_toán .\nVới đồ_thị_thưa () , thuật_toán này rõ_ràng nhanh hơn một_cách đáng_kể .\nỞ đây mình nhấn_mạnh đồ_thị không có trọng số_âm thì ta mới áp_dụng Dijkstra được .\nVấn_đề của bài này là đồ_thị có trọng số_âm : Năm 1977 , Johnson 1 đưa_ra câu một câu trả_lời cho câu_hỏi trên : cũng trong bài báo 1 , Johson giới_thiệu cấu_trúc Heap -phân để thực_thi Dijkstra mà ta đã tìm_hiểu ở bài .\nÝ_tưởng của thuật_toán Johnson : Thay_đổi trọng số của các cung của để thu được đồ_thị sao_cho : (i) trọng số cung của đồ_thị không âm; do_đó ta có_thể áp_dụng Dijkstra cho để tìm đường_đi ngắn nhất giữa mọi cặp đỉnh trong và (ii) đường_đi ngắn nhất giữa hai đỉnh bất_kì của cũng chính là đường_đi ngắn nhất giữa hai đỉnh tương_ứng của . Ta gọi thủ_tục để thực_hiện ý_tưởng trên là một_phép (reduction) từ về .\nKhái_niệm quy dẫn là khái_niệm mà ta sẽ rất hay gặp trong lý_thuyết độ phức_tạp của thuật_toán .\nChú_ý là hai đồ_thị và có cùng tập đỉnh và tập các cung (trọng số của các cung có_thể khác nhau) . Để phát_biểu thuật_toán một_cách tỉ_mỉ hơn , ta cần thêm một_số định_nghĩa và khái_niệm .\nVới mỗi đường_đi giữa hai đỉnh bất_kì trong đồ_thị , ta định_nghĩa của đường_đi (kí hiệu ) bằng trọng số của đường_đi đó trong trừ đi trọng số của cùng_đường đi trong .\nMột_cách hình_thức : trong đó kí_hiệu (hoặc ) là trọng số của đường_đi trong ( hoặc ) . Một_cách đơn_giản nhất để thực_hiện (i) đó là cộng trọng số của tất_cả các cung của với cùng một trọng số đủ lớn để thu được mọi cung đều không âm .\nSau_đó từ_đường đi ngắn nhất giữa hai đỉnh trên đồ_thị , với mỗi cung trên đường_đi , ta trừ đơn_vị trọng số để thu được đường_đi ngắn nhất trong .\nCách làm trên thoạt_đầu nghe có_vẻ đúng nhưng thực_tế là sai (tại sao ? ) .\nTuy_nhiên tư_tưởng của nó vẫn được Johnson áp_dụng trong thuật_toán của mình .\nThay_vì cộng tất_cả các cung với cùng một trọng số , Johnson cộng với mỗi cung một trọng số phụ_thuộc vào chính_cung này .\nCụ_thể , trọng số sẽ được cộng với một_số sao_cho trọng số mới thu được , thỏa_mãn : Để đảm_bảo đường_đi ngắn nhất giữa bất_kì hai đỉnh nào trong cũng là đường_đi ngắn nhất giữa và trong và ngược_lại , ta phải đảm_bảo : Nếu và là hai đường_đi giữa và thỏa_mãn thì .\nNhư_vậy , quan_hệ \"ngắn hơn\" giữa hai đường_đi bất_kì với cùng điểm đầu điểm cuối phải được bảo_toàn khi ta quy dẫn về .\nJohnson đảm_bảo điều này bằng cách chọn sao_cho mọi đường_đi từ tới đều có cùng độ_lệch .\nvới mọi là hai đường_đi khác_nhau bất_kì từ tới và là hàm chỉ phụ_thuộc vào .\nTa sẽ chứng_minh : Giả_sử và là hai đường_đi bất_kì giữa và thỏa_mãn : .\nDo , ta có : Theo định_nghĩa : và Từ_đó ta suy ra , đó là dpcm .\nBài_toán của chúng_ta bây_giờ là đảm_bảo : Độ_lệch của một đường_đi chỉ phụ_thuộc vào điểm đầu và điểm cuối mà không phụ_thuộc vào chính đường_đi đó . Johson chọn với là (potential) của đỉnh (ta sẽ mô_tả chỉ tiết sau) .\nTa sẽ chứng_minh với cách chọn như_vậy , tính bất_biến của độ_lệch sẽ được thỏa_mãn : trong đó là hai đỉnh bất_kì thuộc đồ_thị .\nGọi_là một đường_đi từ tới .\nTheo định_nghĩa ta có : Cũng theo định_nghĩa , .\nTừ_đó ta suy ; hay_không phụ_thuộc vào đường_đi .\nĐó là dpcm .\nTa phải chọn hàm thế_năng sao_cho bất_đằng thức thỏa_mãn với mọi cung .\nDo , bất_đằng thức tương đường với : Bất_đẳng_thức này gợi_lại cho ta bất_đẳng_thức tam_giác : nếu là khoảng_cách ngắn nhất từ (nào đó) tới thì ta có : Do_đó , nếu chọn với mọi thì bất_đằng thức sẽ thỏa_mãn với mọi cung .\nVấn_đề còn_lại là chọn như_thế nào ?\nTa phải chọn sao_cho đường_đi ngắn nhất từ tới mọi đỉnh khác đều tồn_tại , i . e , với mọi .\nJohnson làm như_sau : Thêm vào một đỉnh và với mỗi đỉnh , thêm cung với trọng số .\nPhép thêm đỉnh này sẽ đảm_bảo : nếu_không có chu_trình âm thì cũng không có chu_trình âm và ngược_lại (chứng minh coi_như bài_tập cho bạn đọc) .\nSau khi đã thêm , ta sẽ áp_dụng để tìm khoảng đi ngắn nhất trong thời_gian .\nTổng_kết lại thảo_luận ở trên , thuật_toán Johson có 4 bước : Giả mã : Code_C : Ta sẽ phân_tích từng bước trong mô_tả ở trên .\nBước (1) mất thời_gian .\nBước (2) mất thời_gian (xem lại bài Bellman-Ford) .\nBước (3) mất thời_gian .\nBước (4) áp_dụng lần Dijkstra cho đồ_thị ; bước này , như đã chỉ ra ở trên , mất thời_gian .\nDo_đó , tổng thời_gian của thuật_toán là . Ví_dụ : Hình (a) là đồ_thị có hướng mà ta muốn tìm đường_đi ngắn nhất .\nHình (b) là đồ_thị thu được sau khi ta thêm và các cung (gạch và có màu đó) có hướng từ tới các đỉnh khác với trọng số 0 .\nHình (c) là cây đường_đi ngắn nhất gốc tại sau khi áp_dụng thuật_toán Bellman-Ford .\nCác số trong ô_vuông chính là khoảng_cách từ tới đỉnh tương_ứng .\nHình (d) là đồ_thị thu được sau khi hiệu_chỉnh trọng số của theo công_thức .\nCode đầy_đủ : . 1 Johnson , Donald_B .\nJournal of the ACM (JACM) 24 . 1 (1977) : 1-13 .\n2 Uri_Zwick .\n, Lecture notes for \"Analysis of Algorithms\" , 2009 .\n, , , , , Trackback link : Powered by and\n", "tagged": "Nơi/N tổng_hợp/V và/Cc chia_sẻ/V những/L kiến_thức/N liên_quan/V tới/E giải_thuật/Np nói_chung/X và/Cc lý_thuyết/Np khoa_học/N máy_tính/N nói_riêng/X ./CH\nin/V Chúng_ta/P đã/R tìm_hiểu/V thuật_toán/N Floyd-Warshall/Np tìm/V đường_đi/Np ngắn/A nhất/A giữa/N mọi/L cặp/N đỉnh/N trong/E thời_gian/N ./CH\nThuật_toán/N này/P áp_dụng/V được/V cho/E cả/P trường_hợp/N đồ_thị/Np và/Cc không/R có/V chu_trình/N âm/A ./CH\nCho_đến/E nay/P vẫn/R chưa/R có/V thuật_toán/N nào/P thực_sự/A nhanh/A hơn/A (xem/Np lại/R phần/N Remark/Np cuối_cùng/A của/E bài/N )/CH ./CH\nVới/E đồ_thị/Np ,/CH chúng_ta/P cũng/R đã/R biết/V rằng/C áp_dụng/V thuật_toán/N Dijkstra/Np (với/Np Fibonacci_Heap)/Np lần/N ,/CH ta/P sẽ/R thu/V được/V thuật_toán/N ./CH\nVới/E đồ_thị_thưa/Np ()/Np ,/CH thuật_toán/N này/P rõ_ràng/A nhanh/A hơn/A một_cách/N đáng_kể/A ./CH\nỞ/E đây/P mình/P nhấn_mạnh/V đồ_thị/Np không/R có/V trọng/Np số_âm/Np thì/C ta/P mới/R áp_dụng/V Dijkstra/Np được/V ./CH\nVấn_đề/N của/E bài/N này/P là/V đồ_thị/Np có/V trọng/Np số_âm/Np :/CH Năm/N 1977/M ,/CH Johnson/Np 1/M đưa_ra/Np câu/N một/M câu/N trả_lời/V cho/E câu_hỏi/N trên/E :/CH cũng/R trong/E bài/N báo/N 1/M ,/CH Johson/Np giới_thiệu/V cấu_trúc/N Heap/Np -phân/Np để/E thực_thi/V Dijkstra/Np mà/C ta/P đã/R tìm_hiểu/V ở/E bài/N ./CH\nÝ_tưởng/N của/E thuật_toán/N Johnson/Np :/CH Thay_đổi/V trọng/Np số/N của/E các/L cung/N của/E để/E thu/V được/V đồ_thị/Np sao_cho/Np :/CH (i)/Np trọng/Np số/N cung/N của/E đồ_thị/Np không/R âm;/Np do_đó/C ta/P có_thể/R áp_dụng/V Dijkstra/Np cho/E để/E tìm/V đường_đi/Np ngắn/A nhất/A giữa/N mọi/L cặp/N đỉnh/N trong/E và/Cc (ii)/Np đường_đi/Np ngắn/A nhất/A giữa/N hai/M đỉnh/N bất_kì/R của/E cũng/R chính/T là/V đường_đi/Np ngắn/A nhất/A giữa/N hai/M đỉnh/N tương_ứng/V của/E ./CH Ta/P gọi/V thủ_tục/N để/E thực_hiện/V ý_tưởng/N trên/E là/V một_phép/Np (reduction)/Np từ/E về/E ./CH\nKhái_niệm/N quy/Np dẫn/V là/V khái_niệm/N mà/C ta/P sẽ/R rất/R hay/Cc gặp/V trong/E lý_thuyết/Np độ/N phức_tạp/A của/E thuật_toán/N ./CH\nChú_ý/V là/V hai/M đồ_thị/Np và/Cc có/V cùng/A tập/V đỉnh/N và/Cc tập/V các/L cung/N (trọng/Np số/N của/E các/L cung/N có_thể/R khác/A nhau)/Np ./CH Để/E phát_biểu/V thuật_toán/N một_cách/N tỉ_mỉ/A hơn/A ,/CH ta/P cần/V thêm/V một_số/L định_nghĩa/N và/Cc khái_niệm/N ./CH\nVới/E mỗi/L đường_đi/Np giữa/N hai/M đỉnh/N bất_kì/R trong/E đồ_thị/Np ,/CH ta/P định_nghĩa/N của/E đường_đi/Np (kí/Np hiệu/N )/CH bằng/E trọng/Np số/N của/E đường_đi/Np đó/P trong/E trừ/V đi/V trọng/Np số/N của/E cùng_đường/Np đi/V trong/E ./CH\nMột_cách/N hình_thức/N :/CH trong/E đó/P kí_hiệu/Np (hoặc/Np )/CH là/V trọng/Np số/N của/E đường_đi/Np trong/E (/CH hoặc/Cc )/CH ./CH Một_cách/N đơn_giản/A nhất/A để/E thực_hiện/V (i)/Np đó/P là/V cộng/V trọng/Np số/N của/E tất_cả/P các/L cung/N của/E với/E cùng/A một/M trọng/Np số/N đủ/A lớn/A để/E thu/V được/V mọi/L cung/N đều/R không/R âm/A ./CH\nSau_đó/Np từ_đường/Np đi/V ngắn/A nhất/A giữa/N hai/M đỉnh/N trên/E đồ_thị/Np ,/CH với/E mỗi/L cung/N trên/E đường_đi/Np ,/CH ta/P trừ/V đơn_vị/N trọng/Np số/N để/E thu/V được/V đường_đi/Np ngắn/A nhất/A trong/E ./CH\nCách/N làm/V trên/E thoạt_đầu/N nghe/V có_vẻ/X đúng/A nhưng/C thực_tế/N là/V sai/A (tại/Np sao/P ?/CH )/CH ./CH\nTuy_nhiên/C tư_tưởng/N của/E nó/P vẫn/R được/V Johnson/Np áp_dụng/V trong/E thuật_toán/N của/E mình/P ./CH\nThay_vì/X cộng/V tất_cả/P các/L cung/N với/E cùng/A một/M trọng/Np số/N ,/CH Johnson/Np cộng/V với/E mỗi/L cung/N một/M trọng/Np số/N phụ_thuộc/V vào/E chính_cung/N này/P ./CH\nCụ_thể/A ,/CH trọng/Np số/N sẽ/R được/V cộng/V với/E một_số/L sao_cho/Np trọng/Np số/N mới/R thu/V được/V ,/CH thỏa_mãn/V :/CH Để/E đảm_bảo/V đường_đi/Np ngắn/A nhất/A giữa/N bất_kì/R hai/M đỉnh/N nào/P trong/E cũng/R là/V đường_đi/Np ngắn/A nhất/A giữa/N và/Cc trong/E và/Cc ngược_lại/X ,/CH ta/P phải/V đảm_bảo/V :/CH Nếu/C và/Cc là/V hai/M đường_đi/Np giữa/N và/Cc thỏa_mãn/V thì/C ./CH\nNhư_vậy/X ,/CH quan_hệ/N \"ngắn/Np hơn\"/Np giữa/N hai/M đường_đi/Np bất_kì/R với/E cùng/A điểm/N đầu/N điểm/N cuối/N phải/V được/V bảo_toàn/Np khi/N ta/P quy/Np dẫn/V về/E ./CH\nJohnson/Np đảm_bảo/V điều/N này/P bằng/E cách/N chọn/V sao_cho/Np mọi/L đường_đi/Np từ/E tới/E đều/R có/V cùng/A độ_lệch/Np ./CH\nvới/E mọi/L là/V hai/M đường_đi/Np khác_nhau/Np bất_kì/R từ/E tới/E và/Cc là/V hàm/Np chỉ/R phụ_thuộc/V vào/E ./CH\nTa/P sẽ/R chứng_minh/V :/CH Giả_sử/Np và/Cc là/V hai/M đường_đi/Np bất_kì/R giữa/N và/Cc thỏa_mãn/V :/CH ./CH\nDo/E ,/CH ta/P có/V :/CH Theo/V định_nghĩa/N :/CH và/Cc Từ_đó/Np ta/P suy/V ra/V ,/CH đó/P là/V dpcm/Np ./CH\nBài_toán/N của/E chúng_ta/P bây_giờ/P là/V đảm_bảo/V :/CH Độ_lệch/Np của/E một/M đường_đi/Np chỉ/R phụ_thuộc/V vào/E điểm/N đầu/N và/Cc điểm/N cuối/N mà/C không/R phụ_thuộc/V vào/E chính/T đường_đi/Np đó/P ./CH Johson/Np chọn/V với/E là/V (potential)/Np của/E đỉnh/N (ta/Np sẽ/R mô_tả/V chỉ/R tiết/N sau)/Np ./CH\nTa/P sẽ/R chứng_minh/V với/E cách/N chọn/V như_vậy/X ,/CH tính/V bất_biến/Np của/E độ_lệch/Np sẽ/R được/V thỏa_mãn/V :/CH trong/E đó/P là/V hai/M đỉnh/N bất_kì/R thuộc/V đồ_thị/Np ./CH\nGọi_là/V một/M đường_đi/Np từ/E tới/E ./CH\nTheo/V định_nghĩa/N ta/P có/V :/CH Cũng/R theo/V định_nghĩa/N ,/CH ./CH\nTừ_đó/Np ta/P suy/V ;/CH hay_không/Np phụ_thuộc/V vào/E đường_đi/Np ./CH\nĐó/P là/V dpcm/Np ./CH\nTa/P phải/V chọn/V hàm/Np thế_năng/Np sao_cho/Np bất_đằng/Np thức/V thỏa_mãn/V với/E mọi/L cung/N ./CH\nDo/E ,/CH bất_đằng/Np thức/V tương/Np đường/N với/E :/CH Bất_đẳng_thức/Np này/P gợi_lại/Np cho/E ta/P bất_đẳng_thức/Np tam_giác/N :/CH nếu/C là/V khoảng_cách/N ngắn/A nhất/A từ/E (nào/Np đó)/Np tới/E thì/C ta/P có/V :/CH Do_đó/C ,/CH nếu/C chọn/V với/E mọi/L thì/C bất_đằng/Np thức/V sẽ/R thỏa_mãn/V với/E mọi/L cung/N ./CH\nVấn_đề/N còn_lại/Np là/V chọn/V như_thế/X nào/P ?/CH\nTa/P phải/V chọn/V sao_cho/Np đường_đi/Np ngắn/A nhất/A từ/E tới/E mọi/L đỉnh/N khác/A đều/R tồn_tại/V ,/CH i/M ./CH e/Ni ,/CH với/E mọi/L ./CH\nJohnson/Np làm/V như_sau/Np :/CH Thêm/V vào/E một/M đỉnh/N và/Cc với/E mỗi/L đỉnh/N ,/CH thêm/V cung/N với/E trọng/Np số/N ./CH\nPhép/N thêm/V đỉnh/N này/P sẽ/R đảm_bảo/V :/CH nếu_không/Np có/V chu_trình/N âm/A thì/C cũng/R không/R có/V chu_trình/N âm/A và/Cc ngược_lại/X (chứng/Np minh/Np coi_như/Np bài_tập/Np cho/E bạn/N đọc)/Np ./CH\nSau/E khi/N đã/R thêm/V ,/CH ta/P sẽ/R áp_dụng/V để/E tìm/V khoảng/N đi/V ngắn/A nhất/A trong/E thời_gian/N ./CH\nTổng_kết/V lại/R thảo_luận/V ở/E trên/E ,/CH thuật_toán/N Johson/Np có/V 4/M bước/V :/CH Giả/A mã/N :/CH Code_C/Np :/CH Ta/P sẽ/R phân_tích/V từng/R bước/V trong/E mô_tả/V ở/E trên/E ./CH\nBước/V (1)/Np mất/V thời_gian/N ./CH\nBước/V (2)/Np mất/V thời_gian/N (xem/Np lại/R bài/N Bellman-Ford)/Np ./CH\nBước/V (3)/Np mất/V thời_gian/N ./CH\nBước/V (4)/Np áp_dụng/V lần/N Dijkstra/Np cho/E đồ_thị/Np ;/CH bước/V này/P ,/CH như/C đã/R chỉ/R ra/V ở/E trên/E ,/CH mất/V thời_gian/N ./CH\nDo_đó/C ,/CH tổng/N thời_gian/N của/E thuật_toán/N là/V ./CH Ví_dụ/C :/CH Hình/N (a)/Np là/V đồ_thị/Np có/V hướng/N mà/C ta/P muốn/V tìm/V đường_đi/Np ngắn/A nhất/A ./CH\nHình/N (b)/Np là/V đồ_thị/Np thu/V được/V sau/E khi/N ta/P thêm/V và/Cc các/L cung/N (gạch/Np và/Cc có/V màu/N đó)/Np có/V hướng/N từ/E tới/E các/L đỉnh/N khác/A với/E trọng/Np số/N 0/M ./CH\nHình/N (c)/Np là/V cây/N đường_đi/Np ngắn/A nhất/A gốc/N tại/E sau/E khi/N áp_dụng/V thuật_toán/N Bellman-Ford/Np ./CH\nCác/L số/N trong/E ô_vuông/Np chính/T là/V khoảng_cách/N từ/E tới/E đỉnh/N tương_ứng/V ./CH\nHình/N (d)/Np là/V đồ_thị/Np thu/V được/V sau/E khi/N hiệu_chỉnh/Np trọng/Np số/N của/E theo/V công_thức/N ./CH\nCode/Np đầy_đủ/A :/CH ./CH 1/M Johnson/Np ,/CH Donald_B/Np ./CH\nJournal/Np of/E the/B ACM/Np (JACM)/Np 24/M ./CH 1/M (1977)/Np :/CH 1-13/Np ./CH\n2/M Uri_Zwick/Np ./CH\n,/CH Lecture/Np notes/Np for/Np \"Analysis/Np of/E Algorithms\"/Np ,/CH 2009/M ./CH\n,/CH ,/CH ,/CH ,/CH ,/CH Trackback/Np link/Np :/CH Powered/Np by/Np and/Np\n", "title": "Đường đi ngắn nhất giữa mọi cặp đỉnh trong đồ thị thưa -- Johnson's Algorithm\n", "link": "http://www.giaithuatlaptrinh.com/?p=874\n"}