{"content": "Nơi tổng_hợp và chia_sẻ những kiến_thức liên_quan tới giải_thuật nói_chung và lý_thuyết khoa_học máy_tính nói_riêng .\nin Trong bài này chúng_ta sẽ thảo_luận bài_toán xây_dựng cây nhị_phân tìm_kiếm tối_ưu .\nChúng_ta cũng thảo_luận giải_thuật cuả Knuth trong bài_toán này .\nÝ_tưởng của Knuth sau_này được Yao mở_rộng với trường_hợp Bất_Đẳng_Thức Hình_Chữ_Nhật (Quadrangle Inequality) để cải_tiến quy_hoạch_động , một kĩ_thuật mà mình sẽ giới_thiệu ở phần sau . Cây nhị_phân tìm_kiếm (binary search tree) là một cây nhị_phân có tính_chất sau : Ví_dụ : Ta có mảng và mảng tần_số tương_ứng .\nMột trong số các cây nhị_phân tìm_kiếm hợp_lệ như trong hình sau : Các số trong hình_vuông nhỏ là tần_số tìm_kiếm , các số trong hình_tròn là khóa tìm_kiếm .\nTa có_thể thấy : Như_vậy tổng_số phép so_sánh là .\nCó_thể kiểm_tra (bằng cách thử xây_dựng các cây nhị_phân tìm_kiếm hợp_lệ khac nhau) rằng cây nhị_phân trong hình tương_ứng với và trong ví_dụ có tổng_số_lượng các phép so_sánh là nhỏ nhất .\nQua ví_dụ trên có_thể rút ra số lần so_sánh thực_hiện ở nút gốc không phụ_thuộc vào cách chọn khóa cho nút gốc và luôn là .\nTa sẽ phát_triển công_thức đệ_quy cho bài_toán này .\nGọi_là số phép so_sánh của cây nhị_phân tìm_kiếm tối_ưu cho mảng .\nNếu là khóa của nút gốc , ta có : Vì ta không biết nút nào_là nút gốc , ta có_thể thử tất_cả các lựa_chọn có_thể có cho nút gốc .\nDo_đó ta có : Gọi_là số phép so_sánh của cây nhị_phân tìm_kiếm tối_ưu cho mảng con .\nĐặt .\nTa có : Như các bài_toán khác , quy_hoạch_động trong bài_toán nay quy về cập_nhật các phần_tử của mảng .\nTuy_nhiên , một điểm cần chú_ý ở đây chính là thứ_tự cập_nhật các phần_tử của mảng .\nTrong hình trên , các phân_tử của mảng tô_màu xanh là các phần_tử và được khởi tạo .\nGiả_sử_ta muốn cập_nhật phần_tử được tô_màu đen của mảng (ảnh ngoài_cùng bên trái) , ta phải chắc_chắn rằng các phần_tử được tô_màu đỏ đã được cập_nhật trước đó .\nDo_đó ta có_thể có 3 cách cập_nhật bảng (3 hình với các mũi tên) như_trên hình trên .\nCác mũi_tên chỉ thứ_tự các phần_tử được cập_nhật .\nTrong giả mã dưới_đây , bảng được cập_nhật theo hình thứ nhất (cập nhật kiểu đường chéo) .\nMũi_tên xanh sẽ tương_ứng với vòng_lặp ngoài_cùng của giả mã .\nCác kiểu cập_nhật khác coi_như bài_tập cho bạn_đọc .\nHàm tính .\nHàm () tính theo công_thức đệ_quy .\nTa lưu thêm mảng trong đó lưu lại gốc của cây nhị_phân tìm_kiếm tối_ưu của mảng con .\nMảng có_thể được sử_dụng để truy vết in ra cây nhị_phân tìm_kiếm tối_ưu .\nCode_bằng C của giả mã .\nCode đầy_đủ của thuật_toán được cho ở cuối bài . Bảng có_thể được tính bằng quy_hoạch_động trong thời_gian dựa vào công_thức : .\nGiả mã như_sau : Code_bằng C của giả mã : Giả mã của hàm () .\nCode_bằng C của giả mã : Thời_gian để cập_nhật mảng trong hàm là .\nMỗi phần_tử của mảng được cập_nhật trong thời_gian (có thể phân_tích chặt hơn nhưng thời_gian tiệm_cận vẫn không đổi) .\nNhư_vậy thuật_toán có thời_gian tính là .\nThuật_toán cần hai mảng 2 chiều và kích thướng .\nNhư_vậy bộ_nhớ cần_dùng là .\nHiện_tại chưa có thuật_toán nào tính chính_xác cây nhị_phân tìm_kiếm tối_ưu mà bộ_nhớ .\nVới ví_dụ trên , mảng đầu_ra của thuật_toán là : \\beginbmatrix 122344 \\\\ 022344 \\\\ 003444 \\\\ 000445 \\\\ 000056 \\\\ 000006 \\endbmatrix Với ví_dụ trên , ta quan_sát thấy mảng đầu_ra có hàng và cột là các dãy tăng dần .\nTính_chất này không_phải ngãu nhiên mà đúng_với mọi và được chứng_minh lần đầu_tiên bởi .\nKnuth sử_dụng tính_chất này để giảm thời_gian của thuật_toán quy_hoạch_động xuống còn .\nMỗi mảng con có_thể có nhiều hơn một cây nhị_phân tìm_kiếm tối_ưu .\nTrong số các cây nhị_phân tìm_kiếm tối_ưu đó , chọn cây có gốc có khóa lớn nhất (đồng nghĩa với trong số các gốc của các cây nhị_phân tìm_kiếm tối_ưu , có chỉ_số trong mảng lớn nhất) .\nGọi_là gốc đó .\nNếu để_ý kĩ thủ_thục () với điều_kiện so_sánh : tmp (thay vì tmp ) , thủ_tục đó trả_lại cây của mảng có gốc lớn nhất .\nKnuth chứng_minh bổ_đề sau : Mình sẽ chứng_minh bổ_đề này trong bài viết thảo_luận các kĩ_thuật nâng_cao áp_dụng trong quy_hoạch_động .\nDo_đó trong thủ_tục () , thay_vì duyệt từ đến để tìm gốc , ta chỉ_cần duyệt từ đến .\nGiả mã như_sau : Code_bằng C của giả mã : Các thủ_tục khác không thay_đổi , ta chỉ việc thay_thế thủ_tục bằng Ta có bổ_đề sau : Với mỗi , số thao_tác thuật_toán thực_hiện là : Do_đó , tổng_số thao_tác thực_hiện của thuật_toán là : Code : , .\n2 Jeff_Erickson , , UIUC .\n3 Nagaraj , S .\nV .\n\"Optimal binary search trees . \" Theoretical_Computer_Science 188 . 1 (1997) : 1-44 .\n, , , , , Trackback link : on Great article thank you for sharing . Powered by and\n", "tagged": "Nơi/N tổng_hợp/V và/Cc chia_sẻ/V những/L kiến_thức/N liên_quan/V tới/E giải_thuật/Np nói_chung/X và/Cc lý_thuyết/Np khoa_học/N máy_tính/N nói_riêng/X ./CH\nin/V Trong/E bài/N này/P chúng_ta/P sẽ/R thảo_luận/V bài_toán/N xây_dựng/V cây/N nhị_phân/Np tìm_kiếm/V tối_ưu/A ./CH\nChúng_ta/P cũng/R thảo_luận/V giải_thuật/Np cuả/Np Knuth/Np trong/E bài_toán/N này/P ./CH\nÝ_tưởng/N của/E Knuth/Np sau_này/N được/V Yao/Np mở_rộng/V với/E trường_hợp/N Bất_Đẳng_Thức/Np Hình_Chữ_Nhật/N (Quadrangle/Np Inequality)/Np để/E cải_tiến/V quy_hoạch_động/Np ,/CH một/M kĩ_thuật/N mà/C mình/P sẽ/R giới_thiệu/V ở/E phần/N sau/E ./CH Cây/N nhị_phân/Np tìm_kiếm/V (binary/Np search/Np tree)/Np là/V một/M cây/N nhị_phân/Np có/V tính_chất/N sau/E :/CH Ví_dụ/C :/CH Ta/P có/V mảng/N và/Cc mảng/N tần_số/N tương_ứng/V ./CH\nMột/M trong/E số/N các/L cây/N nhị_phân/Np tìm_kiếm/V hợp_lệ/A như/C trong/E hình/N sau/E :/CH Các/L số/N trong/E hình_vuông/N nhỏ/A là/V tần_số/N tìm_kiếm/V ,/CH các/L số/N trong/E hình_tròn/N là/V khóa/N tìm_kiếm/V ./CH\nTa/P có_thể/R thấy/V :/CH Như_vậy/X tổng_số/N phép/N so_sánh/V là/V ./CH\nCó_thể/R kiểm_tra/V (bằng/Np cách/N thử/V xây_dựng/V các/L cây/N nhị_phân/Np tìm_kiếm/V hợp_lệ/A khac/Np nhau)/Np rằng/C cây/N nhị_phân/Np trong/E hình/N tương_ứng/V với/E và/Cc trong/E ví_dụ/C có/V tổng_số_lượng/Np các/L phép/N so_sánh/V là/V nhỏ/A nhất/A ./CH\nQua/V ví_dụ/C trên/E có_thể/R rút/V ra/V số/N lần/N so_sánh/V thực_hiện/V ở/E nút/N gốc/N không/R phụ_thuộc/V vào/E cách/N chọn/V khóa/N cho/E nút/N gốc/N và/Cc luôn/R là/V ./CH\nTa/P sẽ/R phát_triển/V công_thức/N đệ_quy/Np cho/E bài_toán/N này/P ./CH\nGọi_là/V số/N phép/N so_sánh/V của/E cây/N nhị_phân/Np tìm_kiếm/V tối_ưu/A cho/E mảng/N ./CH\nNếu/C là/V khóa/N của/E nút/N gốc/N ,/CH ta/P có/V :/CH Vì/E ta/P không/R biết/V nút/N nào_là/T nút/N gốc/N ,/CH ta/P có_thể/R thử/V tất_cả/P các/L lựa_chọn/V có_thể/R có/V cho/E nút/N gốc/N ./CH\nDo_đó/C ta/P có/V :/CH Gọi_là/V số/N phép/N so_sánh/V của/E cây/N nhị_phân/Np tìm_kiếm/V tối_ưu/A cho/E mảng/N con/Nc ./CH\nĐặt/V ./CH\nTa/P có/V :/CH Như/C các/L bài_toán/N khác/A ,/CH quy_hoạch_động/Np trong/E bài_toán/N nay/P quy/Np về/E cập_nhật/V các/L phần_tử/N của/E mảng/N ./CH\nTuy_nhiên/C ,/CH một/M điểm/N cần/V chú_ý/V ở/E đây/P chính/T là/V thứ_tự/N cập_nhật/V các/L phần_tử/N của/E mảng/N ./CH\nTrong/E hình/N trên/E ,/CH các/L phân_tử/N của/E mảng/N tô_màu/Np xanh/A là/V các/L phần_tử/N và/Cc được/V khởi/V tạo/V ./CH\nGiả_sử_ta/Np muốn/V cập_nhật/V phần_tử/N được/V tô_màu/Np đen/A của/E mảng/N (ảnh/Np ngoài_cùng/Np bên/N trái)/Np ,/CH ta/P phải/V chắc_chắn/A rằng/C các/L phần_tử/N được/V tô_màu/Np đỏ/A đã/R được/V cập_nhật/V trước/E đó/P ./CH\nDo_đó/C ta/P có_thể/R có/V 3/M cách/N cập_nhật/V bảng/N (3/Np hình/N với/E các/L mũi/N tên)/Np như_trên/Np hình/N trên/E ./CH\nCác/L mũi_tên/N chỉ/R thứ_tự/N các/L phần_tử/N được/V cập_nhật/V ./CH\nTrong/E giả/A mã/N dưới_đây/Np ,/CH bảng/N được/V cập_nhật/V theo/V hình/N thứ/N nhất/A (cập/Np nhật/N kiểu/N đường/N chéo)/Np ./CH\nMũi_tên/N xanh/A sẽ/R tương_ứng/V với/E vòng_lặp/Np ngoài_cùng/Np của/E giả/A mã/N ./CH\nCác/L kiểu/N cập_nhật/V khác/A coi_như/Np bài_tập/Np cho/E bạn_đọc/N ./CH\nHàm/Np tính/V ./CH\nHàm/Np ()/Np tính/V theo/V công_thức/N đệ_quy/Np ./CH\nTa/P lưu/V thêm/V mảng/N trong/E đó/P lưu/V lại/R gốc/N của/E cây/N nhị_phân/Np tìm_kiếm/V tối_ưu/A của/E mảng/N con/Nc ./CH\nMảng/N có_thể/R được/V sử_dụng/V để/E truy/V vết/N in/V ra/V cây/N nhị_phân/Np tìm_kiếm/V tối_ưu/A ./CH\nCode_bằng/Np C/Ni của/E giả/A mã/N ./CH\nCode/Np đầy_đủ/A của/E thuật_toán/N được/V cho/E ở/E cuối/N bài/N ./CH Bảng/N có_thể/R được/V tính/V bằng/E quy_hoạch_động/Np trong/E thời_gian/N dựa/V vào/E công_thức/N :/CH ./CH\nGiả/A mã/N như_sau/Np :/CH Code_bằng/Np C/Ni của/E giả/A mã/N :/CH Giả/A mã/N của/E hàm/Np ()/Np ./CH\nCode_bằng/Np C/Ni của/E giả/A mã/N :/CH Thời_gian/N để/E cập_nhật/V mảng/N trong/E hàm/Np là/V ./CH\nMỗi/L phần_tử/N của/E mảng/N được/V cập_nhật/V trong/E thời_gian/N (có/Np thể/N phân_tích/V chặt/A hơn/A nhưng/C thời_gian/N tiệm_cận/Np vẫn/R không/R đổi)/Np ./CH\nNhư_vậy/X thuật_toán/N có/V thời_gian/N tính/V là/V ./CH\nThuật_toán/N cần/V hai/M mảng/N 2/M chiều/N và/Cc kích/Np thướng/Np ./CH\nNhư_vậy/X bộ_nhớ/Np cần_dùng/Np là/V ./CH\nHiện_tại/N chưa/R có/V thuật_toán/N nào/P tính/V chính_xác/A cây/N nhị_phân/Np tìm_kiếm/V tối_ưu/A mà/C bộ_nhớ/Np ./CH\nVới/E ví_dụ/C trên/E ,/CH mảng/N đầu_ra/N của/E thuật_toán/N là/V :/CH \\beginbmatrix/Np 122344/Np \\\\/Np 022344/Np \\\\/Np 003444/Np \\\\/Np 000445/Np \\\\/Np 000056/Np \\\\/Np 000006/Np \\endbmatrix/Np Với/E ví_dụ/C trên/E ,/CH ta/P quan_sát/V thấy/V mảng/N đầu_ra/N có/V hàng/N và/Cc cột/N là/V các/L dãy/Nc tăng/V dần/R ./CH\nTính_chất/N này/P không_phải/Np ngãu/Np nhiên/Np mà/C đúng_với/Np mọi/L và/Cc được/V chứng_minh/V lần/N đầu_tiên/A bởi/E ./CH\nKnuth/Np sử_dụng/V tính_chất/N này/P để/E giảm/V thời_gian/N của/E thuật_toán/N quy_hoạch_động/Np xuống/V còn/R ./CH\nMỗi/L mảng/N con/Nc có_thể/R có/V nhiều/A hơn/A một/M cây/N nhị_phân/Np tìm_kiếm/V tối_ưu/A ./CH\nTrong/E số/N các/L cây/N nhị_phân/Np tìm_kiếm/V tối_ưu/A đó/P ,/CH chọn/V cây/N có/V gốc/N có/V khóa/N lớn/A nhất/A (đồng/Np nghĩa/N với/E trong/E số/N các/L gốc/N của/E các/L cây/N nhị_phân/Np tìm_kiếm/V tối_ưu/A ,/CH có/V chỉ_số/N trong/E mảng/N lớn/A nhất)/Np ./CH\nGọi_là/V gốc/N đó/P ./CH\nNếu/C để_ý/V kĩ/A thủ_thục/Np ()/Np với/E điều_kiện/N so_sánh/V :/CH tmp/Np (thay/Np vì/E tmp/Np )/CH ,/CH thủ_tục/N đó/P trả_lại/Np cây/N của/E mảng/N có/V gốc/N lớn/A nhất/A ./CH\nKnuth/Np chứng_minh/V bổ_đề/Np sau/E :/CH Mình/P sẽ/R chứng_minh/V bổ_đề/Np này/P trong/E bài/N viết/V thảo_luận/V các/L kĩ_thuật/N nâng_cao/Np áp_dụng/V trong/E quy_hoạch_động/Np ./CH\nDo_đó/C trong/E thủ_tục/N ()/Np ,/CH thay_vì/X duyệt/V từ/E đến/E để/E tìm/V gốc/N ,/CH ta/P chỉ_cần/Np duyệt/V từ/E đến/E ./CH\nGiả/A mã/N như_sau/Np :/CH Code_bằng/Np C/Ni của/E giả/A mã/N :/CH Các/L thủ_tục/N khác/A không/R thay_đổi/V ,/CH ta/P chỉ/R việc/N thay_thế/V thủ_tục/N bằng/E Ta/P có/V bổ_đề/Np sau/E :/CH Với/E mỗi/L ,/CH số/N thao_tác/V thuật_toán/N thực_hiện/V là/V :/CH Do_đó/C ,/CH tổng_số/N thao_tác/V thực_hiện/V của/E thuật_toán/N là/V :/CH Code/Np :/CH ,/CH ./CH\n2/M Jeff_Erickson/Np ,/CH ,/CH UIUC/Np ./CH\n3/M Nagaraj/Np ,/CH S/Y ./CH\nV/Nu ./CH\n\"Optimal/Np binary/Np search/Np trees/Np ./CH \"/CH Theoretical_Computer_Science/Np 188/Np ./CH 1/M (1997)/Np :/CH 1-44/Np ./CH\n,/CH ,/CH ,/CH ,/CH ,/CH Trackback/Np link/Np :/CH on/Np Great/Np article/Np thank/Np you/Np for/Np sharing/Np ./CH Powered/Np by/Np and/Np\n", "title": "Quy hoạch động -- Dynamic Programming IV\n", "link": "http://www.giaithuatlaptrinh.com/?p=112\n"}