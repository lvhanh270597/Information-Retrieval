{"content": "Nguồn : wcipeg Người dịch : Trần_Kim_Thạch Giới_thiệu Trước_khi đọc_bài này , bạn có_thể đọc về các thuật_ngữ trong xử_lý xâu cũng_như về bài_toán so khớp chuỗi ở đây Thuật_toán Knuth-Morris-Pratt (KMP) là một thuật_toán với thời_gian chạy tuyến_tính nhằm giải_quyết bài_toán so khớp chuỗi .\nThuật_toán được xây_dựng dựa vào quan_sát rằng một xâu con chung của S và T sẽ đưa_ra được thông_tin S có khớp với các_vị trí sau của T hay_không .\nBởi_vì xâu con chung này đồng_nghĩa với một phần của T đã khớp với một phần của S , nên bằng việc khởi tạo trước một_số thông_tin với xâu S , ta sẽ thu được những kết_luận về T (nhờ xâu con chung) mà không cần quay ngược và so_sánh lại những ký_tự đã khớp .\nCụ_thể hơn , ta muốn tính_toán trước cách xâu S tự khớp với chính nó .\nNhờ vậy thuật_toán sẽ không quay nhìn lại và chỉ duyệt qua T một_lần duy_nhất .\nCùng_với quá_trình tiền xử_lí tuyến_tính O(T) (với T là độ_dài xâu T) , thuật_toán có thời_gian chạy tuyến_tính .\nCảm_hứng Cảm_hứng của KMP có_thể được minh_họa rõ nhất qua 3 ví_dụ dưới_đây .\nVí_dụ 1 S = aaa T = aaaaaaaaa Ở ví_dụ này , ta cần các lần xuất_hiện của xâu S trong xâu T (S xuất_hiện 7 lần) .\nTa có_thể duyệt bình_thường với độ phức_tạp O(S_T) như_sau : So S_1 với T_1 , S_2 với T_2 , S_3 với T_3 , do_đó vị_trí số 1 là vị_trí khớp của S trong T .\nSo S_1 với T_2 , S_2 với T_3 , S_3 với T_4 , tìm được vị_trí số 2 là vị_trí khớp của S trong T .\nSo S_1 với T_3 , S_2 với T_4 , S_3 với T_5 , tìm được vị_trí số 3 là vị_trí khớp của S trong T .\nVà cứ mãi như_vậy cho_đến khi đủ hết trường_hợp .\nTuy_nhiên ta có_thể làm tốt hơn nếu ta tiền xử_lý S và để_ý : S_1 giống S_2 S_2 giống S_3 .\nVậy tiền_tố độ_dài 2 của S (S_1 S_2) khớp với xâu con độ_dài 2 ở vị_trí thứ 2 của S (S_2 S_3) - nói_cách_khác , S tự khớp một phần .\nSau khi kiểm_tra khớp ở vị_trí số 1 (so sánh S với T_1 T_2 T_3) , ta đã biết : S_1 = T_1 S_2 = T_2 S_3 = T_3 Khi ta kiểm_tra khớp ở vị_trí số 2 (so sánh S với T_2 T_3 T_4) , ta có : S_2 = T_2 , S_3 = T_3 S_1 = S_2 , S_2 = S_3 Suy ra : S_1 = T_2 S_2 = T_3 .\nDo_vậy , việc so_sánh với T_2 , T_3 là không cần_thiết nữa .\nTa chỉ_cần kiểm_tra nốt S_3 = T_4 là đã kết_luận được S được tìm_thấy ở vị_trí 2 trong T .\nNhư_vậy , sau đáp_án ở vị_trí 1 , ta chỉ_cần thêm 1 thao_tác để kết_luận S cũng có ở vị_trí 2 trong T , thay_vì 3 như thuật duyệt bình_thường .\nĐến đây ta biết : S_1 = T_2 S_2 = T_3 S_3 = T_4 Và tương_tự , lại kết_luận được : S_1 = T_3 S_2 = T_4 .\nTa sau_đó chỉ_cần so S_3 với T_5 , tìm được một đáp_án nữa , cứ thế tiếp_tục .\nTrong_khi thuật_toán duyệt cần đến 3 phép_tính cho mỗi lần so_sánh S với một xâu con của T , kĩ_thuật của chúng_ta chỉ_cần 3 phép_tính ở lần_lặp đầu và 1 cho mỗi kết_quả sau , và không xét_lại các kí_tự của T .\n(Đây cũng là cách con_người giải_quyết bài toán) Ví_dụ 2 S = aaa T = aabaabaaa Như ở trên , ta bắt_đầu như thuật_toán duyệt , so_sánh : S_1 với T_1 S_2 với T_2 S_3 với T_3 Ở đây ta thấy S_3 khác T_3 , vậy S không khớp với T ở vị_trí 1 .\nĐến bước này thuật duyệt sẽ tiếp_tục bằng cách so S_1 với T_2 và S_2 với T_3 , không khớp; rồi lại so S_1 với T_3 , không khớp; cứ_như vậy .\nThế_nhưng chúng_ta sẽ thấy ngay rằng sau kết_quả không khớp ở vị_trí_đầu , khả_năng tìm_thấy S ở các_vị trí 2 và 3 của T đã không còn .\nLí_do là_vì , như đã trình_bày ở ví_dụ 1 : S_2 = S_3 S_3 \\neq T_3 Do_đó S_2 \\neq T_3 .\nTương_tự như_vậy , do : S_1 = S_2 S_2 \\neq T_3 Nên S_1 \\neq T_3 , ta không cần tìm S ở vị_trí thứ 3 của T làm_gì .\nSẽ hợp_lí hơn khi bắt_đầu tiếp ở vị_trí số 4 (do ta không_thể chắc_chắn có_thể tìm được hay_không S_2 S_3 S_4 \\ , = \\ , T_4T_5T_6) .\nSau khi so_sánh ở vị_trí 4 và thấy tiếp_tục không khớp , ta dùng lập_luận tương_tự loại_bỏ vị_trí số 5 và 6 , và bắt_đầu lại ở vị_trí số 7 (ở đây 2 xâu khớp nhau) .\nLần nữa , hãy chú_ý các kí_tự của T được duyệt qua theo trình_tự .\nVí_dụ 3 Đây là một ví_dụ phức_tạp hơn : S = tartan T = tartaric_acid Ta quan_sát thấy tiền_tố độ_dài 2 của S khớp với chính xâu con độ_dài 2 bắt_đầu ở vị_trí số 4 của nó .\nBây_giờ lần_lượt so_sánh các_vị trí từ S_1 đến S_6 với T_1 đến T_6 .\nTa thấy S_6 không khớp với T_6 , vậy không có kết_quả ở vị_trí số 1 .\nỞ đây hãy chú_ý : S_1 \\neq S_2 S_1 \\neq S_3 S_2 = T_2 S_3 = T_3 Nên ta có S_1 \\neq T_2 và S_1 \\neq T_3 .\nVậy không_thể có trùng khớp ở vị_trí số 2 và 3 .\nTới đây hãy nhớ_lại rằng : S_1 = S_4 S_2 = S_5 S_4 = T_4 S_5 = T_5 Ta suy ra S_1 = T_4 , S_2 = T_5 .\nVậy_ta sẽ tiếp_tục kiểm_tra vị_trí số 4 bằng việc so_sánh S_3 với T_6 .\nLàm_theo cách này , ta loại_bỏ được hai trường_hợp và bắt_đầu duyệt lại không_phải ở đầu mà ở giữa xâu S , tránh được_việc xét_lại T_4 và T_5 .\nÝ_tưởng chính Gọi_Si là tiền_tố độ_dài i của xâu S .\nCác ví_dụ trên chính là tư_tưởng hoạt_động của KMP : dựa trên quan_sát rằng một_số xâu con của xâu cần tìm có khớp với xâu con nào khác của xâu cần tìm hay_không .\nTuy_nhiên định_hướng chung , mang tính hệ_thống của thuật_toán thì chưa rõ_ràng .\nĐịnh_hướng này được phát_biểu như_sau : Ở mỗi vị_trí i của S , tìm hậu_tố chuẩn dài nhất của Si mà cũng là tiền_tố của S .\n( Hậu_tố chuẩn của một xâu là hậu_tố có độ_dài bé hơn xâu đó . ) Ta sẽ gọi độ_dài của xâu con này là \\pi_i .\nTa cũng có_thể định_nghĩa \\pi_i là số j lớn nhất để Sj \\sqsupset Si . Ký_hiệu X \\sqsupset Y nghĩa_là X là hậu_tố của Y .\nBảng \\pi , gọi_là hàm tiền_tố , chiếm bộ_nhớ tuyến_tính , và như sẽ trình_bày dưới_đây , có_thể tính được trong thời_gian tuyến_tính .\nBảng sẽ chứa toàn_bộ các thông_tin cần_thiết để máy thực_hiện những phương_án \"thông minh nhất\" cho quá_trình tìm_kiếm .\nCụ_thể hơn : Trong ví_dụ 1 và 2 : \\pi_1 = 0 , không có tiền_tố chuẩn thỏa_mãn .\n\\pi_2 = 1 , tiền_tố a khớp hậu_tố a .\n\\pi_3 = 2 , tiền_tố aa khớp hậu_tố aa .\nTrong ví_dụ 3 : \\pi_1 = 0 \\pi_2 = 0 \\pi_3 = 0 \\pi_4 = 1 , tiền_tố t khớp với xâu con t kết_thúc ở vị_trí thứ 4 .\n\\pi_5 = 2 , tiền_tố ta khớp với xâu con ta kết_thúc ở vị_trí thứ 5 .\n\\pi_6 = 0 .\nTổng_quát , bảng \\pi cho ta biết , sau một_lần khớp hoặc không khớp giữa \"cây kim\" và \"đống rơm\" , vị_trí tiếp_theo trong \"đống rơm\" ta cần kiểm_tra là gì .\nCác phép so sẽ tiếp_tục ở các_vị trí tiếp_theo , không bao_giờ quay ngược về các kí_tự ta đã kiểm_tra rồi .\nTính_toán độ phức_tạp Để tính độ phức_tạp cho hàm tiền xử_lí , trước_tiên ta có quan_sát : Dãy \\pi_i = i , \\pi_i , \\pi_\\pi_i , \\pi_\\pi_\\pi_i , . . .\n, 0 chứa toàn_bộ những giá_trị j thỏa_mãn Sj \\sqsupset Si . Vậy , ta có_thể đếm toàn_bộ những hậu_tố của Si đồng_thời là tiền_tố của S bằng cách bắt_đầu với i , dò nó trong bảng \\pi , dùng kết_quả đó dò tiếp_tục và tiếp_tục , đến khi kết_thúc bằng 0 .\nChứng_minh : Đầu_tiên_ta chứng_minh chiều xuôi : nếu j xuất_hiện trong \\pi_i thì Sj \\sqsupset Si . Nếu j là phần_tử đầu trong \\pi_i .\nVậy j = i và hẳn_nhiên Sj \\sqsupset Si . Nếu j không là phần_tử đầu : Gọi phần_tử trước nó là k .\nVậy \\pi_k = j .\nTheo định_nghĩa , Sj \\sqsupset Sk . Nhưng_Sk \\sqsupset Si . Do quan_hệ này có tính_chất bắc_cầu , Sj \\sqsupset Si . Giờ ta chứng_minh chiều ngược : nếu Sj \\sqsupset Si , j thuộc \\pi_i .\nGiả_sử j không xuất_hiện trong dãy .\nRõ_ràng 0 lt; j lt; i do i và 0 đều có trong dãy .\nDo \\pi_i luôn giảm , ta có_thể tìm được một_và chỉ một k thuộc \\pi_i sao_cho kgt;j và \\pi_klt;j .\nNói_cách_khác , ta có_thể tìm được một_và chỉ một k mà sau nó j \"có lẽ\" sẽ xuất_hiện (để giữ cho dãy luôn giảm) .\nỞ phần đầu chứng_minh_ta đã biết Sk \\sqsupset Si . Do hậu_tố độ_dài j của Si là một hậu_tố của hậu_tố độ_dài k của Si , hậu_tố độ_dài j của Si phải khớp với hậu_tố độ_dài j của Sk . Nhưng hậu_tố độ_dài j của Si cũng khớp với Sj , nên Sj khớp với hậu_tố độ_dài j của Sk . Vậy_ta kết_luận \\pi_k \\ge j .\nThế_nhưng j \\ge \\pi_k , mâu_thuẫn .\nCũng chính nhờ việc chứng_minh này , ta có_thể xây_dựng một thuật_toán để tính bảng \\pi .\nVới mỗi i : Đầu_tiên_ta tìm số j gt; 0 sao_cho Sj \\sqsupset Si . Nếu_không tìm được , ta kết_luận \\pi_i = 0 (như trường_hợp i=1) .\nNếu có j gt; 0 thỏa_mãn , vậy khi xóa_bỏ kí_tự cuối của hậu_tố này , ta thu được một hậu_tố của S_i-1 đồng_thời là tiền_tố của S , tức_là Sj-1 \\sqsupset Si-1 .\nVậy bước_đầu ta đếm mọi hậu_tố chuẩn và không-rỗng của Si-1 đồng_thời là tiền_tố của S .\nNếu ta tìm được một hậu_tố độ_dài k đồng_thời thỏa S_k = S_i , vậy Sk+1 \\sqsupset Si , và k+1 là một giá_trị khả_dĩ của j .\nVậy_ta sẽ gán k = \\pi_i-1 và tiếp_tục lặp_lại trong dãy \\pi_\\pi_i , \\pi_\\pi_\\pi_i , . . .\nQuá_trình sẽ dừng lại nếu gặp_phải một phần_tử j trong dãy sao_cho S_j+1 = S_i , và gán \\pi_i = j+1; cách này sẽ luôn cho kết_quả tối_ưu vì dãy \\pi_i-1 luôn giảm và nó chứa toàn_bộ giá_trị k khả_dĩ .\nNếu đi đến hết dãy , vậy \\pi_i = 0 .\nDưới_đây là mã giả để tính \\pi : π1 ← 0 for i ∈ 2 . . m k ← πi-1 while k gt; 0 and Sk+1 ≠ Si k ← πk if Sk+1 = Si πi ← 0 else πi ← k+1 Hoặc có_thể viết gọn lại như_sau : π1 ← 0 k ← 0 for i ∈ 2 . . m while k gt; 0 and Sk+1 ≠ Si k ← πk if Sk+1 = Si k ← k+1 πi ← k Thuật_toán có độ phức_tạp O(m) .\nĐể hiểu tại_sao thì hãy để_ý , k không bao_giờ âm; nó không_thể giảm nhiều hơn mức nó tăng .\nk chỉ tăng ở dòng k ← k+1 , vốn chỉ bị gọi nhiều nhất_là m-1 lần .\nVậy k giảm nhiều nhất_là k lần .\nNhưng k giảm ở mỗi lần_lặp của vòng while , vậy tổng tất_cả các bước trong_vòng while không quá O(m) .\nTất_cả những câu_lệnh trong_vòng for đều có độ phức_tạp là hằng_số , nên cả thuật_toán có độ phức_tạp O(m) .\nSo khớp Coi_như ta đã xây_dựng xong bảng \\pi .\nĐây là lúc ta sử_dụng những thông_tin cực_khổ lấy_được này .\nGiả_sử rằng ta đã kiểm_tra đang vị_trí thứ j , và k kí_tự đầu của S đã khớp .\nNói_cách_khác : S_1 = T_j S_2 = T_j+1 S_3 = T_j+2 . . .\nS_k = T_j+k-1 .\nCó 2 khả_năng : Ta muốn tiếp_tục chạy trên S và T để kiểm_tra các cặp kí_tự Ta kiểm_tra ở một ví trị khác trên T .\nLí_do cho trường_hợp 2 là : hoặc k = m (tức đã tìm_thấy một vị_trí trùng khớp của S trên T và ta cần tiếp_tục ở vị_trí khác) hoặc S_k+1 \\neq T_j+k (loại bỏ vị_trí hiện tại) .\nNếu ta đã biết từ S_1 đến S_k khớp với từ T_j đến T_j+k-1 , vị_trí nào ta có_thể bỏ_qua ?\nĐây là cốt_lõi của thuật_toán KMP : Định_lý : Nếu k gt; 0 thì p = k - \\pi_k sẽ là giá_trị p nhỏ nhất sao_cho S_1 , . . . , S_k-p khớp với T_j+p , . . . , T_j+k-1 .\n(Nếu k=0 , p=1 . ) Nói một_cách dễ hình_dung hơn , ta có_thể bỏ_qua tất_cả các_vị trí từ 0 đến p-1 .\nSuy_nghĩ thật kĩ lí_thuyết này .\nNếu p gt; 0 không thỏa_mãn S_1 , . . . , S_k-p khớp với T_j+p , . . . , T_j+k-1 , vậy S không khớp với T ở vị_trí j+p , tức ta có_thể loại_bỏ vị_trí này .\nMặt_khác , nếu p gt; 0 thỏa_mãn yêu_cầu trên , xâu S có khả_năng khớp với T ở vị_trí j+p , và thực_tế là các kí_tự từ_vị trí j+p đến j+k-1 đều đã khớp với các_vị trí tương_ứng ở S .\nTa chỉ_cần tiếp_tục bằng cách so S_k-p+1 với T_j+k , \"không quay đầu lại\" như đã hứa .\nChứng_minh : Có 0 \\le q lt; k .\nNếu_Sq \\sqsupset Sk , vậy theo định_nghĩa ta có S_1 , . . . , S_q = S_k-q+1 , . . . , S_k .\nNhưng vì S_1 , . . . , S_k = T_j , . . . , T_j+k-1 , nên S_k-q+1 , . . . , S_k = T_j+k-q , . . . , T_j+k-1 .\nVậy S_1 , . . . S_q = T_j+k-q , . . . , T_j+k-1 .\nNgược_lại , nếu_không có Sq \\sqsupset Sk , vậy S_1 , . . . , S_q \\neq S_k-q+1 , . . . , S_k , dẫn đến S_k-q+1 , . . . , S_k = T_j+k-q , . . . , T_j+k-1 là sai , và dẫn đến S_1 , . . . S_q = T_j+k-q , . . . , T_j+k-1 là sai .\nTa kết_luận rằng k-q là một giá_trị khả_dĩ của p khi và chỉ khi Sq \\sqsupset Sk . Do maximum của q là \\pi_k , minumum của p được xác_định bởi k-\\pi_k .\nDưới_đây là mã giả : j ← 1 k ← 0 while j+m-1 ≤ n while k ≤ m and Sk+1 = Tj+k k ← k+1 if k = m print \"Match at position \" j if k = 0 j ← j+1 else j ← j+k-πk k ← πk Ta dò trong xâu cần search một_lần một kí tự; kí_tự đang được xét là nằm ở vị_trí j+k .\nNếu xảy_ra không trùng khớp , ta dùng bảng \\pi để tìm đến vị_trí khả_dĩ tiếp_theo .\nĐoạn code tương_đương dưới_đây thể_hiện rõ hơn việc thuật_toán xét một kí_tự một_lần và không quay ngược_lại : k ← 0 for i ∈ 1 . . n while k gt; 0 and Sk+1 ≠ Ti k ← πk if Sk+1 = Ti k ← k+1 if k = m print \"Match at position \" i-m+1 k ← πk Ở đây , i tương_ứng với j+k ở đoạn code trên .\nMỗi lần_lặp của vòng_lặp trong của một trong 2 đoạn code tương_ứng với một_lần lặp của vòng_lặp ngoài ở đoạn còn_lại .\nỞ đoạn thứ_hai , ta cũng có_thể chứng_minh thuật có độ phức_tạp O(n); mỗi lần vòng while ở trong được thực_hiện , giá_trị của k giảm , nhưng nó không_thể giảm nhiều hơn n lần bởi k khởi_đầu là không và không bao_giờ âm .\nk chỉ tăng nhiều nhất một_lần ở vòng_lặp ngoài (tức nhiều nhất tổng_cộng n lần) .\nVậy vòng_lặp trong chỉ lặp nhiều nhất n lần , và tất_cả các câu_lệnh khác có độ phức_tạp hằng_số .\nBài_tập áp_dụng : VOJ - SUBSTR .\nCode_C++_VOJ - TWOOPERS\n", "tagged": "Nguồn/N :/CH wcipeg/Np Người/N dịch/N :/CH Trần_Kim_Thạch/Np Giới_thiệu/V Trước_khi/Np đọc_bài/Np này/P ,/CH bạn/N có_thể/R đọc/V về/E các/L thuật_ngữ/N trong/E xử_lý/V xâu/Np cũng_như/C về/E bài_toán/N so/V khớp/N chuỗi/N ở/E đây/P Thuật_toán/N Knuth-Morris-Pratt/Np (KMP)/Np là/V một/M thuật_toán/N với/E thời_gian/N chạy/V tuyến_tính/Np nhằm/V giải_quyết/V bài_toán/N so/V khớp/N chuỗi/N ./CH\nThuật_toán/N được/V xây_dựng/V dựa/V vào/E quan_sát/V rằng/C một/M xâu/Np con/Nc chung/A của/E S/Y và/Cc T/Nu sẽ/R đưa_ra/Np được/V thông_tin/N S/Y có/V khớp/N với/E các_vị/Np trí/Np sau/E của/E T/Nu hay_không/Np ./CH\nBởi_vì/E xâu/Np con/Nc chung/A này/P đồng_nghĩa/A với/E một/M phần/N của/E T/Nu đã/R khớp/N với/E một/M phần/N của/E S/Y ,/CH nên/C bằng/E việc/N khởi/V tạo/V trước/E một_số/L thông_tin/N với/E xâu/Np S/Y ,/CH ta/P sẽ/R thu/V được/V những/L kết_luận/V về/E T/Nu (nhờ/Np xâu/Np con/Nc chung)/Np mà/C không/R cần/V quay/V ngược/A và/Cc so_sánh/V lại/R những/L ký_tự/Np đã/R khớp/N ./CH\nCụ_thể/A hơn/A ,/CH ta/P muốn/V tính_toán/V trước/E cách/N xâu/Np S/Y tự/P khớp/N với/E chính/T nó/P ./CH\nNhờ/V vậy/P thuật_toán/N sẽ/R không/R quay/V nhìn/V lại/R và/Cc chỉ/R duyệt/V qua/V T/Nu một_lần/Np duy_nhất/A ./CH\nCùng_với/C quá_trình/N tiền/N xử_lí/V tuyến_tính/Np O(T)/Np (với/Np T/Nu là/V độ_dài/Np xâu/Np T)/Np ,/CH thuật_toán/N có/V thời_gian/N chạy/V tuyến_tính/Np ./CH\nCảm_hứng/Np Cảm_hứng/Np của/E KMP/Np có_thể/R được/V minh_họa/V rõ/A nhất/A qua/V 3/M ví_dụ/C dưới_đây/Np ./CH\nVí_dụ/C 1/M S/Y =/CH aaa/Np T/Nu =/CH aaaaaaaaa/Np Ở/E ví_dụ/C này/P ,/CH ta/P cần/V các/L lần/N xuất_hiện/V của/E xâu/Np S/Y trong/E xâu/Np T/Nu (S/Np xuất_hiện/V 7/M lần)/Np ./CH\nTa/P có_thể/R duyệt/V bình_thường/A với/E độ/N phức_tạp/A O(S_T)/Np như_sau/Np :/CH So/V S_1/Np với/E T_1/Np ,/CH S_2/Np với/E T_2/Np ,/CH S_3/Np với/E T_3/Np ,/CH do_đó/C vị_trí/N số/N 1/M là/V vị_trí/N khớp/N của/E S/Y trong/E T/Nu ./CH\nSo/V S_1/Np với/E T_2/Np ,/CH S_2/Np với/E T_3/Np ,/CH S_3/Np với/E T_4/Np ,/CH tìm/V được/V vị_trí/N số/N 2/M là/V vị_trí/N khớp/N của/E S/Y trong/E T/Nu ./CH\nSo/V S_1/Np với/E T_3/Np ,/CH S_2/Np với/E T_4/Np ,/CH S_3/Np với/E T_5/Np ,/CH tìm/V được/V vị_trí/N số/N 3/M là/V vị_trí/N khớp/N của/E S/Y trong/E T/Nu ./CH\nVà/Cc cứ/R mãi/R như_vậy/X cho_đến/E khi/N đủ/A hết/V trường_hợp/N ./CH\nTuy_nhiên/C ta/P có_thể/R làm/V tốt/A hơn/A nếu/C ta/P tiền/N xử_lý/V S/Y và/Cc để_ý/V :/CH S_1/Np giống/N S_2/Np S_2/Np giống/N S_3/Np ./CH\nVậy/P tiền_tố/Np độ_dài/Np 2/M của/E S/Y (S_1/Np S_2)/Np khớp/N với/E xâu/Np con/Nc độ_dài/Np 2/M ở/E vị_trí/N thứ/N 2/M của/E S/Y (S_2/Np S_3)/Np -/CH nói_cách_khác/Np ,/CH S/Y tự/P khớp/N một/M phần/N ./CH\nSau/E khi/N kiểm_tra/V khớp/N ở/E vị_trí/N số/N 1/M (so/Np sánh/V S/Y với/E T_1/Np T_2/Np T_3)/Np ,/CH ta/P đã/R biết/V :/CH S_1/Np =/CH T_1/Np S_2/Np =/CH T_2/Np S_3/Np =/CH T_3/Np Khi/N ta/P kiểm_tra/V khớp/N ở/E vị_trí/N số/N 2/M (so/Np sánh/V S/Y với/E T_2/Np T_3/Np T_4)/Np ,/CH ta/P có/V :/CH S_2/Np =/CH T_2/Np ,/CH S_3/Np =/CH T_3/Np S_1/Np =/CH S_2/Np ,/CH S_2/Np =/CH S_3/Np Suy/V ra/V :/CH S_1/Np =/CH T_2/Np S_2/Np =/CH T_3/Np ./CH\nDo_vậy/C ,/CH việc/N so_sánh/V với/E T_2/Np ,/CH T_3/Np là/V không/R cần_thiết/A nữa/R ./CH\nTa/P chỉ_cần/Np kiểm_tra/V nốt/R S_3/Np =/CH T_4/Np là/V đã/R kết_luận/V được/V S/Y được/V tìm_thấy/Np ở/E vị_trí/N 2/M trong/E T/Nu ./CH\nNhư_vậy/X ,/CH sau/E đáp_án/N ở/E vị_trí/N 1/M ,/CH ta/P chỉ_cần/Np thêm/V 1/M thao_tác/V để/E kết_luận/V S/Y cũng/R có/V ở/E vị_trí/N 2/M trong/E T/Nu ,/CH thay_vì/X 3/M như/C thuật/Np duyệt/V bình_thường/A ./CH\nĐến/E đây/P ta/P biết/V :/CH S_1/Np =/CH T_2/Np S_2/Np =/CH T_3/Np S_3/Np =/CH T_4/Np Và/Cc tương_tự/A ,/CH lại/R kết_luận/V được/V :/CH S_1/Np =/CH T_3/Np S_2/Np =/CH T_4/Np ./CH\nTa/P sau_đó/Np chỉ_cần/Np so/V S_3/Np với/E T_5/Np ,/CH tìm/V được/V một/M đáp_án/N nữa/R ,/CH cứ/R thế/P tiếp_tục/V ./CH\nTrong_khi/Np thuật_toán/N duyệt/V cần/V đến/E 3/M phép_tính/Np cho/E mỗi/L lần/N so_sánh/V S/Y với/E một/M xâu/Np con/Nc của/E T/Nu ,/CH kĩ_thuật/N của/E chúng_ta/P chỉ_cần/Np 3/M phép_tính/Np ở/E lần_lặp/Np đầu/N và/Cc 1/M cho/E mỗi/L kết_quả/N sau/E ,/CH và/Cc không/R xét_lại/Np các/L kí_tự/Np của/E T/Nu ./CH\n(Đây/Np cũng/R là/V cách/N con_người/N giải_quyết/V bài/N toán)/Np Ví_dụ/C 2/M S/Y =/CH aaa/Np T/Nu =/CH aabaabaaa/Np Như/C ở/E trên/E ,/CH ta/P bắt_đầu/V như/C thuật_toán/N duyệt/V ,/CH so_sánh/V :/CH S_1/Np với/E T_1/Np S_2/Np với/E T_2/Np S_3/Np với/E T_3/Np Ở/E đây/P ta/P thấy/V S_3/Np khác/A T_3/Np ,/CH vậy/P S/Y không/R khớp/N với/E T/Nu ở/E vị_trí/N 1/M ./CH\nĐến/E bước/V này/P thuật/Np duyệt/V sẽ/R tiếp_tục/V bằng/E cách/N so/V S_1/Np với/E T_2/Np và/Cc S_2/Np với/E T_3/Np ,/CH không/R khớp;/Np rồi/C lại/R so/V S_1/Np với/E T_3/Np ,/CH không/R khớp;/Np cứ_như/Np vậy/P ./CH\nThế_nhưng/C chúng_ta/P sẽ/R thấy/V ngay/R rằng/C sau/E kết_quả/N không/R khớp/N ở/E vị_trí_đầu/Np ,/CH khả_năng/N tìm_thấy/Np S/Y ở/E các_vị/Np trí/Np 2/M và/Cc 3/M của/E T/Nu đã/R không/R còn/R ./CH\nLí_do/N là_vì/Np ,/CH như/C đã/R trình_bày/V ở/E ví_dụ/C 1/M :/CH S_2/Np =/CH S_3/Np S_3/Np \\neq/Np T_3/Np Do_đó/C S_2/Np \\neq/Np T_3/Np ./CH\nTương_tự/A như_vậy/X ,/CH do/E :/CH S_1/Np =/CH S_2/Np S_2/Np \\neq/Np T_3/Np Nên/C S_1/Np \\neq/Np T_3/Np ,/CH ta/P không/R cần/V tìm/V S/Y ở/E vị_trí/N thứ/N 3/M của/E T/Nu làm_gì/X ./CH\nSẽ/R hợp_lí/A hơn/A khi/N bắt_đầu/V tiếp/V ở/E vị_trí/N số/N 4/M (do/Np ta/P không_thể/R chắc_chắn/A có_thể/R tìm/V được/V hay_không/Np S_2/Np S_3/Np S_4/Np \\/Np ,/CH =/CH \\/Np ,/CH T_4T_5T_6)/Np ./CH\nSau/E khi/N so_sánh/V ở/E vị_trí/N 4/M và/Cc thấy/V tiếp_tục/V không/R khớp/N ,/CH ta/P dùng/V lập_luận/N tương_tự/A loại_bỏ/V vị_trí/N số/N 5/M và/Cc 6/M ,/CH và/Cc bắt_đầu/V lại/R ở/E vị_trí/N số/N 7/M (ở/Np đây/P 2/M xâu/Np khớp/N nhau)/Np ./CH\nLần/N nữa/R ,/CH hãy/R chú_ý/V các/L kí_tự/Np của/E T/Nu được/V duyệt/V qua/V theo/V trình_tự/N ./CH\nVí_dụ/C 3/M Đây/P là/V một/M ví_dụ/C phức_tạp/A hơn/A :/CH S/Y =/CH tartan/Np T/Nu =/CH tartaric_acid/Np Ta/P quan_sát/V thấy/V tiền_tố/Np độ_dài/Np 2/M của/E S/Y khớp/N với/E chính/T xâu/Np con/Nc độ_dài/Np 2/M bắt_đầu/V ở/E vị_trí/N số/N 4/M của/E nó/P ./CH\nBây_giờ/P lần_lượt/R so_sánh/V các_vị/Np trí/Np từ/E S_1/Np đến/E S_6/Np với/E T_1/Np đến/E T_6/Np ./CH\nTa/P thấy/V S_6/Np không/R khớp/N với/E T_6/Np ,/CH vậy/P không/R có/V kết_quả/N ở/E vị_trí/N số/N 1/M ./CH\nỞ/E đây/P hãy/R chú_ý/V :/CH S_1/Np \\neq/Np S_2/Np S_1/Np \\neq/Np S_3/Np S_2/Np =/CH T_2/Np S_3/Np =/CH T_3/Np Nên/C ta/P có/V S_1/Np \\neq/Np T_2/Np và/Cc S_1/Np \\neq/Np T_3/Np ./CH\nVậy/P không_thể/R có/V trùng/V khớp/N ở/E vị_trí/N số/N 2/M và/Cc 3/M ./CH\nTới/E đây/P hãy/R nhớ_lại/Np rằng/C :/CH S_1/Np =/CH S_4/Np S_2/Np =/CH S_5/Np S_4/Np =/CH T_4/Np S_5/Np =/CH T_5/Np Ta/P suy/V ra/V S_1/Np =/CH T_4/Np ,/CH S_2/Np =/CH T_5/Np ./CH\nVậy_ta/Np sẽ/R tiếp_tục/V kiểm_tra/V vị_trí/N số/N 4/M bằng/E việc/N so_sánh/V S_3/Np với/E T_6/Np ./CH\nLàm_theo/Np cách/N này/P ,/CH ta/P loại_bỏ/V được/V hai/M trường_hợp/N và/Cc bắt_đầu/V duyệt/V lại/R không_phải/Np ở/E đầu/N mà/C ở/E giữa/N xâu/Np S/Y ,/CH tránh/V được_việc/Np xét_lại/Np T_4/Np và/Cc T_5/Np ./CH\nÝ_tưởng/N chính/T Gọi_Si/Np là/V tiền_tố/Np độ_dài/Np i/M của/E xâu/Np S/Y ./CH\nCác/L ví_dụ/C trên/E chính/T là/V tư_tưởng/N hoạt_động/N của/E KMP/Np :/CH dựa/V trên/E quan_sát/V rằng/C một_số/L xâu/Np con/Nc của/E xâu/Np cần/V tìm/V có/V khớp/N với/E xâu/Np con/Nc nào/P khác/A của/E xâu/Np cần/V tìm/V hay_không/Np ./CH\nTuy_nhiên/C định_hướng/V chung/A ,/CH mang/V tính/V hệ_thống/N của/E thuật_toán/N thì/C chưa/R rõ_ràng/A ./CH\nĐịnh_hướng/V này/P được/V phát_biểu/V như_sau/Np :/CH Ở/E mỗi/L vị_trí/N i/M của/E S/Y ,/CH tìm/V hậu_tố/Np chuẩn/N dài/A nhất/A của/E Si/Ny mà/C cũng/R là/V tiền_tố/Np của/E S/Y ./CH\n(/CH Hậu_tố/Np chuẩn/N của/E một/M xâu/Np là/V hậu_tố/Np có/V độ_dài/Np bé/N hơn/A xâu/Np đó/P ./CH )/CH Ta/P sẽ/R gọi/V độ_dài/Np của/E xâu/Np con/Nc này/P là/V \\pi_i/Np ./CH\nTa/P cũng/R có_thể/R định_nghĩa/N \\pi_i/Np là/V số/N j/Np lớn/A nhất/A để/E Sj/Np \\sqsupset/Np Si/Ny ./CH Ký_hiệu/Np X/CH \\sqsupset/Np Y/N nghĩa_là/V X/CH là/V hậu_tố/Np của/E Y/N ./CH\nBảng/N \\pi/Np ,/CH gọi_là/V hàm/Np tiền_tố/Np ,/CH chiếm/V bộ_nhớ/Np tuyến_tính/Np ,/CH và/Cc như/C sẽ/R trình_bày/V dưới_đây/Np ,/CH có_thể/R tính/V được/V trong/E thời_gian/N tuyến_tính/Np ./CH\nBảng/N sẽ/R chứa/V toàn_bộ/L các/L thông_tin/N cần_thiết/A để/E máy/N thực_hiện/V những/L phương_án/N \"thông/Np minh/Np nhất\"/Np cho/E quá_trình/N tìm_kiếm/V ./CH\nCụ_thể/A hơn/A :/CH Trong/E ví_dụ/C 1/M và/Cc 2/M :/CH \\pi_1/Np =/CH 0/M ,/CH không/R có/V tiền_tố/Np chuẩn/N thỏa_mãn/V ./CH\n\\pi_2/Np =/CH 1/M ,/CH tiền_tố/Np a/Ni khớp/N hậu_tố/Np a/Ni ./CH\n\\pi_3/Np =/CH 2/M ,/CH tiền_tố/Np aa/Np khớp/N hậu_tố/Np aa/Np ./CH\nTrong/E ví_dụ/C 3/M :/CH \\pi_1/Np =/CH 0/M \\pi_2/Np =/CH 0/M \\pi_3/Np =/CH 0/M \\pi_4/Np =/CH 1/M ,/CH tiền_tố/Np t/Nu khớp/N với/E xâu/Np con/Nc t/Nu kết_thúc/V ở/E vị_trí/N thứ/N 4/M ./CH\n\\pi_5/Np =/CH 2/M ,/CH tiền_tố/Np ta/P khớp/N với/E xâu/Np con/Nc ta/P kết_thúc/V ở/E vị_trí/N thứ/N 5/M ./CH\n\\pi_6/Np =/CH 0/M ./CH\nTổng_quát/Np ,/CH bảng/N \\pi/Np cho/E ta/P biết/V ,/CH sau/E một_lần/Np khớp/N hoặc/Cc không/R khớp/N giữa/N \"cây/Np kim\"/Np và/Cc \"đống/Np rơm\"/Np ,/CH vị_trí/N tiếp_theo/V trong/E \"đống/Np rơm\"/Np ta/P cần/V kiểm_tra/V là/V gì/P ./CH\nCác/L phép/N so/V sẽ/R tiếp_tục/V ở/E các_vị/Np trí/Np tiếp_theo/V ,/CH không/R bao_giờ/P quay/V ngược/A về/E các/L kí_tự/Np ta/P đã/R kiểm_tra/V rồi/C ./CH\nTính_toán/V độ/N phức_tạp/A Để/E tính/V độ/N phức_tạp/A cho/E hàm/Np tiền/N xử_lí/V ,/CH trước_tiên/N ta/P có/V quan_sát/V :/CH Dãy/Nc \\pi_i/Np =/CH i/M ,/CH \\pi_i/Np ,/CH \\pi_\\pi_i/Np ,/CH \\pi_\\pi_\\pi_i/Np ,/CH ./CH ./CH ./CH\n,/CH 0/M chứa/V toàn_bộ/L những/L giá_trị/N j/Np thỏa_mãn/V Sj/Np \\sqsupset/Np Si/Ny ./CH Vậy/P ,/CH ta/P có_thể/R đếm/V toàn_bộ/L những/L hậu_tố/Np của/E Si/Ny đồng_thời/R là/V tiền_tố/Np của/E S/Y bằng/E cách/N bắt_đầu/V với/E i/M ,/CH dò/V nó/P trong/E bảng/N \\pi/Np ,/CH dùng/V kết_quả/N đó/P dò/V tiếp_tục/V và/Cc tiếp_tục/V ,/CH đến/E khi/N kết_thúc/V bằng/E 0/M ./CH\nChứng_minh/V :/CH Đầu_tiên_ta/Np chứng_minh/V chiều/N xuôi/N :/CH nếu/C j/Np xuất_hiện/V trong/E \\pi_i/Np thì/C Sj/Np \\sqsupset/Np Si/Ny ./CH Nếu/C j/Np là/V phần_tử/N đầu/N trong/E \\pi_i/Np ./CH\nVậy/P j/Np =/CH i/M và/Cc hẳn_nhiên/Np Sj/Np \\sqsupset/Np Si/Ny ./CH Nếu/C j/Np không/R là/V phần_tử/N đầu/N :/CH Gọi/V phần_tử/N trước/E nó/P là/V k/N ./CH\nVậy/P \\pi_k/Np =/CH j/Np ./CH\nTheo/V định_nghĩa/N ,/CH Sj/Np \\sqsupset/Np Sk/Np ./CH Nhưng_Sk/Np \\sqsupset/Np Si/Ny ./CH Do/E quan_hệ/N này/P có/V tính_chất/N bắc_cầu/V ,/CH Sj/Np \\sqsupset/Np Si/Ny ./CH Giờ/N ta/P chứng_minh/V chiều/N ngược/A :/CH nếu/C Sj/Np \\sqsupset/Np Si/Ny ,/CH j/Np thuộc/V \\pi_i/Np ./CH\nGiả_sử/Np j/Np không/R xuất_hiện/V trong/E dãy/Nc ./CH\nRõ_ràng/A 0/M lt;/Np j/Np lt;/Np i/M do/E i/M và/Cc 0/M đều/R có/V trong/E dãy/Nc ./CH\nDo/E \\pi_i/Np luôn/R giảm/V ,/CH ta/P có_thể/R tìm/V được/V một_và/Np chỉ/R một/M k/N thuộc/V \\pi_i/Np sao_cho/Np kgt;j/Np và/Cc \\pi_klt;j/Np ./CH\nNói_cách_khác/Np ,/CH ta/P có_thể/R tìm/V được/V một_và/Np chỉ/R một/M k/N mà/C sau/E nó/P j/Np \"có/Np lẽ\"/Np sẽ/R xuất_hiện/V (để/Np giữ/V cho/E dãy/Nc luôn/R giảm)/Np ./CH\nỞ/E phần/N đầu/N chứng_minh_ta/Np đã/R biết/V Sk/Np \\sqsupset/Np Si/Ny ./CH Do/E hậu_tố/Np độ_dài/Np j/Np của/E Si/Ny là/V một/M hậu_tố/Np của/E hậu_tố/Np độ_dài/Np k/N của/E Si/Ny ,/CH hậu_tố/Np độ_dài/Np j/Np của/E Si/Ny phải/V khớp/N với/E hậu_tố/Np độ_dài/Np j/Np của/E Sk/Np ./CH Nhưng/C hậu_tố/Np độ_dài/Np j/Np của/E Si/Ny cũng/R khớp/N với/E Sj/Np ,/CH nên/C Sj/Np khớp/N với/E hậu_tố/Np độ_dài/Np j/Np của/E Sk/Np ./CH Vậy_ta/Np kết_luận/V \\pi_k/Np \\ge/Np j/Np ./CH\nThế_nhưng/C j/Np \\ge/Np \\pi_k/Np ,/CH mâu_thuẫn/V ./CH\nCũng/R chính/T nhờ/V việc/N chứng_minh/V này/P ,/CH ta/P có_thể/R xây_dựng/V một/M thuật_toán/N để/E tính/V bảng/N \\pi/Np ./CH\nVới/E mỗi/L i/M :/CH Đầu_tiên_ta/Np tìm/V số/N j/Np gt;/Np 0/M sao_cho/Np Sj/Np \\sqsupset/Np Si/Ny ./CH Nếu_không/Np tìm/V được/V ,/CH ta/P kết_luận/V \\pi_i/Np =/CH 0/M (như/Np trường_hợp/N i=1)/Np ./CH\nNếu/C có/V j/Np gt;/Np 0/M thỏa_mãn/V ,/CH vậy/P khi/N xóa_bỏ/V kí_tự/Np cuối/N của/E hậu_tố/Np này/P ,/CH ta/P thu/V được/V một/M hậu_tố/Np của/E S_i-1/Np đồng_thời/R là/V tiền_tố/Np của/E S/Y ,/CH tức_là/V Sj-1/Np \\sqsupset/Np Si-1/Np ./CH\nVậy/P bước_đầu/N ta/P đếm/V mọi/L hậu_tố/Np chuẩn/N và/Cc không-rỗng/Np của/E Si-1/Np đồng_thời/R là/V tiền_tố/Np của/E S/Y ./CH\nNếu/C ta/P tìm/V được/V một/M hậu_tố/Np độ_dài/Np k/N đồng_thời/R thỏa/V S_k/Np =/CH S_i/Np ,/CH vậy/P Sk+1/Np \\sqsupset/Np Si/Ny ,/CH và/Cc k+1/Np là/V một/M giá_trị/N khả_dĩ/Np của/E j/Np ./CH\nVậy_ta/Np sẽ/R gán/V k/N =/CH \\pi_i-1/Np và/Cc tiếp_tục/V lặp_lại/Np trong/E dãy/Nc \\pi_\\pi_i/Np ,/CH \\pi_\\pi_\\pi_i/Np ,/CH ./CH ./CH ./CH\nQuá_trình/N sẽ/R dừng/V lại/R nếu/C gặp_phải/Np một/M phần_tử/N j/Np trong/E dãy/Nc sao_cho/Np S_j+1/Np =/CH S_i/Np ,/CH và/Cc gán/V \\pi_i/Np =/CH j+1;/Np cách/N này/P sẽ/R luôn/R cho/E kết_quả/N tối_ưu/A vì/E dãy/Nc \\pi_i-1/Np luôn/R giảm/V và/Cc nó/P chứa/V toàn_bộ/L giá_trị/N k/N khả_dĩ/Np ./CH\nNếu/C đi/V đến/E hết/V dãy/Nc ,/CH vậy/P \\pi_i/Np =/CH 0/M ./CH\nDưới_đây/Np là/V mã/N giả/A để/E tính/V \\pi/Np :/CH π1/Np ←/Np 0/M for/Np i/M ∈/Np 2/M ./CH ./CH m/Nu k/N ←/Np πi-1/Np while/Np k/N gt;/Np 0/M and/Np Sk+1/Np ≠/Np Si/Ny k/N ←/Np πk/Np if/Np Sk+1/Np =/CH Si/Ny πi/Np ←/Np 0/M else/Np πi/Np ←/Np k+1/Np Hoặc/Cc có_thể/R viết/V gọn/A lại/R như_sau/Np :/CH π1/Np ←/Np 0/M k/N ←/Np 0/M for/Np i/M ∈/Np 2/M ./CH ./CH m/Nu while/Np k/N gt;/Np 0/M and/Np Sk+1/Np ≠/Np Si/Ny k/N ←/Np πk/Np if/Np Sk+1/Np =/CH Si/Ny k/N ←/Np k+1/Np πi/Np ←/Np k/N Thuật_toán/N có/V độ/N phức_tạp/A O(m)/Np ./CH\nĐể/E hiểu/V tại_sao/X thì/C hãy/R để_ý/V ,/CH k/N không/R bao_giờ/P âm;/Np nó/P không_thể/R giảm/V nhiều/A hơn/A mức/N nó/P tăng/V ./CH\nk/N chỉ/R tăng/V ở/E dòng/N k/N ←/Np k+1/Np ,/CH vốn/N chỉ/R bị/V gọi/V nhiều/A nhất_là/X m-1/Np lần/N ./CH\nVậy/P k/N giảm/V nhiều/A nhất_là/X k/N lần/N ./CH\nNhưng/C k/N giảm/V ở/E mỗi/L lần_lặp/Np của/E vòng/N while/Np ,/CH vậy/P tổng/N tất_cả/P các/L bước/V trong_vòng/Np while/Np không/R quá/R O(m)/Np ./CH\nTất_cả/P những/L câu_lệnh/Np trong_vòng/Np for/Np đều/R có/V độ/N phức_tạp/A là/V hằng_số/Np ,/CH nên/C cả/P thuật_toán/N có/V độ/N phức_tạp/A O(m)/Np ./CH\nSo/V khớp/N Coi_như/Np ta/P đã/R xây_dựng/V xong/V bảng/N \\pi/Np ./CH\nĐây/P là/V lúc/N ta/P sử_dụng/V những/L thông_tin/N cực_khổ/A lấy_được/X này/P ./CH\nGiả_sử/Np rằng/C ta/P đã/R kiểm_tra/V đang/R vị_trí/N thứ/N j/Np ,/CH và/Cc k/N kí_tự/Np đầu/N của/E S/Y đã/R khớp/N ./CH\nNói_cách_khác/Np :/CH S_1/Np =/CH T_j/Np S_2/Np =/CH T_j+1/Np S_3/Np =/CH T_j+2/Np ./CH ./CH ./CH\nS_k/Np =/CH T_j+k-1/Np ./CH\nCó/V 2/M khả_năng/N :/CH Ta/P muốn/V tiếp_tục/V chạy/V trên/E S/Y và/Cc T/Nu để/E kiểm_tra/V các/L cặp/N kí_tự/Np Ta/P kiểm_tra/V ở/E một/M ví/N trị/V khác/A trên/E T/Nu ./CH\nLí_do/N cho/E trường_hợp/N 2/M là/V :/CH hoặc/Cc k/N =/CH m/Nu (tức/Np đã/R tìm_thấy/Np một/M vị_trí/N trùng/V khớp/N của/E S/Y trên/E T/Nu và/Cc ta/P cần/V tiếp_tục/V ở/E vị_trí/N khác)/Np hoặc/Cc S_k+1/Np \\neq/Np T_j+k/Np (loại/Np bỏ/V vị_trí/N hiện/N tại)/Np ./CH\nNếu/C ta/P đã/R biết/V từ/E S_1/Np đến/E S_k/Np khớp/N với/E từ/E T_j/Np đến/E T_j+k-1/Np ,/CH vị_trí/N nào/P ta/P có_thể/R bỏ_qua/V ?/CH\nĐây/P là/V cốt_lõi/Np của/E thuật_toán/N KMP/Np :/CH Định_lý/Np :/CH Nếu/C k/N gt;/Np 0/M thì/C p/Ny =/CH k/N -/CH \\pi_k/Np sẽ/R là/V giá_trị/N p/Ny nhỏ/A nhất/A sao_cho/Np S_1/Np ,/CH ./CH ./CH ./CH ,/CH S_k-p/Np khớp/N với/E T_j+p/Np ,/CH ./CH ./CH ./CH ,/CH T_j+k-1/Np ./CH\n(Nếu/Np k=0/Np ,/CH p=1/Np ./CH )/CH Nói/V một_cách/N dễ/A hình_dung/V hơn/A ,/CH ta/P có_thể/R bỏ_qua/V tất_cả/P các_vị/Np trí/Np từ/E 0/M đến/E p-1/Np ./CH\nSuy_nghĩ/V thật/R kĩ/A lí_thuyết/Np này/P ./CH\nNếu/C p/Ny gt;/Np 0/M không/R thỏa_mãn/V S_1/Np ,/CH ./CH ./CH ./CH ,/CH S_k-p/Np khớp/N với/E T_j+p/Np ,/CH ./CH ./CH ./CH ,/CH T_j+k-1/Np ,/CH vậy/P S/Y không/R khớp/N với/E T/Nu ở/E vị_trí/N j+p/Np ,/CH tức/V ta/P có_thể/R loại_bỏ/V vị_trí/N này/P ./CH\nMặt_khác/X ,/CH nếu/C p/Ny gt;/Np 0/M thỏa_mãn/V yêu_cầu/V trên/E ,/CH xâu/Np S/Y có/V khả_năng/N khớp/N với/E T/Nu ở/E vị_trí/N j+p/Np ,/CH và/Cc thực_tế/N là/V các/L kí_tự/Np từ_vị/Np trí/Np j+p/Np đến/E j+k-1/Np đều/R đã/R khớp/N với/E các_vị/Np trí/Np tương_ứng/V ở/E S/Y ./CH\nTa/P chỉ_cần/Np tiếp_tục/V bằng/E cách/N so/V S_k-p+1/Np với/E T_j+k/Np ,/CH \"không/Np quay/V đầu/N lại\"/Np như/C đã/R hứa/V ./CH\nChứng_minh/V :/CH Có/V 0/M \\le/Np q/Ny lt;/Np k/N ./CH\nNếu_Sq/Np \\sqsupset/Np Sk/Np ,/CH vậy/P theo/V định_nghĩa/N ta/P có/V S_1/Np ,/CH ./CH ./CH ./CH ,/CH S_q/Np =/CH S_k-q+1/Np ,/CH ./CH ./CH ./CH ,/CH S_k/Np ./CH\nNhưng/C vì/E S_1/Np ,/CH ./CH ./CH ./CH ,/CH S_k/Np =/CH T_j/Np ,/CH ./CH ./CH ./CH ,/CH T_j+k-1/Np ,/CH nên/C S_k-q+1/Np ,/CH ./CH ./CH ./CH ,/CH S_k/Np =/CH T_j+k-q/Np ,/CH ./CH ./CH ./CH ,/CH T_j+k-1/Np ./CH\nVậy/P S_1/Np ,/CH ./CH ./CH ./CH S_q/Np =/CH T_j+k-q/Np ,/CH ./CH ./CH ./CH ,/CH T_j+k-1/Np ./CH\nNgược_lại/X ,/CH nếu_không/Np có/V Sq/Np \\sqsupset/Np Sk/Np ,/CH vậy/P S_1/Np ,/CH ./CH ./CH ./CH ,/CH S_q/Np \\neq/Np S_k-q+1/Np ,/CH ./CH ./CH ./CH ,/CH S_k/Np ,/CH dẫn/V đến/E S_k-q+1/Np ,/CH ./CH ./CH ./CH ,/CH S_k/Np =/CH T_j+k-q/Np ,/CH ./CH ./CH ./CH ,/CH T_j+k-1/Np là/V sai/A ,/CH và/Cc dẫn/V đến/E S_1/Np ,/CH ./CH ./CH ./CH S_q/Np =/CH T_j+k-q/Np ,/CH ./CH ./CH ./CH ,/CH T_j+k-1/Np là/V sai/A ./CH\nTa/P kết_luận/V rằng/C k-q/Np là/V một/M giá_trị/N khả_dĩ/Np của/E p/Ny khi/N và/Cc chỉ/R khi/N Sq/Np \\sqsupset/Np Sk/Np ./CH Do/E maximum/Np của/E q/Ny là/V \\pi_k/Np ,/CH minumum/Np của/E p/Ny được/V xác_định/V bởi/E k-\\pi_k/Np ./CH\nDưới_đây/Np là/V mã/N giả/A :/CH j/Np ←/Np 1/M k/N ←/Np 0/M while/Np j+m-1/Np ≤/Np n/Ny while/Np k/N ≤/Np m/Nu and/Np Sk+1/Np =/CH Tj+k/Np k/N ←/Np k+1/Np if/Np k/N =/CH m/Nu print/Np \"Match/Np at/Np position/Np \"/CH j/Np if/Np k/N =/CH 0/M j/Np ←/Np j+1/Np else/Np j/Np ←/Np j+k-πk/Np k/N ←/Np πk/Np Ta/P dò/V trong/E xâu/Np cần/V search/Np một_lần/Np một/M kí/V tự;/Np kí_tự/Np đang/R được/V xét/V là/V nằm/V ở/E vị_trí/N j+k/Np ./CH\nNếu/C xảy_ra/Np không/R trùng/V khớp/N ,/CH ta/P dùng/V bảng/N \\pi/Np để/E tìm/V đến/E vị_trí/N khả_dĩ/Np tiếp_theo/V ./CH\nĐoạn/Nc code/Np tương_đương/A dưới_đây/Np thể_hiện/V rõ/A hơn/A việc/N thuật_toán/N xét/V một/M kí_tự/Np một_lần/Np và/Cc không/R quay/V ngược_lại/X :/CH k/N ←/Np 0/M for/Np i/M ∈/Np 1/M ./CH ./CH n/Ny while/Np k/N gt;/Np 0/M and/Np Sk+1/Np ≠/Np Ti/Ny k/N ←/Np πk/Np if/Np Sk+1/Np =/CH Ti/Ny k/N ←/Np k+1/Np if/Np k/N =/CH m/Nu print/Np \"Match/Np at/Np position/Np \"/CH i-m+1/Np k/N ←/Np πk/Np Ở/E đây/P ,/CH i/M tương_ứng/V với/E j+k/Np ở/E đoạn/Nc code/Np trên/E ./CH\nMỗi/L lần_lặp/Np của/E vòng_lặp/Np trong/E của/E một/M trong/E 2/M đoạn/Nc code/Np tương_ứng/V với/E một_lần/Np lặp/V của/E vòng_lặp/Np ngoài/E ở/E đoạn/Nc còn_lại/Np ./CH\nỞ/E đoạn/Nc thứ_hai/N ,/CH ta/P cũng/R có_thể/R chứng_minh/V thuật/Np có/V độ/N phức_tạp/A O(n);/Np mỗi/L lần/N vòng/N while/Np ở/E trong/E được/V thực_hiện/V ,/CH giá_trị/N của/E k/N giảm/V ,/CH nhưng/C nó/P không_thể/R giảm/V nhiều/A hơn/A n/Ny lần/N bởi/E k/N khởi_đầu/V là/V không/R và/Cc không/R bao_giờ/P âm/A ./CH\nk/N chỉ/R tăng/V nhiều/A nhất/A một_lần/Np ở/E vòng_lặp/Np ngoài/E (tức/Np nhiều/A nhất/A tổng_cộng/V n/Ny lần)/Np ./CH\nVậy/P vòng_lặp/Np trong/E chỉ/R lặp/V nhiều/A nhất/A n/Ny lần/N ,/CH và/Cc tất_cả/P các/L câu_lệnh/Np khác/A có/V độ/N phức_tạp/A hằng_số/Np ./CH\nBài_tập/Np áp_dụng/V :/CH VOJ/Np -/CH SUBSTR/Np ./CH\nCode_C++_VOJ/Np -/CH TWOOPERS/Np\n", "title": "Thuật toán Knuth-Morris-Pratt (KMP)\n", "link": "http://vnoi.info/wiki/translate/wcipeg/kmp\n"}