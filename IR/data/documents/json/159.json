{"content": "Tác_giả : Hoàng_Gia_Minh Bài viết này nhằm giúp bạn_đọc nắm được ý_tưởng cơ_bản của các hệ mã_hóa khóa công_khai ( Public_Key_Cryptography ) và một_số ứng_dụng của chúng .\nNgoài_ra , chúng_ta cũng sẽ tìm_hiểu về thuật_toán mã_hóa RSA , một hệ mã_hóa khóa công_khai được sử_dụng khá phổ_biến hiện_nay .\nTable of_Contents 1 .\nMột_số khái_niệm 2 .\nLịch_sử 2 . 1 . Mã_hóa khóa đối_xứng (Symmetric-key cryptography) 2 . 2 . Mã_hóa khóa công_khai (Public-key cryptography) 3 .\nỨng_dụng 3 . 1 . Mã_hóa công_khai (Public-key encryption) : 3 . 2 . Chữ_ký điện_tử (Digital signatures) : 4 .\nRSA 4 . 1 Mã_hóa 4 . 2 . Giải_mã 4 . 3 . Sinh khóa (Key generation) 4 . 4 . Sample code 5 .\nTham_khảo 1 .\nMột_số khái_niệm Mã_hóa (Encryption) : Quá_trình chuyển_đổi thông_tin từ dạng thông_thường (có thể đọc được) sang dạng không đọc được (nếu không có khóa bí mật) , nhằm bảo_mật thông_tin .\nGiải_mã (Decryption) : Là quá_trình ngược của mã_hóa - chuyển_đổi từ_thông_tin đã mã_hóa về thông_tin ban_đầu .\nKhóa (Key) : Một đoạn thông_tin được sử_dụng để mã_hóa và/hoặc giải_mã .\n2 .\nLịch_sử 2 . 1 . Mã_hóa khóa đối_xứng ( Symmetric-key cryptography ) Cho_đến trước năm 1976 , các phương_pháp mã_hóa đều là mã_hóa đối_xứng .\nCác hệ mã_hóa đối_xứng sử_dụng cùng một khóa cho cả bên gửi lẫn bên nhận .\nNói một_cách chính_xác hơn , hai khóa này có_thể : giống nhau , hoặc khác_nhau nhưng có_thể dễ_dàng tìm_ra được khóa còn_lại nếu đã biết một khóa .\nƯu_điểm của các phương_pháp này là đơn_giản , tốc_độ cao , mang_lại hiệu_quả tốt nếu bạn không chia_sẻ khóa của mình cho người khác .\nTuy_nhiên , chúng lại có các nhược_điểm sau : Để có_thể trao_đổi thông_tin bí_mật với_nhau , hai bên phải thống_nhất với_nhau trước về khóa bí_mật .\nBài_toán đặt ra là làm_sao có_thể đảm_bảo việc gửi khóa cho nhau là bí_mật .\nĐể đảm_bảo trong 1 nhóm n người cần phải có 1 số_lượng khóa khá lớn - \\fracn(n-1)2 khóa .\nĐiều này dẫn đến một bài_toán về việc lưu_trữ , phân_phối một_số lượng lớn khóa mà vẫn phải đảm_bảo sự an_toàn của chúng .\nDo bên gửi và nhận sử_dụng chung khóa , chúng_ta không_thể xác_định được nguồn_gốc của một thông_điệp (message) .\n2 . 2 . Mã_hóa khóa công_khai ( Public-key cryptography ) Vào năm 1874 , William_Stanley_Jevons viết trong quyển The_Principles of Science về mối liên_hệ giữa các hàm một_chiều và mật_mã học .\nĐặc_biệt , ông đã đi_sâu vào bài_toán phân_tích ra thừa_số nguyên_tố (sau này được sử_dụng trong thuật_toán RSA) .\nLiệu rằng bạn_đọc có_thể đoán được 2 số_nguyên nào có tích bằng 8 , 616 , 460 , 799 ?\nTôi nghĩ rằng ngoài tôi ra thì không_ai có_thể biết kết_quả được .\nNăm 1976 , Whitfield_Diffie và Martin_Hellman công_bố bài báo New_Directions in Cryptography , làm thay_đổi căn_bản về cách các hệ mật_mã hoạt_động .\nBài báo đã đưa_ra một hệ_thống mã_hóa bất_đối_xứng trong đó nêu ra phương_pháp trao_đổi khóa công_khai , giải_quyết các hạn_chế của mã đối_xứng .\nKhác với mã đối_xứng , mã_hóa khóa bất_đối_xứng sử_dụng một cặp khóa : khóa công_khai ( public key ) và khóa bí_mật ( private key ) .\nHai khóa này được xây_dựng sao_cho từ một khóa , rất khó có cách sinh_ra được khóa còn_lại .\nMột khóa sẽ dành để mã_hóa , khóa còn_lại dùng để giải_mã .\nChỉ_có người sở_hữu nắm được khóa bí_mật trong_khi khóa công_khai được phổ_biến rộng_rãi .\nHình_vẽ sau minh_họa việc mã_hóa và giải_mã : 3 .\nỨng_dụng Mật_mã_hóa khóa công_khai hay còn gọi_là mã_hóa bất_đối_xứng có 2 ứng_dụng phổ_biến sau : 3 . 1 . Mã_hóa công_khai ( Public-key encryption ) : Một thông_điệp được mã_hóa bằng khóa công_khai của người nhận .\nThông_điệp này chỉ_có thể giải_mã được bằng khóa bí_mật mà chỉ người nhận có .\n3 . 2 . Chữ_ký điện_tử ( Digital signatures ) : Chữ_ký điện_tử là thông_tin đi_kèm với dữ_liệu nhằm mục_đích xác_định chủ_sở_hữu của dữ_liệu đó .\nMột văn_bản được \"ký\" bằng khóa bí_mật của người_gửi và có_thể được xác_nhận bới bất_kỳ ai có khóa công_khai của người_gửi .\nCụ_thể hơn , bên gửi sẽ tính ra mã_hash h của văn_bản , sau_đó dùng khóa bí_mật để mã_hóa h thành \\sigma rồi gửi cho bên nhận văn_bản đó cùng_với \"chữ ký\" \\sigma .\nBên nhận_thực hiện xác_nhận như_sau : Tính mã_hash h của văn_bản .\nGiải_mã \"chữ ký\" \\sigma thành h bằng khóa công_khai .\nSo_sánh h và h , nếu chúng bằng_nhau thì quá_trình xác_thực thành_công , ngược_lại quá_trình xác_thực thất_bại .\n4 .\nRSA_RSA là một trong những phương_pháp mã_hóa khóa công_khai đầu_tiên được ứng_dụng rộng_rãi trong việc đảm_bảo an_toàn khi truyền_thông_tin .\nSự bất_đối_xứng của hệ mã này được dựa trên quan_sát là khó có_thể phân_tích ra thừa_số nguyên_tố của một_số là tích của 2 số_nguyên_tố .\nRSA được tạo_thành bằng chữ_cái đầu_tiên của Ron_R ivest , Adi_S hamir , Lenonard_A dleman , 3 người đầu_tiên mô_tả thuật_toán vào năm 1977 .\nNguyên_lý cơ_bản của RSA dựa trên nhận_định là có_thể tìm được 3 số_nguyên_dương rất lớn e , d và n mà : (me)d \\equiv m \\pmod n \\quad \\forall m và dù_cho có biết cả e , n hay cả m thì cũng rất khó để tìm_ra d .\nTiếp_theo chúng_ta sẽ đi_sâu vào từng công_đoạn của 1 hệ mã , bao_gồm việc mã_hóa , giải_mã và sinh khóa .\n4 . 1 Mã_hóa Giả_sử rằng Bob muốn gửi mẫu tin M cho Alice .\nĐầu_tiên thông_điệp M thành từng phần nhỏ , mỗi phần biểu_diễn bởi một_số nguyên m sao_cho 0 \\leq m lt; n .\nViệc chuyển_đổi này cần đảm_bảo là ngẫu_nhiên và m không nhận các giá_trị không an_toàn (ví dụ như số 0 hay 1) nhưng vẫn đảm_bảo là có_thể suy ra M từ m .\nTiếp_theo , Bob tính ra bản mã_hóa c , sử_dụng khóa công_khai e của Alice như_sau : c \\equiv me \\pmod n Bob gửi c cho Alice .\nLưu_ý rằng sao khi mã_hóa , chính Bob cũng không_thể giải_mã được từ c thành m .\n4 . 2 . Giải_mã Alice tính lại ra m từ c dựa vào khóa bí_mật d : cd \\equiv (me)d \\equiv m \\pmod n Dựa vào m , Alice có_thể khôi_phục lại mẫu tin ban_đầu M .\n4 . 3 . Sinh khóa (Key generation) Chọn 2 số_nguyên_tố khác_nhau p và q .\nTính n = p q .\nĐộ_dài của n (tính theo bit) chính là độ_dài của khóa .\nHiện_nay người_ta khuyến_cáo sử_dụng khóa có độ_dài tối thiếu 2048 bit .\nTính \\varphi(n) = \\varphi(p)\\varphi(q) = (p - 1)(q - 1) = n - (p + q - 1) .\nTrong đó \\varphi(n) là phi_hàm Euler .\n\\varphi(n) = số_lượng số_nguyên_dương nhỏ hơn n mà nguyên_tố cùng_nhau với n .\nChọn một_số nguyên e thỏa_mãn 1 lt; e lt; \\varphi(n) và gcd(e , \\varphi(n)) = 1 .\nTính ra d \\equiv e-1 \\pmod\\varphi(n) .\nChứng_minh Để chứng_minh tính đúng_đắn của thuật_toán sinh khóa trên , ta cần chứng_minh rằng med \\equiv m \\pmod n với n = pq .\n1 .\nTrường_hợp gcd(n , m) = 1 Ta có ed \\equiv 1 \\pmod\\varphi(n) Do e và d nguyên dương nên ed = 1 + h\\varphi(n) với h là một_số nguyên không âm .\nDo_đó med = m1 + h\\varphin = m(m\\varphi(n))h .\nTheo định_lý Euler , a\\varphi(n) \\equiv 1 \\pmod n \\quad \\forall a , n : gcd(a , n) = 1 nên m(m\\varphi(n))h \\equiv m(1)h \\equiv m \\pmod n .\n2 .\nTrường_hợp gcd(n , m) \\neq 1 Theo định_lý phần dư Trung_Hoa (Chinese Remainder_Theorem) , nếu p , q nguyên_tố cùng_nhau thì : x \\equiv y \\pmod p \\quad và \\quad x \\equiv y \\pmod q \\Rightarrow x \\equiv y \\pmod pq .\nDo_vậy ta cần chứng mình 2 mệnh_đề sau : med \\equiv m \\pmod p med \\equiv m \\pmod q Vì gcd(m , n) \\neq 1 \\Rightarrow gcd(m , n) = p \\quad hoặc \\quad gcd(m , n) = q .\nKhông mất tính tổng_quát , giả_sử gcd(m , n) = p .\nTa có : gcd(m , p) = p \\ \\Rightarrow m \\equiv 0 \\pmod p \\ \\Rightarrow med \\equiv 0 \\equiv m \\pmod p gcd(m , q) = 1 \\ \\Rightarrow med \\equiv m \\pmod q (chứng mình tương_tự trong trường_hợp 1) 4 . 4 . Sample code ! /usr/bin/env python -- coding : utf-8 -- import random def is_prime ( n ) : return all (( n % j ) for j in range ( 2 , int ( n 0 . 5 ) + 1 )) and n gt; 1 Sinh_ra số_nguyên_tố ngẫu_nhiên trong left , right) mà khác exclude def random_prime ( left , right , exclude = - 1 ) : p = random .\nrandint ( left , right - 1 ); if is_prime ( p ) and p ! = exclude : return p else : return random_prime ( left , right - 1 , exclude ) Thuật_toán tìm nghịch_đảo modulo MMI(A , n) = x thỏa_mãn (Ax) mod n = 1 MMI = lambda A , n , s = 1 , t = 0 , N = 0 : ( n lt; 2 and t % N or MMI ( n , A % n , t , s - A / n t , N or n ) , - 1 ) n lt; 1 Thuật_toán sinh khóa def rsa_generate () : p = random_prime ( 1 , 255 ) q = random_prime ( 1 , 255 , p ) n = p q t = ( p - 1 ) ( q - 1 ) e = random_prime ( 1 , t ) d = MMI ( e , t ) Kết_quả trả về bao_gồm : - Khóa công_khai (n , e) - Khóa bí_mật (n , d) return n , e , d def rsa_encrypt ( message , n , e ) : return pow ( message , e , n ) def rsa_decrypt ( encrypt_message , n , d ) : return pow ( encrypt_message , d , n ) Example n , e , d = rsa_generate () print n=0 , e=1 , d=2 .\nformat ( n , e , d ) message = random .\nrandint ( 1 , n - 1 ) print Original message : 0 .\nformat ( message ) encrypted_message = rsa_encrypt ( message , n , e ) print Encrypted_message : 0 .\nformat ( encrypted_message ) decrypted_message = rsa_decrypt ( encrypted_message , n , d ) print Decrypted_message : 0 .\nformat ( decrypted_message ) 5 .\nTham_khảo Wiki - Public-key_Cryptography_Wiki - RSA_Wiki - History of Cryptography\n", "tagged": "Tác_giả/N :/CH Hoàng_Gia_Minh/Np Bài/N viết/V này/P nhằm/V giúp/V bạn_đọc/N nắm/V được/V ý_tưởng/N cơ_bản/A của/E các/L hệ/N mã_hóa/Np khóa/N công_khai/A (/CH Public_Key_Cryptography/Np )/CH và/Cc một_số/L ứng_dụng/V của/E chúng/P ./CH\nNgoài_ra/X ,/CH chúng_ta/P cũng/R sẽ/R tìm_hiểu/V về/E thuật_toán/N mã_hóa/Np RSA/Np ,/CH một/M hệ/N mã_hóa/Np khóa/N công_khai/A được/V sử_dụng/V khá/R phổ_biến/V hiện_nay/N ./CH\nTable/Np of_Contents/Np 1/M ./CH\nMột_số/L khái_niệm/N 2/M ./CH\nLịch_sử/N 2/M ./CH 1/M ./CH Mã_hóa/Np khóa/N đối_xứng/Np (Symmetric-key/Np cryptography)/Np 2/M ./CH 2/M ./CH Mã_hóa/Np khóa/N công_khai/A (Public-key/Np cryptography)/Np 3/M ./CH\nỨng_dụng/V 3/M ./CH 1/M ./CH Mã_hóa/Np công_khai/A (Public-key/Np encryption)/Np :/CH 3/M ./CH 2/M ./CH Chữ_ký/N điện_tử/N (Digital/Np signatures)/Np :/CH 4/M ./CH\nRSA/Np 4/M ./CH 1/M Mã_hóa/Np 4/M ./CH 2/M ./CH Giải_mã/Np 4/M ./CH 3/M ./CH Sinh/V khóa/N (Key/Np generation)/Np 4/M ./CH 4/M ./CH Sample/Np code/Np 5/M ./CH\nTham_khảo/V 1/M ./CH\nMột_số/L khái_niệm/N Mã_hóa/Np (Encryption)/Np :/CH Quá_trình/N chuyển_đổi/V thông_tin/N từ/E dạng/N thông_thường/A (có/Np thể/N đọc/V được)/Np sang/V dạng/N không/R đọc/V được/V (nếu/Np không/R có/V khóa/N bí/A mật)/Np ,/CH nhằm/V bảo_mật/V thông_tin/N ./CH\nGiải_mã/Np (Decryption)/Np :/CH Là/V quá_trình/N ngược/A của/E mã_hóa/Np -/CH chuyển_đổi/V từ_thông_tin/Np đã/R mã_hóa/Np về/E thông_tin/N ban_đầu/N ./CH\nKhóa/N (Key)/Np :/CH Một/M đoạn/Nc thông_tin/N được/V sử_dụng/V để/E mã_hóa/Np và/Cc giải_mã/Np ./CH\n2/M ./CH\nLịch_sử/N 2/M ./CH 1/M ./CH Mã_hóa/Np khóa/N đối_xứng/Np (/CH Symmetric-key/Np cryptography/Np )/CH Cho_đến/E trước/E năm/N 1976/M ,/CH các/L phương_pháp/N mã_hóa/Np đều/R là/V mã_hóa/Np đối_xứng/Np ./CH\nCác/L hệ/N mã_hóa/Np đối_xứng/Np sử_dụng/V cùng/A một/M khóa/N cho/E cả/P bên/N gửi/V lẫn/C bên/N nhận/V ./CH\nNói/V một_cách/N chính_xác/A hơn/A ,/CH hai/M khóa/N này/P có_thể/R :/CH giống/N nhau/N ,/CH hoặc/Cc khác_nhau/Np nhưng/C có_thể/R dễ_dàng/A tìm_ra/Np được/V khóa/N còn_lại/Np nếu/C đã/R biết/V một/M khóa/N ./CH\nƯu_điểm/N của/E các/L phương_pháp/N này/P là/V đơn_giản/A ,/CH tốc_độ/N cao/A ,/CH mang_lại/Np hiệu_quả/N tốt/A nếu/C bạn/N không/R chia_sẻ/V khóa/N của/E mình/P cho/E người/N khác/A ./CH\nTuy_nhiên/C ,/CH chúng/P lại/R có/V các/L nhược_điểm/N sau/E :/CH Để/E có_thể/R trao_đổi/V thông_tin/N bí_mật/N với_nhau/Np ,/CH hai/M bên/N phải/V thống_nhất/V với_nhau/Np trước/E về/E khóa/N bí_mật/N ./CH\nBài_toán/N đặt/V ra/V là/V làm_sao/X có_thể/R đảm_bảo/V việc/N gửi/V khóa/N cho/E nhau/N là/V bí_mật/N ./CH\nĐể/E đảm_bảo/V trong/E 1/M nhóm/N n/Ny người/N cần/V phải/V có/V 1/M số_lượng/N khóa/N khá/R lớn/A -/CH \\fracn(n-1)2/Np khóa/N ./CH\nĐiều/N này/P dẫn/V đến/E một/M bài_toán/N về/E việc/N lưu_trữ/Np ,/CH phân_phối/V một_số/L lượng/N lớn/A khóa/N mà/C vẫn/R phải/V đảm_bảo/V sự/N an_toàn/A của/E chúng/P ./CH\nDo/E bên/N gửi/V và/Cc nhận/V sử_dụng/V chung/A khóa/N ,/CH chúng_ta/P không_thể/R xác_định/V được/V nguồn_gốc/N của/E một/M thông_điệp/N (message)/Np ./CH\n2/M ./CH 2/M ./CH Mã_hóa/Np khóa/N công_khai/A (/CH Public-key/Np cryptography/Np )/CH Vào/E năm/N 1874/Np ,/CH William_Stanley_Jevons/Np viết/V trong/E quyển/Nc The_Principles/Np of/E Science/Np về/E mối/N liên_hệ/V giữa/N các/L hàm/Np một_chiều/Np và/Cc mật_mã/Np học/V ./CH\nĐặc_biệt/A ,/CH ông/N đã/R đi_sâu/V vào/E bài_toán/N phân_tích/V ra/V thừa_số/Np nguyên_tố/N (sau/Np này/P được/V sử_dụng/V trong/E thuật_toán/N RSA)/Np ./CH\nLiệu/V rằng/C bạn_đọc/N có_thể/R đoán/V được/V 2/M số_nguyên/Np nào/P có/V tích/N bằng/E 8/M ,/CH 616/Np ,/CH 460/M ,/CH 799/Np ?/CH\nTôi/P nghĩ/V rằng/C ngoài/E tôi/P ra/V thì/C không_ai/Np có_thể/R biết/V kết_quả/N được/V ./CH\nNăm/N 1976/M ,/CH Whitfield_Diffie/Np và/Cc Martin_Hellman/Np công_bố/V bài/N báo/N New_Directions/Np in/V Cryptography/Np ,/CH làm/V thay_đổi/V căn_bản/A về/E cách/N các/L hệ/N mật_mã/Np hoạt_động/N ./CH\nBài/N báo/N đã/R đưa_ra/Np một/M hệ_thống/N mã_hóa/Np bất_đối_xứng/Np trong/E đó/P nêu/V ra/V phương_pháp/N trao_đổi/V khóa/N công_khai/A ,/CH giải_quyết/V các/L hạn_chế/V của/E mã/N đối_xứng/Np ./CH\nKhác/A với/E mã/N đối_xứng/Np ,/CH mã_hóa/Np khóa/N bất_đối_xứng/Np sử_dụng/V một/M cặp/N khóa/N :/CH khóa/N công_khai/A (/CH public/Np key/Np )/CH và/Cc khóa/N bí_mật/N (/CH private/Np key/Np )/CH ./CH\nHai/M khóa/N này/P được/V xây_dựng/V sao_cho/Np từ/E một/M khóa/N ,/CH rất/R khó/A có/V cách/N sinh_ra/V được/V khóa/N còn_lại/Np ./CH\nMột/M khóa/N sẽ/R dành/V để/E mã_hóa/Np ,/CH khóa/N còn_lại/Np dùng/V để/E giải_mã/Np ./CH\nChỉ_có/Np người/N sở_hữu/V nắm/V được/V khóa/N bí_mật/N trong_khi/Np khóa/N công_khai/A được/V phổ_biến/V rộng_rãi/A ./CH\nHình_vẽ/Np sau/E minh_họa/V việc/N mã_hóa/Np và/Cc giải_mã/Np :/CH 3/M ./CH\nỨng_dụng/V Mật_mã_hóa/Np khóa/N công_khai/A hay/Cc còn/R gọi_là/V mã_hóa/Np bất_đối_xứng/Np có/V 2/M ứng_dụng/V phổ_biến/V sau/E :/CH 3/M ./CH 1/M ./CH Mã_hóa/Np công_khai/A (/CH Public-key/Np encryption/Np )/CH :/CH Một/M thông_điệp/N được/V mã_hóa/Np bằng/E khóa/N công_khai/A của/E người/N nhận/V ./CH\nThông_điệp/N này/P chỉ_có/Np thể/N giải_mã/Np được/V bằng/E khóa/N bí_mật/N mà/C chỉ/R người/N nhận/V có/V ./CH\n3/M ./CH 2/M ./CH Chữ_ký/N điện_tử/N (/CH Digital/Np signatures/Np )/CH :/CH Chữ_ký/N điện_tử/N là/V thông_tin/N đi_kèm/Np với/E dữ_liệu/N nhằm/V mục_đích/N xác_định/V chủ_sở_hữu/N của/E dữ_liệu/N đó/P ./CH\nMột/M văn_bản/N được/V \"ký\"/Np bằng/E khóa/N bí_mật/N của/E người_gửi/Np và/Cc có_thể/R được/V xác_nhận/V bới/V bất_kỳ/A ai/P có/V khóa/N công_khai/A của/E người_gửi/Np ./CH\nCụ_thể/A hơn/A ,/CH bên/N gửi/V sẽ/R tính/V ra/V mã_hash/Np h/Ny của/E văn_bản/N ,/CH sau_đó/Np dùng/V khóa/N bí_mật/N để/E mã_hóa/Np h/Ny thành/V \\sigma/Np rồi/C gửi/V cho/E bên/N nhận/V văn_bản/N đó/P cùng_với/C \"chữ/Np ký\"/Np \\sigma/Np ./CH\nBên/N nhận_thực/Np hiện/N xác_nhận/V như_sau/Np :/CH Tính/V mã_hash/Np h/Ny của/E văn_bản/N ./CH\nGiải_mã/Np \"chữ/Np ký\"/Np \\sigma/Np thành/V h/Ny bằng/E khóa/N công_khai/A ./CH\nSo_sánh/V h/Ny và/Cc h/Ny ,/CH nếu/C chúng/P bằng_nhau/Np thì/C quá_trình/N xác_thực/Np thành_công/V ,/CH ngược_lại/X quá_trình/N xác_thực/Np thất_bại/V ./CH\n4/M ./CH\nRSA_RSA/Np là/V một/M trong/E những/L phương_pháp/N mã_hóa/Np khóa/N công_khai/A đầu_tiên/A được/V ứng_dụng/V rộng_rãi/A trong/E việc/N đảm_bảo/V an_toàn/A khi/N truyền_thông_tin/Np ./CH\nSự/N bất_đối_xứng/Np của/E hệ/N mã/N này/P được/V dựa/V trên/E quan_sát/V là/V khó/A có_thể/R phân_tích/V ra/V thừa_số/Np nguyên_tố/N của/E một_số/L là/V tích/N của/E 2/M số_nguyên_tố/Np ./CH\nRSA/Np được/V tạo_thành/Np bằng/E chữ_cái/Np đầu_tiên/A của/E Ron_R/Np ivest/Np ,/CH Adi_S/Np hamir/Np ,/CH Lenonard_A/Np dleman/Np ,/CH 3/M người/N đầu_tiên/A mô_tả/V thuật_toán/N vào/E năm/N 1977/M ./CH\nNguyên_lý/Np cơ_bản/A của/E RSA/Np dựa/V trên/E nhận_định/N là/V có_thể/R tìm/V được/V 3/M số_nguyên_dương/Np rất/R lớn/A e/Ni ,/CH d/Ny và/Cc n/Ny mà/C :/CH (me)d/Np \\equiv/Np m/Nu \\pmod/Np n/Ny \\quad/Np \\forall/Np m/Nu và/Cc dù_cho/C có/V biết/V cả/P e/Ni ,/CH n/Ny hay/Cc cả/P m/Nu thì/C cũng/R rất/R khó/A để/E tìm_ra/Np d/Ny ./CH\nTiếp_theo/V chúng_ta/P sẽ/R đi_sâu/V vào/E từng/R công_đoạn/N của/E 1/M hệ/N mã/N ,/CH bao_gồm/V việc/N mã_hóa/Np ,/CH giải_mã/Np và/Cc sinh/V khóa/N ./CH\n4/M ./CH 1/M Mã_hóa/Np Giả_sử/Np rằng/C Bob/Np muốn/V gửi/V mẫu/N tin/N M/Nu cho/E Alice/Np ./CH\nĐầu_tiên/A thông_điệp/N M/Nu thành/V từng/R phần/N nhỏ/A ,/CH mỗi/L phần/N biểu_diễn/V bởi/E một_số/L nguyên/A m/Nu sao_cho/Np 0/M \\leq/Np m/Nu lt;/Np n/Ny ./CH\nViệc/N chuyển_đổi/V này/P cần/V đảm_bảo/V là/V ngẫu_nhiên/A và/Cc m/Nu không/R nhận/V các/L giá_trị/N không/R an_toàn/A (ví/Np dụ/V như/C số/N 0/M hay/Cc 1)/Np nhưng/C vẫn/R đảm_bảo/V là/V có_thể/R suy/V ra/V M/Nu từ/E m/Nu ./CH\nTiếp_theo/V ,/CH Bob/Np tính/V ra/V bản/Nc mã_hóa/Np c/Ni ,/CH sử_dụng/V khóa/N công_khai/A e/Ni của/E Alice/Np như_sau/Np :/CH c/Ni \\equiv/Np me/Np \\pmod/Np n/Ny Bob/Np gửi/V c/Ni cho/E Alice/Np ./CH\nLưu_ý/V rằng/C sao/P khi/N mã_hóa/Np ,/CH chính/T Bob/Np cũng/R không_thể/R giải_mã/Np được/V từ/E c/Ni thành/V m/Nu ./CH\n4/M ./CH 2/M ./CH Giải_mã/Np Alice/Np tính/V lại/R ra/V m/Nu từ/E c/Ni dựa/V vào/E khóa/N bí_mật/N d/Ny :/CH cd/Np \\equiv/Np (me)d/Np \\equiv/Np m/Nu \\pmod/Np n/Ny Dựa/V vào/E m/Nu ,/CH Alice/Np có_thể/R khôi_phục/V lại/R mẫu/N tin/N ban_đầu/N M/Nu ./CH\n4/M ./CH 3/M ./CH Sinh/V khóa/N (Key/Np generation)/Np Chọn/V 2/M số_nguyên_tố/Np khác_nhau/Np p/Ny và/Cc q/Ny ./CH\nTính/V n/Ny =/CH p/Ny q/Ny ./CH\nĐộ_dài/Np của/E n/Ny (tính/Np theo/V bit)/Np chính/T là/V độ_dài/Np của/E khóa/N ./CH\nHiện_nay/N người_ta/P khuyến_cáo/V sử_dụng/V khóa/N có/V độ_dài/Np tối/N thiếu/A 2048/Np bit/Np ./CH\nTính/V \\varphi(n)/Np =/CH \\varphi(p)\\varphi(q)/Np =/CH (p/Np -/CH 1)(q/Np -/CH 1)/Np =/CH n/Ny -/CH (p/Np +/CH q/Ny -/CH 1)/Np ./CH\nTrong/E đó/P \\varphi(n)/Np là/V phi_hàm/Np Euler/Np ./CH\n\\varphi(n)/Np =/CH số_lượng/N số_nguyên_dương/Np nhỏ/A hơn/A n/Ny mà/C nguyên_tố/N cùng_nhau/Np với/E n/Ny ./CH\nChọn/V một_số/L nguyên/A e/Ni thỏa_mãn/V 1/M lt;/Np e/Ni lt;/Np \\varphi(n)/Np và/Cc gcd(e/Np ,/CH \\varphi(n))/Np =/CH 1/M ./CH\nTính/V ra/V d/Ny \\equiv/Np e-1/Np \\pmod\\varphi(n)/Np ./CH\nChứng_minh/V Để/E chứng_minh/V tính/V đúng_đắn/A của/E thuật_toán/N sinh/V khóa/N trên/E ,/CH ta/P cần/V chứng_minh/V rằng/C med/Np \\equiv/Np m/Nu \\pmod/Np n/Ny với/E n/Ny =/CH pq/Np ./CH\n1/M ./CH\nTrường_hợp/N gcd(n/Np ,/CH m)/Np =/CH 1/M Ta/P có/V ed/Np \\equiv/Np 1/M \\pmod\\varphi(n)/Np Do/E e/Ni và/Cc d/Ny nguyên/A dương/A nên/C ed/Np =/CH 1/M +/CH h\\varphi(n)/Np với/E h/Ny là/V một_số/L nguyên/A không/R âm/A ./CH\nDo_đó/C med/Np =/CH m1/Np +/CH h\\varphin/Np =/CH m(m\\varphi(n))h/Np ./CH\nTheo/V định_lý/Np Euler/Np ,/CH a\\varphi(n)/Np \\equiv/Np 1/M \\pmod/Np n/Ny \\quad/Np \\forall/Np a/Ni ,/CH n/Ny :/CH gcd(a/Np ,/CH n)/Np =/CH 1/M nên/C m(m\\varphi(n))h/Np \\equiv/Np m(1)h/Np \\equiv/Np m/Nu \\pmod/Np n/Ny ./CH\n2/M ./CH\nTrường_hợp/N gcd(n/Np ,/CH m)/Np \\neq/Np 1/M Theo/V định_lý/Np phần/N dư/A Trung_Hoa/Np (Chinese/Np Remainder_Theorem)/Np ,/CH nếu/C p/Ny ,/CH q/Ny nguyên_tố/N cùng_nhau/Np thì/C :/CH x/CH \\equiv/Np y/N \\pmod/Np p/Ny \\quad/Np và/Cc \\quad/Np x/CH \\equiv/Np y/N \\pmod/Np q/Ny \\Rightarrow/Np x/CH \\equiv/Np y/N \\pmod/Np pq/Np ./CH\nDo_vậy/C ta/P cần/V chứng/N mình/P 2/M mệnh_đề/N sau/E :/CH med/Np \\equiv/Np m/Nu \\pmod/Np p/Ny med/Np \\equiv/Np m/Nu \\pmod/Np q/Ny Vì/E gcd(m/Np ,/CH n)/Np \\neq/Np 1/M \\Rightarrow/Np gcd(m/Np ,/CH n)/Np =/CH p/Ny \\quad/Np hoặc/Cc \\quad/Np gcd(m/Np ,/CH n)/Np =/CH q/Ny ./CH\nKhông/R mất/V tính/V tổng_quát/Np ,/CH giả_sử/Np gcd(m/Np ,/CH n)/Np =/CH p/Ny ./CH\nTa/P có/V :/CH gcd(m/Np ,/CH p)/Np =/CH p/Ny \\/Np \\Rightarrow/Np m/Nu \\equiv/Np 0/M \\pmod/Np p/Ny \\/Np \\Rightarrow/Np med/Np \\equiv/Np 0/M \\equiv/Np m/Nu \\pmod/Np p/Ny gcd(m/Np ,/CH q)/Np =/CH 1/M \\/Np \\Rightarrow/Np med/Np \\equiv/Np m/Nu \\pmod/Np q/Ny (chứng/Np mình/P tương_tự/A trong/E trường_hợp/N 1)/Np 4/M ./CH 4/M ./CH Sample/Np code/Np !/CH /usr/bin/Np python/Np --/Np coding/Np :/CH utf-8/Np --/Np import/Np random/Np def/Np is_prime/Np (/CH n/Ny )/CH :/CH return/Np all/Np ((/Np n/Ny %/CH j/Np )/CH for/Np j/Np in/V range/Np (/CH 2/M ,/CH int/Np (/CH n/Ny 0/M ./CH 5/M )/CH +/CH 1/M ))/Np and/Np n/Ny gt;/Np 1/M Sinh_ra/V số_nguyên_tố/Np ngẫu_nhiên/A trong/E left/Np ,/CH right)/Np mà/C khác/A exclude/Np def/Np random_prime/Np (/CH left/Np ,/CH right/Np ,/CH exclude/Np =/CH -/CH 1/M )/CH :/CH p/Ny =/CH random/Np ./CH\nrandint/Np (/CH left/Np ,/CH right/Np -/CH 1/M );/CH if/Np is_prime/Np (/CH p/Ny )/CH and/Np p/Ny !/CH =/CH exclude/Np :/CH return/Np p/Ny else/Np :/CH return/Np random_prime/Np (/CH left/Np ,/CH right/Np -/CH 1/M ,/CH exclude/Np )/CH Thuật_toán/N tìm/V nghịch_đảo/Np modulo/Np MMI(A/Np ,/CH n)/Np =/CH x/CH thỏa_mãn/V (Ax)/Np mod/Np n/Ny =/CH 1/M MMI/Np =/CH lambda/Np A/Ni ,/CH n/Ny ,/CH s/Y =/CH 1/M ,/CH t/Nu =/CH 0/M ,/CH N/Ny =/CH 0/M :/CH (/CH n/Ny lt;/Np 2/M and/Np t/Nu %/CH N/Ny or/Np MMI/Np (/CH n/Ny ,/CH A/Ni %/CH n/Ny ,/CH t/Nu ,/CH s/Y -/CH A/Ni //CH n/Ny t/Nu ,/CH N/Ny or/Np n/Ny )/CH ,/CH -/CH 1/M )/CH n/Ny lt;/Np 1/M Thuật_toán/N sinh/V khóa/N def/Np rsa_generate/Np ()/Np :/CH p/Ny =/CH random_prime/Np (/CH 1/M ,/CH 255/Np )/CH q/Ny =/CH random_prime/Np (/CH 1/M ,/CH 255/Np ,/CH p/Ny )/CH n/Ny =/CH p/Ny q/Ny t/Nu =/CH (/CH p/Ny -/CH 1/M )/CH (/CH q/Ny -/CH 1/M )/CH e/Ni =/CH random_prime/Np (/CH 1/M ,/CH t/Nu )/CH d/Ny =/CH MMI/Np (/CH e/Ni ,/CH t/Nu )/CH Kết_quả/N trả/V về/E bao_gồm/V :/CH -/CH Khóa/N công_khai/A (n/Np ,/CH e)/Np -/CH Khóa/N bí_mật/N (n/Np ,/CH d)/Np return/Np n/Ny ,/CH e/Ni ,/CH d/Ny def/Np rsa_encrypt/Np (/CH message/Np ,/CH n/Ny ,/CH e/Ni )/CH :/CH return/Np pow/Np (/CH message/Np ,/CH e/Ni ,/CH n/Ny )/CH def/Np rsa_decrypt/Np (/CH encrypt_message/Np ,/CH n/Ny ,/CH d/Ny )/CH :/CH return/Np pow/Np (/CH encrypt_message/Np ,/CH d/Ny ,/CH n/Ny )/CH Example/Np n/Ny ,/CH e/Ni ,/CH d/Ny =/CH rsa_generate/Np ()/Np print/Np n=0/Np ,/CH e=1/Np ,/CH d=2/Np ./CH\nformat/Np (/CH n/Ny ,/CH e/Ni ,/CH d/Ny )/CH message/Np =/CH random/Np ./CH\nrandint/Np (/CH 1/M ,/CH n/Ny -/CH 1/M )/CH print/Np Original/Np message/Np :/CH 0/M ./CH\nformat/Np (/CH message/Np )/CH encrypted_message/Np =/CH rsa_encrypt/Np (/CH message/Np ,/CH n/Ny ,/CH e/Ni )/CH print/Np Encrypted_message/Np :/CH 0/M ./CH\nformat/Np (/CH encrypted_message/Np )/CH decrypted_message/Np =/CH rsa_decrypt/Np (/CH encrypted_message/Np ,/CH n/Ny ,/CH d/Ny )/CH print/Np Decrypted_message/Np :/CH 0/M ./CH\nformat/Np (/CH decrypted_message/Np )/CH 5/M ./CH\nTham_khảo/V Wiki/Np -/CH Public-key_Cryptography_Wiki/Np -/CH RSA_Wiki/Np -/CH History/Np of/E Cryptography/Np\n", "title": "Public Key Cryptography\n", "link": "http://vnoi.info/wiki/cs/crypto/Public-Key-Cryptography\n"}