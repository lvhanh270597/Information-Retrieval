{"content": "Nguồn : P3G_Người dịch : Phan_Minh Hoàng_Table of_Contents Lịch_sử Bài_toán cơ_bản Thuật_toán duyệt Kĩ_thuật Ý_nghĩa của tên kĩ_thuật Thêm một đường vào tập Phân_tích thuật_toán Ví_dụ 1 : USACO_Tháng 3 năm 2008 \"Acquire\" Bài_toán Nhận_xét 1 : Tồn_tại các hình_chữ_nhật không quan_trọng Nhận_xét 2 : Đoạn liên_tiếp Lời_giải Quy_Hoạch_Động Nhận_xét 3 : Sử_dụng bao lồi Ví_dụ 2 : APIO 2010 Commando Bài_toán Biến_thể động (Fully Dynamic_Variant)_Code Bài_tập : Kĩ_thuật bao lồi là kĩ_thuật (hoặc là cấu_trúc dữ liệu) dùng để xác_định hiệu_quả , có tiền xử_lý , cực_trị của một_tập các hàm tuyến_tính tại một giá_trị của biến độc_lập .\nMặc_dù tên_gọi giống nhưng kĩ_thuật này lại khá khác_biệt so_với thuật_toán bao lồi của hình_học tính_toán .\nNgoài_ra có_một kĩ_thuật liên_quan đến kĩ_thuật bao lồi là IT đoạn_thẳng Lịch_sử Kĩ_thuật bao lồi được biết đến nhiều nhất có_lẽ vì nó cần để ăn trọn toàn_bộ số điểm trong nhiều bài_toán USACO , như_là bài Acquire trong bảng gold của USACO tháng 3 năm 2008 .\nThuật_toán được đưa_vào các cuộc_thi lập_trình một_cách rộng_rãi sau bài Batch_Scheduling trong kì_thi IOI 2002 .\nĐây là một kĩ_thuật khá lạ và ít_có nguồn trên mạng về vấn_đề này .\nBài_toán cơ_bản Cho một_tập lớn các hàm tuyến_tính có dạng y = m_i x + b_i và một_số lượng lớn truy_vấn .\nMỗi truy_vấn là một_số x và hỏi giá_trị cực_tiểu y có_thể đạt được nếu chúng_ta thế x vào một trong những phương_trình đã cho .\nVí_dụ , cho các phương_trình y=4 , y=\\frac43+\\frac23x , y=12-3x và y=3-\\frac12x và truy_vấn x=1 .\nChúng_ta phải tìm phương_trình mà trả về giá_trị cực_tiểu hoặc giá_trị cực_tiểu đó (trong trường_hợp này là phương_trình y=\\frac43+\\frac23x và giá_trị cực_tiểu đó là 2) .\nBiến_thể của bài_toán có_thể là tìm giá_trị cực_đại có_thể giải_quyết với một thay_đổi nhỏ vì_vậy trong bài viết này chỉ tập_trung vào bài_toán tìm giá_trị cực_tiểu .\nSau khi ta vẽ các đường_thẳng lên hệ trục tọa_độ , dễ thấy rằng : chúng_ta muốn xác_định , tại x=1(đường màu đỏ) đường nào có tọa_độ y nhỏ nhất .\nỞ trong trường_hợp này là đường_nét đứt đậm y=\\frac43+\\frac23x .\nThuật_toán duyệt Với mỗi truy_vấn trong Q truy_vấn , ta duyệt qua từng hàm_số và thử từng từng hàm và xem thử hàm nào trả_giá_trị cực_tiểu cho giá_trị x .\nNếu có M đường_thẳng và Q truy_vấn , độ phức_tạp của thuật_toán sẽ \\mathcalO(MQ) .\nKĩ_thuật bao lồi sẽ giúp giảm độ phức_tạp xuống còn \\mathcalO((Q+M)\\log M , một_độ phức_tạp hiệu quá hơn nhiều .\nKĩ_thuật Xét hình_vẽ ở trên .\nĐường_thẳng y=4 sẽ không bao_giờ là giá_trị nhỏ nhất với tất_cả giá_trị của x .\nMỗi đường_trong mỗi đường_thẳng còn_lại sẽ lại trả_lại giá_trị cực_tiểu trong một_và chỉ một đoạn liên_tiếp (có thể có_một biên là +\\infty hoặc -\\infty) .\nĐường chấm đậm sẽ cho giá_trị cực_tiểu với tất_cả giá_trị nằm bên trái điểm giao với đường đen đậm .\nĐường đen đậm sẽ cho giá_trị cực_tiểu với tất_cả giá_trị giữa giao_điểm của nó với đường nhạt và đường chấm đậm .\nVà đường nhạt sẽ nhận cực_tiểu cho tất_cả giá_trị bên phải giao_điểm với đường đậm .\nMột nhận_xét nữa_là với giá_trị của x càng tăng thì hệ_số góc của các hàm_số sẽ giảm , \\frac23 , \\frac-12 , -3 .\nVới một_chút chứng_minh dễ thấy rằng điều này luôn đúng .\nĐiều này giúp chúng_ta hiểu phần_nào thuật_toán : Bỏ_đi các đường_thẳng không quan_trọng như y=4 trong ví_dụ (những đường_thẳng mà không nhận giá_trị cực_tiểu trong bất_kì đoạn nào) Sắp_xếp các đoạn_thẳng còn_lại theo hệ_số góc và được một_tập N đoạn_thẳng (của N đường_thẳng còn lại) mà mỗi đoạn có_một đường_thẳng nhận giá_trị cực_tiểu .\nDùng thuật_toán tìm_kiếm nhị_phân cơ_bản để có_thể tìm_kiếm đáp_án cho từng truy_vấn .\nÝ_nghĩa của tên kĩ_thuật Cụm_từ bao lồi được sử_dụng để chỉ hình_bao trên/dưới (upper / lower envelope) .\nTrong ví_dụ , nếu chúng_ta coi mỗi phần đoạn_thẳng tối_ưu của đường_thẳng (bỏ qua_đường y=4) , chúng_ta sẽ thấy những đoạn đó tạo_thành một hình_bao dưới (lower envelope) , một_tập các đoạn_thẳng chứa tất_cả điểm cực_tiểu cho mọi giá_trị của x (hình bao dưới được tô bằng màu xanh_trong hình .\nCái tên kĩ_thuật bao lồi xuất_phát từ việc đường_bao trên tạo_thành một đường lồi , từ_đó thành bao lồi của một_tập điểm .\nThêm một đường vào tập Ta có_thể thấy nếu ta có_một tập đường_thẳng đã được xác_định sắp_xếp , ta có_thể dễ_dàng trả_lời bất_kì truy_vấn nào với độ phức_tạp là \\mathcalO(\\log M) với tìm_kiếm nhị_phân .\nVậy nếu chúng_ta tìm_ra cách thêm một đường_thẳng vào tính_toán lại một_cách hiệu_quả là chúng_ta đã có_một thuật_toán hoạt_động ngon_lành .\nGiả_sử chúng_ta được xử_lý tất_cả đường_thẳng trước_khi làm các truy_vấn thì chúng_ta chỉ_cần đơn_giản sắp_xếp các đường_thẳng theo hệ_số góc và thêm từng đường một vào .\nSẽ có_thể một_số đường không quan_trọng và sẽ bị bỏ_đi .\nChúng_ta sẽ sử_dụng cấu_trúc dữ_liệu Stack để cài_đặt , bỏ từng đường_thẳng vào stack và nếu đường nào không quan_trọng sẽ bị bỏ ra ngoài đến khi chỉ còn một đường_thẳng (đường thẳng cuối không_thể bỏ) Vậy làm_sao để có_thể xác_định đường_thẳng nào sẽ bị bỏ khỏi stack ?\nGiả_sử l_1 , l_2 và l_3 là đường_thẳng áp_chót (gần cuối ) trên stack , đường_thẳng cuối_cùng trong stack và đường_thẳng được thêm vào stack .\nĐoạn l_2 không quan trọng(không có_giá trị cực_tiểu ở điểm nào) khi và chỉ khi giao_điểm của l_1 và l_3 nằm bên trái giao_điểm của l_1 và l_2 (Đoạn mà l_3 nhận giá_trị cực_tiểu đã nằm đè lên đoạn của l_2) .\nGiả_sử rằng không có ba đường nào trùng hay song_song với_nhau (có thể giải_quyết một_cách đơn giản) .\nPhân_tích thuật_toán Độ phức_tạp bộ_nhớ sẽ là \\mathcalO(M) : chúng_ta cần một danh_sách lưu lại các đoạn_thẳng , biểu_diễn bởi hai số_thực .\nĐộ phức_tạp thời_gian cho phần tiền xây_dựng : Để sắp_xếp các đoạn_thẳng theo tăng dần hệ_số góc sẽ tốn \\mathcalO(M\\logM) .\nDuyệt qua các đường_thẳng mỗi đường_được cho vào stack và bỏ khỏi stack tối_đa một_lần vậy_nên sẽ tốn \\mathcalO(M) cho bước này .\nVậy thời_gian cho việc xây_dựng sẽ là \\mathcalO(M\\logM) .\nVới mỗi truy_vấn dùng chặt nhị_phân sẽ cho độ phúc tạp tốt nhất \\mathcalO(\\log M) .\nVí_dụ 1 : USACO_Tháng 3 năm 2008 \"Acquire\" Bài_toán Cho_N(N \\le 50000) hình_chữ_nhật khác_nhau về hình_dạng , mục_tiêu của bài_toán là phải lấy_được tất_cả hình_chữ_nhật .\nMột_tập hình_chữ_nhật có_thể thu được với chi_phí bằng tích của chiều_dài dài nhất và chiều_rộng dài nhất .\nChúng_ta cần phân_hoạch tập các hình_chữ_nhật này một_cách khôn_khéo sao_cho tổng_chi_phí có_thể được tối_thiểu_hóa và tính chi_phí này .\nHình_chữ_nhật không_thể được xoay (đổi chiều_dài và chiều rộng) .\nNhận_xét 1 : Tồn_tại các hình_chữ_nhật không quan_trọng Giả_sử tồn_tại hai hình_chữ_nhật A và B mà mà_cả chiều_dài và chiều_rộng của hình B đều bé hơn hình A thì ta có_thể nói hình B là không quan_trọng vì ta có_thể để hình B chung với hình A từ_đó chi_phí của hình B không còn quan_trọng .\nSau khi đã loại hết tất_cả hình không quan_trọng đi và sắp_xếp lại các hình theo chiều_dài giảm_dần thì chiều_rộng các hình đã sắp_xếp sẽ theo chiều tăng .\nNhận_xét 2 : Đoạn liên_tiếp Sau khi sắp_xếp , ta có_thể hình_dung được rằng nếu chúng_ta chọn hai hình_chữ_nhật ở vị_trí i và ở vị_trí j thì ta có_thể chọn tất_cả hình_chữ_nhật từ i+1 đến j-1 mà không tốn chi_phí nào cả .\nVậy_ta có_thể thấy rằng cách phân_hoạch tối_ưu là một_cách phân dãy thành các đoạn liên_tiếp và chi_phí của một đoạn là bằng tích của chiều_dài của hình_chữ_nhật đầu_tiên và chiều_rộng của hình_chữ_nhật cuối_cùng .\nLời_giải Quy_Hoạch_Động Vậy bài_toán trờ về bài_toán phân dãy sao_cho tổng_chi_phí của các dãy là tối_ưu .\nĐây là một dạng bài quy_hoạch_động hay gặp và chúng_ta có_thể dễ_dàng nghĩ_ra thuật_toán \\mathcalO(N2) như mã giả phía dưới .\n(Giả sử các hình đã được sắp_xếp và bỏ_đi những hình_chữ_nhật không quan trọng) input N for i ∈ 1 . . N input recti . h input recti . w let cost0 = 0 for i ∈ 1 . . N let costi = ∞ for j ∈ 0 . . i-1 costi = min(costi , costj+recti . hrectj+1 . w) print costN Ở trên costk lưu lại chi_phí cực_tiểu để lấy_được k hình_chữ_nhật đầu_tiên .\nHiển_nhiên , cost0=0 .\nĐể tính_toán được costi với i khác 0 , ta có tính tổng_chi_phí để lấy_được các tập trước và cộng nó với chi_phí của tập cuối cùng(có chứa i ) .\nChi_phí của một_tập có_thể dễ_dàng tính bằng cách lấy tích của chiều_dài hình_chữ_nhật đầu_tiên và chiều_rộng của hình_chữ_nhật cuối_cùng .\nVậy_ta có min(costi , costj+recti . hrectj+1 . w) với j là hình_chữ_nhật đầu_tiên của tập cuối_cùng .\nVới_N=50000 thì thuật_toán \\mathcalO(N2) này là quá chậm .\nNhận_xét 3 : Sử_dụng bao lồi Với m_j=rectj+1 . w , b_j=costj , x=recti . h với rectx . h là chiều_rộng của hình_chữ_nhật x và rectx . w là chiều_dài của hình_chữ_nhật x .\nVậy_thì bài_toán trờ về tìm hàm cực_tiểu của y=m_jx+b_j bằng cách tìm j tối_ưu .\nNó giống hoàn_toàn bài_toán chúng_ta đã đề_cập ở trên .\nGiả_sử_ta đã hoàn_thành việc cài_đặt cấu_trúc đã đề_cập ở trên chúng_ta có_thể có_mã giả ở dưới_đây : input N for i ∈ 1 . . N input recti . h input recti . w let E = empty lower envelope structure let cost0 = 0 add the line y=mx+b to E , where m=rect1 . w and b=cost0 //b is zero for i ∈ 1 . . N costi = E . query(recti . h) if ilt;N E . add(m=recti+1 . w , b=costi) print costN Rõ_ràng các đường_thẳng đã được sắp_xếp giảm_dần về độ lớn của hệ_số góc do chúng_ta đã sắp_xếp các chiều_dài giảm_dần .\nDo mỗi truy_vấn có_thể thực_hiện trong thời_gian \\mathcalO(\\logN) , ta có_thể dễ_dàng thấy thời_gian_thực hiện của cả bài_toán là \\mathcalO(N\\logN) .\nDo các truy_vấn của chúng_ta cũng tăng dần (do chiều_rộng đã được sắp_xếp tăng tần) ta có_thể thay_thế việc chặt nhị_phân bằng một con_trỏ chạy song_song với việc quy_hoạch_động đưa bước quy_hoạch_động còn \\mathcalO(N) nhưng tổng_độ phức_tạp vẫn là \\mathcalO(N\\logN) do chi_phí sắp_xếp .\nVậy là ta đã giải_quyết thành_công bài_toán sử_dụng kĩ_thuật bao lồi đầu_tiên của chúng_ta : D .\nVí_dụ 2 : APIO 2010 Commando Bài_toán Bạn được cho : Một dãy có N số_nguyên_dương (1\\le N \\le 106) Một hàm_số bậc 2 với hệ_số_nguyên duong f(x)= ax2 + bx +c , a\\lt0 .\nMục_tiêu cũng của bài_toán là phân dãy này ra thành các đoạn liên_tiếp sao tổng_các hàm f trên các dãy là lớn nhất ( giá_trị của hàm f lên dãy là f(x) với x là tổng_dãy đó) .\nTương_tự như bài trên công_thức quy_hoạch_động có_thể dễ thấy công_thức \\mathcalO(N2) .\nĐịnh_nghĩa rằng : sum(i , j) = xi + xi+1 + . . .\n+ xj adjust(i , j) = asum(i , j)2 + bsum(i , j) + c Ta có : dp(n) = max_k=0n-1dp(k)+adjust(k+1 , n) Mã giả : dp0 ← 0 for n ∈ 1 . . N for k ∈ 0 . . n-1 dpn ← max(dpn , dpk + adjust(k + 1 , n)) Hãy thử biến_đổi hàm \"adjust\" một_tí nào .\nĐịnh_nghĩa sum(1 , x) là \\delta(x) .\nVậy với một_số k bất_kì ta có_thể viết là : dp(n)=dp(k)+a(\\delta(n)-\\delta(k))2+b(\\delta(n)-\\delta(k))+c dp(n)=dp(k)+a(\\delta(n)2+\\delta(k)2-2\\delta(n)\\delta(k))+b(\\delta(n)-\\delta(k))+c dp(n)=(a\\delta(n)2 +b\\delta(n) +c)+dp(k)-2a\\delta(n)\\delta(k)+a\\delta(k)2-b\\delta(k) Nếu : z=\\delta(n) m=-2a\\delta(k) p=dp(k)+a\\delta(k)2-b\\delta(k) Ta có_thể thấy mz+p là đại_lượng mà chúng_ta muốn tối_ưu_hóa bằng cách chọn k .\ndp(n) sẽ bằng đại_lượng đó cộng thêm với a\\delta(n)+b\\delta(n)+c(độc lập so_với k) .\nTrong đó z cũng độc_lập với k , và m và p phụ_thuộc vào k .\nNgược với bài \"acquire\" khi chúng_ta phải tối_thiểu_hóa hàm quy_hoạch_động thì bài này chúng_ta phải cực_đại_hóa nó .\nChúng_ta phải xây_dựng một hình_bao trên với các đường_thẳng tăng dần về hệ_số góc .\nDo đề_bài đã cho a\\lt0 hệ_số góc của chúng_ta tăng dần và luôn dương_thỏa với điều_kiện của cấu_trúc chúng_ta .\nDo dễ thấy \\delta(n)gt;\\delta(n-1) , giống_như bài \"acquire\" các truy_vấn chúng_ta cũng tăng dần theo thứ_tự do_vậy chúng_ta có_thể khơi tạo một biến chạy để chạy song_song khi làm quy_hoạch_động (bỏ được phần chặt nhị phân) .\nBiến_thể động (Fully Dynamic_Variant) Kĩ_thuật này có_thể dễ_dàng được thực_hiện khi các đường_thẳng được thêm trước tất_cả các truy_vấn hay các đường_thẳng được thêm vào theo thứ_tự giảm_dần của hệ_số góc .\nHoặc với cấu_trúc deque chúng_ta cũng có_thể thêm những đường_thẳng có hệ_số góc lớn hơn_hết các đường_thẳng đã có .\nNhưng có những lúc sẽ có các bài_toán khi chúng_ta phải giải_quyết các truy_vấn và thêm đường_thẳng lồng vào nhau với các hệ_số góc ngẫu_nhiên .\nChúng_ta không_thể sắp_xếp lại trước (do bị lồng vào truy vấn) và không_thể sắp_xếp lại với mỗi lần thêm đường_thẳng (vậy sẽ cho ta một_độ phức_tạp tuyến_tính với mỗi truy vấn) .\nCó tồn_tại một_cách để thêm các đường_thẳng ngẫu_nhiên vào trong độ phức_tạp log .\nChúng_ta lưu các đoạn_thẳng trong một cấu_trúc có thứ_tự động như std : : set của C++ .\nMỗi đường_thẳng chứa hệ_số góc và giao_điểm y (sắp xếp theo hệ_số góc trước rồi theo y) cùng_với một biến left thêm , x nhỏ nhất sao_cho đường_thẳng này đạt cực_tiểu trong tập các đường_thẳng .\nSắp đường_thẳng này vào vị_trí đúng của nó và những đường bị loại sẽ là các đường liên_tiếp kế bên nó .\nChúng_ta dùng các điều_kiện tương_tự trên để bỏ các đường_thẳng bên trái và bên phải nó .\nĐể trả_lời truy_vấn , chúng_ta dùng một set nữa dùng chính các biến ấy nhưng lại sắp_xếp theo left .\nVậy mỗi lần truy_vấn ta có_thể dễ_dàng chặt nhị_phân để tìm_ra kết_quả như đã nói ở trên .\nCode_Code_C++ cho \"acquire\" Code_C++ cho \"commando\" Bài_tập : Bài_J - ACM_ICPC_Vietnam_Regional 2017\n", "tagged": "Nguồn/N :/CH P3G_Người/Np dịch/N :/CH Phan_Minh/Np Hoàng_Table/Np of_Contents/Np Lịch_sử/N Bài_toán/N cơ_bản/A Thuật_toán/N duyệt/V Kĩ_thuật/N Ý_nghĩa/N của/E tên/N kĩ_thuật/N Thêm/V một/M đường/N vào/E tập/V Phân_tích/V thuật_toán/N Ví_dụ/C 1/M :/CH USACO_Tháng/Np 3/M năm/N 2008/M \"Acquire\"/Np Bài_toán/N Nhận_xét/N 1/M :/CH Tồn_tại/V các/L hình_chữ_nhật/N không/R quan_trọng/A Nhận_xét/N 2/M :/CH Đoạn/Nc liên_tiếp/A Lời_giải/Np Quy_Hoạch_Động/Np Nhận_xét/N 3/M :/CH Sử_dụng/V bao/N lồi/Np Ví_dụ/C 2/M :/CH APIO/Np 2010/M Commando/Np Bài_toán/N Biến_thể/N động/N (Fully/Np Dynamic_Variant)_Code/Np Bài_tập/Np :/CH Kĩ_thuật/N bao/N lồi/Np là/V kĩ_thuật/N (hoặc/Np là/V cấu_trúc/N dữ/A liệu)/Np dùng/V để/E xác_định/V hiệu_quả/N ,/CH có/V tiền/N xử_lý/V ,/CH cực_trị/N của/E một_tập/Np các/L hàm/Np tuyến_tính/Np tại/E một/M giá_trị/N của/E biến/V độc_lập/A ./CH\nMặc_dù/C tên_gọi/Np giống/N nhưng/C kĩ_thuật/N này/P lại/R khá/R khác_biệt/A so_với/Np thuật_toán/N bao/N lồi/Np của/E hình_học/Np tính_toán/V ./CH\nNgoài_ra/X có_một/Np kĩ_thuật/N liên_quan/V đến/E kĩ_thuật/N bao/N lồi/Np là/V IT/Np đoạn_thẳng/Np Lịch_sử/N Kĩ_thuật/N bao/N lồi/Np được/V biết/V đến/E nhiều/A nhất/A có_lẽ/X vì/E nó/P cần/V để/E ăn/V trọn/A toàn_bộ/L số/N điểm/N trong/E nhiều/A bài_toán/N USACO/Np ,/CH như_là/V bài/N Acquire/Np trong/E bảng/N gold/Np của/E USACO/Np tháng/N 3/M năm/N 2008/M ./CH\nThuật_toán/N được/V đưa_vào/Np các/L cuộc_thi/Np lập_trình/V một_cách/N rộng_rãi/A sau/E bài/N Batch_Scheduling/Np trong/E kì_thi/Np IOI/Np 2002/M ./CH\nĐây/P là/V một/M kĩ_thuật/N khá/R lạ/A và/Cc ít_có/Np nguồn/N trên/E mạng/N về/E vấn_đề/N này/P ./CH\nBài_toán/N cơ_bản/A Cho/E một_tập/Np lớn/A các/L hàm/Np tuyến_tính/Np có/V dạng/N y/N =/CH m_i/Np x/CH +/CH b_i/Np và/Cc một_số/L lượng/N lớn/A truy_vấn/Np ./CH\nMỗi/L truy_vấn/Np là/V một_số/L x/CH và/Cc hỏi/V giá_trị/N cực_tiểu/Np y/N có_thể/R đạt/V được/V nếu/C chúng_ta/P thế/P x/CH vào/E một/M trong/E những/L phương_trình/Np đã/R cho/E ./CH\nVí_dụ/C ,/CH cho/E các/L phương_trình/Np y=4/Np ,/CH y=\\frac43+\\frac23x/Np ,/CH y=12-3x/Np và/Cc y=3-\\frac12x/Np và/Cc truy_vấn/Np x=1/Np ./CH\nChúng_ta/P phải/V tìm/V phương_trình/Np mà/C trả/V về/E giá_trị/N cực_tiểu/Np hoặc/Cc giá_trị/N cực_tiểu/Np đó/P (trong/Np trường_hợp/N này/P là/V phương_trình/Np y=\\frac43+\\frac23x/Np và/Cc giá_trị/N cực_tiểu/Np đó/P là/V 2)/Np ./CH\nBiến_thể/N của/E bài_toán/N có_thể/R là/V tìm/V giá_trị/N cực_đại/A có_thể/R giải_quyết/V với/E một/M thay_đổi/V nhỏ/A vì_vậy/C trong/E bài/N viết/V này/P chỉ/R tập_trung/V vào/E bài_toán/N tìm/V giá_trị/N cực_tiểu/Np ./CH\nSau/E khi/N ta/P vẽ/V các/L đường_thẳng/N lên/V hệ/N trục/N tọa_độ/Np ,/CH dễ/A thấy/V rằng/C :/CH chúng_ta/P muốn/V xác_định/V ,/CH tại/E x=1(đường/Np màu/N đỏ)/Np đường/N nào/P có/V tọa_độ/Np y/N nhỏ/A nhất/A ./CH\nỞ/E trong/E trường_hợp/N này/P là/V đường_nét/Np đứt/V đậm/A y=\\frac43+\\frac23x/Np ./CH\nThuật_toán/N duyệt/V Với/E mỗi/L truy_vấn/Np trong/E Q/Ny truy_vấn/Np ,/CH ta/P duyệt/V qua/V từng/R hàm_số/Np và/Cc thử/V từng/R từng/R hàm/Np và/Cc xem/V thử/V hàm/Np nào/P trả_giá_trị/Np cực_tiểu/Np cho/E giá_trị/N x/CH ./CH\nNếu/C có/V M/Nu đường_thẳng/N và/Cc Q/Ny truy_vấn/Np ,/CH độ/N phức_tạp/A của/E thuật_toán/N sẽ/R \\mathcalO(MQ)/Np ./CH\nKĩ_thuật/N bao/N lồi/Np sẽ/R giúp/V giảm/V độ/N phức_tạp/A xuống/V còn/R \\mathcalO((Q+M)\\log/Np M/Nu ,/CH một_độ/Np phức_tạp/A hiệu/N quá/R hơn/A nhiều/A ./CH\nKĩ_thuật/N Xét/V hình_vẽ/Np ở/E trên/E ./CH\nĐường_thẳng/N y=4/Np sẽ/R không/R bao_giờ/P là/V giá_trị/N nhỏ/A nhất/A với/E tất_cả/P giá_trị/N của/E x/CH ./CH\nMỗi/L đường_trong/Np mỗi/L đường_thẳng/N còn_lại/Np sẽ/R lại/R trả_lại/Np giá_trị/N cực_tiểu/Np trong/E một_và/Np chỉ/R một/M đoạn/Nc liên_tiếp/A (có/Np thể/N có_một/Np biên/N là/V +\\infty/Np hoặc/Cc -\\infty)/Np ./CH\nĐường/N chấm/V đậm/A sẽ/R cho/E giá_trị/N cực_tiểu/Np với/E tất_cả/P giá_trị/N nằm/V bên/N trái/Nc điểm/N giao/V với/E đường/N đen/A đậm/A ./CH\nĐường/N đen/A đậm/A sẽ/R cho/E giá_trị/N cực_tiểu/Np với/E tất_cả/P giá_trị/N giữa/N giao_điểm/N của/E nó/P với/E đường/N nhạt/A và/Cc đường/N chấm/V đậm/A ./CH\nVà/Cc đường/N nhạt/A sẽ/R nhận/V cực_tiểu/Np cho/E tất_cả/P giá_trị/N bên/N phải/V giao_điểm/N với/E đường/N đậm/A ./CH\nMột/M nhận_xét/N nữa_là/X với/E giá_trị/N của/E x/CH càng/R tăng/V thì/C hệ_số/N góc/N của/E các/L hàm_số/Np sẽ/R giảm/V ,/CH \\frac23/Np ,/CH \\frac-12/Np ,/CH -3/Np ./CH\nVới/E một_chút/L chứng_minh/V dễ/A thấy/V rằng/C điều/N này/P luôn/R đúng/A ./CH\nĐiều/N này/P giúp/V chúng_ta/P hiểu/V phần_nào/L thuật_toán/N :/CH Bỏ_đi/Np các/L đường_thẳng/N không/R quan_trọng/A như/C y=4/Np trong/E ví_dụ/C (những/Np đường_thẳng/N mà/C không/R nhận/V giá_trị/N cực_tiểu/Np trong/E bất_kì/R đoạn/Nc nào)/Np Sắp_xếp/V các/L đoạn_thẳng/Np còn_lại/Np theo/V hệ_số/N góc/N và/Cc được/V một_tập/Np N/Ny đoạn_thẳng/Np (của/Np N/Ny đường_thẳng/N còn/R lại)/Np mà/C mỗi/L đoạn/Nc có_một/Np đường_thẳng/N nhận/V giá_trị/N cực_tiểu/Np ./CH\nDùng/V thuật_toán/N tìm_kiếm/V nhị_phân/Np cơ_bản/A để/E có_thể/R tìm_kiếm/V đáp_án/N cho/E từng/R truy_vấn/Np ./CH\nÝ_nghĩa/N của/E tên/N kĩ_thuật/N Cụm_từ/N bao/N lồi/Np được/V sử_dụng/V để/E chỉ/R hình_bao/Np trên/E (upper/Np //CH lower/Np envelope)/Np ./CH\nTrong/E ví_dụ/C ,/CH nếu/C chúng_ta/P coi/V mỗi/L phần/N đoạn_thẳng/Np tối_ưu/A của/E đường_thẳng/N (bỏ/Np qua_đường/Np y=4)/Np ,/CH chúng_ta/P sẽ/R thấy/V những/L đoạn/Nc đó/P tạo_thành/Np một/M hình_bao/Np dưới/E (lower/Np envelope)/Np ,/CH một_tập/Np các/L đoạn_thẳng/Np chứa/V tất_cả/P điểm/N cực_tiểu/Np cho/E mọi/L giá_trị/N của/E x/CH (hình/Np bao/N dưới/E được/V tô/Np bằng/E màu/N xanh_trong/Np hình/N ./CH\nCái/Nc tên/N kĩ_thuật/N bao/N lồi/Np xuất_phát/V từ/E việc/N đường_bao/Np trên/E tạo_thành/Np một/M đường/N lồi/Np ,/CH từ_đó/Np thành/V bao/N lồi/Np của/E một_tập/Np điểm/N ./CH\nThêm/V một/M đường/N vào/E tập/V Ta/P có_thể/R thấy/V nếu/C ta/P có_một/Np tập/V đường_thẳng/N đã/R được/V xác_định/V sắp_xếp/V ,/CH ta/P có_thể/R dễ_dàng/A trả_lời/V bất_kì/R truy_vấn/Np nào/P với/E độ/N phức_tạp/A là/V \\mathcalO(\\log/Np M)/Np với/E tìm_kiếm/V nhị_phân/Np ./CH\nVậy/P nếu/C chúng_ta/P tìm_ra/Np cách/N thêm/V một/M đường_thẳng/N vào/E tính_toán/V lại/R một_cách/N hiệu_quả/N là/V chúng_ta/P đã/R có_một/Np thuật_toán/N hoạt_động/N ngon_lành/A ./CH\nGiả_sử/Np chúng_ta/P được/V xử_lý/V tất_cả/P đường_thẳng/N trước_khi/Np làm/V các/L truy_vấn/Np thì/C chúng_ta/P chỉ_cần/Np đơn_giản/A sắp_xếp/V các/L đường_thẳng/N theo/V hệ_số/N góc/N và/Cc thêm/V từng/R đường/N một/M vào/E ./CH\nSẽ/R có_thể/R một_số/L đường/N không/R quan_trọng/A và/Cc sẽ/R bị/V bỏ_đi/Np ./CH\nChúng_ta/P sẽ/R sử_dụng/V cấu_trúc/N dữ_liệu/N Stack/Np để/E cài_đặt/V ,/CH bỏ/V từng/R đường_thẳng/N vào/E stack/Np và/Cc nếu/C đường/N nào/P không/R quan_trọng/A sẽ/R bị/V bỏ/V ra/V ngoài/E đến/E khi/N chỉ/R còn/R một/M đường_thẳng/N (đường/Np thẳng/A cuối/N không_thể/R bỏ)/Np Vậy/P làm_sao/X để/E có_thể/R xác_định/V đường_thẳng/N nào/P sẽ/R bị/V bỏ/V khỏi/V stack/Np ?/CH\nGiả_sử/Np l_1/Np ,/CH l_2/Np và/Cc l_3/Np là/V đường_thẳng/N áp_chót/Np (gần/Np cuối/N )/CH trên/E stack/Np ,/CH đường_thẳng/N cuối_cùng/A trong/E stack/Np và/Cc đường_thẳng/N được/V thêm/V vào/E stack/Np ./CH\nĐoạn/Nc l_2/Np không/R quan/N trọng(không/Np có_giá/Np trị/V cực_tiểu/Np ở/E điểm/N nào)/Np khi/N và/Cc chỉ/R khi/N giao_điểm/N của/E l_1/Np và/Cc l_3/Np nằm/V bên/N trái/Nc giao_điểm/N của/E l_1/Np và/Cc l_2/Np (Đoạn/Np mà/C l_3/Np nhận/V giá_trị/N cực_tiểu/Np đã/R nằm/V đè/V lên/V đoạn/Nc của/E l_2)/Np ./CH\nGiả_sử/Np rằng/C không/R có/V ba/M đường/N nào/P trùng/V hay/Cc song_song/A với_nhau/Np (có/Np thể/N giải_quyết/V một_cách/N đơn/N giản)/Np ./CH\nPhân_tích/V thuật_toán/N Độ/N phức_tạp/A bộ_nhớ/Np sẽ/R là/V \\mathcalO(M)/Np :/CH chúng_ta/P cần/V một/M danh_sách/N lưu/V lại/R các/L đoạn_thẳng/Np ,/CH biểu_diễn/V bởi/E hai/M số_thực/Np ./CH\nĐộ/N phức_tạp/A thời_gian/N cho/E phần/N tiền/N xây_dựng/V :/CH Để/E sắp_xếp/V các/L đoạn_thẳng/Np theo/V tăng/V dần/R hệ_số/N góc/N sẽ/R tốn/V \\mathcalO(M\\logM)/Np ./CH\nDuyệt/V qua/V các/L đường_thẳng/N mỗi/L đường_được/Np cho/E vào/E stack/Np và/Cc bỏ/V khỏi/V stack/Np tối_đa/A một_lần/Np vậy_nên/Np sẽ/R tốn/V \\mathcalO(M)/Np cho/E bước/V này/P ./CH\nVậy/P thời_gian/N cho/E việc/N xây_dựng/V sẽ/R là/V \\mathcalO(M\\logM)/Np ./CH\nVới/E mỗi/L truy_vấn/Np dùng/V chặt/A nhị_phân/Np sẽ/R cho/E độ/N phúc/A tạp/A tốt/A nhất/A \\mathcalO(\\log/Np M)/Np ./CH\nVí_dụ/C 1/M :/CH USACO_Tháng/Np 3/M năm/N 2008/M \"Acquire\"/Np Bài_toán/N Cho_N(N/Np \\le/Np 50000)/Np hình_chữ_nhật/N khác_nhau/Np về/E hình_dạng/N ,/CH mục_tiêu/N của/E bài_toán/N là/V phải/V lấy_được/X tất_cả/P hình_chữ_nhật/N ./CH\nMột_tập/Np hình_chữ_nhật/N có_thể/R thu/V được/V với/E chi_phí/N bằng/E tích/N của/E chiều_dài/N dài/A nhất/A và/Cc chiều_rộng/Np dài/A nhất/A ./CH\nChúng_ta/P cần/V phân_hoạch/Np tập/V các/L hình_chữ_nhật/N này/P một_cách/N khôn_khéo/A sao_cho/Np tổng_chi_phí/Np có_thể/R được/V tối_thiểu_hóa/Np và/Cc tính/V chi_phí/N này/P ./CH\nHình_chữ_nhật/N không_thể/R được/V xoay/V (đổi/Np chiều_dài/N và/Cc chiều/N rộng)/Np ./CH\nNhận_xét/N 1/M :/CH Tồn_tại/V các/L hình_chữ_nhật/N không/R quan_trọng/A Giả_sử/Np tồn_tại/V hai/M hình_chữ_nhật/N A/Ni và/Cc B/Ni mà/C mà_cả/Np chiều_dài/N và/Cc chiều_rộng/Np của/E hình/N B/Ni đều/R bé/N hơn/A hình/N A/Ni thì/C ta/P có_thể/R nói/V hình/N B/Ni là/V không/R quan_trọng/A vì/E ta/P có_thể/R để/E hình/N B/Ni chung/A với/E hình/N A/Ni từ_đó/Np chi_phí/N của/E hình/N B/Ni không/R còn/R quan_trọng/A ./CH\nSau/E khi/N đã/R loại/N hết/V tất_cả/P hình/N không/R quan_trọng/A đi/V và/Cc sắp_xếp/V lại/R các/L hình/N theo/V chiều_dài/N giảm_dần/Np thì/C chiều_rộng/Np các/L hình/N đã/R sắp_xếp/V sẽ/R theo/V chiều/N tăng/V ./CH\nNhận_xét/N 2/M :/CH Đoạn/Nc liên_tiếp/A Sau/E khi/N sắp_xếp/V ,/CH ta/P có_thể/R hình_dung/V được/V rằng/C nếu/C chúng_ta/P chọn/V hai/M hình_chữ_nhật/N ở/E vị_trí/N i/M và/Cc ở/E vị_trí/N j/Np thì/C ta/P có_thể/R chọn/V tất_cả/P hình_chữ_nhật/N từ/E i+1/Np đến/E j-1/Np mà/C không/R tốn/V chi_phí/N nào/P cả/P ./CH\nVậy_ta/Np có_thể/R thấy/V rằng/C cách/N phân_hoạch/Np tối_ưu/A là/V một_cách/N phân/V dãy/Nc thành/V các/L đoạn/Nc liên_tiếp/A và/Cc chi_phí/N của/E một/M đoạn/Nc là/V bằng/E tích/N của/E chiều_dài/N của/E hình_chữ_nhật/N đầu_tiên/A và/Cc chiều_rộng/Np của/E hình_chữ_nhật/N cuối_cùng/A ./CH\nLời_giải/Np Quy_Hoạch_Động/Np Vậy/P bài_toán/N trờ/V về/E bài_toán/N phân/V dãy/Nc sao_cho/Np tổng_chi_phí/Np của/E các/L dãy/Nc là/V tối_ưu/A ./CH\nĐây/P là/V một/M dạng/N bài/N quy_hoạch_động/Np hay/Cc gặp/V và/Cc chúng_ta/P có_thể/R dễ_dàng/A nghĩ_ra/Np thuật_toán/N \\mathcalO(N2)/Np như/C mã/N giả/A phía/N dưới/E ./CH\n(Giả/Np sử/Np các/L hình/N đã/R được/V sắp_xếp/V và/Cc bỏ_đi/Np những/L hình_chữ_nhật/N không/R quan/N trọng)/Np input/Np N/Ny for/Np i/M ∈/Np 1/M ./CH ./CH N/Ny input/Np recti/Np ./CH h/Ny input/Np recti/Np ./CH w/Nu let/Np cost0/Np =/CH 0/M for/Np i/M ∈/Np 1/M ./CH ./CH N/Ny let/Np costi/Np =/CH ∞/Np for/Np j/Np ∈/Np 0/M ./CH ./CH i-1/Np costi/Np =/CH min(costi/Np ,/CH costj+recti/Np ./CH hrectj+1/Np ./CH w)/Np print/Np costN/Np Ở/E trên/E costk/Np lưu/V lại/R chi_phí/N cực_tiểu/Np để/E lấy_được/X k/N hình_chữ_nhật/N đầu_tiên/A ./CH\nHiển_nhiên/Np ,/CH cost0=0/Np ./CH\nĐể/E tính_toán/V được/V costi/Np với/E i/M khác/A 0/M ,/CH ta/P có/V tính/V tổng_chi_phí/Np để/E lấy_được/X các/L tập/V trước/E và/Cc cộng/V nó/P với/E chi_phí/N của/E tập/V cuối/N cùng(có/Np chứa/V i/M )/CH ./CH\nChi_phí/N của/E một_tập/Np có_thể/R dễ_dàng/A tính/V bằng/E cách/N lấy/V tích/N của/E chiều_dài/N hình_chữ_nhật/N đầu_tiên/A và/Cc chiều_rộng/Np của/E hình_chữ_nhật/N cuối_cùng/A ./CH\nVậy_ta/Np có/V min(costi/Np ,/CH costj+recti/Np ./CH hrectj+1/Np ./CH w)/Np với/E j/Np là/V hình_chữ_nhật/N đầu_tiên/A của/E tập/V cuối_cùng/A ./CH\nVới_N=50000/Np thì/C thuật_toán/N \\mathcalO(N2)/Np này/P là/V quá/R chậm/A ./CH\nNhận_xét/N 3/M :/CH Sử_dụng/V bao/N lồi/Np Với/E m_j=rectj+1/Np ./CH w/Nu ,/CH b_j=costj/Np ,/CH x=recti/Np ./CH h/Ny với/E rectx/Np ./CH h/Ny là/V chiều_rộng/Np của/E hình_chữ_nhật/N x/CH và/Cc rectx/Np ./CH w/Nu là/V chiều_dài/N của/E hình_chữ_nhật/N x/CH ./CH\nVậy_thì/X bài_toán/N trờ/V về/E tìm/V hàm/Np cực_tiểu/Np của/E y=m_jx+b_j/Np bằng/E cách/N tìm/V j/Np tối_ưu/A ./CH\nNó/P giống/N hoàn_toàn/A bài_toán/N chúng_ta/P đã/R đề_cập/V ở/E trên/E ./CH\nGiả_sử_ta/Np đã/R hoàn_thành/V việc/N cài_đặt/V cấu_trúc/N đã/R đề_cập/V ở/E trên/E chúng_ta/P có_thể/R có_mã/Np giả/A ở/E dưới_đây/Np :/CH input/Np N/Ny for/Np i/M ∈/Np 1/M ./CH ./CH N/Ny input/Np recti/Np ./CH h/Ny input/Np recti/Np ./CH w/Nu let/Np E/Ni =/CH empty/Np lower/Np envelope/Np structure/Np let/Np cost0/Np =/CH 0/M add/Np the/B line/N y=mx+b/Np to/A E/Ni ,/CH where/Np m=rect1/Np ./CH w/Nu and/Np b=cost0/Np //CH is/Np zero/Np for/Np i/M ∈/Np 1/M ./CH ./CH N/Ny costi/Np =/CH E/Ni ./CH query(recti/Np ./CH h)/Np if/Np ilt;N/Np E/Ni ./CH add(m=recti+1/Np ./CH w/Nu ,/CH b=costi)/Np print/Np costN/Np Rõ_ràng/A các/L đường_thẳng/N đã/R được/V sắp_xếp/V giảm_dần/Np về/E độ/N lớn/A của/E hệ_số/N góc/N do/E chúng_ta/P đã/R sắp_xếp/V các/L chiều_dài/N giảm_dần/Np ./CH\nDo/E mỗi/L truy_vấn/Np có_thể/R thực_hiện/V trong/E thời_gian/N \\mathcalO(\\logN)/Np ,/CH ta/P có_thể/R dễ_dàng/A thấy/V thời_gian_thực/Np hiện/N của/E cả/P bài_toán/N là/V \\mathcalO(N\\logN)/Np ./CH\nDo/E các/L truy_vấn/Np của/E chúng_ta/P cũng/R tăng/V dần/R (do/Np chiều_rộng/Np đã/R được/V sắp_xếp/V tăng/V tần)/Np ta/P có_thể/R thay_thế/V việc/N chặt/A nhị_phân/Np bằng/E một/M con_trỏ/Np chạy/V song_song/A với/E việc/N quy_hoạch_động/Np đưa/V bước/V quy_hoạch_động/Np còn/R \\mathcalO(N)/Np nhưng/C tổng_độ/Np phức_tạp/A vẫn/R là/V \\mathcalO(N\\logN)/Np do/E chi_phí/N sắp_xếp/V ./CH\nVậy/P là/V ta/P đã/R giải_quyết/V thành_công/V bài_toán/N sử_dụng/V kĩ_thuật/N bao/N lồi/Np đầu_tiên/A của/E chúng_ta/P :/CH D/Ny ./CH\nVí_dụ/C 2/M :/CH APIO/Np 2010/M Commando/Np Bài_toán/N Bạn/N được/V cho/E :/CH Một/M dãy/Nc có/V N/Ny số_nguyên_dương/Np (1\\le/Np N/Ny \\le/Np 106)/Np Một/M hàm_số/Np bậc/N 2/M với/E hệ_số_nguyên/Np duong/Np f(x)=/Np ax2/Np +/CH bx/Np +c/Np ,/CH a\\lt0/Np ./CH\nMục_tiêu/N cũng/R của/E bài_toán/N là/V phân/V dãy/Nc này/P ra/V thành/V các/L đoạn/Nc liên_tiếp/A sao/P tổng_các/Np hàm/Np f/Np trên/E các/L dãy/Nc là/V lớn/A nhất/A (/CH giá_trị/N của/E hàm/Np f/Np lên/V dãy/Nc là/V f(x)/Np với/E x/CH là/V tổng_dãy/Np đó)/Np ./CH\nTương_tự/A như/C bài/N trên/E công_thức/N quy_hoạch_động/Np có_thể/R dễ/A thấy/V công_thức/N \\mathcalO(N2)/Np ./CH\nĐịnh_nghĩa/N rằng/C :/CH sum(i/Np ,/CH j)/Np =/CH xi/N +/CH xi+1/Np +/CH ./CH ./CH ./CH\n+/CH xj/Np adjust(i/Np ,/CH j)/Np =/CH asum(i/Np ,/CH j)2/Np +/CH bsum(i/Np ,/CH j)/Np +/CH c/Ni Ta/P có/V :/CH dp(n)/Np =/CH max_k=0n-1dp(k)+adjust(k+1/Np ,/CH n)/Np Mã/N giả/A :/CH dp0/Np ←/Np 0/M for/Np n/Ny ∈/Np 1/M ./CH ./CH N/Ny for/Np k/N ∈/Np 0/M ./CH ./CH n-1/Np dpn/Np ←/Np max(dpn/Np ,/CH dpk/Np +/CH adjust(k/Np +/CH 1/M ,/CH n))/Np Hãy/R thử/V biến_đổi/V hàm/Np \"adjust\"/Np một_tí/L nào/P ./CH\nĐịnh_nghĩa/N sum(1/Np ,/CH x)/Np là/V \\delta(x)/Np ./CH\nVậy/P với/E một_số/L k/N bất_kì/R ta/P có_thể/R viết/V là/V :/CH dp(n)=dp(k)+a(\\delta(n)-\\delta(k))2+b(\\delta(n)-\\delta(k))+c/Np dp(n)=dp(k)+a(\\delta(n)2+\\delta(k)2-2\\delta(n)\\delta(k))+b(\\delta(n)-\\delta(k))+c/Np dp(n)=(a\\delta(n)2/Np +b\\delta(n)/Np +c)+dp(k)-2a\\delta(n)\\delta(k)+a\\delta(k)2-b\\delta(k)/Np Nếu/C :/CH z=\\delta(n)/Np m=-2a\\delta(k)/Np p=dp(k)+a\\delta(k)2-b\\delta(k)/Np Ta/P có_thể/R thấy/V mz+p/Np là/V đại_lượng/Np mà/C chúng_ta/P muốn/V tối_ưu_hóa/Np bằng/E cách/N chọn/V k/N ./CH\ndp(n)/Np sẽ/R bằng/E đại_lượng/Np đó/P cộng/V thêm/V với/E a\\delta(n)+b\\delta(n)+c(độc/Np lập/V so_với/Np k)/Np ./CH\nTrong/E đó/P z/Y cũng/R độc_lập/A với/E k/N ,/CH và/Cc m/Nu và/Cc p/Ny phụ_thuộc/V vào/E k/N ./CH\nNgược/A với/E bài/N \"acquire\"/Np khi/N chúng_ta/P phải/V tối_thiểu_hóa/Np hàm/Np quy_hoạch_động/Np thì/C bài/N này/P chúng_ta/P phải/V cực_đại_hóa/Np nó/P ./CH\nChúng_ta/P phải/V xây_dựng/V một/M hình_bao/Np trên/E với/E các/L đường_thẳng/N tăng/V dần/R về/E hệ_số/N góc/N ./CH\nDo/E đề_bài/Np đã/R cho/E a\\lt0/Np hệ_số/N góc/N của/E chúng_ta/P tăng/V dần/R và/Cc luôn/R dương_thỏa/Np với/E điều_kiện/N của/E cấu_trúc/N chúng_ta/P ./CH\nDo/E dễ/A thấy/V \\delta(n)gt;\\delta(n-1)/Np ,/CH giống_như/Np bài/N \"acquire\"/Np các/L truy_vấn/Np chúng_ta/P cũng/R tăng/V dần/R theo/V thứ_tự/N do_vậy/C chúng_ta/P có_thể/R khơi/N tạo/V một/M biến/V chạy/V để/E chạy/V song_song/A khi/N làm/V quy_hoạch_động/Np (bỏ/Np được/V phần/N chặt/A nhị/M phân)/Np ./CH\nBiến_thể/N động/N (Fully/Np Dynamic_Variant)/Np Kĩ_thuật/N này/P có_thể/R dễ_dàng/A được/V thực_hiện/V khi/N các/L đường_thẳng/N được/V thêm/V trước/E tất_cả/P các/L truy_vấn/Np hay/Cc các/L đường_thẳng/N được/V thêm/V vào/E theo/V thứ_tự/N giảm_dần/Np của/E hệ_số/N góc/N ./CH\nHoặc/Cc với/E cấu_trúc/N deque/Np chúng_ta/P cũng/R có_thể/R thêm/V những/L đường_thẳng/N có/V hệ_số/N góc/N lớn/A hơn_hết/Np các/L đường_thẳng/N đã/R có/V ./CH\nNhưng/C có/V những/L lúc/N sẽ/R có/V các/L bài_toán/N khi/N chúng_ta/P phải/V giải_quyết/V các/L truy_vấn/Np và/Cc thêm/V đường_thẳng/N lồng/N vào/E nhau/N với/E các/L hệ_số/N góc/N ngẫu_nhiên/A ./CH\nChúng_ta/P không_thể/R sắp_xếp/V lại/R trước/E (do/Np bị/V lồng/N vào/E truy/V vấn)/Np và/Cc không_thể/R sắp_xếp/V lại/R với/E mỗi/L lần/N thêm/V đường_thẳng/N (vậy/Np sẽ/R cho/E ta/P một_độ/Np phức_tạp/A tuyến_tính/Np với/E mỗi/L truy/V vấn)/Np ./CH\nCó/V tồn_tại/V một_cách/N để/E thêm/V các/L đường_thẳng/N ngẫu_nhiên/A vào/E trong/E độ/N phức_tạp/A log/Np ./CH\nChúng_ta/P lưu/V các/L đoạn_thẳng/Np trong/E một/M cấu_trúc/N có/V thứ_tự/N động/N như/C std/Np :/CH :/CH set/N của/E C++/Np ./CH\nMỗi/L đường_thẳng/N chứa/V hệ_số/N góc/N và/Cc giao_điểm/N y/N (sắp/Np xếp/V theo/V hệ_số/N góc/N trước/E rồi/C theo/V y)/Np cùng_với/C một/M biến/V left/Np thêm/V ,/CH x/CH nhỏ/A nhất/A sao_cho/Np đường_thẳng/N này/P đạt/V cực_tiểu/Np trong/E tập/V các/L đường_thẳng/N ./CH\nSắp/R đường_thẳng/N này/P vào/E vị_trí/N đúng/A của/E nó/P và/Cc những/L đường/N bị/V loại/N sẽ/R là/V các/L đường/N liên_tiếp/A kế/V bên/N nó/P ./CH\nChúng_ta/P dùng/V các/L điều_kiện/N tương_tự/A trên/E để/E bỏ/V các/L đường_thẳng/N bên/N trái/Nc và/Cc bên/N phải/V nó/P ./CH\nĐể/E trả_lời/V truy_vấn/Np ,/CH chúng_ta/P dùng/V một/M set/N nữa/R dùng/V chính/T các/L biến/V ấy/P nhưng/C lại/R sắp_xếp/V theo/V left/Np ./CH\nVậy/P mỗi/L lần/N truy_vấn/Np ta/P có_thể/R dễ_dàng/A chặt/A nhị_phân/Np để/E tìm_ra/Np kết_quả/N như/C đã/R nói/V ở/E trên/E ./CH\nCode_Code_C++/Np cho/E \"acquire\"/Np Code_C++/Np cho/E \"commando\"/Np Bài_tập/Np :/CH Bài_J/Np -/CH ACM_ICPC_Vietnam_Regional/Np 2017/Np\n", "title": "Kĩ thuật bao lồi (Convex Hull Trick)\n", "link": "http://vnoi.info/wiki/translate/wcipeg/Convex-Hull-Trick\n"}