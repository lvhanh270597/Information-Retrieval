{"content": "Nơi tổng_hợp và chia_sẻ những kiến_thức liên_quan tới giải_thuật nói_chung và lý_thuyết khoa_học máy_tính nói_riêng .\nin Trong bài trước_ta đã tìm_hiểu các thuật_toán tìm_kiếm xâu với thời_gian trong đó là độ_dài của văn_bản và là độ_dài của xâu tìm_kiếm .\nMỗi thuật_toán có đặc_tính và ứng_dụng riêng 2 : là thuật_toán tìm_kiếm tuyến_tính đơn_giản nhất , là thuật_toán có thời_gian sublinear trong thực_tế , có_ý nghĩa về_mặt lịch_sử cũng_như ý_tưởng của thuật_toán và thuật_toán này còn có_thể được mở_rộng ra trong trường_hợp thời_gian_thực và tìm_kiếm một_tập nhiều mẫu , được trong phát_hiện đạo_văn .\nTuy_nhiên , tất_cả các thuật_toán này đều rất khó mở_rộng khi chúng_ta muốn thực_hiện các truy_vấn (query) văn_bản .\nMột_số truy_vấn thường gặp như : Ngoài hai truy_vấn cuối_cùng , các truy_vấn còn_lại có_thể được thực_hiện lặp_đi lặp_lại với các xâu mẫu khác_nhau .\nTa có_thể tưởng_tượng trong thực_tế văn_bản có kích_thước lớn còn xâu mẫu có kích_thước nhỏ .\nDo_đó , một truy_vấn có_thể coi là nếu thời_gian_thực hiện truy_vấn chỉ phụ_thuộc vào độ_dài của , không phụ_thuộc vào độ_dài của .\nPhương_pháp đầu_tiên chúng_ta có_thể nghĩ tới đó là tìm một_cách biểu_diễn sao_cho việc thực_hiện các truy_vấn được thực_hiện hiệu_quả .\nThời_gian để biểu_diễn sẽ được tính vào thời_gian tiền xử_lí .\nThông_thường , thời_gian tiền xử_lí là khá lớn .\nCây hậu_tố (suffix tree) , được đề_xuất bởi Weiner 1 vào năm 1973 , là một trong những cách biểu_diễn có_thể trả_lời các truy_vấn trên một_cách hiệu_quả .\nĐiều đặc_biệt là cây hậu_tố có_thể được xây_dựng trong thời_gian .\nKnuth , theo , đã gọi thuật_toán xây_dựng cây hậu_tố của Winer là \"giải thuật của năm 1973\" .\nVí_dụ : , hình dưới_đây biểu_diễn cây hậu_tố với 6 nút lá .\nMột điều đặc_biệt chú_ý là .\nVí_dụ không có cây hậu_tố biểu_diễn nào thỏa_mãn 5 tính_chất ở trên (mình khuyến_khích bạn_đọc nên thử xây dựng) .\nLí_do (sau khi bạn thử xây_dựng bạn sẽ thấy) không có cây hậu_tố tương_ứng là_vì hậu_tố là tiền_tố của hậu_tố .\nTổng_quát_hóa ta sẽ thấy : có cây hậu_tố biểu_diễn nó khi và chỉ khi có_một hậu_tố là tiền_tố của một hậu_tố khác . Do_đó , để đảm_bảo ta luôn có_thể xây_dựng được cây hậu_tố cho mọi văn_bản đầu_vào , ta sẽ thêm kí_tự không thuộc bảng_chữ_cái vào cuối của văn_bản .\nDễ thấy sau khi thêm , trường_hợp của nhận_xét trên không bao_giờ xảy_ra .\nTừ đoạn này trở_đi của bài viết , ta luôn giả_sử .\nTa sẽ biểu_diễn cây hậu_tố dưới dạng cấu_trúc cây .\nVề cơ_bản , mỗi nút của cây hậu_tố sẽ có các thông_tin sau : Nếu có các thông_tin khác lưu_trữ để tăng_tốc thuật_toán xây_dựng thì chúng_ta sẽ bổ_sung sau . Hậu_tố với được gọi_là hậu_tố thứ của và kí_hiệu là .\nVới mỗi nút của cây hậu_tố , là xâu con thu được bằng cách ghép (concatenation) các xâu con của các cạnh trên đường_đi từ nút gốc đến của .\nĐộ_dài của xâu được gọi_là string depth và kí_hiệu là ( là viết tắt của string depth) .\nGiả_sử chúng_ta đã xây_dựng được cây hậu_tố cho .\nSử_dụng cây hậu_tố , ta có_thể trả_lời một_số truy_vấn ở trên như_sau : Giả mã của các truy_vấn này được cho ở phần_phụ_lục ở cuối bài .\nDưới_đây , chúng_ta giới_thiệu thuật_toán đơn_giản với thời_gian xây_dựng cây hậu_tố .\nBài tiếp_theo chúng_ta sẽ làm_quen với thuật_toán . Ta lần_lượt xây_dựng cây hậu_tố bằng cách chèn lần_lượt các hậu_tố , trong đó là hậu_tố thứ của , vào cây hậu_tố hiện_tại .\nCây hậu_tố chỉ_có 1 nút lá (và một nút gốc) biểu_diễn hậu_tố .\nTại bước thứ , thuật_toán chèn hậu_tố vào cây hậu_tố hiện_tại .\nĐể chèn hậu_tố vào cây hậu_tố hiện_tại , ta sẽ : Ví_dụ Cây hậu tối khi chèn và lần_lượt tương_ứng với trường_hợp (I) và (II) sẽ như ở hình_vẽ sau : Giả mã của thuật_toán như_sau : Code của giả mã bằng C .\nCode đầy_đủ được đính ở cuối bài .\nTrước_hết ta phân_tích xem cây hậu_tố ở trên có tối_đa bao_nhiêu nút .\nDễ_dàng thấy số nút lá của cây hậu_tố là , bằng kích_thước của văn_bản đầu_vào , vì mỗi nút lá ứng với một hậu_tố .\nTrong quá_trình xây_dựng cây hậu_tố , một nút trong chỉ xuất_hiện khi chèn thêm một hậu_tố mới .\nDo_đó , số nút trong của cây không_thể vượt_quá là số nút lá .\nDo_đó , cây hậu_tố có tối_đa nút .\nNếu biểu_diễn con_trỏ tới các nút con bằng mảng như thực_hiện ở trên , thì cần con_trỏ cho mỗi nút trong của cây .\nDo_đó , mỗi nút chiếm bộ_nhớ là để biểu_diễn và tổng_bộ_nhớ cần để biểu_diễn cây là .\nTuy_nhiên , nếu ta biểu_diễn con_trỏ tới các nút con là một danh_sách , thì số_lượng con_trỏ của tất_cả các nút trong không lớn hơn số cạnh của cây hậu_tố .\nVì cây hậu_tố có tối_đa nút , nó sẽ có tối_đa cạnh và do_đó số con_trỏ đó không quá .\nNhư_vậy , bộ_nhớ để biểu_diễn cây trong trường_hợp này là . Về_mặt thời_gian , có_thể thấy rằng thuật_toán xây_dựng cây hậu_tố trong bước .\nBước thứ tìm_kiếm hậu_tố trong cây hậu_tố đang xây_dựng hiện_tại .\nBước này sử_dụng (là chiều_dài của hậu_tố ) phép so_sánh để tìm_kiếm .\nDo_đó , tổng thời_gian của thuật_toán là .\nCode của giả mã bằng C : Code của giả mã bằng C : Như đã nhắc đến ở trên , để thực_hiện truy_vấn này , với mỗi nút , chúng_ta lưu thêm một trường lưu_số lượng nút lá của cây_con gốc .\nThông_tin này có_thể được cập_nhật trong quá_trình xây_dựng cây mà không làm giảm thời_gian tiệm_cận xây_dựng cây .\nCode của giả mã bằng C : Để thực_hiện truy_vấn này , với mỗi nút , chúng_ta lưu thêm một trường lưu string depth của nút .\nThông_tin này có_thể được cập_nhật trong quá_trình xây_dựng cây mà không làm giảm thời_gian tiệm_cận xây_dựng cây .\nCode của giả mã bằng C : Code của giả mã bằng C : Code : .\n1 Weiner , Peter .\nSwitching and Automata_Theory , 1973 .\nSWAT08 .\nIEEE_Conference_Record of 14th Annual_Symposium on .\nIEEE , 1973 .\n2 Gusfield , Dan .\n.\nCambridge university press , 1997 .\n3 Carl_Kingsford .\n.\nCMSC 423 , CMU .\nHậu_tố của một xâu là một xâu con của có dạng với là một_số nào_đó thỏa_mãn .\nVí_dụ thì_là một hậu_tố của .\nChú_ý là hậu_tố của chính nó .\nMột hậu_tố của được gọi_là một hậu_tố riêng (proper suffix) nếu hậu_tố đó khác .\n, , Trackback link : Powered by and\n", "tagged": "Nơi/N tổng_hợp/V và/Cc chia_sẻ/V những/L kiến_thức/N liên_quan/V tới/E giải_thuật/Np nói_chung/X và/Cc lý_thuyết/Np khoa_học/N máy_tính/N nói_riêng/X ./CH\nin/V Trong/E bài/N trước_ta/Np đã/R tìm_hiểu/V các/L thuật_toán/N tìm_kiếm/V xâu/Np với/E thời_gian/N trong/E đó/P là/V độ_dài/Np của/E văn_bản/N và/Cc là/V độ_dài/Np của/E xâu/Np tìm_kiếm/V ./CH\nMỗi/L thuật_toán/N có/V đặc_tính/N và/Cc ứng_dụng/V riêng/A 2/M :/CH là/V thuật_toán/N tìm_kiếm/V tuyến_tính/Np đơn_giản/A nhất/A ,/CH là/V thuật_toán/N có/V thời_gian/N sublinear/Np trong/E thực_tế/N ,/CH có_ý/Np nghĩa/N về_mặt/Np lịch_sử/N cũng_như/C ý_tưởng/N của/E thuật_toán/N và/Cc thuật_toán/N này/P còn/R có_thể/R được/V mở_rộng/V ra/V trong/E trường_hợp/N thời_gian_thực/Np và/Cc tìm_kiếm/V một_tập/Np nhiều/A mẫu/N ,/CH được/V trong/E phát_hiện/V đạo_văn/Np ./CH\nTuy_nhiên/C ,/CH tất_cả/P các/L thuật_toán/N này/P đều/R rất/R khó/A mở_rộng/V khi/N chúng_ta/P muốn/V thực_hiện/V các/L truy_vấn/Np (query)/Np văn_bản/N ./CH\nMột_số/L truy_vấn/Np thường/R gặp/V như/C :/CH Ngoài/E hai/M truy_vấn/Np cuối_cùng/A ,/CH các/L truy_vấn/Np còn_lại/Np có_thể/R được/V thực_hiện/V lặp_đi/Np lặp_lại/Np với/E các/L xâu/Np mẫu/N khác_nhau/Np ./CH\nTa/P có_thể/R tưởng_tượng/V trong/E thực_tế/N văn_bản/N có/V kích_thước/N lớn/A còn/R xâu/Np mẫu/N có/V kích_thước/N nhỏ/A ./CH\nDo_đó/C ,/CH một/M truy_vấn/Np có_thể/R coi/V là/V nếu/C thời_gian_thực/Np hiện/N truy_vấn/Np chỉ/R phụ_thuộc/V vào/E độ_dài/Np của/E ,/CH không/R phụ_thuộc/V vào/E độ_dài/Np của/E ./CH\nPhương_pháp/N đầu_tiên/A chúng_ta/P có_thể/R nghĩ/V tới/E đó/P là/V tìm/V một_cách/N biểu_diễn/V sao_cho/Np việc/N thực_hiện/V các/L truy_vấn/Np được/V thực_hiện/V hiệu_quả/N ./CH\nThời_gian/N để/E biểu_diễn/V sẽ/R được/V tính/V vào/E thời_gian/N tiền/N xử_lí/V ./CH\nThông_thường/A ,/CH thời_gian/N tiền/N xử_lí/V là/V khá/R lớn/A ./CH\nCây/N hậu_tố/Np (suffix/Np tree)/Np ,/CH được/V đề_xuất/V bởi/E Weiner/Np 1/M vào/E năm/N 1973/M ,/CH là/V một/M trong/E những/L cách/N biểu_diễn/V có_thể/R trả_lời/V các/L truy_vấn/Np trên/E một_cách/N hiệu_quả/N ./CH\nĐiều/N đặc_biệt/A là/V cây/N hậu_tố/Np có_thể/R được/V xây_dựng/V trong/E thời_gian/N ./CH\nKnuth/Np ,/CH theo/V ,/CH đã/R gọi/V thuật_toán/N xây_dựng/V cây/N hậu_tố/Np của/E Winer/Np là/V \"giải/Np thuật/Np của/E năm/N 1973\"/Np ./CH\nVí_dụ/C :/CH ,/CH hình/N dưới_đây/Np biểu_diễn/V cây/N hậu_tố/Np với/E 6/M nút/N lá/N ./CH\nMột/M điều/N đặc_biệt/A chú_ý/V là/V ./CH\nVí_dụ/C không/R có/V cây/N hậu_tố/Np biểu_diễn/V nào/P thỏa_mãn/V 5/M tính_chất/N ở/E trên/E (mình/Np khuyến_khích/V bạn_đọc/N nên/C thử/V xây/V dựng)/Np ./CH\nLí_do/N (sau/Np khi/N bạn/N thử/V xây_dựng/V bạn/N sẽ/R thấy)/Np không/R có/V cây/N hậu_tố/Np tương_ứng/V là_vì/Np hậu_tố/Np là/V tiền_tố/Np của/E hậu_tố/Np ./CH\nTổng_quát_hóa/Np ta/P sẽ/R thấy/V :/CH có/V cây/N hậu_tố/Np biểu_diễn/V nó/P khi/N và/Cc chỉ/R khi/N có_một/Np hậu_tố/Np là/V tiền_tố/Np của/E một/M hậu_tố/Np khác/A ./CH Do_đó/C ,/CH để/E đảm_bảo/V ta/P luôn/R có_thể/R xây_dựng/V được/V cây/N hậu_tố/Np cho/E mọi/L văn_bản/N đầu_vào/N ,/CH ta/P sẽ/R thêm/V kí_tự/Np không/R thuộc/V bảng_chữ_cái/Np vào/E cuối/N của/E văn_bản/N ./CH\nDễ/A thấy/V sau/E khi/N thêm/V ,/CH trường_hợp/N của/E nhận_xét/N trên/E không/R bao_giờ/P xảy_ra/Np ./CH\nTừ/E đoạn/Nc này/P trở_đi/Np của/E bài/N viết/V ,/CH ta/P luôn/R giả_sử/Np ./CH\nTa/P sẽ/R biểu_diễn/V cây/N hậu_tố/Np dưới/E dạng/N cấu_trúc/N cây/N ./CH\nVề/E cơ_bản/A ,/CH mỗi/L nút/N của/E cây/N hậu_tố/Np sẽ/R có/V các/L thông_tin/N sau/E :/CH Nếu/C có/V các/L thông_tin/N khác/A lưu_trữ/Np để/E tăng_tốc/Np thuật_toán/N xây_dựng/V thì/C chúng_ta/P sẽ/R bổ_sung/V sau/E ./CH Hậu_tố/Np với/E được/V gọi_là/V hậu_tố/Np thứ/N của/E và/Cc kí_hiệu/Np là/V ./CH\nVới/E mỗi/L nút/N của/E cây/N hậu_tố/Np ,/CH là/V xâu/Np con/Nc thu/V được/V bằng/E cách/N ghép/V (concatenation)/Np các/L xâu/Np con/Nc của/E các/L cạnh/N trên/E đường_đi/Np từ/E nút/N gốc/N đến/E của/E ./CH\nĐộ_dài/Np của/E xâu/Np được/V gọi_là/V string/Np depth/Np và/Cc kí_hiệu/Np là/V (/CH là/V viết/V tắt/V của/E string/Np depth)/Np ./CH\nGiả_sử/Np chúng_ta/P đã/R xây_dựng/V được/V cây/N hậu_tố/Np cho/E ./CH\nSử_dụng/V cây/N hậu_tố/Np ,/CH ta/P có_thể/R trả_lời/V một_số/L truy_vấn/Np ở/E trên/E như_sau/Np :/CH Giả/A mã/N của/E các/L truy_vấn/Np này/P được/V cho/E ở/E phần_phụ_lục/Np ở/E cuối/N bài/N ./CH\nDưới_đây/Np ,/CH chúng_ta/P giới_thiệu/V thuật_toán/N đơn_giản/A với/E thời_gian/N xây_dựng/V cây/N hậu_tố/Np ./CH\nBài/N tiếp_theo/V chúng_ta/P sẽ/R làm_quen/V với/E thuật_toán/N ./CH Ta/P lần_lượt/R xây_dựng/V cây/N hậu_tố/Np bằng/E cách/N chèn/V lần_lượt/R các/L hậu_tố/Np ,/CH trong/E đó/P là/V hậu_tố/Np thứ/N của/E ,/CH vào/E cây/N hậu_tố/Np hiện_tại/N ./CH\nCây/N hậu_tố/Np chỉ_có/Np 1/M nút/N lá/N (và/Np một/M nút/N gốc)/Np biểu_diễn/V hậu_tố/Np ./CH\nTại/E bước/V thứ/N ,/CH thuật_toán/N chèn/V hậu_tố/Np vào/E cây/N hậu_tố/Np hiện_tại/N ./CH\nĐể/E chèn/V hậu_tố/Np vào/E cây/N hậu_tố/Np hiện_tại/N ,/CH ta/P sẽ/R :/CH Ví_dụ/C Cây/N hậu/A tối/N khi/N chèn/V và/Cc lần_lượt/R tương_ứng/V với/E trường_hợp/N (I)/Np và/Cc (II)/Np sẽ/R như/C ở/E hình_vẽ/Np sau/E :/CH Giả/A mã/N của/E thuật_toán/N như_sau/Np :/CH Code/Np của/E giả/A mã/N bằng/E C/Ni ./CH\nCode/Np đầy_đủ/A được/V đính/V ở/E cuối/N bài/N ./CH\nTrước_hết/N ta/P phân_tích/V xem/V cây/N hậu_tố/Np ở/E trên/E có/V tối_đa/A bao_nhiêu/P nút/N ./CH\nDễ_dàng/A thấy/V số/N nút/N lá/N của/E cây/N hậu_tố/Np là/V ,/CH bằng/E kích_thước/N của/E văn_bản/N đầu_vào/N ,/CH vì/E mỗi/L nút/N lá/N ứng/V với/E một/M hậu_tố/Np ./CH\nTrong/E quá_trình/N xây_dựng/V cây/N hậu_tố/Np ,/CH một/M nút/N trong/E chỉ/R xuất_hiện/V khi/N chèn/V thêm/V một/M hậu_tố/Np mới/R ./CH\nDo_đó/C ,/CH số/N nút/N trong/E của/E cây/N không_thể/R vượt_quá/Np là/V số/N nút/N lá/N ./CH\nDo_đó/C ,/CH cây/N hậu_tố/Np có/V tối_đa/A nút/N ./CH\nNếu/C biểu_diễn/V con_trỏ/Np tới/E các/L nút/N con/Nc bằng/E mảng/N như/C thực_hiện/V ở/E trên/E ,/CH thì/C cần/V con_trỏ/Np cho/E mỗi/L nút/N trong/E của/E cây/N ./CH\nDo_đó/C ,/CH mỗi/L nút/N chiếm/V bộ_nhớ/Np là/V để/E biểu_diễn/V và/Cc tổng_bộ_nhớ/Np cần/V để/E biểu_diễn/V cây/N là/V ./CH\nTuy_nhiên/C ,/CH nếu/C ta/P biểu_diễn/V con_trỏ/Np tới/E các/L nút/N con/Nc là/V một/M danh_sách/N ,/CH thì/C số_lượng/N con_trỏ/Np của/E tất_cả/P các/L nút/N trong/E không/R lớn/A hơn/A số/N cạnh/N của/E cây/N hậu_tố/Np ./CH\nVì/E cây/N hậu_tố/Np có/V tối_đa/A nút/N ,/CH nó/P sẽ/R có/V tối_đa/A cạnh/N và/Cc do_đó/C số/N con_trỏ/Np đó/P không/R quá/R ./CH\nNhư_vậy/X ,/CH bộ_nhớ/Np để/E biểu_diễn/V cây/N trong/E trường_hợp/N này/P là/V ./CH Về_mặt/Np thời_gian/N ,/CH có_thể/R thấy/V rằng/C thuật_toán/N xây_dựng/V cây/N hậu_tố/Np trong/E bước/V ./CH\nBước/V thứ/N tìm_kiếm/V hậu_tố/Np trong/E cây/N hậu_tố/Np đang/R xây_dựng/V hiện_tại/N ./CH\nBước/V này/P sử_dụng/V (là/Np chiều_dài/N của/E hậu_tố/Np )/CH phép/N so_sánh/V để/E tìm_kiếm/V ./CH\nDo_đó/C ,/CH tổng/N thời_gian/N của/E thuật_toán/N là/V ./CH\nCode/Np của/E giả/A mã/N bằng/E C/Ni :/CH Code/Np của/E giả/A mã/N bằng/E C/Ni :/CH Như/C đã/R nhắc/V đến/E ở/E trên/E ,/CH để/E thực_hiện/V truy_vấn/Np này/P ,/CH với/E mỗi/L nút/N ,/CH chúng_ta/P lưu/V thêm/V một/M trường/N lưu_số/Np lượng/N nút/N lá/N của/E cây_con/Np gốc/N ./CH\nThông_tin/N này/P có_thể/R được/V cập_nhật/V trong/E quá_trình/N xây_dựng/V cây/N mà/C không/R làm/V giảm/V thời_gian/N tiệm_cận/Np xây_dựng/V cây/N ./CH\nCode/Np của/E giả/A mã/N bằng/E C/Ni :/CH Để/E thực_hiện/V truy_vấn/Np này/P ,/CH với/E mỗi/L nút/N ,/CH chúng_ta/P lưu/V thêm/V một/M trường/N lưu/V string/Np depth/Np của/E nút/N ./CH\nThông_tin/N này/P có_thể/R được/V cập_nhật/V trong/E quá_trình/N xây_dựng/V cây/N mà/C không/R làm/V giảm/V thời_gian/N tiệm_cận/Np xây_dựng/V cây/N ./CH\nCode/Np của/E giả/A mã/N bằng/E C/Ni :/CH Code/Np của/E giả/A mã/N bằng/E C/Ni :/CH Code/Np :/CH ./CH\n1/M Weiner/Np ,/CH Peter/Np ./CH\nSwitching/Np and/Np Automata_Theory/Np ,/CH 1973/M ./CH\nSWAT08/Np ./CH\nIEEE_Conference_Record/Np of/E 14th/Np Annual_Symposium/Np on/Np ./CH\nIEEE/Np ,/CH 1973/M ./CH\n2/M Gusfield/Np ,/CH Dan/Np ./CH\n./CH\nCambridge/Np university/Np press/Np ,/CH 1997/M ./CH\n3/M Carl_Kingsford/Np ./CH\n./CH\nCMSC/Np 423/Np ,/CH CMU/Np ./CH\nHậu_tố/Np của/E một/M xâu/Np là/V một/M xâu/Np con/Nc của/E có/V dạng/N với/E là/V một_số/L nào_đó/P thỏa_mãn/V ./CH\nVí_dụ/C thì_là/Np một/M hậu_tố/Np của/E ./CH\nChú_ý/V là/V hậu_tố/Np của/E chính/T nó/P ./CH\nMột/M hậu_tố/Np của/E được/V gọi_là/V một/M hậu_tố/Np riêng/A (proper/Np suffix)/Np nếu/C hậu_tố/Np đó/P khác/A ./CH\n,/CH ,/CH Trackback/Np link/Np :/CH Powered/Np by/Np and/Np\n", "title": "Cây hậu tố -- Suffix Tree\n", "link": "http://www.giaithuatlaptrinh.com/?p=420\n"}