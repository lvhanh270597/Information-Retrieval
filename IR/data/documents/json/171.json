{"content": "Tác_giả : RR_Table of_Contents 1 .\nĐịnh_nghĩa 2 .\nỨng_dụng 1 2 . 1 . Bước 1 2 . 2 . Bước 2 2 . 2 . Bước 3 3 .\nỨng_dụng 2 4 .\nDirichlet_Convolution 4 . 1 . Ví_dụ 1 4 . 2 . Ví_dụ 2 4 . 3 . Các hàm nhân_tính thường gặp 5 .\nTổng_kết Bài luyện_tập Reference_Trong bài viết này , mình sẽ giới_thiệu về hàm nhân_tính cũng_như ứng_dụng của nó trong Competitive_Programming (lập trình thi đấu) .\n1 .\nĐịnh_nghĩa Một hàm f(n) , n \\in N được coi là hàm nhân_tính ( Multiplicative_Function ) nếu : Với mọi cặp số_nguyên_tố cùng_nhau n , m \\in N ta có f(mn)=f(m)f(n) .\nVí_dụ Xét hàm f(n) là số ước của n .\nTa có : f(1) = 1 f(2) = 2 f(3) = 2 f(4) = 3 f(5) = 2 f(6) = 4 = f(2) f(3) f(7) = 2 f(8) = 4 f(9) = 3 f(10) = 4 = f(2) f(5) f(12) = 6 = f(3) f(4) f(18) = 6 = f(2) f(9) Ta có_thể chứng_minh hàm f là hàm nhân_tính như_sau : Xét m và n nguyên_tố cùng_nhau .\nĐể chứng_minh f(m n) = f(m) f(n) , ta cần chứng_minh 2 chiều : Mỗi ước của m n ứng với 1 cặp (a , b) với a là ước của m và b là ước của n .\nĐiều này đúng do mỗi ước của m n ta luôn tách được thành_tích của 2 số a b với a là ước của m và b là ước của n .\nMỗi cặp (a , b) với a là ước của m và b là ước của n ứng với 1 ước của m n .\nĐiều này đúng do với mỗi cặp (a , b) thì a b là ước của m n .\nNhư_vậy , f(m n) = f(m) f(n) .\n2 .\nỨng_dụng 1 Giờ ta xét bài_toán sau : Cho số N không quá 105 .\nTính tất_cả các f(i) với i lt;= N .\nĐể làm những bài dạng này , ta sẽ có 3 bước : Chứng_minh f là hàm nhân_tính .\nTìm công_thức cho f(pk) với p là số_nguyên_tố .\nDùng sàng để tính f trong O(NlogN) .\nNếu bạn chưa biết sàng có_thể đọc ở đây .\n2 . 1 . Bước 1 Như đã chứng_minh ở phần trước , f là hàm nhân_tính .\n2 . 2 . Bước 2 Với một_số nguyên_tố p , ta có f(pk) = k + 1 , do các ước của pk là 1 , p , p2 , . . . , pk .\n2 . 2 . Bước 3 Đầu_tiên , ta dùng sàng để : Biết được số nào_là số_nguyên_tố .\nVới mỗi số_không phải nguyên_tố , tìm được 1 ước nguyên_tố .\nTừ 2 , ta nhanh_chóng kiểm_tra được 1 số có dạng pk hay_không .\nNhư_vậy , ta có_thể cài_đặt như_sau : const int MN = 1e6 + 11 ; int sieve MN ; // Sàng số_nguyên_tố .\nSau khi sàng : // - sievei = 0 nếu i là số_nguyên_tố // - ngược_lại sievei = một ước bất_kỳ của i .\npair lt; int , int gt; pk MN ; // Nếu i có dạng pk , pki = p , k .\n// Ngược_lại , pki = -1 , 0 int ndiv MN ; // ndivi = Số ước của i .\nint main () // Sàng số_nguyên_tố for ( int i = 2 ; i lt;= 1000 ; i ++ ) // số_không nguyên_tố có 1 ước lt;= 103 .\nif ( ! sieve i ) for ( int j = i i ; j lt;= 1000000 ; j += i ) sieve j = i ; ndiv 1 = 1 ; for ( int i = 2 ; i lt;= 1000000 ; i ++ ) if ( ! sieve i ) // i là số_nguyên_tố .\npk i = make_pair ( i , 1 ); ndiv i = 2 ; else int p = sieve i ; // p là ước bất_kỳ của i .\nif ( pk i / p .\nfirst == p ) // i = pk pk i = make_pair ( p , pk i / p .\nsecond + 1 ); ndiv i = pk i .\nsecond + 1 ; // ndivpk = k+1 .\nelse pk i = make_pair ( - 1 , 0 ); // Phân_tích i = uv , với gcd(u , v) = 1 .\nint u = i , v = 1 ; while ( u % p == 0 ) u /= p ; v = v p ; ndiv i = ndiv u ndiv v ; 3 .\nỨng_dụng 2 Ta xét bài_toán sau : Cho số N không quá 1012 .\nTính f(N) Chú_ý ở bài_toán trước_ta cần tính nhiều giá_trị của f(N) với N nhỏ , còn trong bài này ta chỉ_cần tính duy_nhất 1 giá_trị của f(N) với N lớn .\nCũng_như trên , ta sẽ làm_theo 3 bước chính : Chứng_minh f là hàm nhân_tính .\nTìm công_thức cho f(pk) với p là số_nguyên_tố .\nPhân_tích N thành thừa_số nguyê tố để tính f(N) trong O(sqrt(N)) .\nVì 2 bước_đầu giống_hệt phần trước nên mình sẽ không nhắc_lại .\nỞ bước 3 , bạn chỉ_cần xét tất_cả các số_từ 1 đến sqrt(N) , từ_đó phân_tích được thành thừa_số nguyên_tố .\nCode như_sau : int n ; int res = 1 ; // kết_quả for ( int i = 2 ; i i lt;= n ; i ++ ) if ( n % i == 0 ) // i là ước nguyên_tố của n // (nếu i không nguyên_tố , và có ước p , thì ở bước trước đó , // ta đã chia n cho p đến khi n không chia_hết_cho p) .\nint u = 1 , k = 0 ; // u = ik là luỹ_thừa lớn nhất của i mà là ước của n .\nwhile ( n % i == 0 ) n /= i ; u = u i ; k += 1 ; res = res ( k + 1 ); if ( n gt; 1 ) // giá_trị hiện_tại của n là số_nguyên_tố res = res 2 ; 4 .\nDirichlet_Convolution_Việc chứng_minh trực_tiếp một hàm là hàm nhân_tính như ví_dụ về hàm_số ước ở trên không_hề đơn_giản .\nChẳng_hạn , bạn hãy thử chứng_minh hàm f(n) là hàm nhân_tính với f(n) là tổng_các ước của số n .\nDĩ_nhiên bạn có_thể chứng_minh trâu_bò bằng cách viết ra một đống công_thức , tuy_nhiên ở mục này mình sẽ hướng_dẫn các bạn một phương_pháp kỳ_diệu hơn .\nVới 2 hàm f và g là hàm nhân_tính , ta có_một hàm nhân_tính mới f g : (f g)(n) = \\sum_d_1d_2=nf(d_1)g(d_2) Một_cách biểu_diễn khác là : (f g)(n) = \\sum_d nf(d)g(n/d) Các bạn chú_ý kí_hiệu d n nghĩa_là n chia_hết_cho d .\nChứng_minh Xét a và b nguyên_tố cùng_nhau .\nMỗi ước d của ab có_thể phân_tích duy_nhất dưới dạng d = rs trong đó r a và s b , do gcd(a , b) = 1 .\nDo_đó : (f g)(ab) = \\sum_ra , sbf(rs) g(ab/rs) = \\sum_ra , sbf(r) f(s) g(a/r) g(b/s) = \\sum_raf(r) g(a/r) \\sum_sbf(s) g(b/s) = (f g)(a) (f g)(b) Như_vậy , (f g) cũng là hàm nhân_tính .\nĐể hiểu thêm về Dirichlet_Convolution , ta xét vài ví_dụ : 4 . 1 . Ví_dụ 1 Xét hàm f(n) = 1 và g(n) = 1 .\nRõ_ràng f và g đều là hàm nhân_tính .\n(f g)(n) = \\sum_d nf(d) g(n/d) = \\sum_d n1 Như_vậy (f g)(n) là số ước của số n và là hàm nhân_tính .\n4 . 2 . Ví_dụ 2 Xét hàm f(n) = n và g(n) = 1 .\nRõ_ràng f và g đều là hàm nhân_tính .\n(f g)(n) = \\sum_d nf(d) g(n/d) = \\sum_d nd Như_vậy (f g)(n) là tổng_các ước của n và là hàm nhân_tính .\nTổng_quát hơn , với hằng_số k bất_kỳ , hàm f(n) = \\sum_d ndk là hàm nhân_tính .\n4 . 3 . Các hàm nhân_tính thường gặp Sau_đây là các hàm nhân_tính thường gặp .\nBạn có_thể thử chứng_minh những hàm này là hàm nhân_tính dựa theo định_nghĩa hoặc Dirichlet_Convolution .\nViệc nắm được những hàm này sẽ giúp thuận_lợi hơn trong việc gỉai những bài liên_quan đến hàm nhân_tính .\nI(n) = 1 , hàm f luôn bằng 1 với tất_cả các giá_trị của n .\nid(n) = n id_k(n) = nk gcd(n , k) với k là hằng_số phi(n) : số số_nguyên_tố cùng_nhau với n và nhỏ hơn hoặc bằng n (Phi hàm Euler) mobius(n) : Hàm mobius thường được dùng trong các bài_toán đếm sử_dụng nguyên_lý bù_trừ : Nếu n có ước là số chính_phương khác 1 , mobius(n) = 0 .\nNếu n có lẻ ước nguyên_tố , mobius(n) = -1 .\nNếu n có chẵn ước nguyên_tố , mobius(n) = 1 .\nChú_ý mobius(1) = 1 .\nf(n) = \\sum_d nd là tổng_các ước của n .\nf_k(n) = \\sum_d ndk với k là hằng_số .\n5 .\nTổng_kết Như_vậy , nếu bạn chứng_minh được một hàm f là hàm nhân_tính , và tìm được công_thức O(1) cho f(pk) thì sẽ dễ_dàng tính được tất_cả các giá_trị f(i) , i \\le N trong O(NlogN) .\nBạn cũng_nên nắm được những hàm nhân_tính thường gặp , từ_đó giúp nhận_dạng bài_toán dễ_dàng hơn .\nBài luyện_tập VOJ - GCDSUM Gợi_ý : Xét f(n) = \\sum_1 \\le i \\le ngcd(n , i) .\nCF 391 - E Gợi_ý : Tìm cách bỏ phép_cộng trong công_thức của f_r(n) .\nCF 400 - E_Reference_Wikipedia\n", "tagged": "Tác_giả/N :/CH RR_Table/Np of_Contents/Np 1/M ./CH\nĐịnh_nghĩa/N 2/M ./CH\nỨng_dụng/V 1/M 2/M ./CH 1/M ./CH Bước/V 1/M 2/M ./CH 2/M ./CH Bước/V 2/M 2/M ./CH 2/M ./CH Bước/V 3/M 3/M ./CH\nỨng_dụng/V 2/M 4/M ./CH\nDirichlet_Convolution/Np 4/M ./CH 1/M ./CH Ví_dụ/C 1/M 4/M ./CH 2/M ./CH Ví_dụ/C 2/M 4/M ./CH 3/M ./CH Các/L hàm/Np nhân_tính/Np thường/R gặp/V 5/M ./CH\nTổng_kết/V Bài/N luyện_tập/V Reference_Trong/Np bài/N viết/V này/P ,/CH mình/P sẽ/R giới_thiệu/V về/E hàm/Np nhân_tính/Np cũng_như/C ứng_dụng/V của/E nó/P trong/E Competitive_Programming/Np (lập/Np trình/V thi/V đấu)/Np ./CH\n1/M ./CH\nĐịnh_nghĩa/N Một/M hàm/Np f(n)/Np ,/CH n/Ny \\in/Np N/Ny được/V coi/V là/V hàm/Np nhân_tính/Np (/CH Multiplicative_Function/Np )/CH nếu/C :/CH Với/E mọi/L cặp/N số_nguyên_tố/Np cùng_nhau/Np n/Ny ,/CH m/Nu \\in/Np N/Ny ta/P có/V f(mn)=f(m)f(n)/Np ./CH\nVí_dụ/C Xét/V hàm/Np f(n)/Np là/V số/N ước/V của/E n/Ny ./CH\nTa/P có/V :/CH f(1)/Np =/CH 1/M f(2)/Np =/CH 2/M f(3)/Np =/CH 2/M f(4)/Np =/CH 3/M f(5)/Np =/CH 2/M f(6)/Np =/CH 4/M =/CH f(2)/Np f(3)/Np f(7)/Np =/CH 2/M f(8)/Np =/CH 4/M f(9)/Np =/CH 3/M f(10)/Np =/CH 4/M =/CH f(2)/Np f(5)/Np f(12)/Np =/CH 6/M =/CH f(3)/Np f(4)/Np f(18)/Np =/CH 6/M =/CH f(2)/Np f(9)/Np Ta/P có_thể/R chứng_minh/V hàm/Np f/Np là/V hàm/Np nhân_tính/Np như_sau/Np :/CH Xét/V m/Nu và/Cc n/Ny nguyên_tố/N cùng_nhau/Np ./CH\nĐể/E chứng_minh/V f(m/Np n)/Np =/CH f(m)/Np f(n)/Np ,/CH ta/P cần/V chứng_minh/V 2/M chiều/N :/CH Mỗi/L ước/V của/E m/Nu n/Ny ứng/V với/E 1/M cặp/N (a/Np ,/CH b)/Np với/E a/Ni là/V ước/V của/E m/Nu và/Cc b/Ni là/V ước/V của/E n/Ny ./CH\nĐiều/N này/P đúng/A do/E mỗi/L ước/V của/E m/Nu n/Ny ta/P luôn/R tách/V được/V thành_tích/N của/E 2/M số/N a/Ni b/Ni với/E a/Ni là/V ước/V của/E m/Nu và/Cc b/Ni là/V ước/V của/E n/Ny ./CH\nMỗi/L cặp/N (a/Np ,/CH b)/Np với/E a/Ni là/V ước/V của/E m/Nu và/Cc b/Ni là/V ước/V của/E n/Ny ứng/V với/E 1/M ước/V của/E m/Nu n/Ny ./CH\nĐiều/N này/P đúng/A do/E với/E mỗi/L cặp/N (a/Np ,/CH b)/Np thì/C a/Ni b/Ni là/V ước/V của/E m/Nu n/Ny ./CH\nNhư_vậy/X ,/CH f(m/Np n)/Np =/CH f(m)/Np f(n)/Np ./CH\n2/M ./CH\nỨng_dụng/V 1/M Giờ/N ta/P xét/V bài_toán/N sau/E :/CH Cho/E số/N N/Ny không/R quá/R 105/Np ./CH\nTính/V tất_cả/P các/L f(i)/Np với/E i/M lt;=/Np N/Ny ./CH\nĐể/E làm/V những/L bài/N dạng/N này/P ,/CH ta/P sẽ/R có/V 3/M bước/V :/CH Chứng_minh/V f/Np là/V hàm/Np nhân_tính/Np ./CH\nTìm/V công_thức/N cho/E f(pk)/Np với/E p/Ny là/V số_nguyên_tố/Np ./CH\nDùng/V sàng/Np để/E tính/V f/Np trong/E O(NlogN)/Np ./CH\nNếu/C bạn/N chưa/R biết/V sàng/Np có_thể/R đọc/V ở/E đây/P ./CH\n2/M ./CH 1/M ./CH Bước/V 1/M Như/C đã/R chứng_minh/V ở/E phần/N trước/E ,/CH f/Np là/V hàm/Np nhân_tính/Np ./CH\n2/M ./CH 2/M ./CH Bước/V 2/M Với/E một_số/L nguyên_tố/N p/Ny ,/CH ta/P có/V f(pk)/Np =/CH k/N +/CH 1/M ,/CH do/E các/L ước/V của/E pk/Nu là/V 1/M ,/CH p/Ny ,/CH p2/Np ,/CH ./CH ./CH ./CH ,/CH pk/Nu ./CH\n2/M ./CH 2/M ./CH Bước/V 3/M Đầu_tiên/A ,/CH ta/P dùng/V sàng/Np để/E :/CH Biết/V được/V số/N nào_là/T số_nguyên_tố/Np ./CH\nVới/E mỗi/L số_không/Np phải/V nguyên_tố/N ,/CH tìm/V được/V 1/M ước/V nguyên_tố/N ./CH\nTừ/E 2/M ,/CH ta/P nhanh_chóng/A kiểm_tra/V được/V 1/M số/N có/V dạng/N pk/Nu hay_không/Np ./CH\nNhư_vậy/X ,/CH ta/P có_thể/R cài_đặt/V như_sau/Np :/CH const/Np int/Np MN/Np =/CH 1e6/Np +/CH 11/M ;/CH int/Np sieve/Np MN/Np ;/CH //CH Sàng/Np số_nguyên_tố/Np ./CH\nSau/E khi/N sàng/Np :/CH //CH -/CH sievei/Np =/CH 0/M nếu/C i/M là/V số_nguyên_tố/Np //CH -/CH ngược_lại/X sievei/Np =/CH một/M ước/V bất_kỳ/A của/E i/M ./CH\npair/Np lt;/Np int/Np ,/CH int/Np gt;/Np pk/Nu MN/Np ;/CH //CH Nếu/C i/M có/V dạng/N pk/Nu ,/CH pki/Np =/CH p/Ny ,/CH k/N ./CH\n//CH Ngược_lại/X ,/CH pki/Np =/CH -1/Np ,/CH 0/M int/Np ndiv/Np MN/Np ;/CH //CH ndivi/Np =/CH Số/N ước/V của/E i/M ./CH\nint/Np main/Np ()/Np //CH Sàng/Np số_nguyên_tố/Np for/Np (/CH int/Np i/M =/CH 2/M ;/CH i/M lt;=/Np 1000/M ;/CH i/M ++/Np )/CH //CH số_không/Np nguyên_tố/N có/V 1/M ước/V lt;=/Np 103/M ./CH\nif/Np (/CH !/CH sieve/Np i/M )/CH for/Np (/CH int/Np j/Np =/CH i/M i/M ;/CH j/Np lt;=/Np 1000000/Np ;/CH j/Np +=/Np i/M )/CH sieve/Np j/Np =/CH i/M ;/CH ndiv/Np 1/M =/CH 1/M ;/CH for/Np (/CH int/Np i/M =/CH 2/M ;/CH i/M lt;=/Np 1000000/Np ;/CH i/M ++/Np )/CH if/Np (/CH !/CH sieve/Np i/M )/CH //CH i/M là/V số_nguyên_tố/Np ./CH\npk/Nu i/M =/CH make_pair/Np (/CH i/M ,/CH 1/M );/CH ndiv/Np i/M =/CH 2/M ;/CH else/Np int/Np p/Ny =/CH sieve/Np i/M ;/CH //CH p/Ny là/V ước/V bất_kỳ/A của/E i/M ./CH\nif/Np (/CH pk/Nu i/M //CH p/Ny ./CH\nfirst/Np ==/Np p/Ny )/CH //CH i/M =/CH pk/Nu pk/Nu i/M =/CH make_pair/Np (/CH p/Ny ,/CH pk/Nu i/M //CH p/Ny ./CH\nsecond/Np +/CH 1/M );/CH ndiv/Np i/M =/CH pk/Nu i/M ./CH\nsecond/Np +/CH 1/M ;/CH //CH ndivpk/Np =/CH k+1/Np ./CH\nelse/Np pk/Nu i/M =/CH make_pair/Np (/CH -/CH 1/M ,/CH 0/M );/CH //CH Phân_tích/V i/M =/CH uv/Np ,/CH với/E gcd(u/Np ,/CH v)/Np =/CH 1/M ./CH\nint/Np u/N =/CH i/M ,/CH v/Nu =/CH 1/M ;/CH while/Np (/CH u/N %/CH p/Ny ==/Np 0/M )/CH u/N /=/Np p/Ny ;/CH v/Nu =/CH v/Nu p/Ny ;/CH ndiv/Np i/M =/CH ndiv/Np u/N ndiv/Np v/Nu ;/CH 3/M ./CH\nỨng_dụng/V 2/M Ta/P xét/V bài_toán/N sau/E :/CH Cho/E số/N N/Ny không/R quá/R 1012/Np ./CH\nTính/V f(N)/Np Chú_ý/V ở/E bài_toán/N trước_ta/Np cần/V tính/V nhiều/A giá_trị/N của/E f(N)/Np với/E N/Ny nhỏ/A ,/CH còn/R trong/E bài/N này/P ta/P chỉ_cần/Np tính/V duy_nhất/A 1/M giá_trị/N của/E f(N)/Np với/E N/Ny lớn/A ./CH\nCũng_như/C trên/E ,/CH ta/P sẽ/R làm_theo/Np 3/M bước/V chính/T :/CH Chứng_minh/V f/Np là/V hàm/Np nhân_tính/Np ./CH\nTìm/V công_thức/N cho/E f(pk)/Np với/E p/Ny là/V số_nguyên_tố/Np ./CH\nPhân_tích/V N/Ny thành/V thừa_số/Np nguyê/Np tố/N để/E tính/V f(N)/Np trong/E O(sqrt(N))/Np ./CH\nVì/E 2/M bước_đầu/N giống_hệt/A phần/N trước/E nên/C mình/P sẽ/R không/R nhắc_lại/Np ./CH\nỞ/E bước/V 3/M ,/CH bạn/N chỉ_cần/Np xét/V tất_cả/P các/L số_từ/Np 1/M đến/E sqrt(N)/Np ,/CH từ_đó/Np phân_tích/V được/V thành/V thừa_số/Np nguyên_tố/N ./CH\nCode/Np như_sau/Np :/CH int/Np n/Ny ;/CH int/Np res/Np =/CH 1/M ;/CH //CH kết_quả/N for/Np (/CH int/Np i/M =/CH 2/M ;/CH i/M i/M lt;=/Np n/Ny ;/CH i/M ++/Np )/CH if/Np (/CH n/Ny %/CH i/M ==/Np 0/M )/CH //CH i/M là/V ước/V nguyên_tố/N của/E n/Ny //CH (nếu/Np i/M không/R nguyên_tố/N ,/CH và/Cc có/V ước/V p/Ny ,/CH thì/C ở/E bước/V trước/E đó/P ,/CH //CH ta/P đã/R chia/V n/Ny cho/E p/Ny đến/E khi/N n/Ny không/R chia_hết_cho/Np p)/Np ./CH\nint/Np u/N =/CH 1/M ,/CH k/N =/CH 0/M ;/CH //CH u/N =/CH ik/Np là/V luỹ_thừa/Np lớn/A nhất/A của/E i/M mà/C là/V ước/V của/E n/Ny ./CH\nwhile/Np (/CH n/Ny %/CH i/M ==/Np 0/M )/CH n/Ny /=/Np i/M ;/CH u/N =/CH u/N i/M ;/CH k/N +=/Np 1/M ;/CH res/Np =/CH res/Np (/CH k/N +/CH 1/M );/CH if/Np (/CH n/Ny gt;/Np 1/M )/CH //CH giá_trị/N hiện_tại/N của/E n/Ny là/V số_nguyên_tố/Np res/Np =/CH res/Np 2/M ;/CH 4/M ./CH\nDirichlet_Convolution_Việc/Np chứng_minh/V trực_tiếp/A một/M hàm/Np là/V hàm/Np nhân_tính/Np như/C ví_dụ/C về/E hàm_số/Np ước/V ở/E trên/E không_hề/Np đơn_giản/A ./CH\nChẳng_hạn/X ,/CH bạn/N hãy/R thử/V chứng_minh/V hàm/Np f(n)/Np là/V hàm/Np nhân_tính/Np với/E f(n)/Np là/V tổng_các/Np ước/V của/E số/N n/Ny ./CH\nDĩ_nhiên/A bạn/N có_thể/R chứng_minh/V trâu_bò/N bằng/E cách/N viết/V ra/V một/M đống/N công_thức/N ,/CH tuy_nhiên/C ở/E mục/N này/P mình/P sẽ/R hướng_dẫn/V các/L bạn/N một/M phương_pháp/N kỳ_diệu/A hơn/A ./CH\nVới/E 2/M hàm/Np f/Np và/Cc g/Nu là/V hàm/Np nhân_tính/Np ,/CH ta/P có_một/Np hàm/Np nhân_tính/Np mới/R f/Np g/Nu :/CH (f/Np g)(n)/Np =/CH \\sum_d_1d_2=nf(d_1)g(d_2)/Np Một_cách/N biểu_diễn/V khác/A là/V :/CH (f/Np g)(n)/Np =/CH \\sum_d/Np nf(d)g(n/Np Các/L bạn/N chú_ý/V kí_hiệu/Np d/Ny n/Ny nghĩa_là/V n/Ny chia_hết_cho/Np d/Ny ./CH\nChứng_minh/V Xét/V a/Ni và/Cc b/Ni nguyên_tố/N cùng_nhau/Np ./CH\nMỗi/L ước/V d/Ny của/E ab/Np có_thể/R phân_tích/V duy_nhất/A dưới/E dạng/N d/Ny =/CH rs/Np trong/E đó/P r/Np a/Ni và/Cc s/Y b/Ni ,/CH do/E gcd(a/Np ,/CH b)/Np =/CH 1/M ./CH\nDo_đó/C :/CH (f/Np g)(ab)/Np =/CH \\sum_ra/Np ,/CH sbf(rs)/Np g(ab/Np =/CH \\sum_ra/Np ,/CH sbf(r)/Np f(s)/Np g(a/Np g(b/Np =/CH \\sum_raf(r)/Np g(a/Np \\sum_sbf(s)/Np g(b/Np =/CH (f/Np g)(a)/Np (f/Np g)(b)/Np Như_vậy/X ,/CH (f/Np g)/Np cũng/R là/V hàm/Np nhân_tính/Np ./CH\nĐể/E hiểu/V thêm/V về/E Dirichlet_Convolution/Np ,/CH ta/P xét/V vài/L ví_dụ/C :/CH 4/M ./CH 1/M ./CH Ví_dụ/C 1/M Xét/V hàm/Np f(n)/Np =/CH 1/M và/Cc g(n)/Np =/CH 1/M ./CH\nRõ_ràng/A f/Np và/Cc g/Nu đều/R là/V hàm/Np nhân_tính/Np ./CH\n(f/Np g)(n)/Np =/CH \\sum_d/Np nf(d)/Np g(n/Np =/CH \\sum_d/Np n1/Np Như_vậy/X (f/Np g)(n)/Np là/V số/N ước/V của/E số/N n/Ny và/Cc là/V hàm/Np nhân_tính/Np ./CH\n4/M ./CH 2/M ./CH Ví_dụ/C 2/M Xét/V hàm/Np f(n)/Np =/CH n/Ny và/Cc g(n)/Np =/CH 1/M ./CH\nRõ_ràng/A f/Np và/Cc g/Nu đều/R là/V hàm/Np nhân_tính/Np ./CH\n(f/Np g)(n)/Np =/CH \\sum_d/Np nf(d)/Np g(n/Np =/CH \\sum_d/Np nd/Np Như_vậy/X (f/Np g)(n)/Np là/V tổng_các/Np ước/V của/E n/Ny và/Cc là/V hàm/Np nhân_tính/Np ./CH\nTổng_quát/Np hơn/A ,/CH với/E hằng_số/Np k/N bất_kỳ/A ,/CH hàm/Np f(n)/Np =/CH \\sum_d/Np ndk/Np là/V hàm/Np nhân_tính/Np ./CH\n4/M ./CH 3/M ./CH Các/L hàm/Np nhân_tính/Np thường/R gặp/V Sau_đây/Np là/V các/L hàm/Np nhân_tính/Np thường/R gặp/V ./CH\nBạn/N có_thể/R thử/V chứng_minh/V những/L hàm/Np này/P là/V hàm/Np nhân_tính/Np dựa/V theo/V định_nghĩa/N hoặc/Cc Dirichlet_Convolution/Np ./CH\nViệc/N nắm/V được/V những/L hàm/Np này/P sẽ/R giúp/V thuận_lợi/N hơn/A trong/E việc/N gỉai/Np những/L bài/N liên_quan/V đến/E hàm/Np nhân_tính/Np ./CH\nI(n)/Np =/CH 1/M ,/CH hàm/Np f/Np luôn/R bằng/E 1/M với/E tất_cả/P các/L giá_trị/N của/E n/Ny ./CH\nid(n)/Np =/CH n/Ny id_k(n)/Np =/CH nk/Np gcd(n/Np ,/CH k)/Np với/E k/N là/V hằng_số/Np phi(n)/Np :/CH số/N số_nguyên_tố/Np cùng_nhau/Np với/E n/Ny và/Cc nhỏ/A hơn/A hoặc/Cc bằng/E n/Ny (Phi/Np hàm/Np Euler)/Np mobius(n)/Np :/CH Hàm/Np mobius/Np thường/R được/V dùng/V trong/E các/L bài_toán/N đếm/V sử_dụng/V nguyên_lý/Np bù_trừ/Np :/CH Nếu/C n/Ny có/V ước/V là/V số/N chính_phương/Np khác/A 1/M ,/CH mobius(n)/Np =/CH 0/M ./CH\nNếu/C n/Ny có/V lẻ/A ước/V nguyên_tố/N ,/CH mobius(n)/Np =/CH -1/Np ./CH\nNếu/C n/Ny có/V chẵn/Np ước/V nguyên_tố/N ,/CH mobius(n)/Np =/CH 1/M ./CH\nChú_ý/V mobius(1)/Np =/CH 1/M ./CH\nf(n)/Np =/CH \\sum_d/Np nd/Np là/V tổng_các/Np ước/V của/E n/Ny ./CH\nf_k(n)/Np =/CH \\sum_d/Np ndk/Np với/E k/N là/V hằng_số/Np ./CH\n5/M ./CH\nTổng_kết/V Như_vậy/X ,/CH nếu/C bạn/N chứng_minh/V được/V một/M hàm/Np f/Np là/V hàm/Np nhân_tính/Np ,/CH và/Cc tìm/V được/V công_thức/N O(1)/Np cho/E f(pk)/Np thì/C sẽ/R dễ_dàng/A tính/V được/V tất_cả/P các/L giá_trị/N f(i)/Np ,/CH i/M \\le/Np N/Ny trong/E O(NlogN)/Np ./CH\nBạn/N cũng_nên/Np nắm/V được/V những/L hàm/Np nhân_tính/Np thường/R gặp/V ,/CH từ_đó/Np giúp/V nhận_dạng/Np bài_toán/N dễ_dàng/A hơn/A ./CH\nBài/N luyện_tập/V VOJ/Np -/CH GCDSUM/Np Gợi_ý/V :/CH Xét/V f(n)/Np =/CH \\sum_1/Np \\le/Np i/M \\le/Np ngcd(n/Np ,/CH i)/Np ./CH\nCF/Np 391/M -/CH E/Ni Gợi_ý/V :/CH Tìm/V cách/N bỏ/V phép_cộng/Np trong/E công_thức/N của/E f_r(n)/Np ./CH\nCF/Np 400/M -/CH E_Reference_Wikipedia/Np\n", "title": "Hàm nhân tính\n", "link": "http://vnoi.info/wiki/algo/math/multiplicative-function\n"}