{"content": "Table of_Contents Mở_đầu Ví_dụ 1 Ví_dụ 2 Ví_dụ 3 Ví_dụ 4 Phép_toán kết_hợp và độ phức_tạp tính_toán Nhân tổ_hợp dãy ma_trận Giải_thuật Freivalds kiểm_tra tích hai ma_trận Bài_tập áp_dụng Tác_giả : Nguyễn_RR Thành_Trung , Nguyễn_Mạnh_Quân Mở_đầu Thông_thường , để đạt được độ phức_tạp thuật_toán như mong_muốn , cách làm thường là tìm_ra một thuật_toán ban_đầu làm cơ_sở , rồi từ_đó dùng các kỹ_năng để giảm độ phức_tạp của thuật_toán .\nTrong bài viết này , tôi xin giới_thiệu với bạn_đọc một kỹ_năng khá thông_dụng : nhân ma_trận .\nTrước_khi đọc_bài viết này , nếu bạn chưa có khái_niệm gì về ma_trận , bạn có_thể tham_khảo định_nghĩa về ma_trận trong một tài_liệu khác .\nTrước_hết , tôi xin nhắc_lại tóm_tắt khái_niệm về phép_nhân ma_trận : Cho 2 ma_trận : A kích_thước M_N và B kích_thước N_P .\n(chú ý số cột của ma_trận A phải bằng số hàng của ma_trận B thì mới có_thể thực_hiện phép nhân) .\nKết_quả phép_nhân ma_trận A và B là ma_trận C kích_thước M_P , với mỗi phần_tử của ma_trận C được tính theo công_thức : C(i , j) = \\sumA(i , k) B(k , j) Để thực_hiện phép_nhân ma_trận trên máy_tính , ta có_thể thực_hiện thuật_toán với độ phức_tạp \\mathcalO(M N_P) như_sau : for i : = 1 to M do for j : = 1 to P do begin C i , j : = 0 ; for k : = 1 to N do C i , j : = C i , j + A i , k B k , j ; end ; Đối_với phép_nhân các ma_trận vuông kích_thước N_N , có thuật_toán nhân ma_trận Strassen với độ phức_tạp \\mathcalO(N\\log7) theo tư_tưởng chia_nhỏ ma_trận (tương tự cách nhân nhanh 2 số lớn)) .\nTuy_nhiên cài_đặt rất phức_tạp và trên thực_tế với giá_trị_N thường gặp , cách này không chạy nhanh hơn nhân ma_trận thông_thường \\mathcalO(N3) .\nCần chú_ý thêm là phép_nhân ma_trận không có tính_giao hoán (do có_thể thực_hiện nhân 2 ma_trận A kích_thước M_N và ma_trận B kích_thước N_P nhưng không_thể thực_hiện phép_nhân B_A nếu P \\ne M) .\nTuy_nhiên , nhân ma_trận lại có tính kết_hợp : (A B)_C = A (B C) Ví_dụ 1 Chúng_ta hãy cùng xem_xét một ví_dụ kinh_điển nhất trong ứng_dụng của phép_nhân ma_trận .\nBài_toán Dãy_Fibonacci được định_nghĩa như_sau : F(0) = 1 F(1) = 1 . . .\nF(i) = F(i-1) + F(i-2) , i gt;= 2 Yêu_cầu : Cho_N (N \\le 109) , tính F(N) .\nBạn có_thể nộp bài thử ở VNOI - LATGACH4 .\nPhân_tích Hiển_nhiên cách làm thông_thường là tính lần_lượt các F(j) .\nTuy_nhiên , cách làm này hoàn_toàn không hiệu_quả với N lên đến 109 , và ta cần một_cách tiếp_cận khác .\nTa xét các lớp số : Lớp 1 : F(1) , F(2)_Lớp 2 : F(2) , F(3) . . .\nLớp i : F(i) , F(i+1)_Ta hình_dung mỗi lớp là một ma_trận 1x2 .\nTiếp đó , ta sẽ biến_đổi từ lớp i-1 đến lớp i .\nSau mỗi lần biến_đổi như_vậy , ta tính thêm được một giá_trị F(i+1) .\nĐể thực_hiện phép biến_đổi này , chú_ý là các số ở lớp sau chỉ phụ_thuộc vào lớp ngay trước nó theo các phép_cộng , ta tìm được cách biến_đổi bằng nhân ma_trận : Chắc_hẳn đọc đến đây bạn_đọc sẽ thắc_mắc , làm thế_nào để tìm được ma_trận trên ?\nĐể tìm được ma_trận này , ta làm như_sau : Ta có : F(i) = 0 F(i-1) + 1 F(i) , do_đó hàng_đầu của ma_trận là 0 , 1 F(i+1) = 1 F(i-1) + 1 F(i) , do_đó hàng thứ 2 của ma_trận là 1 , 1 Bây_giờ ta sẽ cần tìm cách tăng_tốc việc tính 0 , 1; 1 , 1T ( ) .\nViệc tính nhanh ( ) cũng hoàn_toàn tương_tự việc_ta tính aT với a là số_nguyên .\nSau_đây là đoạn code minh_hoạ .\nTrong đoạn code này , để bạn_đọc dễ_hiểu , tôi bỏ_qua yếu_tố về tính_toán số_lớn , và thực_hiện các phép_tính với kiểu số 32-bit .\ntype matrix = array 0 . . 1 , 0 . . 1 of longint ; const a : matrix =(( 0 , 1 ) , ( 1 , 1 )); //Định nghĩa phép_nhân 2 ma_trận operator ( a , b : matrix ) c : matrix ; var i , j , k : longint ; begin fillchar ( c , sizeof ( c ) , 0 ); for i : = 0 to 1 do for j : = 0 to 1 do for k : = 0 to 1 do c i , j : = c i , j + a i , k b k , j ; end ; //Tính an function power ( n : longint ) : matrix ; var temp : matrix ; begin if n = 1 then exit ( a ); temp : = power ( n div 2 ); temp : = temp temp ; if n mod 2 = 1 then temp : = temp a ; exit ( temp ); end ; Ví_dụ 2 Bây_giờ chúng_ta sẽ cùng xem_xét một ví_dụ tổng_quát hơn của ví_dụ 1 .\nBài_toán : SPOJ - SEQ_Cho số_nguyên N (N \\le 100) và 2 dãy_số độ_dài N : a_1 , a_2 , . . . , a_N; b_1 , b_2 , . . . , b_N .\nDãy_số c được định_nghĩa như_sau : c_i = a_i với i \\le N c_i = c_i-1 b_1 + c_i-2 b_2 + . . .\n+ c_i-N b_N Yêu_cầu : Tính c_k với k \\le 109 .\nPhân_tích Cũng_như trong ví_dụ 1 , ta xét các lớp số : Lớp 1 : c_1 , c_2 , . . . , c_N Lớp 2 : c_2 , c_3 , . . . , c_N+1 . . .\nLớp i : c_i , c_i+1 , . . . , c_i+N-1 Ta cũng sẽ áp_dụng phép_nhân ma_trận để biến_đổi từ lớp i sang lớp i+1 như_sau : Để xây_dựng ma_trận vuông như_trên , ta thực_hiện tương_tự như trong ví_dụ trước : Phân_tích a_i+1 đến a_i+N dưới dạng a_i , . . . , a_i+N-1 : a_i+1 = 0 a_i + 1 a_i+1 + . . .\n+ 0 a_i+N-1 nên hàng 1 là 0 , 1 , 0 , . . . . , 0 . . .\na_i+N-1 = 0 a_i + 0 a_i+1 + . . .\n+ 1 a_i+N-1 nên hàng N-1 là 0 , 0 , 0 , . . . , 1 a_i+N = b_N a_i + b_N-1 a_i+1 + . . .\n+ b_1 a_i+N-1 nên hàng N là b_N , b_N-1 , . . . , b_1 Từ_đó , ta thu được cách làm như trong ví_dụ 1 .\nCài_đặt cụ_thể xin nhường_lại cho bạn_đọc .\nChú_ý rằng ta hoàn_toàn có_thể thay_thế phép_nhân và phép_cộng trong định_nghĩa phép_nhân ma_trận , chỉ_cần đảm_bảo giữ_nguyên tính_chất kết_hợp .\nCụ_thể hơn , thay_vì C(i , j) = \\sumA(i , k) B(k , j) , ta có_thể định_nghĩa phép_nhân ma_trận : C(i , j) = min(A(i , k) + B(k , j)) .\nTừ_đó , ta có_thể thu được một lớp các bài_toán khác .\nSau_đây là một ví_dụ minh_hoạ cho nhóm các bài_toán này Ví_dụ 3 Bài_toán Cho đồ_thị có hướng N đỉnh (N \\le 100) .\nTính ma_trận C(k) kích_thước N_N , với C(k) i , j là độ_dài đường_đi ngắn nhất từ i đến j đi_qua đúng k cạnh Phân_tích Xét ma_trận A là ma_trận kề của đồ_thị đã cho .\nTa có : A = C(1)_C(2)i , j = \\minAi , u + Au , j với u chạy từ 1 đến N_C(k)i , j = \\minC(k-1)i , u + Au , j với u chạy từ 1 đến N Như_vậy , nếu ta thay phép_nhân và phép_cộng trong việc nhân ma_trận thông_thường lần_lượt bởi phép_cộng và phép lấy min , ta thu được một_phép ”nhân ma trận” mới , tạm dùng ký_hiệu x , thì : C1 = A_C2 = C1 x C1 = A x C1_C3 = C1 x C2 = A x C2_C4 = C1 x C3 = A x C3 . . .\nCk = C1 x C(k-1) = A x C(k-1) Do_đó , C(k) = Ak Như_vậy , bài_toán được đưa về bài_toán tính lũy_thừa của một ma_trận , ta hoàn_toàn có_thể giải tương_tự các ví_dụ trước .\nCài_đặt phép_nhân ma_trận mới này hoàn_toàn không phức_tạp hơn cài_đặt phép_nhân ma_trận thông_thường .\nViệc cài_đặt xin nhường_lại cho bạn_đọc .\nVí_dụ 4 VOJ - THBAC Bài_toán Người_ta mới tìm_ra một loại vi_khuẩn mới .\nChúng sống thành N bầy (N \\le 100) , đánh_số từ 0 đến N-1 .\nBan_đầu , mỗi bầy này chỉ_có một con vi_khuẩn .\nTuy_nhiên , mỗi giây , số_lượng vi_khuẩn trong các bầy lại có sự thay_đổi .\nVí_dụ : một bầy có_thể bị chết đi số_lượng vi_khuẩn trong một bầy có_thể tăng lên một bầy có_thể di_chuyển vị_trí .\nCác thay_đổi này tuân theo một_số quy_luật cho trước .\nTại mỗi giây chỉ xảy_ra đúng một quy_luật .\nCác quy_luật này được thực_hiện nối_tiếp nhau và theo chu_kỳ .\nCó_nghĩa là , nếu đánh_số các quy_luật từ 0 đến M-1 , tại giây thứ S thì quy_luật được áp_dụng sẽ là (S-1) \\space mod \\space M (M \\le 1000) Nhiệm_vụ của bạn là tìm xem , với một bộ các quy_luật cho trước , sau T đơn_vị thời_gian (T \\le 1018) , mỗi bầy có bao_nhiêu vi_khuẩn .\nCác loại quy_luật có_thể có : A i 0 : Tất_cả các vi_khuẩn thuộc bầy i chết .\nB i k : Số vi_khuẩn trong bầy i tăng lên k lần .\nC i j : số vi_khuẩn bầy thứ i tăng lên một_số lượng bằng với số vi_khuẩn bầy j .\nD i j : Các vi_khuẩn thuộc bầy j di_chuyển toàn_bộ sang bầy i .\nE i j : Các vi_khuẩn thuộc bầy i và bầy j đổi vị_trí cho nhau .\nF 0 0 : Vị_trí các vi_khuẩn di_chuyển trên vòng_tròn .\nPhân_tích Cách làm đơn_giản nhất_là chúng_ta mô_phỏng lại số_lượng vi_khuẩn trong mỗi bầy qua từng đơn_vị thời_gian .\nCách làm này có độ phức_tạp \\mathcalO(T N k) với \\mathcalO(k) là độ phức_tạp cho xử_lý_số lớn .\nCách này không_thể chạy được với T lớn .\nTa hình_dung số_lượng vi_khuẩn trong mỗi bầy trong một đơn_vị thời_gian là một dãy_số .\nNhư_vậy , mỗi quy_luật cho trước thực_chất là một_phép biến_đổi từ một dãy_số thành một dãy_số mới , và ta hoàn_toàn có_thể thực_hiện biến_đổi này bằng một_phép nhân ma_trận .\nCụ_thể hơn , ta coi số_lượng vi_khuẩn trong N bầy tại một_thời điểm xác_định là một ma_trận 1 N , và mỗi phép biến_đổi là một ma_trận N_N .\nKhi áp_dụng mỗi phép biến_đổi , ta nhân hai ma_trận nói trên với_nhau .\nBây_giờ , xét trường_hợp N = 4 , tôi xin lần_lượt mô_tả các ma_trận tương_ứng với các phép biến_đổi : Biến_đổi : A 2 0 1 0 0 0 0 1 0 0 0 0 0 0 0 0 0 1 Biến_đổi : B 2 6 1 0 0 0 0 1 0 0 0 0 6 0 0 0 0 1 Biến_đổi : C 1 3 1 0 0 0 0 1 0 0 0 0 1 0 0 1 0 1 Biến_đổi : D 1 3 1 0 0 0 0 1 0 0 0 0 1 0 0 1 0 0 Biến_đổi : E 1 3 1 0 0 0 0 0 0 1 0 0 1 0 0 1 0 0 Biến_đổi : F 0 0 0 1 0 0 0 0 1 0 0 0 0 1 1 0 0 0 Cũng_như các bài_toán trước , ta sẽ cố_gắng áp_dụng việc tính_toán lũy_thừa , kết_hợp với phép_nhân ma_trận để giảm độ phức_tạp từ T xuống \\logT .\nTuy_nhiên , có_thể thấy việc sử_dụng phép lũy_thừa trong bài_toán này phần_nào phức_tạp hơn bởi các ma_trận được cho_không giống nhau .\nĐể giải_quyết vấn_đề này , ta làm như_sau : Gọi X_1 , X_2 , . . . , X_m là các ma_trận tương_ứng với các phép biến_đổi được cho .\nĐặt_X = X_1 X_2 . . .\nX_m .\nĐặt_S = 1 , 1 , . . . , 1 (dãy số_lượng vi_khuẩn tại thời_điểm đầu tiên) .\nNhư_vậy , Y = S_Xt X_1 X_2 . . .\nX_r là ma_trận thể_hiện số_lượng vi_khuẩn tại thời_điểm M t + r .\nNhư_vậy , thuật_toán đến đây đã rõ .\nTa phân_tích T = M t + r , nhờ đó , ta có_thể giải_quyết bài_toán trong \\mathcalO(N3 M) cho bước tính ma_trận X và \\mathcalO(N3 (\\logT/M + M) cho bước tính Y .\nBài_toán được giải_quyết .\nPhép_toán kết_hợp và độ phức_tạp tính_toán Nhân tổ_hợp dãy ma_trận Trong phần Mở_Đầu ta đã có thuật_toán nhân hai ma_trận A kích_cỡ M_N và B kích_cỡ N_P cần độ phức_tạp O(M_N_P) .\nGiả_sử_ta có thêm ma_trận C có kích_cỡ P_Q và ta cần tính tích A_B_C .\nXét hai cách thực_hiện phép_nhân này : Cách 1 : (A B)_C thực_hiện nhân A và B rồi nhân với C cần độ phức_tạp O(M_N_P) + O(M_P_Q) = O(M_P (N + Q))_Cách 2 : A (B C) thực_hiện nhân B và C rồi nhân với A cần độ phức_tạp O(N_P_Q) + O(M_N_Q) = O(N_Q (M + P)) Như_vậy là hai cách thực_hiện khác_nhau cần hai độ phức_tạp khác_nhau .\nChọn_M = N = 500 , P = 1000 , Q = 2 , cách 1 sẽ cần tới 500 1000 (500 + 2) = 251 106 phép_tính , trong_khi cách 2 chỉ_cần 500 2 (500 + 1000) = 1 . 5 106 phép_tính , nghĩa_là cách 1 chậm hơn cách 2 tới gần 200 lần .\nKhi độ_dài của dãy ma_trận tăng lên , sự khác_biệt có_thể còn lớn hơn_nữa .\nVí_dụ trên đã cho thấy rằng trong một_số trường_hợp thứ_tự thực_hiện phép_nhân ma_trận có_ý nghĩa rất lớn đối_với việc tìm lời_giải của các bài_toán .\nTrong thực_tế , bài_toán xác_định thứ_tự nhân ma_trận hiệu_quả nhất_là một bài_toán rất phổ_biến , bạn có_thể tìm đọc chi_tiết thêm ở Mục 3 . 5 Phép_Nhân Tổ_Hợp dãy Ma_Trận trong ebook của thầy Lê_Minh Hoàng .\nGiải_thuật Freivalds kiểm_tra tích hai ma_trận Giải_thuật Freivalds là một ví_dụ điển_hình về việc áp_dụng thứ_tự thực_hiện phép_nhân ma_trận để giảm độ phức_tạp tính_toán của phép_nhân một dãy ma_trận .\nBài_toán đặt ra là cho ba ma_trận vuông A , B , C có kích_cỡ N_N với N \\le 1000 .\nTa cần kiểm_tra xem C có_phải là tích của A và B , nói_cách_khác ta cần kiểm_tra AB = C có_phải là mệnh_đề đúng hay_không (đây chính là bài VMATRIX - VNOI_Marathon 2014 ) .\nPhân_tích Cách làm thông_thường là nhân trực_tiếp hai ma_trận A , B rồi so_sánh kết_quả với C .\nNhư phân_tích trong phần Mở_Đầu độ phức_tạp của cách làm này là O(N3) , với N = 1000 thì cách làm này không đủ nhanh .\nGiải_thuật Freivalds thực_hiện việc kiểm_tra thông_qua thuật_toán xác_suất kiểu Monte_Carlo với k lần thử cho xác_suất kết_luận sai là xấp_xỉ 1 / 2k , mỗi lần thử có độ phức_tạp O(N2) .\nCác bước cơ_bản của một_phép thử Freivalds như_sau : Sinh ngẫu_nhiên một ma_trận v kích_cỡ N 1 với các phần_tử chỉ nhận giá_trị 0 hoặc 1 .\nTính hiệu P = A_B v - C v .\nDễ thấy rằng P là ma_trận kích_cỡ N 1 .\nTrả về True nếu P chỉ gồm phần_tử 0 (bằng với vector 0) và False nếu ngược_lại .\nTa thực_hiện k lần thử , nếu gặp phép thử trả về False thì ta kết_luận là A_B \\neq C .\nNgược_lại nếu sau k phép thử mà luôn thấy True thì ta kết_luận A_B = C .\nVì xác_suất lỗi giảm theo hàm mũ của k nên thông_thường chỉ_cần chọn k vừa đủ là sẽ thu được xác_suất đúng rất cao (k = 5 với bài VMATRIX ở trên) .\nMột nhận_xét quan_trọng khác là cận_trên của đánh_giá xác_suất kiểm_tra lỗi không phụ_thuộc vào kích_cỡ N của ma_trận được cho mà chỉ phụ_thuộc vào số lần thực_hiện phép thử .\nXét bước thứ 2 , ta thấy rằng phép thử Freivalds chỉ_có ý_nghĩa nếu_như ta có_thể thực_hiện phép_nhân A_B v trong thời_gian O(N2) (vì phép_nhân C v đã đạt sẵn O(N2) rồi) .\nThay_vì thực_hiện tuần_tự từ trái qua phải sẽ cần O(N3) , ta thực_hiện theo thứ_tự A (B v) .\nVì kết_quả của phép_nhân B và v là một ma_trận N 1 nên độ phức_tạp tổng_cộng sẽ là O(N2) .\nTrên tất_cả các phép thử , độ phức_tạp là O(k_N2) .\nBài_tập áp_dụng HackerEarth - PK and interesting language HackerEarth - Long walks from Office to Home_Sweet_Home_HackerEarth - Tiles_HackerEarth - ABCD_Strings_HackerEarth - Mehta and the difficult task HackerEarth - Mehta and the Evil_Strings_VOJ - PA06ANT_VOJ - CONNECTE\n", "tagged": "Table/Np of_Contents/Np Mở_đầu/V Ví_dụ/C 1/M Ví_dụ/C 2/M Ví_dụ/C 3/M Ví_dụ/C 4/M Phép_toán/Np kết_hợp/V và/Cc độ/N phức_tạp/A tính_toán/V Nhân/N tổ_hợp/N dãy/Nc ma_trận/N Giải_thuật/Np Freivalds/Np kiểm_tra/V tích/N hai/M ma_trận/N Bài_tập/Np áp_dụng/V Tác_giả/N :/CH Nguyễn_RR/Np Thành_Trung/Np ,/CH Nguyễn_Mạnh_Quân/Np Mở_đầu/V Thông_thường/A ,/CH để/E đạt/V được/V độ/N phức_tạp/A thuật_toán/N như/C mong_muốn/V ,/CH cách/N làm/V thường/R là/V tìm_ra/Np một/M thuật_toán/N ban_đầu/N làm/V cơ_sở/N ,/CH rồi/C từ_đó/Np dùng/V các/L kỹ_năng/N để/E giảm/V độ/N phức_tạp/A của/E thuật_toán/N ./CH\nTrong/E bài/N viết/V này/P ,/CH tôi/P xin/V giới_thiệu/V với/E bạn_đọc/N một/M kỹ_năng/N khá/R thông_dụng/A :/CH nhân/N ma_trận/N ./CH\nTrước_khi/Np đọc_bài/Np viết/V này/P ,/CH nếu/C bạn/N chưa/R có/V khái_niệm/N gì/P về/E ma_trận/N ,/CH bạn/N có_thể/R tham_khảo/V định_nghĩa/N về/E ma_trận/N trong/E một/M tài_liệu/N khác/A ./CH\nTrước_hết/N ,/CH tôi/P xin/V nhắc_lại/Np tóm_tắt/V khái_niệm/N về/E phép_nhân/Np ma_trận/N :/CH Cho/E 2/M ma_trận/N :/CH A/Ni kích_thước/N M_N/Np và/Cc B/Ni kích_thước/N N_P/Np ./CH\n(chú/Np ý/N số/N cột/N của/E ma_trận/N A/Ni phải/V bằng/E số/N hàng/N của/E ma_trận/N B/Ni thì/C mới/R có_thể/R thực_hiện/V phép/N nhân)/Np ./CH\nKết_quả/N phép_nhân/Np ma_trận/N A/Ni và/Cc B/Ni là/V ma_trận/N C/Ni kích_thước/N M_P/Np ,/CH với/E mỗi/L phần_tử/N của/E ma_trận/N C/Ni được/V tính/V theo/V công_thức/N :/CH C(i/Np ,/CH j)/Np =/CH \\sumA(i/Np ,/CH k)/Np B(k/Np ,/CH j)/Np Để/E thực_hiện/V phép_nhân/Np ma_trận/N trên/E máy_tính/N ,/CH ta/P có_thể/R thực_hiện/V thuật_toán/N với/E độ/N phức_tạp/A \\mathcalO(M/Np N_P)/Np như_sau/Np :/CH for/Np i/M :/CH =/CH 1/M to/A M/Nu do/E for/Np j/Np :/CH =/CH 1/M to/A P/Ny do/E begin/Np C/Ni i/M ,/CH j/Np :/CH =/CH 0/M ;/CH for/Np k/N :/CH =/CH 1/M to/A N/Ny do/E C/Ni i/M ,/CH j/Np :/CH =/CH C/Ni i/M ,/CH j/Np +/CH A/Ni i/M ,/CH k/N B/Ni k/N ,/CH j/Np ;/CH end/Np ;/CH Đối_với/E phép_nhân/Np các/L ma_trận/N vuông/N kích_thước/N N_N/Np ,/CH có/V thuật_toán/N nhân/N ma_trận/N Strassen/Np với/E độ/N phức_tạp/A \\mathcalO(N\\log7)/Np theo/V tư_tưởng/N chia_nhỏ/Np ma_trận/N (tương/Np tự/P cách/N nhân/N nhanh/A 2/M số/N lớn))/Np ./CH\nTuy_nhiên/C cài_đặt/V rất/R phức_tạp/A và/Cc trên/E thực_tế/N với/E giá_trị_N/Np thường/R gặp/V ,/CH cách/N này/P không/R chạy/V nhanh/A hơn/A nhân/N ma_trận/N thông_thường/A \\mathcalO(N3)/Np ./CH\nCần/V chú_ý/V thêm/V là/V phép_nhân/Np ma_trận/N không/R có/V tính_giao/Np hoán/Np (do/Np có_thể/R thực_hiện/V nhân/N 2/M ma_trận/N A/Ni kích_thước/N M_N/Np và/Cc ma_trận/N B/Ni kích_thước/N N_P/Np nhưng/C không_thể/R thực_hiện/V phép_nhân/Np B_A/Np nếu/C P/Ny \\ne/Np M)/Np ./CH\nTuy_nhiên/C ,/CH nhân/N ma_trận/N lại/R có/V tính/V kết_hợp/V :/CH (A/Np B)_C/Np =/CH A/Ni (B/Np C)/Np Ví_dụ/C 1/M Chúng_ta/P hãy/R cùng/A xem_xét/V một/M ví_dụ/C kinh_điển/A nhất/A trong/E ứng_dụng/V của/E phép_nhân/Np ma_trận/N ./CH\nBài_toán/N Dãy_Fibonacci/Np được/V định_nghĩa/N như_sau/Np :/CH F(0)/Np =/CH 1/M F(1)/Np =/CH 1/M ./CH ./CH ./CH\nF(i)/Np =/CH F(i-1)/Np +/CH F(i-2)/Np ,/CH i/M gt;=/Np 2/M Yêu_cầu/V :/CH Cho_N/Np (N/Np \\le/Np 109)/Np ,/CH tính/V F(N)/Np ./CH\nBạn/N có_thể/R nộp/V bài/N thử/V ở/E VNOI/Np -/CH LATGACH4/Np ./CH\nPhân_tích/V Hiển_nhiên/Np cách/N làm/V thông_thường/A là/V tính/V lần_lượt/R các/L F(j)/Np ./CH\nTuy_nhiên/C ,/CH cách/N làm/V này/P hoàn_toàn/A không/R hiệu_quả/N với/E N/Ny lên/V đến/E 109/M ,/CH và/Cc ta/P cần/V một_cách/N tiếp_cận/V khác/A ./CH\nTa/P xét/V các/L lớp/N số/N :/CH Lớp/N 1/M :/CH F(1)/Np ,/CH F(2)_Lớp/Np 2/M :/CH F(2)/Np ,/CH F(3)/Np ./CH ./CH ./CH\nLớp/N i/M :/CH F(i)/Np ,/CH F(i+1)_Ta/Np hình_dung/V mỗi/L lớp/N là/V một/M ma_trận/N 1x2/Np ./CH\nTiếp/V đó/P ,/CH ta/P sẽ/R biến_đổi/V từ/E lớp/N i-1/Np đến/E lớp/N i/M ./CH\nSau/E mỗi/L lần/N biến_đổi/V như_vậy/X ,/CH ta/P tính/V thêm/V được/V một/M giá_trị/N F(i+1)/Np ./CH\nĐể/E thực_hiện/V phép/N biến_đổi/V này/P ,/CH chú_ý/V là/V các/L số/N ở/E lớp/N sau/E chỉ/R phụ_thuộc/V vào/E lớp/N ngay/R trước/E nó/P theo/V các/L phép_cộng/Np ,/CH ta/P tìm/V được/V cách/N biến_đổi/V bằng/E nhân/N ma_trận/N :/CH Chắc_hẳn/R đọc/V đến/E đây/P bạn_đọc/N sẽ/R thắc_mắc/V ,/CH làm/V thế_nào/P để/E tìm/V được/V ma_trận/N trên/E ?/CH\nĐể/E tìm/V được/V ma_trận/N này/P ,/CH ta/P làm/V như_sau/Np :/CH Ta/P có/V :/CH F(i)/Np =/CH 0/M F(i-1)/Np +/CH 1/M F(i)/Np ,/CH do_đó/C hàng_đầu/N của/E ma_trận/N là/V 0/M ,/CH 1/M F(i+1)/Np =/CH 1/M F(i-1)/Np +/CH 1/M F(i)/Np ,/CH do_đó/C hàng/N thứ/N 2/M của/E ma_trận/N là/V 1/M ,/CH 1/M Bây_giờ/P ta/P sẽ/R cần/V tìm/V cách/N tăng_tốc/Np việc/N tính/V 0/M ,/CH 1;/Np 1/M ,/CH 1T/Np (/CH )/CH ./CH\nViệc/N tính/V nhanh/A (/CH )/CH cũng/R hoàn_toàn/A tương_tự/A việc_ta/Np tính/V aT/Np với/E a/Ni là/V số_nguyên/Np ./CH\nSau_đây/Np là/V đoạn/Nc code/Np minh_hoạ/V ./CH\nTrong/E đoạn/Nc code/Np này/P ,/CH để/E bạn_đọc/N dễ_hiểu/Np ,/CH tôi/P bỏ_qua/V yếu_tố/N về/E tính_toán/V số_lớn/Np ,/CH và/Cc thực_hiện/V các/L phép_tính/Np với/E kiểu/N số/N 32-bit/Np ./CH\ntype/Np matrix/Np =/CH array/Np 0/M ./CH ./CH 1/M ,/CH 0/M ./CH ./CH 1/M of/E longint/Np ;/CH const/Np a/Ni :/CH matrix/Np =((/Np 0/M ,/CH 1/M )/CH ,/CH (/CH 1/M ,/CH 1/M ));/Np //CH nghĩa/N phép_nhân/Np 2/M ma_trận/N operator/Np (/CH a/Ni ,/CH b/Ni :/CH matrix/Np )/CH c/Ni :/CH matrix/Np ;/CH var/Np i/M ,/CH j/Np ,/CH k/N :/CH longint/Np ;/CH begin/Np fillchar/Np (/CH c/Ni ,/CH sizeof/Np (/CH c/Ni )/CH ,/CH 0/M );/CH for/Np i/M :/CH =/CH 0/M to/A 1/M do/E for/Np j/Np :/CH =/CH 0/M to/A 1/M do/E for/Np k/N :/CH =/CH 0/M to/A 1/M do/E c/Ni i/M ,/CH j/Np :/CH =/CH c/Ni i/M ,/CH j/Np +/CH a/Ni i/M ,/CH k/N b/Ni k/N ,/CH j/Np ;/CH end/Np ;/CH //CH an/A function/Np power/Np (/CH n/Ny :/CH longint/Np )/CH :/CH matrix/Np ;/CH var/Np temp/Np :/CH matrix/Np ;/CH begin/Np if/Np n/Ny =/CH 1/M then/Np exit/Np (/CH a/Ni );/CH temp/Np :/CH =/CH power/Np (/CH n/Ny div/Np 2/M );/CH temp/Np :/CH =/CH temp/Np temp/Np ;/CH if/Np n/Ny mod/Np 2/M =/CH 1/M then/Np temp/Np :/CH =/CH temp/Np a/Ni ;/CH exit/Np (/CH temp/Np );/CH end/Np ;/CH Ví_dụ/C 2/M Bây_giờ/P chúng_ta/P sẽ/R cùng/A xem_xét/V một/M ví_dụ/C tổng_quát/Np hơn/A của/E ví_dụ/C 1/M ./CH\nBài_toán/N :/CH SPOJ/Np -/CH SEQ_Cho/Np số_nguyên/Np N/Ny (N/Np \\le/Np 100)/Np và/Cc 2/M dãy_số/Np độ_dài/Np N/Ny :/CH a_1/Np ,/CH a_2/Np ,/CH ./CH ./CH ./CH ,/CH a_N;/Np b_1/Np ,/CH b_2/Np ,/CH ./CH ./CH ./CH ,/CH b_N/Np ./CH\nDãy_số/Np c/Ni được/V định_nghĩa/N như_sau/Np :/CH c_i/Np =/CH a_i/Np với/E i/M \\le/Np N/Ny c_i/Np =/CH c_i-1/Np b_1/Np +/CH c_i-2/Np b_2/Np +/CH ./CH ./CH ./CH\n+/CH c_i-N/Np b_N/Np Yêu_cầu/V :/CH Tính/V c_k/Np với/E k/N \\le/Np 109/M ./CH\nPhân_tích/V Cũng_như/C trong/E ví_dụ/C 1/M ,/CH ta/P xét/V các/L lớp/N số/N :/CH Lớp/N 1/M :/CH c_1/Np ,/CH c_2/Np ,/CH ./CH ./CH ./CH ,/CH c_N/Np Lớp/N 2/M :/CH c_2/Np ,/CH c_3/Np ,/CH ./CH ./CH ./CH ,/CH c_N+1/Np ./CH ./CH ./CH\nLớp/N i/M :/CH c_i/Np ,/CH c_i+1/Np ,/CH ./CH ./CH ./CH ,/CH c_i+N-1/Np Ta/P cũng/R sẽ/R áp_dụng/V phép_nhân/Np ma_trận/N để/E biến_đổi/V từ/E lớp/N i/M sang/V lớp/N i+1/Np như_sau/Np :/CH Để/E xây_dựng/V ma_trận/N vuông/N như_trên/Np ,/CH ta/P thực_hiện/V tương_tự/A như/C trong/E ví_dụ/C trước/E :/CH Phân_tích/V a_i+1/Np đến/E a_i+N/Np dưới/E dạng/N a_i/Np ,/CH ./CH ./CH ./CH ,/CH a_i+N-1/Np :/CH a_i+1/Np =/CH 0/M a_i/Np +/CH 1/M a_i+1/Np +/CH ./CH ./CH ./CH\n+/CH 0/M a_i+N-1/Np nên/C hàng/N 1/M là/V 0/M ,/CH 1/M ,/CH 0/M ,/CH ./CH ./CH ./CH ./CH ,/CH 0/M ./CH ./CH ./CH\na_i+N-1/Np =/CH 0/M a_i/Np +/CH 0/M a_i+1/Np +/CH ./CH ./CH ./CH\n+/CH 1/M a_i+N-1/Np nên/C hàng/N N-1/Np là/V 0/M ,/CH 0/M ,/CH 0/M ,/CH ./CH ./CH ./CH ,/CH 1/M a_i+N/Np =/CH b_N/Np a_i/Np +/CH b_N-1/Np a_i+1/Np +/CH ./CH ./CH ./CH\n+/CH b_1/Np a_i+N-1/Np nên/C hàng/N N/Ny là/V b_N/Np ,/CH b_N-1/Np ,/CH ./CH ./CH ./CH ,/CH b_1/Np Từ_đó/Np ,/CH ta/P thu/V được/V cách/N làm/V như/C trong/E ví_dụ/C 1/M ./CH\nCài_đặt/V cụ_thể/A xin/V nhường_lại/Np cho/E bạn_đọc/N ./CH\nChú_ý/V rằng/C ta/P hoàn_toàn/A có_thể/R thay_thế/V phép_nhân/Np và/Cc phép_cộng/Np trong/E định_nghĩa/N phép_nhân/Np ma_trận/N ,/CH chỉ_cần/Np đảm_bảo/V giữ_nguyên/Np tính_chất/N kết_hợp/V ./CH\nCụ_thể/A hơn/A ,/CH thay_vì/X C(i/Np ,/CH j)/Np =/CH \\sumA(i/Np ,/CH k)/Np B(k/Np ,/CH j)/Np ,/CH ta/P có_thể/R định_nghĩa/N phép_nhân/Np ma_trận/N :/CH C(i/Np ,/CH j)/Np =/CH min(A(i/Np ,/CH k)/Np +/CH B(k/Np ,/CH j))/Np ./CH\nTừ_đó/Np ,/CH ta/P có_thể/R thu/V được/V một/M lớp/N các/L bài_toán/N khác/A ./CH\nSau_đây/Np là/V một/M ví_dụ/C minh_hoạ/V cho/E nhóm/N các/L bài_toán/N này/P Ví_dụ/C 3/M Bài_toán/N Cho/E đồ_thị/Np có/V hướng/N N/Ny đỉnh/N (N/Np \\le/Np 100)/Np ./CH\nTính/V ma_trận/N C(k)/Np kích_thước/N N_N/Np ,/CH với/E C(k)/Np i/M ,/CH j/Np là/V độ_dài/Np đường_đi/Np ngắn/A nhất/A từ/E i/M đến/E j/Np đi_qua/Np đúng/A k/N cạnh/N Phân_tích/V Xét/V ma_trận/N A/Ni là/V ma_trận/N kề/V của/E đồ_thị/Np đã/R cho/E ./CH\nTa/P có/V :/CH A/Ni =/CH C(1)_C(2)i/Np ,/CH j/Np =/CH \\minAi/Np ,/CH u/N +/CH Au/Np ,/CH j/Np với/E u/N chạy/V từ/E 1/M đến/E N_C(k)i/Np ,/CH j/Np =/CH \\minC(k-1)i/Np ,/CH u/N +/CH Au/Np ,/CH j/Np với/E u/N chạy/V từ/E 1/M đến/E N/Ny Như_vậy/X ,/CH nếu/C ta/P thay/V phép_nhân/Np và/Cc phép_cộng/Np trong/E việc/N nhân/N ma_trận/N thông_thường/A lần_lượt/R bởi/E phép_cộng/Np và/Cc phép/N lấy/V min/Np ,/CH ta/P thu/V được/V một_phép/Np ”nhân/Np ma/N trận”/Np mới/R ,/CH tạm/A dùng/V ký_hiệu/Np x/CH ,/CH thì/C :/CH C1/Np =/CH A_C2/Np =/CH C1/Np x/CH C1/Np =/CH A/Ni x/CH C1_C3/Np =/CH C1/Np x/CH C2/Np =/CH A/Ni x/CH C2_C4/Np =/CH C1/Np x/CH C3/Np =/CH A/Ni x/CH C3/Np ./CH ./CH ./CH\nCk/Ny =/CH C1/Np x/CH C(k-1)/Np =/CH A/Ni x/CH C(k-1)/Np Do_đó/C ,/CH C(k)/Np =/CH Ak/Np Như_vậy/X ,/CH bài_toán/N được/V đưa/V về/E bài_toán/N tính/V lũy_thừa/Np của/E một/M ma_trận/N ,/CH ta/P hoàn_toàn/A có_thể/R giải/N tương_tự/A các/L ví_dụ/C trước/E ./CH\nCài_đặt/V phép_nhân/Np ma_trận/N mới/R này/P hoàn_toàn/A không/R phức_tạp/A hơn/A cài_đặt/V phép_nhân/Np ma_trận/N thông_thường/A ./CH\nViệc/N cài_đặt/V xin/V nhường_lại/Np cho/E bạn_đọc/N ./CH\nVí_dụ/C 4/M VOJ/Np -/CH THBAC/Np Bài_toán/N Người_ta/P mới/R tìm_ra/Np một/M loại/N vi_khuẩn/N mới/R ./CH\nChúng/P sống/V thành/V N/Ny bầy/Nc (N/Np \\le/Np 100)/Np ,/CH đánh_số/Np từ/E 0/M đến/E N-1/Np ./CH\nBan_đầu/N ,/CH mỗi/L bầy/Nc này/P chỉ_có/Np một/M con/Nc vi_khuẩn/N ./CH\nTuy_nhiên/C ,/CH mỗi/L giây/Nu ,/CH số_lượng/N vi_khuẩn/N trong/E các/L bầy/Nc lại/R có/V sự/N thay_đổi/V ./CH\nVí_dụ/C :/CH một/M bầy/Nc có_thể/R bị/V chết/V đi/V số_lượng/N vi_khuẩn/N trong/E một/M bầy/Nc có_thể/R tăng/V lên/V một/M bầy/Nc có_thể/R di_chuyển/V vị_trí/N ./CH\nCác/L thay_đổi/V này/P tuân/V theo/V một_số/L quy_luật/N cho/E trước/E ./CH\nTại/E mỗi/L giây/Nu chỉ/R xảy_ra/Np đúng/A một/M quy_luật/N ./CH\nCác/L quy_luật/N này/P được/V thực_hiện/V nối_tiếp/V nhau/N và/Cc theo/V chu_kỳ/Np ./CH\nCó_nghĩa/A là/V ,/CH nếu/C đánh_số/Np các/L quy_luật/N từ/E 0/M đến/E M-1/Np ,/CH tại/E giây/Nu thứ/N S/Y thì/C quy_luật/N được/V áp_dụng/V sẽ/R là/V (S-1)/Np \\space/Np mod/Np \\space/Np M/Nu (M/Np \\le/Np 1000)/Np Nhiệm_vụ/N của/E bạn/N là/V tìm/V xem/V ,/CH với/E một/M bộ/N các/L quy_luật/N cho/E trước/E ,/CH sau/E T/Nu đơn_vị/N thời_gian/N (T/Np \\le/Np 1018)/Np ,/CH mỗi/L bầy/Nc có/V bao_nhiêu/P vi_khuẩn/N ./CH\nCác/L loại/N quy_luật/N có_thể/R có/V :/CH A/Ni i/M 0/M :/CH Tất_cả/P các/L vi_khuẩn/N thuộc/V bầy/Nc i/M chết/V ./CH\nB/Ni i/M k/N :/CH Số/N vi_khuẩn/N trong/E bầy/Nc i/M tăng/V lên/V k/N lần/N ./CH\nC/Ni i/M j/Np :/CH số/N vi_khuẩn/N bầy/Nc thứ/N i/M tăng/V lên/V một_số/L lượng/N bằng/E với/E số/N vi_khuẩn/N bầy/Nc j/Np ./CH\nD/Ny i/M j/Np :/CH Các/L vi_khuẩn/N thuộc/V bầy/Nc j/Np di_chuyển/V toàn_bộ/L sang/V bầy/Nc i/M ./CH\nE/Ni i/M j/Np :/CH Các/L vi_khuẩn/N thuộc/V bầy/Nc i/M và/Cc bầy/Nc j/Np đổi/V vị_trí/N cho/E nhau/N ./CH\nF/Np 0/M 0/M :/CH Vị_trí/N các/L vi_khuẩn/N di_chuyển/V trên/E vòng_tròn/N ./CH\nPhân_tích/V Cách/N làm/V đơn_giản/A nhất_là/X chúng_ta/P mô_phỏng/Np lại/R số_lượng/N vi_khuẩn/N trong/E mỗi/L bầy/Nc qua/V từng/R đơn_vị/N thời_gian/N ./CH\nCách/N làm/V này/P có/V độ/N phức_tạp/A \\mathcalO(T/Np N/Ny k)/Np với/E \\mathcalO(k)/Np là/V độ/N phức_tạp/A cho/E xử_lý_số/Np lớn/A ./CH\nCách/N này/P không_thể/R chạy/V được/V với/E T/Nu lớn/A ./CH\nTa/P hình_dung/V số_lượng/N vi_khuẩn/N trong/E mỗi/L bầy/Nc trong/E một/M đơn_vị/N thời_gian/N là/V một/M dãy_số/Np ./CH\nNhư_vậy/X ,/CH mỗi/L quy_luật/N cho/E trước/E thực_chất/N là/V một_phép/Np biến_đổi/V từ/E một/M dãy_số/Np thành/V một/M dãy_số/Np mới/R ,/CH và/Cc ta/P hoàn_toàn/A có_thể/R thực_hiện/V biến_đổi/V này/P bằng/E một_phép/Np nhân/N ma_trận/N ./CH\nCụ_thể/A hơn/A ,/CH ta/P coi/V số_lượng/N vi_khuẩn/N trong/E N/Ny bầy/Nc tại/E một_thời/Np điểm/N xác_định/V là/V một/M ma_trận/N 1/M N/Ny ,/CH và/Cc mỗi/L phép/N biến_đổi/V là/V một/M ma_trận/N N_N/Np ./CH\nKhi/N áp_dụng/V mỗi/L phép/N biến_đổi/V ,/CH ta/P nhân/N hai/M ma_trận/N nói/V trên/E với_nhau/Np ./CH\nBây_giờ/P ,/CH xét/V trường_hợp/N N/Ny =/CH 4/M ,/CH tôi/P xin/V lần_lượt/R mô_tả/V các/L ma_trận/N tương_ứng/V với/E các/L phép/N biến_đổi/V :/CH Biến_đổi/V :/CH A/Ni 2/M 0/M 1/M 0/M 0/M 0/M 0/M 1/M 0/M 0/M 0/M 0/M 0/M 0/M 0/M 0/M 0/M 1/M Biến_đổi/V :/CH B/Ni 2/M 6/M 1/M 0/M 0/M 0/M 0/M 1/M 0/M 0/M 0/M 0/M 6/M 0/M 0/M 0/M 0/M 1/M Biến_đổi/V :/CH C/Ni 1/M 3/M 1/M 0/M 0/M 0/M 0/M 1/M 0/M 0/M 0/M 0/M 1/M 0/M 0/M 1/M 0/M 1/M Biến_đổi/V :/CH D/Ny 1/M 3/M 1/M 0/M 0/M 0/M 0/M 1/M 0/M 0/M 0/M 0/M 1/M 0/M 0/M 1/M 0/M 0/M Biến_đổi/V :/CH E/Ni 1/M 3/M 1/M 0/M 0/M 0/M 0/M 0/M 0/M 1/M 0/M 0/M 1/M 0/M 0/M 1/M 0/M 0/M Biến_đổi/V :/CH F/Np 0/M 0/M 0/M 1/M 0/M 0/M 0/M 0/M 1/M 0/M 0/M 0/M 0/M 1/M 1/M 0/M 0/M 0/M Cũng_như/C các/L bài_toán/N trước/E ,/CH ta/P sẽ/R cố_gắng/V áp_dụng/V việc/N tính_toán/V lũy_thừa/Np ,/CH kết_hợp/V với/E phép_nhân/Np ma_trận/N để/E giảm/V độ/N phức_tạp/A từ/E T/Nu xuống/V \\logT/Np ./CH\nTuy_nhiên/C ,/CH có_thể/R thấy/V việc/N sử_dụng/V phép/N lũy_thừa/Np trong/E bài_toán/N này/P phần_nào/L phức_tạp/A hơn/A bởi/E các/L ma_trận/N được/V cho_không/Np giống/N nhau/N ./CH\nĐể/E giải_quyết/V vấn_đề/N này/P ,/CH ta/P làm/V như_sau/Np :/CH Gọi/V X_1/Np ,/CH X_2/Np ,/CH ./CH ./CH ./CH ,/CH X_m/Np là/V các/L ma_trận/N tương_ứng/V với/E các/L phép/N biến_đổi/V được/V cho/E ./CH\nĐặt_X/Np =/CH X_1/Np X_2/Np ./CH ./CH ./CH\nX_m/Np ./CH\nĐặt_S/Np =/CH 1/M ,/CH 1/M ,/CH ./CH ./CH ./CH ,/CH 1/M (dãy/Np số_lượng/N vi_khuẩn/N tại/E thời_điểm/N đầu/N tiên)/Np ./CH\nNhư_vậy/X ,/CH Y/N =/CH S_Xt/Np X_1/Np X_2/Np ./CH ./CH ./CH\nX_r/Np là/V ma_trận/N thể_hiện/V số_lượng/N vi_khuẩn/N tại/E thời_điểm/N M/Nu t/Nu +/CH r/Np ./CH\nNhư_vậy/X ,/CH thuật_toán/N đến/E đây/P đã/R rõ/A ./CH\nTa/P phân_tích/V T/Nu =/CH M/Nu t/Nu +/CH r/Np ,/CH nhờ/V đó/P ,/CH ta/P có_thể/R giải_quyết/V bài_toán/N trong/E \\mathcalO(N3/Np M)/Np cho/E bước/V tính/V ma_trận/N X/CH và/Cc \\mathcalO(N3/Np (\\logT/Np +/CH M)/Np cho/E bước/V tính/V Y/N ./CH\nBài_toán/N được/V giải_quyết/V ./CH\nPhép_toán/Np kết_hợp/V và/Cc độ/N phức_tạp/A tính_toán/V Nhân/N tổ_hợp/N dãy/Nc ma_trận/N Trong/E phần/N Mở_Đầu/V ta/P đã/R có/V thuật_toán/N nhân/N hai/M ma_trận/N A/Ni kích_cỡ/N M_N/Np và/Cc B/Ni kích_cỡ/N N_P/Np cần/V độ/N phức_tạp/A O(M_N_P)/Np ./CH\nGiả_sử_ta/Np có/V thêm/V ma_trận/N C/Ni có/V kích_cỡ/N P_Q/Np và/Cc ta/P cần/V tính/V tích/N A_B_C/Np ./CH\nXét/V hai/M cách/N thực_hiện/V phép_nhân/Np này/P :/CH Cách/N 1/M :/CH (A/Np B)_C/Np thực_hiện/V nhân/N A/Ni và/Cc B/Ni rồi/C nhân/N với/E C/Ni cần/V độ/N phức_tạp/A O(M_N_P)/Np +/CH O(M_P_Q)/Np =/CH O(M_P/Np (N/Np +/CH Q))_Cách/Np 2/M :/CH A/Ni (B/Np C)/Np thực_hiện/V nhân/N B/Ni và/Cc C/Ni rồi/C nhân/N với/E A/Ni cần/V độ/N phức_tạp/A O(N_P_Q)/Np +/CH O(M_N_Q)/Np =/CH O(N_Q/Np (M/Np +/CH P))/Np Như_vậy/X là/V hai/M cách/N thực_hiện/V khác_nhau/Np cần/V hai/M độ/N phức_tạp/A khác_nhau/Np ./CH\nChọn_M/Np =/CH N/Ny =/CH 500/M ,/CH P/Ny =/CH 1000/M ,/CH Q/Ny =/CH 2/M ,/CH cách/N 1/M sẽ/R cần/V tới/E 500/M 1000/M (500/Np +/CH 2)/Np =/CH 251/Np 106/M phép_tính/Np ,/CH trong_khi/Np cách/N 2/M chỉ_cần/Np 500/M 2/M (500/Np +/CH 1000)/Np =/CH 1/M ./CH 5/M 106/M phép_tính/Np ,/CH nghĩa_là/V cách/N 1/M chậm/A hơn/A cách/N 2/M tới/E gần/A 200/M lần/N ./CH\nKhi/N độ_dài/Np của/E dãy/Nc ma_trận/N tăng/V lên/V ,/CH sự/N khác_biệt/A có_thể/R còn/R lớn/A hơn_nữa/C ./CH\nVí_dụ/C trên/E đã/R cho/E thấy/V rằng/C trong/E một_số/L trường_hợp/N thứ_tự/N thực_hiện/V phép_nhân/Np ma_trận/N có_ý/Np nghĩa/N rất/R lớn/A đối_với/E việc/N tìm/V lời_giải/Np của/E các/L bài_toán/N ./CH\nTrong/E thực_tế/N ,/CH bài_toán/N xác_định/V thứ_tự/N nhân/N ma_trận/N hiệu_quả/N nhất_là/X một/M bài_toán/N rất/R phổ_biến/V ,/CH bạn/N có_thể/R tìm/V đọc/V chi_tiết/N thêm/V ở/E Mục/N 3/M ./CH 5/M Phép_Nhân/Np Tổ_Hợp/N dãy/Nc Ma_Trận/N trong/E ebook/Np của/E thầy/N Lê_Minh/Np Hoàng/V ./CH\nGiải_thuật/Np Freivalds/Np kiểm_tra/V tích/N hai/M ma_trận/N Giải_thuật/Np Freivalds/Np là/V một/M ví_dụ/C điển_hình/N về/E việc/N áp_dụng/V thứ_tự/N thực_hiện/V phép_nhân/Np ma_trận/N để/E giảm/V độ/N phức_tạp/A tính_toán/V của/E phép_nhân/Np một/M dãy/Nc ma_trận/N ./CH\nBài_toán/N đặt/V ra/V là/V cho/E ba/M ma_trận/N vuông/N A/Ni ,/CH B/Ni ,/CH C/Ni có/V kích_cỡ/N N_N/Np với/E N/Ny \\le/Np 1000/M ./CH\nTa/P cần/V kiểm_tra/V xem/V C/Ni có_phải/Np là/V tích/N của/E A/Ni và/Cc B/Ni ,/CH nói_cách_khác/Np ta/P cần/V kiểm_tra/V AB/Np =/CH C/Ni có_phải/Np là/V mệnh_đề/N đúng/A hay_không/Np (đây/Np chính/T là/V bài/N VMATRIX/Np -/CH VNOI_Marathon/Np 2014/M )/CH ./CH\nPhân_tích/V Cách/N làm/V thông_thường/A là/V nhân/N trực_tiếp/A hai/M ma_trận/N A/Ni ,/CH B/Ni rồi/C so_sánh/V kết_quả/N với/E C/Ni ./CH\nNhư/C phân_tích/V trong/E phần/N Mở_Đầu/V độ/N phức_tạp/A của/E cách/N làm/V này/P là/V O(N3)/Np ,/CH với/E N/Ny =/CH 1000/M thì/C cách/N làm/V này/P không/R đủ/A nhanh/A ./CH\nGiải_thuật/Np Freivalds/Np thực_hiện/V việc/N kiểm_tra/V thông_qua/V thuật_toán/N xác_suất/N kiểu/N Monte_Carlo/Np với/E k/N lần/N thử/V cho/E xác_suất/N kết_luận/V sai/A là/V xấp_xỉ/A 1/M //CH 2k/Np ,/CH mỗi/L lần/N thử/V có/V độ/N phức_tạp/A O(N2)/Np ./CH\nCác/L bước/V cơ_bản/A của/E một_phép/Np thử/V Freivalds/Np như_sau/Np :/CH Sinh/V ngẫu_nhiên/A một/M ma_trận/N v/Nu kích_cỡ/N N/Ny 1/M với/E các/L phần_tử/N chỉ/R nhận/V giá_trị/N 0/M hoặc/Cc 1/M ./CH\nTính/V hiệu/N P/Ny =/CH A_B/Np v/Nu -/CH C/Ni v/Nu ./CH\nDễ/A thấy/V rằng/C P/Ny là/V ma_trận/N kích_cỡ/N N/Ny 1/M ./CH\nTrả/V về/E True/Np nếu/C P/Ny chỉ/R gồm/V phần_tử/N 0/M (bằng/Np với/E vector/Np 0)/Np và/Cc False/Np nếu/C ngược_lại/X ./CH\nTa/P thực_hiện/V k/N lần/N thử/V ,/CH nếu/C gặp/V phép/N thử/V trả/V về/E False/Np thì/C ta/P kết_luận/V là/V A_B/Np \\neq/Np C/Ni ./CH\nNgược_lại/X nếu/C sau/E k/N phép/N thử/V mà/C luôn/R thấy/V True/Np thì/C ta/P kết_luận/V A_B/Np =/CH C/Ni ./CH\nVì/E xác_suất/N lỗi/N giảm/V theo/V hàm/Np mũ/N của/E k/N nên/C thông_thường/A chỉ_cần/Np chọn/V k/N vừa/R đủ/A là/V sẽ/R thu/V được/V xác_suất/N đúng/A rất/R cao/A (k/Np =/CH 5/M với/E bài/N VMATRIX/Np ở/E trên)/Np ./CH\nMột/M nhận_xét/N quan_trọng/A khác/A là/V cận_trên/Np của/E đánh_giá/V xác_suất/N kiểm_tra/V lỗi/N không/R phụ_thuộc/V vào/E kích_cỡ/N N/Ny của/E ma_trận/N được/V cho/E mà/C chỉ/R phụ_thuộc/V vào/E số/N lần/N thực_hiện/V phép/N thử/V ./CH\nXét/V bước/V thứ/N 2/M ,/CH ta/P thấy/V rằng/C phép/N thử/V Freivalds/Np chỉ_có/Np ý_nghĩa/N nếu_như/C ta/P có_thể/R thực_hiện/V phép_nhân/Np A_B/Np v/Nu trong/E thời_gian/N O(N2)/Np (vì/Np phép_nhân/Np C/Ni v/Nu đã/R đạt/V sẵn/A O(N2)/Np rồi)/Np ./CH\nThay_vì/X thực_hiện/V tuần_tự/R từ/E trái/Nc qua/V phải/V sẽ/R cần/V O(N3)/Np ,/CH ta/P thực_hiện/V theo/V thứ_tự/N A/Ni (B/Np v)/Np ./CH\nVì/E kết_quả/N của/E phép_nhân/Np B/Ni và/Cc v/Nu là/V một/M ma_trận/N N/Ny 1/M nên/C độ/N phức_tạp/A tổng_cộng/V sẽ/R là/V O(N2)/Np ./CH\nTrên/E tất_cả/P các/L phép/N thử/V ,/CH độ/N phức_tạp/A là/V O(k_N2)/Np ./CH\nBài_tập/Np áp_dụng/V HackerEarth/Np -/CH PK/Nu and/Np interesting/Np language/Np HackerEarth/Np -/CH Long/Np walks/Np from/Np Office/Np to/A Home_Sweet_Home_HackerEarth/Np -/CH Tiles_HackerEarth/Np -/CH ABCD_Strings_HackerEarth/Np -/CH Mehta/Np and/Np the/B difficult/Np task/Np HackerEarth/Np -/CH Mehta/Np and/Np the/B Evil_Strings_VOJ/Np -/CH PA06ANT_VOJ/Np -/CH CONNECTE/Np\n", "title": "Nhân ma trận\n", "link": "http://vnoi.info/wiki/algo/trick/matrix-multiplication\n"}