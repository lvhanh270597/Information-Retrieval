Luồng trong mạng II: Thuật toán Edmonds-Karp -- Network Flow II: Edmonds-Karp Algorithm
http://www.giaithuatlaptrinh.com/?p=1539
Nơi tổng hợp và chia sẻ những kiến thức liên quan tới giải thuật nói chung và lý thuyết khoa học máy tính nói riêng.   in  | Trong bài trước, chúng ta đã tìm hiểu  tìm luồng cực đại trong mạng (có khả năng thông qua nguyên). Thuật toán Ford-Fulkerson, về cơ bản, bắt đầu từ một luồng hợp lệ  (ví dụ luồng 0), và thực lặp lại 3 bước sau cho đến khi thu được luồng cực đại:Ta đã chứng minh, sau mỗi bước tăng luồng, luồng sẽ được tăng lên ít nhất 1 đơn vị. Do đó, ta có thể thực thi thuật toán Ford-Fulkerson trong thời gian ; ở đây  là giá trị của luồng cực đại. Tuy nhiên, thuật toán Ford-Fulkerson không phải là thuật toán thời gian đa thức vì giá trị của luồng cực đại  có thể chỉ biểu diễn được bằng  bít. Trong bài này, chúng ta sẽ tìm hiểu 2 cách tìm đường tăng luồng khác nhau, đề xuất bởi Edmonds và Karp [1]. Cả 2 cách này đều cho chúng ta thuật toán thời gian đa thức. Edmonds và Karp để xuất: 
Đường tăng luồng này có thể tìm được bằng cách áp dụng BFS (Breath-First Search) trong đồ thị thặng dư. Edmonds và Karp chứng minh rằng  nếu ta chọn đường tăng luồng như vậy, thuật toán Ford-Fulkerson sẽ kết thúc sau  bước tăng luồng. Kết quả này thực sự là một kết quả ngạc nhiên, vì nó cho thấy có sự khác biệt cơ bản giữa DFS và BFS trong tìm đường tăng luồng. Tất nhiên, phần khó nhất vẫn là phân tích thuật toán, mà ta sẽ tìm hiểu dưới đây.  Gọi  là các đồ thị, trong đó,  là đồ thị thặng dư tại bước thứ . Gọi  là số cung của đường đi có ít cung nhất từ  tới  trong . Theo định nghĩa này thì . Về mặt trực quan,  chính là khoảng cách ngắn nhất từ  tới  trong  nếu ta gán trọng số  cho mọi cung của . Dễ thấy,  với mọi . Nhắc lại, một cung  được gọi là bị bão hòa bởi luồng  nếu . Theo định nghĩa đồ thị tăng luồng, nếu một cung  bị bão hòa bởi luồng  thì nó sẽ không xuất hiện (mà cung ngược của nó sẽ xuất hiện) trong đồ thị thặng dư . Ta nói  bị  khỏi đồ thị thặng dư . Nếu một cung bị biến mất khỏi đồ thị  thì có thể nó lại xuất hiện ở đồ thị  với . Ý tưởng trong chứng minh Theorem 1 của Edmond và Karp đó là mỗi cung  sẽ bị biến mất không quá  lần trong toàn bộ quá trình tăng luồng, và do mỗi lần tăng luồng, ít nhất 1 cung sẽ bị biến mất (bão hòa), do đó, số lần tăng luồng tối đa là .  Trước hết, ta sẽ chứng minh rằng, sau mỗi lần tăng luồng, level của các đỉnh không bao giờ giảm xuống. 
 Ta chỉ cần chứng minh Lemma 1 đúng cho trường hợp . Ta sẽ chứng minh bằng quy nạp trên hai biến  và . Dễ thấy  luôn bằng 0 với mọi , do đó, Lemma đúng với .Gọi  là một cung của  sao cho . Theo quy nạp, .  Ta cần chứng minh . Ta có hai trường hợp: 
 Giả sử cung  và cung này bị biến mất sau khi tăng luồng tại bước . Theo định nghĩa, ta có:  Gọi  là chỉ số  lớn hơn  sao cho cung  lại xuất hiện trong .Do  xuất hiện trong  (nhưng không ở trong ), cung ngược của nó  là cung bị biến mất khỏi . Do đó, ta có    Do , theo Lemma 1, ta suy ra . Kêt hợp với , ta suy ra:  Hay nói cách khác, mỗi khi cung  biến mất và sau đó lại xuất hiện, mức của  lại tăng lên ít nhất 2 đơn vị. Do  với mọi , cung  biến mất không quá  lần (dpcm).  Trong phân tích trên, ta không hề sử dụng điều kiện nguyên của khả năng thông qua. Do đó, thuật toán đường ngắn sẽ cho ta luồng cực đại trong thời gian  ngay cả khi khả năng thông qua không phải là nguyên. Ý tưởng của giải thuật khá "tự nhiên": 
Cuối bài, ta sẽ tìm hiểu cách tìm đường tăng luồng "béo" nhất (đường cho ta lượng tăng luồng lớn nhất) từ  đến  trong thời gian . Bay giờ chúng ta tạm thời thống nhất là đường béo có thể được tìm một cách hiệu quả.  Câu hỏi tương tự phần trước là: thuật toán Ford-Fulkerson sẽ kết thúc sau bao nhiêu bước tăng luồng? Để trả lời câu hỏi này, chúng ta cần phải có cách nhìn khác về đường tăng luồng.Nhắc lại,  là đồ thị thặng dư tương ứng với luồng . Gọi  là đường tăng luồng trong đồ thị  và  là trọng số của cung nhỏ nhất trong . Ta gọi  là  của đường tăng luồng .  Đường "béo" nhất chính là đường có động rộng  lớn nhất. Nếu ta coi  là một luồng trong đồ thị thặng dư, gọi là ,  thì luồng này có giá trị là . Với cách nhìn đó, thay vì tăng luồng dọc theo đường tăng luồng, ta có thể tăng luồng (trong đồ thị gốc) dọc theo các cung có luồng không âm của luồng thặng dư, mà vẫn đảm bảo luồng sau khi tăng là một luồng hợp lệ. Ngoài ra, lượng tăng luồng sau mỗi bước tăng cũng đúng bằng  giá trị của luồng thặng dư. Bạn đọc cần phải phân biệt rõ ràng khái niệm luồng cực đại và luồng dư cực đại trước khi đọc tiếp. Luồng cực đại là luồng trong đồ thị gốc và luồng dư cực đại là luồng cực đại trong đồ thị thặng dư.Ta gọi  là luồng cực đại (của đồ thị gốc). Gọi  là luồng sau khi thực hiện tăng luồng lần thứ  dọc theo đường tăng luồng béo nhất và  là luồng thặng dư  của đồ thị thặng dư . Ban đầu  và . Theo phân tích ở trên, ta có:  Theo , ta dễ dàng suy ra nếu  được tăng lên một lượng  () thì  sẽ bị giảm đi cùng một lượng  ().Cũng theo , nếu ta tìm được luồng dư cực đại thì chỉ cần 1 bước tăng luồng nữa là ta tìm được luồng cực đại trong đồ thị gốc. Tuy nhiên,  tìm luồng dư cực đại không dễ hơn tìm luồng cực đại trong đồ thị gốc và chúng ta cũng không cố gắng đi tìm luồng dư cực đại. Ở đây, ta sẽ cố gắng liên hệ độ rộng của đường tăng luồng béo nhất với . Gọi  là  độ rộng của đường tăng luồng béo nhất trong đồ thị thặng dư . Ta sẽ có:   
Ta sẽ sử dụng theo định lý Ford-Fulkerson: khả năng thông qua của bất kì một lát cắt nào cũng lớn hơn giá trị của luồng cực đại. Gọi  là tập các đỉnh trong đồ thị thặng dư sao cho với mỗi , tồn tại một đường đi từ  tới  sao cho mọi cung trên đường đi này đều có trọng số lớn hơn (nhưng không bằng) . Gọi . Rõ ràng, , vì nếu không, ta sẽ tìm được đường đi từ  đến  với độ rộng lớn hơn ; điều này trái với định nghĩa của . Theo định nghĩa của , mọi cung từ  tới  đều có trọng số nhỏ hơn hoặc bằng . Do lát cắt  có tối đa  cung, ta có:  Kết hợp với định lý Ford-Fulkerson, ta suy ra điều phải chứng minh. 
 Theo nhận xét từ , mỗi bước ta tăng luồng của đồ thị gốc một lượng  thì luồng dư cực đại cũng bị giảm đi . Do đó:  Theo Lemma 3, ta có , ta suy ra:  Từ , ta suy ra . Khi , ta có:  Ở đây, ta sử dụng bất đẳng thức ,  là cơ số của logarithm tự nhiên. Như vậy, luồng dư cực đại tại bước thứ  có giá trị không quá 1. Do khả năng thông qua là nguyên, ta chỉ cần tăng luồng thêm một lần nữa thì luồng dư cực đại tại bước  sẽ là . Lúc đó, theo , luồng trong đồ thị gốc thu được là luồng cực đại.: Tư tưởng tìm đường rộng nhất giống như tư tưởng tìm đường đi ngắn nhất của . Mình sẽ không đi sâu vào chi tiết mà chỉ lượt qua ý tưởng cơ bản. Ta bắt đầu từ đỉnh  và xây dựng "cây đường đi béo nhất" (thay vì cây đường đi ngắn nhất trong Dijkstra) có gốc tại . Với mỗi đỉnh , đường đi (duy nhất) từ  tới  trong cây chính là đường đi béo nhất trong  từ  tới . Mỗi bước, ta sẽ thêm một đỉnh vào cây này (ban đầu cây chỉ có một đỉnh là ). Với mỗi đỉnh  không thuộc cây, gọi  là trọng số của cung lớn nhất  với  là đỉnh thuộc cây đã xây dựng. Nếu đỉnh  không có cung nào như vậy thì coi .  Ta sẽ thêm vào cây đỉnh  có  lớ nhất. Tiếp tục lặp lại cho đến khi ta thêm  vào cây, và đường đi béo nhất tương ứng sẽ là đường đi từ  tới  trên cây.Chứng minh tính đúng đắn mình coi như bài tập cho bạn đọc (mình khuyến khích bạn đọc xem lại chi tiết và cách chứng minh thuật toán Dijkstra). Cũng như Dijkstra, thuật toán này có thể thực thi trong thời gian . Kết hợp với Lemma 4, ta có:  Trong giải thuật đường béo, ta có sử dụng tính nguyên của khả năng thông qua để chứng minh tính dừng của giải thuật.  [1] J. Edmonds and R.M. Karp.  Journal of the ACM (JACM) 19.2 (1972): 248-264.
[2] J. Erickson. , UIUC, Fall 2013. , Trackback link: Powered by  and 