Một số bài toán NP-complete trên đồ thị -- NP-complete problems on graphs
http://www.giaithuatlaptrinh.com/?p=1791
Nơi tổng hợp và chia sẻ những kiến thức liên quan tới giải thuật nói chung và lý thuyết khoa học máy tính nói riêng.   in  | Trong , chúng ta đã tìm hiểu về NP-complete và 2 bài toán  đầu tiên là  và . Công cụ để chứng minh một bài toán thuộc  là quy dẫn (reduction), mà cụ thể là Lemma 3 trong . Nói ngắn gọn, để chứng minh một bài toán  thuộc , ta sẽ:Các bạn phải đặc biệt chú ý chiều của quy dẫn::  nếu ta muốn sử dụng bài toán  để chứng minh bài toán  . Càng về sau chúng ta càng dễ nhầm chiều.Trong post này, chúng ta tập trung vào một số bài toán  trên đồ thị: Tập độc lập (indepndent set), phủ đỉnh (vertex cover), clique, chu trình Hamilton và bài toán người du lịch (tsp). Chúng ta sẽ thực hiên quy dẫn theo Figure 1.
Quy dẫn giữa một số bài toán trong đồ thị.Quy dẫn từ  sang  ta đã trình bày trong . Chúng ta sẽ bỏ qua quy dẫn từ  về  vì quy dẫn khá phức tạp, khó trình bày trong khuôn khổ cho phép của post này. Các bạn có thể xem thêm tại [1] và CLRS [2]. Các quy dẫn khác trong hình ta sẽ trình bày ở post này.Trước khi đi vào quy dẫn, mình muốn làm rõ một vài khái niệm và kí hiệu với bài toán . Bạn đọc cần phân biệt biến (variables) và literals. Mỗi biến  có 2 literals tương ứng là  và phủ của nó . Nếu  được gán giá trị   thì literal  sẽ có giá trị  còn literal  sẽ có giá trị . Một mệnh đề (clause)  của  có giá trị  khi và chỉ khi ít nhất 1 literal trong mệnh đề đó có giá trị , mặc dù tất cả các biến trong mệnh đề đó có thể nhận giá trị  .Ngoài ra, theo  của , mỗi mệnh đề của  có  3 literals. Thực tế, bài toán 3SAT với mỗi mệnh đề có  3 literals cũng là NP-complete. Do đó, ta sẽ giả sử mỗi mệnh đề của   có đúng 3 literals, để ta không phải xét các trường hợp khi thực hiện quy dẫn. Ta bắt đầu với bài toán tập độc lập (independent set), do quy dẫn từ  về tập độc lập là quy dẫn phức tạp nhất của bài viết. Sau khi thực hiện quy dẫn này rồi, các quy dẫn khác sẽ dễ hơn nhiều.Một tập đỉnh được gọi là một tập độc lập của một đồ thị nếu như không có cạnh nào nối hai đỉnh cùng thuộc một tập đó (xem lại chi tiết định nghĩa và ví dụ ).  
Ta sẽ chứng minh: 
 Ta sẽ quy dẫn bài toán  về  như sau: bắt đầu từ một biểu thức  thuộc bài toán  , ta sẽ xây dựng một đồ thị  và một số nguyên  (trong thời gian đa thức) sao cho  có một phép gán có giá trị  khi và chỉ khi đồ thị    có một tập độc lập với kích thước ít nhất . Ta bắt đầu bằng cách xây dựng các  cho từng mệnh đề của . Sau đó chúng ta sẽ tìm cách nối các gadget lại với nhau. Một gadget ở đây được hiểu là một đồ thị con để phục vụ cho mục đích giải bài toán của chúng ta. Dựa trên định nghĩa, ta có  nhận xét: với mỗi cạnh , tối đa một đỉnh thuộc tập độc lập.Gadget mệnh đề: với mỗi mệnh đề có 3 biến, ví dụ , ta tạo ra 3 đỉnh mới có nhãn tương ứng  và . Sau đó, ta nối 3 đỉnh này đôi một với nhau.  Xem Figure 2. Chú ý, dấu  phủ trên biến  không có gì đặc biệt, chỉ để minh họa một mệnh đề có cả biến và phủ của biến. Các mệnh đề không có phủ hoặc chỉ có phủ ta làm tương tự. Nhận thấy, với mỗi gadget mệnh đề, chỉ có tối đa một đỉnh thuộc tập độc lập, và đỉnh nào thuộc tập độc lập thì literal tương ứng sẽ nhận giá trị . Ta sẽ thiết lập giá trị   sao cho đúng một trong 3 đỉnh của gadget mệnh đề sẽ thuộc tập độc lập.

 Gadget cho mệnh đề .Giờ ta sẽ nối các gadget mệnh đề lại với nhau. Hiện tại, số đỉnh của đồ thị là  vì với mỗi mệnh đề ta có 3 đỉnh. Với mỗi biến , chỉ có đúng một trong hai literals  và  nhận giá trị , do đó, ta sẽ nối mọi cặp đỉnh có nhãn dạng   và  lại với nhau. Do đó, chỉ đúng có một trong hai đỉnh  và   thuộc tập độc lập. Đỉnh nào thuộc tập độc lập thì ta thiết lập literal tương ứng sẽ nhận giá trị . Như vậy ta đã hoàn thành đồ thị. Xem minh họa trong Figure 3. Để thiết lập giá trị , ta thấy  nhận giá trị   khi và chỉ khi tồn tại một cách gán biến sao cho mọi mệnh đề có giá trị . Hay nói cách khác, mỗi mệnh đề đều có một literal . Điều đó có nghĩa, mỗi gadget mệnh đề có ít nhất 1 biến thuộc tập độc lập. Do đó, ta thiết lập . 
 Các cạnh màu đỏ gạch là các cạnh nối giữa các gadget mệnh đề.Giờ ta sẽ chứng minh  có một phép gán có giá trị  khi và chỉ khi đồ thị    có một tập độc lập với kích thước ít nhất . Chiều thuận : Với mỗi biến ,  nếu phép gán của  gán cho  giá trị , ta lấy đỉnh có nhãn  của mỗi mệnh đề vào tập . Ngược lại, ta lấy đỉnh có nhãn  vào tập . Do phép gán đó là phép gán  , mỗi mệnh đề đều có  một literal có giá trị . Nếu mệnh đề có ít nhất 2 literals có giá trị  có  một literal có giá trị , ta cũng chỉ lấy đúng 1 đỉnh trong số ít nhất 2 đỉnh tương ứng để đảm bảo  là tập đọc lập. Do đó,  có đúng (do đó, ít nhất)  đỉnh.Chiều ngược : Gọi  là một tập độc lập có kích thước ít nhất  trong đồ thị. Do đồ thị có  đỉnh và mỗi gadget mệnh đề chỉ có tối đa  đỉnh trong , ta suy ra  có   đỉnh. Trong  không có 2 đỉnh nào có dạng  và  với mọi  vì theo cách xây dựng đồ thị, ta sẽ có một cạnh nối 2 đỉnh đó. Do đó, trong  có đúng  literals, và các literals tương ứng với mỗi biến  chỉ có dạng  hoặc . Giờ ta sẽ gán giá trị cho biến sao cho mọi literals trong  đều nhận giá trị . Do  chứa đúng một literal  cho mỗi clause, cách gán này khiến mọi mệnh đề có giá trị , do đó, biểu thức sẽ có giá trị  (dpcm).Cho một đồ thị , một tập đỉnh  được gọi là một tập phủ đỉnh (vertex cover) nếu như với mọi cạnh  của đồ thị, ít nhất một trong hai đầu mút của nó thuộc . Tập  được gọi là một Clique nếu như giữa mọi cặp đỉnh của  đều tồn tại một cạnh của đồ thị nối hai đỉnh đó. Xem ví dụ trong hình minh họa trong Figure 4.
 (a) Các đỉnh được tô đậm màu đỏ thuộc Clique có kích thước 4 trong đồ thị  và (b) các đỉnh được tô đậm màu xanh là một tập phủ đỉnh của đồ thị.Bài toán  được định nghĩa như sau: 
Ta có:  
 Ta sẽ quy dẫn từ bài toán . Ở đây mình chỉ lượt qua ý tưởng. Chi tiết chứng minh theo từng bước coi như bài tập của bạn đọc.  Chứng minh dựa trên nhận xét: nếu  là một tập phủ đỉnh của đồ thị thì  là một tập độc lập của đồ thị. Nhận xét này có thể chứng minh bằng phản chứng như sau. Kí hiệu . Nếu  không phải là tập độc lập thì sẽ tồn tại một cạnh nối hai đỉnh của  của . Theo định nghĩa của phủ đỉnh, ít nhất một trong hai đầu mút của cạnh này phải thuộc tập phủ đỉnh, ta thu được phản chứng.Bài toán  được định nghĩa như sau: 
Ta có:  
 Ta sẽ quy dẫn từ bài toán . Cũng như Lemma 2, mình chỉ nêu ý tưởng chính. Chi tiết chứng minh theo từng bước coi như bài tập của bạn đọc.
Ta định nghĩa đồ thị bù, kí hiệu , của đồ thị   như sau. Tập đỉnh của đồ thị bù cũng là tập đỉnh của đồ thị gốc, i.e, . Tập cạnh của đồ thị bù là phần bù của tập cạnh của đồ thị gốc. Nói cách khác, nếu giữa hai đỉnh  của đồ thị gốc không có cạnh nào nối chúng thì ta sẽ thêm cạnh  vào đồ thị bù và ngược lại.Quy dẫn từ  dựa trên nhận xét:  là một Clique của đồ thị  khi và chỉ khi nó là một tập độc lập của đồ thị bù .Bài toán chu trình Hamilton và bài toán người du lịch (tsp) mình đã đã định nghĩa chi tiết kèm ví dụ ở . Mình nhắc lại ngắn gọn hai bài toàn này tại đây.  Ta có: 
 Như đã nói ở đầu bài viết, quy dẫn cho Hamiltonian cycle khá phức tạp và mình sẽ không trình bày cụ thể ở đây. Bạn đọc xem chứng minh chi tiết thêm tại note của Jeff Erickson [2]. Ta sẽ công nhận  là bài toán thuộc lớp . Ta sẽ chứng minh     bằng cách quy dẫn từ bài toán .Gọi  là đồ thị đầu vào của bài toán . Ta quy đồ thị này thành đầu vào của bài toán  bằng cách gán cho mỗi cạnh trọng số  và thiết lập . Ta có nhận xét: đồ thị  với các cạnh trọng số  có một đường đi đóng có tổng trọng số nhỏ hơn hoặc bằng  khi và chỉ khi mọi đỉnh xuất hiện đúng 1 lần trên đường đi, ngoại trừ đỉnh đầu và đỉnh cuối. Do đó, đường đi đóng là chính là một chu trình Hamilton của đồ thị .[1] J. Erickson. . UIUC. 2014
[2] T. H. Cormen, C. E. Leiserson, R. L. Rivest, C. Stein. . Chapter 36. MIT Press and McGraw-Hill. ISBN 0-262-03293-7.  (2001).
[3] M. R. Garey and D. S. Johnson. . W. H. Freeman & Co., New York, NY, USA. 1979. , , , , , , Trackback link: Powered by  and 