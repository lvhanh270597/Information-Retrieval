Luồng trong mạng III: Một số biến thể của luồng -- Network Flow III: Some Flow Variants
http://www.giaithuatlaptrinh.com/?p=1569
Nơi tổng hợp và chia sẻ những kiến thức liên quan tới giải thuật nói chung và lý thuyết khoa học máy tính nói riêng.   in  | Trong post này, chúng ta tìm hiểu 3 biến thể khác nhau của bài toán luồng cực đại:Hai biến thể đầu tiên, ta áp dụng phép quy dẫn để quy về bài toán luồng cơ bản. Bài toán thứ 2 chúng ta sẽ áp dụng thuật toán  để tìm luồng có chi phí cực tiểu. Trong bài này, ta kí hiệu  là mạng đầu vào.Trong biến thể này, mạng của chúng ta, ngoài khả năng thông qua, còn có một tập các đỉnh phát  và một tập các đỉnh thu . Xem ví dụ minh họa trong Figure 1(a). Luồng trong mạng này được định nghĩa là hàm  thỏa mãn điều kiện thông qua và điều kiện bảo toàn luồng tại mọi đỉnh trong . Giá trị của luồng  được định nghĩa là tổng luồng đi ra tại tất cả các đỉnh trong :  Bài toán của chúng ta là tìm một luồng có giá trị cực đại trong mạng. Để quy về bài toán luồng cực đại với một đỉnh phát, một đỉnh thu  mà chúng ta đã biết cách giải, ta sẽ thêm vào 2 đỉnh mới  và . Ta sẽ nối  với mỗi đỉnh phát  bằng một cung  và nối mỗi đỉnh  với đỉnh  bằng một cung . .Xem ví dụ minh họa trong Figure 1(b). Gọi  là mạng thu được. Ta sẽ chứng minh tìm luồng cực đại trong  có thể được quy về tìm luồng cực đại trong , mạng chỉ có một đỉnh phát và một đỉnh thu.
: (a) một luồng với nhiều đỉnh phát/thu (b) đồ thị quy dẫn. 
 Gọi  lần lượt là luồng cực đại trong  và . Trước hết, ta chứng minh . Gọi  là một luồng cực trong . Ta sẽ chuyển luồng này thành một luồng trong . Gọi  là luồng trong đó:  và     Ta có thể dễ dàng kiểm tra điều kiện thông qua của  vì các cạnh mới trong  đều có khả năng thông qua vô hạn. Để kiểm tra điều kiện bảo toàn luồng, ta chỉ cần kiểm tra với các đỉnh thuộc . Ta có thể kiểm tra trực tiếp dựa vào định nghĩa. Do đó, luồng  là một luồng hợp lệ trong . Do đó, . Ngoài ra, do , ta suy ra dpcm.Chứng minh , ta làm tương tự. Chi tiết coi như bài tập cho bạn đọc. Ta sử dụng khả năng thông  chỉ để trình bày được dễ hiểu. Ở đây, ta có thể thay  bằng tổng khả năng thông qua của tất cả các cung. Giả sử mạng của chúng ta chỉ có một đỉnh phát và một đỉnh thu. Tuy nhiên, mỗi cung , ngoài khả năng thông qua, còn có một định mức:  cho biết lượng luồng ít nhất trên cung .  Điều kiện này được gọi . Một luồng được gọi là hợp lệ trong trường hợp này, ngoài điều kiện thông qua và bảo toàn luồng, còn phải thỏa mãn điều kiện định mức. Ví dụ một mạng với định mức cạnh trong Figure 2(a). Bài toán của chúng ta đặt ra là tìm một luồng cực đại với định mức của cung. Trước hết chúng ta giải bài toán đơn giản hơn: tìm một luồng hợp lệ với định mức của cung. Nếu ta tìm được một luồng hợp lệ , chúng ta có thể tìm luồng cực đại với điều kiện định mức bằng cách tăng luồng hợp lệ  này sử dụng ý tưởng của Ford-Fulkerson. Thực ra, khâu khó nhất của bài toán luồng cực đại với định mức chính là tìm một luồng hợp lệ. Trong bài toán luồng cổ điển, luồng với giá trị 0 trên mọi cung là một luồng hợp lệ. Ta sẽ quy bài toán tìm luồng hợp lệ bằng về bài toán luồng cực đại cổ điển  như sau. Thêm vào  hai đỉnh mới  và . Thiết lập khả năng thông qua mới  như sau: 
 Gọi đồ thị mới là . Chú ý, các cung trong  không có định mức (định mức bằng ). Figure 2(b) dưới đây minh họa phép quy dẫn áp dụng cho đồ thị ở Figure 2(a).

 (a) Một mạng với định mức của cạnh. Với mỗi cung dạng ,  là khả năng thông qua và  là định mức.  (b) Đồ thị quy dẫn về bài toán luồng cực đại cổ điển.
Ta sẽ chứng minh tìm luồng hợp lệ trong  có thể quy về tìm luồng cực đại trong . Ta gọi luồng  trong  là một  nếu mọi cung đi ra từ  đều bị bão hòa. Một cách hình thức: 
 Theo định lý luồng cực đại và lắt cắt cực tiểu, luồng bão hòa cũng chính là một luồng cực đại. Do đó, tìm luồng bão hòa trong  cũng chính là tìm luồng cực đại. 
  Ta sẽ phải chứng minh hai chiều: (1) từ một luồng  hợp lệ của , ta sẽ phải biến đổi nó thành một luồng bão hòa trong  và (2) từ một luồng bão hòa trong , ta phải biến đổi nó thành một luồng hợp lệ của .Chứng minh (1). Gọi  là một luồng hợp lệ của . Ta sẽ gán cho mỗi cung của  một luồng với giá trị như sau: 
 Dễ thấy  với mọi cung  do  thõa mãn điều kiện định mức. Ngoài ra, ta dễ dàng kiểm tra được  bão hòa các cung đi ra từ . Luồng  thỏa mãn điều kiện thông qua do  thỏa mãn điều kiện thông qua. Ta chỉ còn phải kiểm tra điều kiện bảo toàn luồng của . Ta thấy với mỗi đỉnh  khác  của , luồng đi vào  trong   bằng luồng đi vào  trong  và luồng đi ra từ  trong   bằng luồng đi ra từ  trong . Tại , luồng đi ra có giá trị  (giả sử luồng cực đại của  của  không có luồng quay ngược lại ). Do ta gán luồng trên cung $ cũng bằng . Do đó, điều kiện bảo toàn luồng thỏa mãn với mọi đỉnh thuộc , ngoại trừ .Chứng minh (2) tương tự như (1) và coi như bài tập cho bạn đọc.Sau khi ta đã có được một luồng hợp lệ với định mức cạnh, ta sẽ sử dụng ý tưởng Ford-Fukerson để tìm đường tăng luồng trong đồ thị thặng dư và thực hiện tăng luồng để tìm luồng cực đại. Tuy nhiên, trong trường hợp này, chúng ta cần phải cần thận trong bước tăng luồng để đảm bảo luồng của các cung sau khi tăng vẫn phải thỏa mãn điều kiện định mức. Ta định nghĩa đồ thị thặng dư như sau. Với mỗi cung  có luồng  không âm, ta định nghĩa 2 cung song song với trọng số: 
 Sau đó, ta thực hiện tìm đường tăng luồng và tăng như trong thuật toán gốc của Ford-Fukerson.Trong phiên bản này, ngoại trừ khả năng thông qua, mỗi cung  của  còn có một chi phí .  Chi phí này là chi phí phải trả cho  luồng trên cung. Chi phí của một luồng  trong  được định nghĩa như sau: 
 Trong Figure 3 là một luồng cực đại với chi phí .
 Một luồng cực đại với chi phí. Mỗi cung có dạng  trong đó  là khả năng thông qua,  là giá trị của luồng trên cung và  là chi phí cho mỗi đơn vị của luồng.Bài toán đặt ra cho chúng ta là trong số các luồng cực đại của , tìm luồng cực đại có chi phí nhỏ nhất. Nhìn dưới góc độ bài toán dẫn dầu như trong bài trước, một công ty muốn chuyển dầu qua mạng đường ống có sẵn sẽ phải trả tiền cho phần ống mà họ chuyển dầu qua. Công ty muốn chuyển được lượng dầu nhiều nhất với chi phí nhỏ nhất, họ sẽ phải tìm luồng cực đại với chi phí cực tiểu.Ta sẽ giả sử đầu thì đầu vào  không có cung song song, i.e, nếu  thì  và ngược lại. Tính chất này có thể được đảm bảo bằng cách thêm một đỉnh mới vào một trong 2 cung song song (xem lại kĩ thuật tương tự trong bài trước).Ý tưởng của thuật toán gồm 2 bước: (1) Tìm một luồng cực đại trong  mà chưa cần quan tâm đến chi phí và (2) thực hiện thay đổi luồng cực đại để thu được một luồng cực đại khác với chi phí nhỏ hơn. Bước (2) sẽ được lặp lại cho đến khi ta không thể thay đổi được luồng cực đại nữa thì luồng cuối cùng thu được sẽ là luồng cực đại có chi phí nhỏ nhất. Bước (1) ta có thể áp dụng bất kì thuật toán tìm luồng cực đại nào. Thực hiện bước (2), ta dựa trên nhận xét: "tăng" luồng dọc theo một chu trình có hướng (trong đồ thị thặng dư) không làm thay đổi giá trị cực đại của luồng. Ví dụ trong Figure 4, hình (b) là luồng thu được sau khi tăng luồng cực đại trong Figure 3 dọc theo một chu trình của đồ thị thặng dư (chu trình màu đỏ). Luồng thu được sau khi tăng có giá trị 15, bằng giá trị của luồng trong Figure 3.
 (a) Đồ thị thặng dư của luồng trong Figure 3 (b) Luồng cực đại thu được sau khi "tăng" luồng cực đại trong Figure 3 dọc theo chu trình màu đỏ trong (a).Do đó, ta có thể thay đổi một luồng cực đại thành một luồng cực đại khác bằng cách tăng luồng dọc theo chu trình. Để giảm chi phí của luồng cực đại mỗi khi thay đổi luồng, ta phải tìm một chu trình trong đồ thị thặng dư sao cho khi tăng luồng dọc theo chu trình này, chi phí của luồng cực đại sẽ giảm đi. Do đó, ta cần phải đưa thêm chi phí vào trong định nghĩa của đồ thị thặng dư, mà ta gọi là  và kí hiệu là . Với mỗi cung  mà  dương, ta định nghĩa cung ngược  trong  với trọng số . Nếu  < , ta định nghĩa cung   với trọng số . Xem ví dụ trong Figure 5. Về cơ bản, đồ thị chi phí thặng dư có cấu trúc giống đồ thị thặng dư, chỉ khác trọng số ở đây là chi phí.
 Đồ thị chi phí thặng dư của luồng trong Figure 3.Ta sẽ tìm một chu trình âm trong  với trọng số  (sử dụng  chẳng hạn), và thực hiện tăng luồng dọc theo chu trình âm này. Dễ thấy sau khi tăng luồng, chi phí của luồng cực đại sẽ giảm đi , trong đó  là lượng luồng tăng dọc theo chu trình âm và  là chi phí (trọng số) của chu trình âm. Trong Figure 5, chu trình âm tìm được là chu trình mà đỏ với chi phí  và  (xem Figure 4(b)). Do đó nêu tăng luồng dọc theo chu trình âm này, chi phí sẽ giảm đi  đơn vị. Luồng cực đại có thể tìm được trong thời gian  (sử dụng thuật toán Orlin[2]). Chu trình âm có thể tìm được trong thời gain  sử dụng Bellman-Ford. Mỗi bước tăng luồng, chi phí của luồng cực đại giảm đi ít nhất 1 đơn vị. Do đó, cần tối đa  bước tăng luồng, trong đó  là chi phí của luồng cực đại. Như vậy, ta có thể thực thi thuật toán này trong thời gian O(VEC). Tất nhiên đây không phải là thời gian đa thức vì  có thể biểu diễn được bằng  bít. Một số kĩ thuật như Edmond-Karp cũng không áp dụng được ở đây vì bài toán tìm chu trình âm với chi phí nhỏ nhất và bài toán tìm chu trình âm có ít cạnh nhất đều là các bài toán NP-Hard. Goldberg và Tajan [3] đưa ra thuật toán tìm chu trình âm với chi phí trung bình nhỏ nhất (chi phí trung bình ở đây là chi phí trung bình trên mỗi cạnh) trong thời gian đa thức và chứng minh rằng phép tăng luồng sẽ kết thúc sau đa thưc bước, do đó, cho ta thuật toán thời gian đa thức.[1] J. Erickson. , UIUC, Fall 2013.
[2] J.B. Orlin.. In Proceedings of the 45th Annual ACM Symposium on Theory of Computing, pp. 765-774. ACM, 2013.
[3] A. V. Goldberg and R. E. Tarjan. . J. Assoc. Comput. Mach., 36(4):873-886, 1989. , , , , Trackback link: Powered by  and 