{"content": "Bài viết sưu_tầm trên mạng .\nTable of_Contents 1 .\nDãy con đơn_điệu dài nhất 1 . 1 . Mô_hình 1 . 2 . Công_thức QHĐ 1 . 3 . Cài_đặt 1 . 4 . Một_số bài_toán khác Bố_trí phòng_họp (mất tính thứ_tự so_với dãy ban đầu) Cho_thuê máy Dãy tam_giác bao nhau Dãy đổi dấu Dãy_số WAVIO_Xếp các khối đá 2 .\nVali (B) 2 . 1 . Mô_hình 2 . 2 . Công_thức 2 . 3 . Cài_đặt 2 . 4 . Một_số bài_toán khác Dãy con có tổng_bằng S_Chia kẹo_Market (Olympic Balkan 2000) Điền_dấu Expression_Farmer (IOI 2004) 3 .\nBiến_đổi xâu 3 . 1 . Mô_hình 3 . 2 . Hướng_dẫn 3 . 3 . Một_số bài_toán khác Xâu con chung dài nhất Bắc_cầu Palindrome (IOI 2000) 4 .\nVali (A) 4 . 1 . Mô_hình 4 . 2 . Công_thức 4 . 3 . Cài_đặt 4 . 4 . Một_số bài_toán khác Đổi_tiền 5 .\nNhân ma_trận 5 . 1 . Mô_hình 5 . 2 . Công_thức 5 . 3 . Cài_đặt 5 . 4 . Một_số bài_toán khác Chia đa_giác Biểu_thức số_học (IOI 1999) 6 .\nGhép_cặp 6 . 1 . Mô_hình 6 . 2 . Công_thức 6 . 3 . Cài_đặt 6 . 4 . Một_số bài_toán khác Câu_lạc_bộ Mua giày (Đề QG bảng B năm 2003) 7 .\nDi_chuyển 7 . 1 . Mô_hình 7 . 2 . Công_thức 7 . 3 . Cài_đặt 7 . 4 . Một_số bài_toán khác Tam_giác (IOI 1994) 1 .\nDãy con đơn_điệu dài nhất 1 . 1 . Mô_hình Cho dãy A_1 , A_2 , . . . , A_n .\nHãy tìm một dãy con tăng có nhiều phần_tử nhất của dãy .\nĐặc_trưng : Các phần_tử trong dãy kết_quả chỉ xuất_hiện 1 lần .\nVì_vậy phương_pháp làm là ta sẽ dùng vòng For duyệt qua các phần_tử A trong dãy , khác với các bài_toán của mô_hình 4 (đặc trưng là bài_toán đổi tiền) , các phần_tử trong dãy có_thể được chọn nhiều lần nên ta thực_hiện bằng phương_pháp cho giá_trị cần quy_đổi tăng dần từng đơn_vị .\nThứ_tự của các phần_tử được chọn phải được giữ_nguyên so_với dãy ban_đầu .\nĐặc_trưng này có_thể mất đi trong một_số bài_toán khác tùy vào yêu_cầu cụ_thể .\nChẳng_hạn bài : Tam_giác bao nhau .\n1 . 2 . Công_thức QHĐ Hàm_mục_tiêu : f : độ_dài dãy con .\nVì độ_dài dãy con chỉ phụ_thuộc vào một yếu_tố là dãy ban_đầu nên bảng phương_án là bảng một_chiều .\nGọi L_i là độ_dài dãy con tăng dài nhất , các phần_tử lấy trong miền từ A_1 đến A_i và phần_tử cuối_cùng là A_i .\nNhận_xét với cách làm này ta đã chia 1 bài_toán lớn (dãy con của n số) thành các bài_toán con cùng kiểu có kích_thước nhỏ hơn (dãy con của dãy i số) .\nVấn_đề là công_thức truy_hồi để phối_hợp kết_quả của các bài_toán con .\nTa có_công thức QHĐ để tính L_i như_sau : L_1 = 1 .\n(Hiển nhiên) L_i = max(1 , L_j + 1) với mọi phần_tử j thỏa_mãn : 0lt;jlt;i và A_j \\le A_i Tính L_i : phần_tử đang được xét là A_i .\nTa tìm đến phần_tử A_j lt; A_i có L_j lớn nhất .\nKhi đó nếu bổ_sung A_i vào sau dãy con . . . A_j ta sẽ được dãy con tăng dần dài nhất xét từ A_1 . . . A_i .\n1 . 3 . Cài_đặt Bảng phương_án là một mảng một_chiều L để lưu_trữ các giá_trị của hàm QHĐ L_i .\nĐoạn chương_trình tính các giá_trị của mảng L như_sau : for i : = 1 to n do begin L i : = 1 ; for j : = 1 to i - 1 do if ( A j lt;= A i ) and ( L i lt; L j + 1 ) then L i : = L j + 1 ; end ; Như_vậy độ phức_tạp bộ_nhớ của bài_toán là O(n) , độ phức_tạp thời_gian là O(n2) .\nCó_một số phương_pháp cài_đặt tốt hơn so_với phương_pháp trên , cho chi_phí thời_gian là O(nlogn) , một trong những cách đó là dùng Segment_Tree .\n1 . 4 . Một_số bài_toán khác Bài_toán dãy con đơn_điệu tăng dài nhất có biến_thể đơn_giản nhất_là bài_toán dãy con đơn_điệu giảm dài nhất , tuy_nhiên chúng_ta có_thể coi chúng như_là một .\nSau_đây là một_số bài_toán khác .\nBố_trí phòng_họp (mất tính thứ_tự so_với dãy ban đầu) Bài_toán : Có n cuộc_họp , cuộc_họp thứ i bắt_đầu vào thời_điểm A_i và kết_thúc ở thời_điểm B_i .\nDo chỉ_có một phòng hội_thảo nên 2 cuộc_họp bất_kì sẽ được cùng bố_trí phục_vụ nếu khoảng thời_gian làm_việc của chúng chỉ giao nhau tại đầu_mút .\nHãy bố_trí phòng_họp để phục_vụ được nhiều cuộc_họp nhất .\nHướng_dẫn : Sắp_xếp các cuộc_họp tăng dần theo_thời điểm kết_thúc B_i .\nThế_thì cuộc_họp i sẽ bố_trí được sau cuộc_họp j khi và chỉ khi jlt;i và B_j \\le A_i .\nYêu_cầu bố_trí được nhiều cuộc_họp nhất có_thể đưa về việc tìm dãy các cuộc_họp dài nhất thoả_mãn điều_kiện trên .\nCho_thuê máy Bài_toán : Trung_tâm tính_toán hiệu_năng cao nhận được đơn đặt_hàng của n khách_hàng .\nKhách_hàng i muốn sử_dụng máy trong_khoảng thời_gian từ a_i đến b_i và trả tiền thuê là c_i .\nHãy bố_trí lịch thuê máy để tổng_số tiền thu được là lớn nhất mà thời_gian sử_dụng máy của 2 khách_hàng bất_kì được phục_vụ đều không giao nhau (cả trung_tâm chỉ_có một máy cho thuê) .\nHướng_dẫn : Tương_tự như bài_toán bố_trí phòng_họp , nếu sắp_xếp các đơn đặt_hàng theo_thời điểm kết_thúc , ta sẽ đưa được về bài_toán tìm dãy con có tổng_lớn nhất .\nBài_toán này là biến_thể của bài_toán tìm dãy con tăng dài nhất , ta có_thể cài_đặt bằng đoạn chương_trình như_sau : for i : = 1 to n do begin L i : = C i ; for j : = 1 to i - 1 do if ( B j lt;= A i ) and ( L i lt; L j + C i ) then L i : = L j + C i ; end ; Dãy tam_giác bao nhau Bài_toán : Cho n tam_giác trên mặt_phẳng .\nTam_giác i bao tam_giác j nếu 3 đỉnh của tam_giác j đều nằm trong tam_giác i (có thể nằm trên cạnh) .\nHãy tìm dãy tam_giác bao nhau có nhiều tam_giác nhất .\nHướng_dẫn : Sắp_xếp các tam_giác tăng dần về diện_tích .\nKhi đó tam_giác i sẽ bao tam_giác j nếu jlt;i và 3 đỉnh của j nằm trong i .\nTừ_đó có_thể đưa về bài_toán tìm dãy “tăng” dài nhất .\nBài_toán có_một số biến_thể khác như tìm dãy hình_tam_giác , hình chữ nhật… bao nhau có tổng_diện_tích lớn nhất .\nViệc kiểm_tra điểm M có nằm trong tam_giác ABC không có_thể dựa trên phương_pháp tính diện_tích : điểm M nằm trong nếu S(ABC) = S(ABM) + S(ACM) + S(BCM) .\nDãy đổi dấu Bài_toán : Cho dãy A_1 , A_2 , . . . , A_N .\nHãy tìm dãy con đổi dấu dài nhất của dãy đó .\nDãy con đổi dấu A_i1 , A_i2 , . . . , A_ik phải thoả_mãn các điều_kiện sau : A_i1 lt; A_i2 gt; A_i3 lt; . . .\nhoặc A_i1 gt; A_i2 lt; A_i3 gt; . . .\nCác chỉ_số phải_cách nhau ít_nhất L : i_2 - i_1 \\ge L , i_3 - i_2 \\ge L , . . .\nChênh_lệch giữa 2 phần_tử liên_tiếp nhỏ hơn U : A_i1 - A_i2 \\le U , A_i2 - A_i3 \\le U , . . .\nHướng_dẫn : Gọi L_i là số phần_tử của dãy con đổi dấu có phần_tử cuối_cùng là A_i và phần_tử cuối_cùng lớn hơn phần_tử đứng trước .\nTương_tự , P_i là số phần_tử của dãy con đổi dấu có phần_tử cuối_cùng là A_i và phần_tử cuối_cùng nhỏ hơn phần_tử đứng trước .\nTa dễ_dàng suy ra : L_i = max(1 , P_j + 1) , với mọi j thỏa_mãn : j \\le i-L và A_i - U \\le A_j lt; A_i .\nP_i = max(1 , L_j + 1) , với mọi j thỏa_mãn : j \\le i-L và A_i lt; A_j \\le A_i + U .\nDãy_số WAVIO Bài_toán : Dãy_số Wavio là dãy_số nguyên thỏa_mãn các tính_chất : các phần_tử đầu sắp_xếp thành 1 dãy tăng dần đến 1 phần_tử đỉnh sau_đó giảm_dần .\nVí_dụ dãy_số 1 2 3 4 5 2 1 là 1 dãy Wavio độ_dài 7 .\nCho 1 dãy gồm N số_nguyên , hãy chỉ ra một dãy con Wavio có đọ dài lớn nhất trích ra từ dãy đó .\nHướng_dẫn : L1_i là mảng ghi độ_dài lớn nhất của 1 dãy con tăng dần trích ra từ dãy N phần_tử kể_từ phần_tử 1 đến phần_tử a_i .\nL2_i : mảng ghi độ_dài lớn nhất của dãy con giảm_dần trích ra từ dãy N phần_tử kể_từ phần_tử A_N đến A_i .\nTa tìm phần_tử j trong 2 mảng L1 , L2 thỏa_mãn L1_j + L2_j lớn nhất .\nXếp các khối đá Bài_toán : Cho_N khối đá (N \\le 5000) .\nCác khối đá đều có dạng_hình hộp chữ_nhật và được đặc_trưng bới 3 kích_thước : dài , rộng , cao .\nMột_cách xây_dựng tháp là một_cách đặt một_số các khối đá trong các khối đá đã cho chồng lên nhau theo quy_tắc : Chiều_cao mỗi khối đá là kích_thước nhỏ nhất trong 3 kích_thước .\nCác mép của khối đá được đặt song_song với_nhau sao_cho không có phần_nào của khối trên nằm chìa ra ngoài khối dưới .\nHãy chỉ ra cách để xây_dựng được_một_cái tháp sao_cho số_khối đá được dùng là nhiều nhất .\n2 .\nVali (B) 2 . 1 . Mô_hình Có n đồ_vật , vật thứ i có trọng_lượng A_i và giá_trị B_i .\nHãy chọn ra một_số các đồ_vật , mỗi vật một cái để xếp vào 1 vali có trọng_lượng tối_đa W sao_cho tổng_giá trị của vali là lớn nhất .\n2 . 2 . Công_thức Hàm_mục_tiêu : f : tổng_giá trị của vali .\nNhận_xét : giá_trị của vali phụ_thuộc vào 2 yếu_tố : có bao_nhiêu vật đang được xét và trọng_lượng của các vật .\nDo_đó bảng phương_án sẽ là bảng 2 chiều : - L(i , j) : tổng_giá trị lớn nhất của vali khi xét từ vật 1 . .\nvật i và trọng_lượng của vali chưa vượt_quá j .\nChú_ý rằng khi xét đến Li , j thì các giá_trị trên bảng phương_án đều đã được tối_ưu .\nTính_L(i , j) : vật đang xét là a_i với trọng_lượng của vali không được quá j .\nCó 2 khả_năng xảy_ra : Nếu chọn A_i đưa_vào vali , trọng_lượng vali trước đó phải không quá j - A_i .\nVì mỗi vật chỉ được chọn 1 lần nên giá_trị lớn nhất của vali lúc_đó là L(i-1 , j - A_i) + B_i .\nNếu_không chọn A_i , trọng_lượng của vali là như_cũ (như lúc trước_khi chọn A_i) : L(i-1 , j) .\nTóm_lại ta có Li , j = max(L(i-1 , j - A_i) + B_i , L(i-1 , j)) .\n2 . 3 . Cài_đặt For i : = 1 to n do For j : = 1 to W do If b i lt;= j then L i , j : = max ( L i - 1 , j - A i + B i , L i - 1 , j ) else L i , j : = L i - 1 , j ; 2 . 4 . Một_số bài_toán khác Dãy con có tổng_bằng S Bài_toán : Cho dãy A_1 , A_2 , . . . , A_N .\nTìm một dãy con của dãy đó có tổng_bằng S .\nHướng_dẫn : Đặt_Li , t=1 nếu có_thể tạo ra tổng t từ một dãy con của dãy gồm các phần_tử A_1 , A_2 , . . . , A_i .\nNgược_lại thì Li , t=0 .\nNếu_Ln , S=1 thì đáp_án của bài_toán trên là “có” .\nTa có_thể tính Li , t theo công_thức : Li , t=1 nếu Li-1 , t=1 hoặc Li-1 , t-ai=1 .\nCài_đặt : Nếu áp_dụng luôn công_thức trên thì ta cần_dùng bảng phương_án hai chiều .\nTa có_thể nhận_xét rằng để tính dòng thứ i , ta chỉ_cần dòng i-1 .\nBảng phương_án khi đó chỉ_cần 1 mảng 1 chiều L0 . . S và được tính như_sau : L t : = 0 ; L 0 : = 1 ; for i : = 1 to n do for t : = S downto a i do if ( L t = 0 ) and ( L t - a i = 1 ) then L t : = 1 ; Dễ thấy độ phức_tạp bộ_nhớ của cách cài_đặt trên là O(m) , độ phức_tạp thời_gian là O(n m) , với m là tổng của n số .\nHãy tự kiểm_tra xem tại_sao vòng for thứ 2 lại là for downto chứ không_phải là for to .\nChia kẹo Bài_toán : Cho n gói kẹo , gói thứ i có a_i viên .\nHãy chia các gói thành 2 phần sao_cho chênh_lệch giữa 2 phần là ít_nhất .\nHướng_dẫn : Gọi_T là tổng_số kẹo của n gói .\nChúng_ta cần tìm số S lớn nhất thoả_mãn : S \\le T/2 .\nCó_một dãy con của dãy a có tổng_bằng S .\nKhi đó sẽ có cách chia với chênh_lệch 2 phần là T-2S là nhỏ nhất và dãy con có tổng_bằng S ở trên gồm các phần_tử là các gói kẹo_thuộc phần thứ nhất .\nPhần thứ_hai là các gói kẹo_còn lại .\nMarket (Olympic Balkan 2000) Bài_toán : Người đánh_cá Clement bắt_được n con cá , khối_lượng mỗi con là a_i , đem bán ngoài chợ .\nỞ chợ cá , người_ta không mua cá theo từng con mà mua theo một lượng nào_đó .\nChẳng_hạn 3 kg , 5kg . . .\nVí_dụ : có 3 con cá , khối_lượng lần_lượt là : 3 , 2 , 4 .\nMua lượng 6kg sẽ phải lấy con cá thứ 2 và và thứ 3 .\nMua lượng 3 kg thì lấy con_thứ nhất .\nKhông_thể mua lượng 8 kg .\nNếu bạn là người đầu_tiên mua cá , có bao_nhiêu lượng bạn có_thể chọn ?\nHướng_dẫn Thực_chất bài_toán là tìm các số S mà có_một dãy con của dãy a có tổng_bằng S .\nTa có_thể dùng phương_pháp đánh_dấu của bài chia kẹo ở trên rồi đếm các giá_trị t mà Lt=1 .\nĐiền_dấu Bài_toán : Cho n số_tự_nhiên A_1 , A_2 , . . . , A_N .\nBan_đầu các số được đặt liên_tiếp theo đúng thứ_tự cách nhau bởi dấu \" ? \" : A1 ?\nA2 ?\n. . .\n?\nAN .\nCho trước_số nguyên S , có cách nào thay các dấu ?\nbằng dấu + hay dấu − để được một biểu_thức số_học cho giá_trị là S không ?\nHướng_dẫn : Đặt_Li , t=1 nếu có_thể điền_dấu vào i số đầu_tiên và cho kết_quả bằng t .\nTa có_công thức sau để tính L : L1 , a1 = 1 Li , t = 1 nếu Li - 1 , t + ai = 1 hoặc Li - 1 , t - ai = 1 .\nNếu_Ln , S = 1 thì câu trả_lời của bài_toán là có .\nKhi cài_đặt , có_thể dùng một mảng 2 chiều (lưu toàn_bộ bảng phương án) hoặc 2 mảng một_chiều (để lưu dòng i và dòng i-1) .\nChú_ý là chỉ_số theo t của các mảng phải có cả phần âm (tức là từ -T đến T , với T là tổng của n số) , vì trong bài này chúng_ta dùng cả dấu - nên có_thể tạo ra các tổng_âm .\nBài này có_một biến_thể là đặt dấu sao_cho kết_quả là một_số chia_hết_cho k .\nTa có thuật_giải tương_tự bài_toán trên bằng cách thay các phép_cộng , trừ bằng các phép_cộng và trừ theo modulo k và dùng mảng đánh_dấu với các giá_trị từ 0 đến k-1 (là các số_dư có_thể có_khi chia cho k) .\nĐáp_số của bài_toán là Ln , 0 .\nExpression Bài_toán : Cho n số_nguyên .\nHãy chia chúng thành 2 nhóm sao_cho tích của tổng 2 nhóm là lớn nhất .\nHướng_dẫn : Gọi_T là tổng n số_nguyên đó .\nGiả_sử_ta chia dãy thành 2 nhóm , gọi S là tổng của một nhóm , tổng nhóm còn_lại là T-S và tích của tổng 2 nhóm là S(T-S) .\nBằng phương_pháp đánh_dấu ta xác_định được mọi số S là tổng của một nhóm (như bài Market) và tìm số S sao_cho S(T-S) đạt max .\nFarmer (IOI 2004) Bài_toán Một người có N mảnh_đất và M dải_đất .\nCác mảnh_đất có_thể coi là một tứ_giác và các dải_đất thì coi_như một đường_thẳng .\nDọc theo các dải_đất ông ta trồng các cây bách , dải_đất thứ i có A_i cây bách .\nÔng ta cũng trồng các cây bách trên viền của các mảnh_đất , mảnh_đất thứ j có B_j cây bách .\nCả ở trên các mảnh_đất và dải_đất , xen giữa 2 cây bách ông ta trồng một cây ôliu .\nÔng ta cho con_trai được chọn các mảnh_đất và dải_đất tuỳ_ý với điều_kiện tổng_số cây bách không vượt_quá Q .\nNgười con_trai phải chọn thế_nào để có nhiều cây ôliu (loài cây mà anh ta thích) nhất .\nHướng_dẫn Dễ thấy mảnh_đất thứ i có A_i cây ôliu và dải_đất thứ j có B_j-1 cây ôliu .\nCoi các mảnh_đất và dải_đất là các “đồ vật” , đồ_vật thứ k có khối_lượng W_k và giá_trị V_k (nếu k là mảnh_đất i thì W_k=V_k=A_i , nếu k là dải_đất j thì W_k=B_j , V_k=B_j-1) .\nTa cần chọn các “đồ vật” , sao_cho tổng “khối lượng” của chúng không vượt Q và tổng “giá trị” là lớn nhất .\nĐây chính là bài_toán xếp balô đã trình_bày ở trên .\n3 .\nBiến_đổi xâu 3 . 1 . Mô_hình Cho 2 xâu X , F .\nXâu gốc có n kí_tự X_1 X_2 . . .\nX_n , xâu đích có m kí_tự F_1 F_2 . . .\nF_m .\nCó 3 phép biến_đổi : Chèn 1 kí_tự vào sau kí_tự thứ i : I i C Thay_thế kí_tự ở vị_trí thứ i bằng kí_tự C : R i C_Xoá kí_tự ở vị_trí thứ i : D i Hãy tìm số_ít nhất các phép biến_đổi để biến xâu X thành xâu F .\n3 . 2 . Hướng_dẫn Hàm_mục_tiêu : f : số phép biến_đổi .\nDễ thấy số phép biến_đổi phụ_thuộc vào vị_trí i đang xét của xâu X và vị_trí j đang xét của xâu F .\nDo_vậy để cài_đặt cho bảng phương_án ta sẽ dùng mảng 2 chiều .\nGọi_Li , j là số phép biến_đổi ít_nhất để biến xâu X_i gồm i kí_tự phần đầu của X (X_i = X1 . . i) thành xâu F_j gồm j kí_tự phần đầu của F (F_j = F1 . . j) .\nDễ thấy L0 , j=j và Li , 0=i .\nCó 2 trường_hợp xảy_ra : Nếu_Xi = Fj : X_1 X_2 . . .\nX_i-1 X_i F_1 F_2 . . .\nF_j-1 X_i thì ta chỉ phải biến_đổi xâu X_i-1 thành xâu F_j-1 .\nDo_đó Li , j=Li-1 , j-1 .\nNgược_lại , ta có 3 cách biến_đổi : Xoá kí_tự X_i : X_1 X_2 . . .\nX_i-1 F_1 F_2 . . .\nF_j-1 F_j Xâu X_i-1 thành F_j .\nKhi đó Li , j=Li-1 , j+1 .\n(Cộng 1 là do ta đã dùng 1 phép xóa) Thay_thế X_i bởi F_j : X_1 X_2 . . .\nX_i-1 F_j F_1 F_2 . . .\nF_j-1 F_j Xâu X_i-1 thành F_j-1 .\nKhi đó Li , j=Li-1 , j-1+1 .\nChèn F_j vào sau X_i : X_1 X_2 . . .\nX_i F_j F_1 F_2 . . .\nF_j-1 F_j Xâu X_i thành F_j-1 .\nKhi đó Li , j=Li , j-1+1 Tổng_kết lại , ta có_công thức QHĐ : L0 , j=j Li , 0=i Li , j =Li−1 , j−1 nếu X_i = Y_j .\nLi , j = min(Li−1 , j , Li , j−1 , Li−1 , j−1) + 1 nếu X_i \\ne F_j .\nBài này ta có_thể tiết_kiệm biến hơn bằng cách dùng 2 mảng 1 chiều tính lẫn_nhau và một mảng đánh_dấu 2 chiều để truy vết .\n3 . 3 . Một_số bài_toán khác Xâu con chung dài nhất Bài_toán : Cho 2 xâu X , Y .\nHãy tìm xâu con của X và của Y có độ_dài lớn nhất .\nBiết xâu con của một xâu thu được khi xóa_một số kí_tự thuộc xâu đó (hoặc không xóa kí_tự nào) .\nCông_thức QHĐ : Gọi_Li , j là độ_dài xâu con chung dài nhất của xâu X_i gồm i kí_tự phần đầu của X (X_i = X1 . . i) và xâu Y_j gồm j kí_tự phần đầu của Y (Y_j = Y1 . . j) .\nTa có_công thức quy_hoạch_động như_sau : L0 , j = Li , 0 = 0 Li , j = Li−1 , j−1 + 1 nếu X_i = Y_j Li , j = max(Li−1 , j , Li , j−1) nếu X_i \\ne Y_j .\nCài_đặt : Bảng phương_án là một mảng 2 chiều L0 . . m , 0 . . n để lưu các giá_trị của hàm QHĐ_Li , j .\nĐoạn chương_trình cài_đặt công_thức QHĐ trên như_sau : for i : = 0 to m do L i , 0 : = 0 ; for j : = 0 to n do L 0 , j : = 0 ; for i : = 1 to m do for j : = 1 to n do if X i = Y j then L i , j : = L i - 1 , j - 1 + 1 else L i , j : = max ( L i - 1 , j , L i , j - 1 ); Như_vậy độ phức_tạp bộ_nhớ của bài_toán là O(n2) , độ phức_tạp thời_gian là O(n2) .\nCó_một phương_pháp cài_đặt tốt hơn , chỉ với độ phức_tạp bộ_nhớ O(n) dựa trên nhận_xét sau : để tính ô Li , j của bảng phương_án , ta chỉ_cần 3 ô Li-1 , j-1 , Li-1 , j và Li , j-1 .\nTức_là để tính dòng Li thì chỉ_cần dòng Li-1 .\nDo_đó ta chỉ_cần 2 mảng 1 chiều để lưu dòng vừa tính (P) và dòng đang tính (L) mà_thôi .\nCách cài_đặt mới như_sau : for j : = 0 to n do P j : = 0 ; for i : = 1 to m do begin L 0 : = 0 ; for j : = 1 to n do if X i = Y j then L i , j : = P j - 1 + 1 else L i , j : = max ( P j , L j - 1 ); P : = L ; end ; Bắc_cầu Bài_toán : Hai nước Alpha và Beta nằm ở hai bên_bờ sông Omega , Alpha nằm ở bờ bắc và có M thành_phố được đánh_số từ 1 đến M , Beta nằm ở bờ nam và có N thành_phố được đánh_số từ 1 đến N (theo vị_trí từ đông sang tây) .\nMỗi thành_phố của nước này thường có quan_hệ kết_nghĩa với một_số thành_phố của nước kia .\nĐể tăng_cường tình hữu_nghị , hai nước muốn xây các cây cầu bắc qua_sông , mỗi cây cầu sẽ là nhịp cầu_nối 2 thành_phố kết_nghĩa .\nVới yêu_cầu là các cây cầu không được cắt nhau và mỗi thành_phố chỉ là đầu_cầu cho nhiều nhất_là một cây cầu , hãy chỉ ra cách bắc_cầu được nhiều cầu nhất .\nHướng_dẫn : Gọi các thành_phố của Alpha lần_lượt là A_1 , A_2 , . . . , A_M; các thành_phố của Beta là B_1 , B_2 , . . . , B_N .\nNếu thành_phố A_i và B_j kết_nghĩa với_nhau thì coi A_i \"bằng” B_j .\nĐể các cây cầu không cắt nhau , nếu ta đã chọn cặp thành_phố (A_i , B_j) để xây cầu thì cặp tiếp_theo phải là cặp (A_u , B_v) sao_cho ugt;i và vgt;j .\nNhư_vậy các cặp thành_phố được chọn xây cầu có_thể coi là một dãy con chung của hai dãy A và B .\nBài_toán của chúng_ta trở_thành bài_toán tìm dãy con chung dài nhất , ở đây hai phần_tử “bằng” nhau nếu chúng có quan_hệ kết_nghĩa .\nPalindrome (IOI 2000) Bài_toán : Một xâu gọi_là xâu đối_xứng (palindrome) nếu xâu đó đọc từ trái sang phải hay từ phải sang trái đều như_nhau .\nCho một xâu S , hãy tìm số kí_tự ít_nhất cần thêm vào S để S trở_thành xâu đối_xứng .\nHướng_dẫn : Bài_toán này có_một công_thức QHĐ như_sau : Gọi_Li , j là số kí_tự ít_nhất cần thêm vào xâu con Si . . j của S để xâu đó trở_thành đối_xứng .\nĐáp_số của bài_toán sẽ là L1 , n với n là số kí_tự của S .\nTa có_công thức sau để tính Li , j : L(i , i)=0 .\nL(i , j)=L(i+1 , j-1) nếu S_i=S_j L(i , j)=max(L(i+1 , j) , L(i , j-1)) nếu S_i \\ne S_j Bạn_đọc dễ_dàng có_thể kiểm_chứng công_thức đó .\nTa có_thể cài_đặt trực_tiếp công_thức đó bằng phương_pháp đệ_quy có nhớ .\nTuy_nhiên khi đó độ phức_tạp bộ_nhớ là O(n2) .\nCó_một phương_pháp cài_đặt tiết_kiệm hơn , có_thể tham_khảo ở bài viết của Nguyễn_Hoành Tiến_Ta có thuật_toán đơn_giản hơn như_sau : Gọi_P là xâu đảo của S và T là xâu con chung dài nhất của S và P .\nKhi đó các kí_tự của S không thuộc T cũng là các kí_tự cần thêm vào để S trở_thành đối_xứng .\nĐáp_số của bài_toán sẽ là n-k , với k là độ_dài của T .\nVí_dụ : S=edbabcd , xâu đảo của S là P=dcbabde .\nXâu con chung dài nhất của S và P là T=dbabd .\nNhư_vậy cần thêm 2 kí_tự là e và c vào để S trở_thành xâu đối_xứng .\n4 .\nVali (A) 4 . 1 . Mô_hình Cho n vật , vật i nặng A_i và có_giá trị B_i .\nHãy chọn ra một_số vật để_cho vào balô sao_cho tổng khối_lượng không vượt_quá W và tổng_giá trị là lớn nhất .\nChú_ý rằng mỗi vật có_thể được chọn nhiều lần .\n4 . 2 . Công_thức Gọi_L(i , j) là tổng_giá trị lớn nhất khi được chọn i vật từ 1 đến i cho vào balô với tổng khối_lượng không vượt_quá j .\nL(n , W) sẽ là đáp_số của bài_toán (là giá_trị lớn nhất có được nếu chọn n vật và tổng khối_lượng không vượt_quá W) .\nCông_thức tính L(i , t) như_sau : L(i , 0) = 0 L(0 , t) = 0 L(i , t) = L(i-1 , t) nếu tlt;A_i L(i , t) = max(L(i-1 , t) , L(i , t-A_i) + B_i) nếu t \\ge A_i Trong đó : L(i-1 , t) là giá_trị có được nếu_không đưa vật i vào balô , L(i , t-A_i) + B_i là giá_trị có được nếu chọn vật i .\n4 . 3 . Cài_đặt Ta có_thể dùng một mảng 2 chiều để lưu bảng phương_án , tuy_nhiên dựa trên nhận_xét rằng để tính dòng i của bảng phương_án chỉ_cần dòng i-1 , ta chỉ_cần dùng 2 mảng một_chiều P và L có chỉ_số từ 0 đến m để lưu 2 dòng đó .\nĐoạn chương_trình con_tính bảng phương_án như_sau .\nL t : = 0 ; với mọi t for i : = 1 to n do begin P : = L ; for t : = 0 to m do if t lt; a i then L t : = P t else L t : = max ( P t , L t - a i + b i ); end ; Nếu để_ý kĩ bạn sẽ thấy rằng đoạn trình trên chỉ viết giống công_thức QHĐ chứ chưa tối_ưu .\nChẳng_hạn đã có lệnh gán P : =L , sau_đó lại có gán Lt : =Pt với các giá_trị tlt;ai là không cần_thiết .\nBạn_đọc có_thể tự cải_tiến để chương_trình tối_ưu hơn .\nĐộ phức_tạp bộ_nhớ là O(m) và độ phức_tạp thời_gian là O(m n) .\n4 . 4 . Một_số bài_toán khác Đổi_tiền Bài_toán Ở đất_nước Omega người_ta chỉ_tiêu tiền xu .\nCó_N loại tiền xu , loại thứ i có mệnh_giá là A_i đồng .\nMột người khách_du lịch đến Omega du_lịch với số tiền M đồng .\nÔng ta muốn đổi số tiền đó ra tiền xu Omega để tiện tiêu_dùng .\nÔng ta cũng muốn số đồng_tiền đổi được là ít_nhất (cho túi_tiền đỡ nặng khi đi đây đi đó) .\nBạn hãy giúp ông ta tìm cách đổi_tiền .\nHướng_dẫn Bài_toán này khá giống bài_toán xếp balô (“khối lượng” là mệnh_giá , “giá trị” là 1) , chỉ_có một thay_đổi nhỏ : tổng_giá trị yêu_cầu là nhỏ nhất .\nDo_đó ta cũng xây_dựng hàm QHĐ một_cách tương_tự : Gọi_Li , t là số đồng xu ít_nhất nếu đổi t đồng ra i loại tiền xu (từ 1 đến i) .\nCông_thức tính Li , t như_sau : Li , 0=0 L0 , t= \\inf với tgt;0 .\nLi , t=Li-1 , t nếu tlt;Ai . Li , t=min(Li-1 , t , Li , t-Ai+1) nếu t \\ge A_i .\nCông_thức này khác công_thức của bài xếp balô ở chỗ : dùng hàm min chứ không_phải hàm_max (vì cần tìm cách chọn ít hơn) .\n5 .\nNhân ma_trận 5 . 1 . Mô_hình Nhân một ma_trận kích_thước m n với một ma_trận n p , số phép_nhân phải thực_hiện là m n p .\nMặt_khác phép_nhân các ma_trận có tính kết_hợp , tức_là : (A B)_C = A (B C) Do_đó khi tính tích nhiều ma_trận , ta có_thể thực_hiện theo các trình_tự khác_nhau , mỗi trình_tự tính sẽ quyết_định số phép_nhân cần thực_hiện .\nCho_N ma_trận A_1 , A_2 , . . . , A_N , ma_trận A có kích_thước là d_i-1 d_i .\nHãy xác_định trình_tự nhân ma_trận A_1 A_2 . . .\nA_N sao_cho số phép_nhân cần thực_hiện là ít_nhất .\n5 . 2 . Công_thức Gọi_F(i , j) là số phép_nhân để tính tích các ma_trận từ A_i đến A_j (A_i A_i+1 . . .\nA_j) .\nFi , i=0 .\nFi , i+1=d_i-1 d_i d_i+1 Fi , j = min(Fi , k+Fk+1 , j + d_i-1 d_i d_i+1 với k=i+1 , i+2 , . . . , j-1 Công_thức hơi phức_tạp nên tôi xin giải_thích như_sau : Fi , i=0 là hiển_nhiên .\nFi , i+1 là số phép_nhân khi nhân A_i và A_i+1 .\nA_i có kích_thước d_i-1 d_i , A_i+1 có kích_thước d_i d_i+1 , do_đó Fi , i+1=d_i-1 d_i d_i+1 Với jgt;i+1 thì ta thấy có_thể tính A_i A_i+1 . . .\nA_j bằng cách chọn một vị_trí k nào_đó để đặt ngoặc theo trình_tự : A_i A_i+1 . . .\nA_j = (A_i . . A_k) (A_k+1 . . A_j) Ma_trận kết_quả của phép_nhân (A_i . . A_k) có kích_thước d_i-1 d_i , ma_trận kết_quả của phép_nhân (A_k+1 . . A_j) có kích_thước d_k d_j .\nVới cách đặt đó ta sẽ mất Fi , k phép_nhân để có kết_quả trong dấu ngoặc thứ nhất , mất thêm Fk+1 , j phép_nhân để có kết_quả trong dấu ngoặc thứ_hai , và cuối_cùng mất d_i-1 d_k d_j để nhân 2 ma_trận kết_quả đó .\nTừ_đó tổng_số phép_nhân của cách đặt đó là : Fi , k + Fk+1 , j + d_i-1 d_k d_j .\nTa chọn vị_trí k cho số phép_nhân ít_nhất .\n5 . 3 . Cài_đặt Bảng phương_án là một mảng 2 chiều F để lưu Fi , j .\nChú_ý khi cài_đặt là để tính được Fi , j , ta phải tính Fi , k và Fk+1 , j trước .\nPhương_pháp đơn_giản để làm điều đó là phương_pháp đệ_quy có nhớ .\nTuy_nhiên dựa vào nhận_xét là trong công_thức QHĐ : j-i lớn hơn k-i và j-k , ta có_thể tính theo trình_tự khác : tính các phần_tử Fi , j với j-i từ nhỏ đến lớn (không phải là tính các giá_trị Fi , j với i , j từ nhỏ đến lớn như vẫn làm) .\nVới cách đó , khi tính đến Fi , j thì ta đã có Fi , k và Fk+1 , j .\nĐoạn chương_trình tính bảng phương_án như_sau : for i : = 1 to n do F i , i : = 0 ; for i : = 1 to n - 1 do F i , i + 1 : = d i - 1 d i d i + 1 ; for m : = 2 to n - 1 do begin for i : = 1 to n - m do begin j : = i + m ; F i , j : = oo ; for k : = i + 1 to j - 1 do F i , j : = min ( F i , j , F i , k + F k + 1 , j + d i - 1 d k d j ); end ; end ; Với cách cài_đặt trên , độ phức_tạp bộ_nhớ là O(n2) , độ phức_tạp thời_gian là O(n3) .\n5 . 4 . Một_số bài_toán khác Chia đa_giác Bài_toán Cho một đa_giác lồi N đỉnh .\nBằng các đường_chéo không cắt nhau , ta có_thể chia đa_giác thành N-2 tam_giác .\nHãy xác_định cách chia có tổng_các đường_chéo ngắn nhất .\nHướng_dẫn Để đơn_giản ta coi mọi đoạn_thẳng nối 2 đỉnh đều là “đường chéo” (nếu nối 2 đỉnh trùng nhau hoặc 2 đỉnh liên_tiếp thì_có độ_dài bằng 0) .\nGọi_F(i , j) là tổng_độ dài các đường_chéo khi chia đa_giác gồm các đỉnh từ i đến j thành các tam_giác .\nNếu jlt;i+3 thì đa_giác đó có ít_hơn 4 đỉnh , không cần phải chia nên F(i , j)=0 .\nNgược_lại ta xét cách chia đa_giác đó bằng cách chọn một đỉnh k nằm giữa i , j và nối i , j với k .\nKhi đó Fi , j=Fi , k+Fk , j+di , k+dk , j với d(i , k) là độ_dài đường_chéo (i , k) .\nTóm_lại công_thức QHĐ như_sau : Fi , j=0 với jlt;i+3 .\nFi , j=min(Fi , k+Fk , j+di , k+dk , j) với k=i+1 , . . . j-1 .\nF1 , n là tổng đường_chéo của cách chia tối_ưu .\nBiểu_thức số_học (IOI 1999) Bài_toán Cho biểu_thức A_1 \\cdot A_2 \\cdot . . .\n\\cdot A_N , trong đó A_i là các số_thực không âm và \\cdot là một_phép_toán + hoặc cho trước .\nHãy đặt các dấu ngoặc để biểu_thức thu được có kết_quả lớn nhất .\nHướng_dẫn Gọi_Fi , j là giá_trị lớn nhất có_thể có_của biểu_thức A_i \\cdot A_i+1 \\cdot . . .\n\\cdot A_j .\nDễ thấy nếu i=j thì Fi , j=A_i , nếu j=i+1 thì Fi , j=A_i \\cdot A_j .\nNếu jgt;i+1 thì_có thể tính biểu_thức A_i \\cdot A_i+1 \\cdot . . .\n\\cdot A_j bằng cách chia thành 2 nhóm : (A_i \\cdot A_i+1 \\cdot . . .\n\\cdot A_k) \\cdot (A_k+1 \\cdot . . .\n\\cdot A_j) , Khi đó Fi , j=Fi , k \\cdot Fk+1 , j .\nTóm_lại , công_thức QHĐ là : Fi , i=A_i Fi , i+1=A_i \\cdot A_i+1 Fi , j=max(Fi , k \\cdot Fk+1 , j) với k=i+1 , i+2 , . . j-1 .\n(Chú là_là các hạng tử của dãy đều không âm và các phép_toán là + hoặc nên Fi , k và Fk+1 , j đạt max thì Fi , k \\cdot Fk+1 , j cũng đạt max) .\n6 .\nGhép_cặp 6 . 1 . Mô_hình Có n lọ hoa sắp thẳng_hàng và k bó hoa được đánh_số thứ_tự từ nhỏ đến lớn .\nCần cắm k bó hoa trên vào n lọ sao_cho hoa có_số thứ_tự nhỏ phải đứng trước hoa có_số thứ_tự lớn .\nGiá_trị thẩm_mỹ tương_ứng khi cắm hoa i vào lọ thứ j là v(i , j) .\nHãy tìm 1 cách cắm sao_cho tổng_giá trị thẫm mỹ là lớn nhất .\nChú_ý rằng mỗi bó hoa chỉ được cắm vào 1 lọ và mỗi lọ cũng chỉ cắm được 1 bó hoa .\n6 . 2 . Công_thức Nhận_xét rằng bài_toán nêu trên là một bài_toán ghép_cặp có yêu_cầu về thứ_tự nên ta có_thể giải_quyết bằng phương_pháp QHĐ .\nHàm_mục_tiêu : f : tổng_giá trị thẩm_mỹ của cách cắm .\nGiá_trị thẩm_mỹ phụ_thuộc vào các hoa và các lọ đang được xét nên ta sẽ dùng mảng 2 chiều để lưu bảng phương_án .\nL(i , j) : tổng_giá trị thẩm_mỹ lớn nhất khi xét đến hoa i và lọ j .\nKhi tính L(i , j) hoa đang xét sẽ là hoa i và lọ j .\nNếu i = j .\nChỉ_có một_cách cắm Li , i : = V1 , 1+V2 , 2+ . . . +Vi , i Nếu igt;j .\nKhông có cách cắm hợp_lý Nếu ilt;j .\nCó 2 trường_hợp xảy_ra : Cắm hoa i vào lọ j .\nTổng_giá trị thẩm_mỹ là Li-1 , j-1+V(i , j) .\n(Bằng tổng_giá trị trước_khi cắm cộng với giá_trị thẩm_mỹ khi cắm hoa i vào lọ j) Không cắm hoa i vào lọ j (có thể cắm vào lọ trước j) , giá_trị thẫm mỹ của cách cắm là như_cũ : Li , j-1 6 . 3 . Cài_đặt L i , j : = - maxint ; For i : = 1 to k do For j : = i to n do If i = j then L i , j : = sum ( i ) else if i lt; j then L i , j : = max ( L i - 1 , j - 1 + v i , j , L i , j - 1 ); 6 . 4 . Một_số bài_toán khác Câu_lạc_bộ Bài_toán Có n phòng_học chuyên_đề và k nhóm học được đánh_số thứ_tự từ nhỏ đến lớn .\nCần xếp k nhóm trên vào n phòng_học sao_cho nhóm có_số hiệu nhỏ được xếp vào phòng có_số hiệu nhỏ , nhóm có_số hiệu lớn phải được xếp vào phòng có_số hiệu lớn .\nVới mỗi phòng có_chứ học_sinh , các ghế thừa phải được chuyển ra hết , nếu thiếu ghế thì lấy vào cho đủ ghế .\nBiết phòng i có A_i ghế , nhóm j có B_j học_sinh .\nHãy chọn 1 phương_án bố_trí sao_cho tổng_số lần chuyển ghế ra và vào là ít_nhất .\nHướng_dẫn Khi xếp nhóm i vào phòng j thì số lần chuyển ghế chính là độ chênh_lệch giữa số ghế trong phòng i và số_học sinh trong nhóm .\nĐặt_Vi , j : =A_i - B_j Mua giày (Đề QG bảng B năm 2003) Bài_toán Trong hiệu có n đôi giày , đôi giày i có kích_thước H_i .\nCó k người cần mua giày , người i cần mua đôi giày kích_thước S_i .\nKhi người i chọn mua đôi giày j thì độ_lệch sẽ là H_i-S_j .\nHãy tìm cách chọn mua giày cho k người trên sao_cho tổng_độ lệch là ít_nhất .\nBiết rằng mỗi người chỉ mua 1 đôi giày và 1 đôi giày cũng chỉ_có một người mua .\nHướng_dẫn Lập_công thức giải như bài Câu_lạc_bộ .\nChú_ý chứng_minh tính đúng_đắn của bổ_đề heuristic sau : Cho 2 dãy tăng dần các số_dương A_1 , A_2 , . . . , A_N , B_1 , B_2 , . . . , B_N .\nGọi C_1 , C_2 , . . . , C_N là một hoán_vị bất_kỳ của dãy B .\nKhi đó : A_1-B_1 + A_2-B_2 + . . .\n+ A_N-B_N \\le A_1-C_1 + A_2 - C_2 + . . .\n+ A_N-C_N 7 .\nDi_chuyển 7 . 1 . Mô_hình Cho bảng A gồm M_N ô .\nTừ ô (i , j) có_thể di_chuyển sang 3 ô (i+1 , j) , (i+1 , j-1) và (i+1 , j+1) .\nHãy xác_định một lộ_trình đi từ hàng 1 đến hàng M sao_cho tổng_các ô đi_qua là lớn nhất .\n7 . 2 . Công_thức Gọi_F(i , j) là giá_trị lớn nhất có được khi di_chuyển đến ô (i , j) .\nCó 3 ô có_thể đi đến ô (i , j) là (i-1 , j) , (i-1 , j-1) và (i-1 , j+1) .\nDo_đó ta có_công thức QHĐ như_sau : F1 , j=A1 , j Fi , j=max(Fi-1 , j , F(i-1 , j-1 , Fi-1 , j+1)+Ai , j với igt;1 7 . 3 . Cài_đặt Bảng phương_án là bảng 2 chiều F0 . . m , 0 . . n .\n(Tất cả các ô trên biên đều cho giá_trị bằng 0) .\nQuá_trình tính như_sau : for i : = 1 to m do for j : = 1 to n do F i , j = max ( F i - 1 , j , F i - 1 , j - 1 , F i - 1 , j + 1 + A i , j ); Cách cài_đặt này cho độ phức_tạp bộ_nhớ và thời_gian đều là O(n2) .\nTa có_thể tiết_kiệm không_gian nhớ bằng cách tính trực_tiếp trên mảng A .\n7 . 4 . Một_số bài_toán khác Tam_giác (IOI 1994) Bài_toán Cho một tam_giác gồm các số_nguyên không âm .\nHãy tính tổng_lớn nhất các số trên đường_đi từ đỉnh tam_giác xuống một điểm nào_đó ở đáy tam_giác nào_đó .\nTại mỗi ô ta chỉ_có đi_thẳng xuống , sang ô bên trái hoặc bên phải .\nHướng_dẫn Mô_tả các phần_tử của tam_giác số như một ma_trận , Ai , j là phần_tử thứ j trên dòng i (với 1 \\le i \\le N và 1 \\le j \\le i) .\nCó 2 ô có_thể di_chưyển đến ô (i , j) là ô (i-1 , j-1) và ô (i-1 , j) .\nGọi_F(i , j) là tổng_lớn nhất có_thể có_khi đi đến ô (i , j) ta có : F1 , 1=A1 , 1 Fi , 1=Fi-1 , 1+Ai , 1 Fi , j=max( Fi-1 , j-1 , Fi-1 , j ) + Ai , j\n", "tagged": "Bài/N viết/V sưu_tầm/V trên/E mạng/N ./CH\nTable/Np of_Contents/Np 1/M ./CH\nDãy/Nc con/Nc đơn_điệu/Np dài/A nhất/A 1/M ./CH 1/M ./CH Mô_hình/N 1/M ./CH 2/M ./CH Công_thức/N QHĐ/Np 1/M ./CH 3/M ./CH Cài_đặt/V 1/M ./CH 4/M ./CH Một_số/L bài_toán/N khác/A Bố_trí/V phòng_họp/Np (mất/Np tính/V thứ_tự/N so_với/Np dãy/Nc ban/N đầu)/Np Cho_thuê/Np máy/N Dãy/Nc tam_giác/N bao/N nhau/N Dãy/Nc đổi/V dấu/N Dãy_số/Np WAVIO_Xếp/Np các/L khối/N đá/V 2/M ./CH\nVali/Np (B)/Np 2/M ./CH 1/M ./CH Mô_hình/N 2/M ./CH 2/M ./CH Công_thức/N 2/M ./CH 3/M ./CH Cài_đặt/V 2/M ./CH 4/M ./CH Một_số/L bài_toán/N khác/A Dãy/Nc con/Nc có/V tổng_bằng/Np S_Chia/Np kẹo_Market/Np (Olympic/Np Balkan/Np 2000)/Np Điền_dấu/Np Expression_Farmer/Np (IOI/Np 2004)/Np 3/M ./CH\nBiến_đổi/V xâu/Np 3/M ./CH 1/M ./CH Mô_hình/N 3/M ./CH 2/M ./CH Hướng_dẫn/V 3/M ./CH 3/M ./CH Một_số/L bài_toán/N khác/A Xâu/Np con/Nc chung/A dài/A nhất/A Bắc_cầu/V Palindrome/Np (IOI/Np 2000)/Np 4/M ./CH\nVali/Np (A)/Np 4/M ./CH 1/M ./CH Mô_hình/N 4/M ./CH 2/M ./CH Công_thức/N 4/M ./CH 3/M ./CH Cài_đặt/V 4/M ./CH 4/M ./CH Một_số/L bài_toán/N khác/A Đổi_tiền/Np 5/M ./CH\nNhân/N ma_trận/N 5/M ./CH 1/M ./CH Mô_hình/N 5/M ./CH 2/M ./CH Công_thức/N 5/M ./CH 3/M ./CH Cài_đặt/V 5/M ./CH 4/M ./CH Một_số/L bài_toán/N khác/A Chia/V đa_giác/Np Biểu_thức/Np số_học/Np (IOI/Np 1999)/Np 6/M ./CH\nGhép_cặp/Np 6/M ./CH 1/M ./CH Mô_hình/N 6/M ./CH 2/M ./CH Công_thức/N 6/M ./CH 3/M ./CH Cài_đặt/V 6/M ./CH 4/M ./CH Một_số/L bài_toán/N khác/A Câu_lạc_bộ/N Mua/V giày/N (Đề/Np QG/Np bảng/N B/Ni năm/N 2003)/Np 7/M ./CH\nDi_chuyển/V 7/M ./CH 1/M ./CH Mô_hình/N 7/M ./CH 2/M ./CH Công_thức/N 7/M ./CH 3/M ./CH Cài_đặt/V 7/M ./CH 4/M ./CH Một_số/L bài_toán/N khác/A Tam_giác/N (IOI/Np 1994)/Np 1/M ./CH\nDãy/Nc con/Nc đơn_điệu/Np dài/A nhất/A 1/M ./CH 1/M ./CH Mô_hình/N Cho/E dãy/Nc A_1/Np ,/CH A_2/Np ,/CH ./CH ./CH ./CH ,/CH A_n/Np ./CH\nHãy/R tìm/V một/M dãy/Nc con/Nc tăng/V có/V nhiều/A phần_tử/N nhất/A của/E dãy/Nc ./CH\nĐặc_trưng/A :/CH Các/L phần_tử/N trong/E dãy/Nc kết_quả/N chỉ/R xuất_hiện/V 1/M lần/N ./CH\nVì_vậy/C phương_pháp/N làm/V là/V ta/P sẽ/R dùng/V vòng/N For/Np duyệt/V qua/V các/L phần_tử/N A/Ni trong/E dãy/Nc ,/CH khác/A với/E các/L bài_toán/N của/E mô_hình/N 4/M (đặc/Np trưng/V là/V bài_toán/N đổi/V tiền)/Np ,/CH các/L phần_tử/N trong/E dãy/Nc có_thể/R được/V chọn/V nhiều/A lần/N nên/C ta/P thực_hiện/V bằng/E phương_pháp/N cho/E giá_trị/N cần/V quy_đổi/Np tăng/V dần/R từng/R đơn_vị/N ./CH\nThứ_tự/N của/E các/L phần_tử/N được/V chọn/V phải/V được/V giữ_nguyên/Np so_với/Np dãy/Nc ban_đầu/N ./CH\nĐặc_trưng/A này/P có_thể/R mất/V đi/V trong/E một_số/L bài_toán/N khác/A tùy/V vào/E yêu_cầu/V cụ_thể/A ./CH\nChẳng_hạn/X bài/N :/CH Tam_giác/N bao/N nhau/N ./CH\n1/M ./CH 2/M ./CH Công_thức/N QHĐ/Np Hàm_mục_tiêu/Np :/CH f/Np :/CH độ_dài/Np dãy/Nc con/Nc ./CH\nVì/E độ_dài/Np dãy/Nc con/Nc chỉ/R phụ_thuộc/V vào/E một/M yếu_tố/N là/V dãy/Nc ban_đầu/N nên/C bảng/N phương_án/N là/V bảng/N một_chiều/Np ./CH\nGọi/V L_i/Np là/V độ_dài/Np dãy/Nc con/Nc tăng/V dài/A nhất/A ,/CH các/L phần_tử/N lấy/V trong/E miền/N từ/E A_1/Np đến/E A_i/Np và/Cc phần_tử/N cuối_cùng/A là/V A_i/Np ./CH\nNhận_xét/N với/E cách/N làm/V này/P ta/P đã/R chia/V 1/M bài_toán/N lớn/A (dãy/Np con/Nc của/E n/Ny số)/Np thành/V các/L bài_toán/N con/Nc cùng/A kiểu/N có/V kích_thước/N nhỏ/A hơn/A (dãy/Np con/Nc của/E dãy/Nc i/M số)/Np ./CH\nVấn_đề/N là/V công_thức/N truy_hồi/Np để/E phối_hợp/V kết_quả/N của/E các/L bài_toán/N con/Nc ./CH\nTa/P có_công/Np thức/V QHĐ/Np để/E tính/V L_i/Np như_sau/Np :/CH L_1/Np =/CH 1/M ./CH\n(Hiển/Np nhiên)/Np L_i/Np =/CH max(1/Np ,/CH L_j/Np +/CH 1)/Np với/E mọi/L phần_tử/N j/Np thỏa_mãn/V :/CH 0lt;jlt;i/Np và/Cc A_j/Np \\le/Np A_i/Np Tính/V L_i/Np :/CH phần_tử/N đang/R được/V xét/V là/V A_i/Np ./CH\nTa/P tìm/V đến/E phần_tử/N A_j/Np lt;/Np A_i/Np có/V L_j/Np lớn/A nhất/A ./CH\nKhi/N đó/P nếu/C bổ_sung/V A_i/Np vào/E sau/E dãy/Nc con/Nc ./CH ./CH ./CH A_j/Np ta/P sẽ/R được/V dãy/Nc con/Nc tăng/V dần/R dài/A nhất/A xét/V từ/E A_1/Np ./CH ./CH ./CH A_i/Np ./CH\n1/M ./CH 3/M ./CH Cài_đặt/V Bảng/N phương_án/N là/V một/M mảng/N một_chiều/Np L/Ny để/E lưu_trữ/Np các/L giá_trị/N của/E hàm/Np QHĐ/Np L_i/Np ./CH\nĐoạn/Nc chương_trình/N tính/V các/L giá_trị/N của/E mảng/N L/Ny như_sau/Np :/CH for/Np i/M :/CH =/CH 1/M to/A n/Ny do/E begin/Np L/Ny i/M :/CH =/CH 1/M ;/CH for/Np j/Np :/CH =/CH 1/M to/A i/M -/CH 1/M do/E if/Np (/CH A/Ni j/Np lt;=/Np A/Ni i/M )/CH and/Np (/CH L/Ny i/M lt;/Np L/Ny j/Np +/CH 1/M )/CH then/Np L/Ny i/M :/CH =/CH L/Ny j/Np +/CH 1/M ;/CH end/Np ;/CH Như_vậy/X độ/N phức_tạp/A bộ_nhớ/Np của/E bài_toán/N là/V O(n)/Np ,/CH độ/N phức_tạp/A thời_gian/N là/V O(n2)/Np ./CH\nCó_một/Np số/N phương_pháp/N cài_đặt/V tốt/A hơn/A so_với/Np phương_pháp/N trên/E ,/CH cho/E chi_phí/N thời_gian/N là/V O(nlogn)/Np ,/CH một/M trong/E những/L cách/N đó/P là/V dùng/V Segment_Tree/Np ./CH\n1/M ./CH 4/M ./CH Một_số/L bài_toán/N khác/A Bài_toán/N dãy/Nc con/Nc đơn_điệu/Np tăng/V dài/A nhất/A có/V biến_thể/N đơn_giản/A nhất_là/X bài_toán/N dãy/Nc con/Nc đơn_điệu/Np giảm/V dài/A nhất/A ,/CH tuy_nhiên/C chúng_ta/P có_thể/R coi/V chúng/P như_là/V một/M ./CH\nSau_đây/Np là/V một_số/L bài_toán/N khác/A ./CH\nBố_trí/V phòng_họp/Np (mất/Np tính/V thứ_tự/N so_với/Np dãy/Nc ban/N đầu)/Np Bài_toán/N :/CH Có/V n/Ny cuộc_họp/Np ,/CH cuộc_họp/Np thứ/N i/M bắt_đầu/V vào/E thời_điểm/N A_i/Np và/Cc kết_thúc/V ở/E thời_điểm/N B_i/Np ./CH\nDo/E chỉ_có/Np một/M phòng/N hội_thảo/V nên/C 2/M cuộc_họp/Np bất_kì/R sẽ/R được/V cùng/A bố_trí/V phục_vụ/V nếu/C khoảng/N thời_gian/N làm_việc/V của/E chúng/P chỉ/R giao/V nhau/N tại/E đầu_mút/Np ./CH\nHãy/R bố_trí/V phòng_họp/Np để/E phục_vụ/V được/V nhiều/A cuộc_họp/Np nhất/A ./CH\nHướng_dẫn/V :/CH Sắp_xếp/V các/L cuộc_họp/Np tăng/V dần/R theo_thời/Np điểm/N kết_thúc/V B_i/Np ./CH\nThế_thì/Np cuộc_họp/Np i/M sẽ/R bố_trí/V được/V sau/E cuộc_họp/Np j/Np khi/N và/Cc chỉ/R khi/N jlt;i/Np và/Cc B_j/Np \\le/Np A_i/Np ./CH\nYêu_cầu/V bố_trí/V được/V nhiều/A cuộc_họp/Np nhất/A có_thể/R đưa/V về/E việc/N tìm/V dãy/Nc các/L cuộc_họp/Np dài/A nhất/A thoả_mãn/V điều_kiện/N trên/E ./CH\nCho_thuê/Np máy/N Bài_toán/N :/CH Trung_tâm/N tính_toán/V hiệu_năng/Np cao/A nhận/V được/V đơn/N đặt_hàng/V của/E n/Ny khách_hàng/N ./CH\nKhách_hàng/N i/M muốn/V sử_dụng/V máy/N trong_khoảng/Np thời_gian/N từ/E a_i/Np đến/E b_i/Np và/Cc trả/V tiền/N thuê/V là/V c_i/Np ./CH\nHãy/R bố_trí/V lịch/N thuê/V máy/N để/E tổng_số/N tiền/N thu/V được/V là/V lớn/A nhất/A mà/C thời_gian/N sử_dụng/V máy/N của/E 2/M khách_hàng/N bất_kì/R được/V phục_vụ/V đều/R không/R giao/V nhau/N (cả/Np trung_tâm/N chỉ_có/Np một/M máy/N cho/E thuê)/Np ./CH\nHướng_dẫn/V :/CH Tương_tự/A như/C bài_toán/N bố_trí/V phòng_họp/Np ,/CH nếu/C sắp_xếp/V các/L đơn/N đặt_hàng/V theo_thời/Np điểm/N kết_thúc/V ,/CH ta/P sẽ/R đưa/V được/V về/E bài_toán/N tìm/V dãy/Nc con/Nc có/V tổng_lớn/Np nhất/A ./CH\nBài_toán/N này/P là/V biến_thể/N của/E bài_toán/N tìm/V dãy/Nc con/Nc tăng/V dài/A nhất/A ,/CH ta/P có_thể/R cài_đặt/V bằng/E đoạn/Nc chương_trình/N như_sau/Np :/CH for/Np i/M :/CH =/CH 1/M to/A n/Ny do/E begin/Np L/Ny i/M :/CH =/CH C/Ni i/M ;/CH for/Np j/Np :/CH =/CH 1/M to/A i/M -/CH 1/M do/E if/Np (/CH B/Ni j/Np lt;=/Np A/Ni i/M )/CH and/Np (/CH L/Ny i/M lt;/Np L/Ny j/Np +/CH C/Ni i/M )/CH then/Np L/Ny i/M :/CH =/CH L/Ny j/Np +/CH C/Ni i/M ;/CH end/Np ;/CH Dãy/Nc tam_giác/N bao/N nhau/N Bài_toán/N :/CH Cho/E n/Ny tam_giác/N trên/E mặt_phẳng/N ./CH\nTam_giác/N i/M bao/N tam_giác/N j/Np nếu/C 3/M đỉnh/N của/E tam_giác/N j/Np đều/R nằm/V trong/E tam_giác/N i/M (có/Np thể/N nằm/V trên/E cạnh)/Np ./CH\nHãy/R tìm/V dãy/Nc tam_giác/N bao/N nhau/N có/V nhiều/A tam_giác/N nhất/A ./CH\nHướng_dẫn/V :/CH Sắp_xếp/V các/L tam_giác/N tăng/V dần/R về/E diện_tích/N ./CH\nKhi/N đó/P tam_giác/N i/M sẽ/R bao/N tam_giác/N j/Np nếu/C jlt;i/Np và/Cc 3/M đỉnh/N của/E j/Np nằm/V trong/E i/M ./CH\nTừ_đó/Np có_thể/R đưa/V về/E bài_toán/N tìm/V dãy/Nc “tăng”/Np dài/A nhất/A ./CH\nBài_toán/N có_một/Np số/N biến_thể/N khác/A như/C tìm/V dãy/Nc hình_tam_giác/Np ,/CH hình/N chữ/N nhật…/Np bao/N nhau/N có/V tổng_diện_tích/Np lớn/A nhất/A ./CH\nViệc/N kiểm_tra/V điểm/N M/Nu có/V nằm/V trong/E tam_giác/N ABC/Ny không/R có_thể/R dựa/V trên/E phương_pháp/N tính/V diện_tích/N :/CH điểm/N M/Nu nằm/V trong/E nếu/C S(ABC)/Np =/CH S(ABM)/Np +/CH S(ACM)/Np +/CH S(BCM)/Np ./CH\nDãy/Nc đổi/V dấu/N Bài_toán/N :/CH Cho/E dãy/Nc A_1/Np ,/CH A_2/Np ,/CH ./CH ./CH ./CH ,/CH A_N/Np ./CH\nHãy/R tìm/V dãy/Nc con/Nc đổi/V dấu/N dài/A nhất/A của/E dãy/Nc đó/P ./CH\nDãy/Nc con/Nc đổi/V dấu/N A_i1/Np ,/CH A_i2/Np ,/CH ./CH ./CH ./CH ,/CH A_ik/Np phải/V thoả_mãn/V các/L điều_kiện/N sau/E :/CH A_i1/Np lt;/Np A_i2/Np gt;/Np A_i3/Np lt;/Np ./CH ./CH ./CH\nhoặc/Cc A_i1/Np gt;/Np A_i2/Np lt;/Np A_i3/Np gt;/Np ./CH ./CH ./CH\nCác/L chỉ_số/N phải_cách/Np nhau/N ít_nhất/A L/Ny :/CH i_2/Np -/CH i_1/Np \\ge/Np L/Ny ,/CH i_3/Np -/CH i_2/Np \\ge/Np L/Ny ,/CH ./CH ./CH ./CH\nChênh_lệch/A giữa/N 2/M phần_tử/N liên_tiếp/A nhỏ/A hơn/A U/N :/CH A_i1/Np -/CH A_i2/Np \\le/Np U/N ,/CH A_i2/Np -/CH A_i3/Np \\le/Np U/N ,/CH ./CH ./CH ./CH\nHướng_dẫn/V :/CH Gọi/V L_i/Np là/V số/N phần_tử/N của/E dãy/Nc con/Nc đổi/V dấu/N có/V phần_tử/N cuối_cùng/A là/V A_i/Np và/Cc phần_tử/N cuối_cùng/A lớn/A hơn/A phần_tử/N đứng/V trước/E ./CH\nTương_tự/A ,/CH P_i/Np là/V số/N phần_tử/N của/E dãy/Nc con/Nc đổi/V dấu/N có/V phần_tử/N cuối_cùng/A là/V A_i/Np và/Cc phần_tử/N cuối_cùng/A nhỏ/A hơn/A phần_tử/N đứng/V trước/E ./CH\nTa/P dễ_dàng/A suy/V ra/V :/CH L_i/Np =/CH max(1/Np ,/CH P_j/Np +/CH 1)/Np ,/CH với/E mọi/L j/Np thỏa_mãn/V :/CH j/Np \\le/Np i-L/Np và/Cc A_i/Np -/CH U/N \\le/Np A_j/Np lt;/Np A_i/Np ./CH\nP_i/Np =/CH max(1/Np ,/CH L_j/Np +/CH 1)/Np ,/CH với/E mọi/L j/Np thỏa_mãn/V :/CH j/Np \\le/Np i-L/Np và/Cc A_i/Np lt;/Np A_j/Np \\le/Np A_i/Np +/CH U/N ./CH\nDãy_số/Np WAVIO/Np Bài_toán/N :/CH Dãy_số/Np Wavio/Np là/V dãy_số/Np nguyên/A thỏa_mãn/V các/L tính_chất/N :/CH các/L phần_tử/N đầu/N sắp_xếp/V thành/V 1/M dãy/Nc tăng/V dần/R đến/E 1/M phần_tử/N đỉnh/N sau_đó/Np giảm_dần/Np ./CH\nVí_dụ/C dãy_số/Np 1/M 2/M 3/M 4/M 5/M 2/M 1/M là/V 1/M dãy/Nc Wavio/Np độ_dài/Np 7/M ./CH\nCho/E 1/M dãy/Nc gồm/V N/Ny số_nguyên/Np ,/CH hãy/R chỉ/R ra/V một/M dãy/Nc con/Nc Wavio/Np có/V đọ/V dài/A lớn/A nhất/A trích/V ra/V từ/E dãy/Nc đó/P ./CH\nHướng_dẫn/V :/CH L1_i/Np là/V mảng/N ghi/V độ_dài/Np lớn/A nhất/A của/E 1/M dãy/Nc con/Nc tăng/V dần/R trích/V ra/V từ/E dãy/Nc N/Ny phần_tử/N kể_từ/Np phần_tử/N 1/M đến/E phần_tử/N a_i/Np ./CH\nL2_i/Np :/CH mảng/N ghi/V độ_dài/Np lớn/A nhất/A của/E dãy/Nc con/Nc giảm_dần/Np trích/V ra/V từ/E dãy/Nc N/Ny phần_tử/N kể_từ/Np phần_tử/N A_N/Np đến/E A_i/Np ./CH\nTa/P tìm/V phần_tử/N j/Np trong/E 2/M mảng/N L1/Np ,/CH L2/Np thỏa_mãn/V L1_j/Np +/CH L2_j/Np lớn/A nhất/A ./CH\nXếp/V các/L khối/N đá/V Bài_toán/N :/CH Cho_N/Np khối/N đá/V (N/Np \\le/Np 5000)/Np ./CH\nCác/L khối/N đá/V đều/R có/V dạng_hình/Np hộp/N chữ_nhật/Np và/Cc được/V đặc_trưng/A bới/V 3/M kích_thước/N :/CH dài/A ,/CH rộng/A ,/CH cao/A ./CH\nMột_cách/N xây_dựng/V tháp/N là/V một_cách/N đặt/V một_số/L các/L khối/N đá/V trong/E các/L khối/N đá/V đã/R cho/E chồng/N lên/V nhau/N theo/V quy_tắc/N :/CH Chiều_cao/N mỗi/L khối/N đá/V là/V kích_thước/N nhỏ/A nhất/A trong/E 3/M kích_thước/N ./CH\nCác/L mép/N của/E khối/N đá/V được/V đặt/V song_song/A với_nhau/Np sao_cho/Np không/R có/V phần_nào/L của/E khối/N trên/E nằm/V chìa/V ra/V ngoài/E khối/N dưới/E ./CH\nHãy/R chỉ/R ra/V cách/N để/E xây_dựng/V được_một_cái/Np tháp/N sao_cho/Np số_khối/Np đá/V được/V dùng/V là/V nhiều/A nhất/A ./CH\n2/M ./CH\nVali/Np (B)/Np 2/M ./CH 1/M ./CH Mô_hình/N Có/V n/Ny đồ_vật/N ,/CH vật/N thứ/N i/M có/V trọng_lượng/N A_i/Np và/Cc giá_trị/N B_i/Np ./CH\nHãy/R chọn/V ra/V một_số/L các/L đồ_vật/N ,/CH mỗi/L vật/N một/M cái/Nc để/E xếp/V vào/E 1/M vali/Np có/V trọng_lượng/N tối_đa/A W/Nu sao_cho/Np tổng_giá/Np trị/V của/E vali/Np là/V lớn/A nhất/A ./CH\n2/M ./CH 2/M ./CH Công_thức/N Hàm_mục_tiêu/Np :/CH f/Np :/CH tổng_giá/Np trị/V của/E vali/Np ./CH\nNhận_xét/N :/CH giá_trị/N của/E vali/Np phụ_thuộc/V vào/E 2/M yếu_tố/N :/CH có/V bao_nhiêu/P vật/N đang/R được/V xét/V và/Cc trọng_lượng/N của/E các/L vật/N ./CH\nDo_đó/C bảng/N phương_án/N sẽ/R là/V bảng/N 2/M chiều/N :/CH -/CH L(i/Np ,/CH j)/Np :/CH tổng_giá/Np trị/V lớn/A nhất/A của/E vali/Np khi/N xét/V từ/E vật/N 1/M ./CH ./CH\nvật/N i/M và/Cc trọng_lượng/N của/E vali/Np chưa/R vượt_quá/Np j/Np ./CH\nChú_ý/V rằng/C khi/N xét/V đến/E Li/Np ,/CH j/Np thì/C các/L giá_trị/N trên/E bảng/N phương_án/N đều/R đã/R được/V tối_ưu/A ./CH\nTính_L(i/Np ,/CH j)/Np :/CH vật/N đang/R xét/V là/V a_i/Np với/E trọng_lượng/N của/E vali/Np không/R được/V quá/R j/Np ./CH\nCó/V 2/M khả_năng/N xảy_ra/Np :/CH Nếu/C chọn/V A_i/Np đưa_vào/Np vali/Np ,/CH trọng_lượng/N vali/Np trước/E đó/P phải/V không/R quá/R j/Np -/CH A_i/Np ./CH\nVì/E mỗi/L vật/N chỉ/R được/V chọn/V 1/M lần/N nên/C giá_trị/N lớn/A nhất/A của/E vali/Np lúc_đó/Np là/V L(i-1/Np ,/CH j/Np -/CH A_i)/Np +/CH B_i/Np ./CH\nNếu_không/Np chọn/V A_i/Np ,/CH trọng_lượng/N của/E vali/Np là/V như_cũ/Np (như/Np lúc/N trước_khi/Np chọn/V A_i)/Np :/CH L(i-1/Np ,/CH j)/Np ./CH\nTóm_lại/Np ta/P có/V Li/Np ,/CH j/Np =/CH max(L(i-1/Np ,/CH j/Np -/CH A_i)/Np +/CH B_i/Np ,/CH L(i-1/Np ,/CH j))/Np ./CH\n2/M ./CH 3/M ./CH Cài_đặt/V For/Np i/M :/CH =/CH 1/M to/A n/Ny do/E For/Np j/Np :/CH =/CH 1/M to/A W/Nu do/E If/Np b/Ni i/M lt;=/Np j/Np then/Np L/Ny i/M ,/CH j/Np :/CH =/CH max/Np (/CH L/Ny i/M -/CH 1/M ,/CH j/Np -/CH A/Ni i/M +/CH B/Ni i/M ,/CH L/Ny i/M -/CH 1/M ,/CH j/Np )/CH else/Np L/Ny i/M ,/CH j/Np :/CH =/CH L/Ny i/M -/CH 1/M ,/CH j/Np ;/CH 2/M ./CH 4/M ./CH Một_số/L bài_toán/N khác/A Dãy/Nc con/Nc có/V tổng_bằng/Np S/Y Bài_toán/N :/CH Cho/E dãy/Nc A_1/Np ,/CH A_2/Np ,/CH ./CH ./CH ./CH ,/CH A_N/Np ./CH\nTìm/V một/M dãy/Nc con/Nc của/E dãy/Nc đó/P có/V tổng_bằng/Np S/Y ./CH\nHướng_dẫn/V :/CH Đặt_Li/Np ,/CH t=1/Np nếu/C có_thể/R tạo/V ra/V tổng/N t/Nu từ/E một/M dãy/Nc con/Nc của/E dãy/Nc gồm/V các/L phần_tử/N A_1/Np ,/CH A_2/Np ,/CH ./CH ./CH ./CH ,/CH A_i/Np ./CH\nNgược_lại/X thì/C Li/Np ,/CH t=0/Np ./CH\nNếu_Ln/Np ,/CH S=1/Np thì/C đáp_án/N của/E bài_toán/N trên/E là/V “có”/Np ./CH\nTa/P có_thể/R tính/V Li/Np ,/CH t/Nu theo/V công_thức/N :/CH Li/Np ,/CH t=1/Np nếu/C Li-1/Np ,/CH t=1/Np hoặc/Cc Li-1/Np ,/CH t-ai=1/Np ./CH\nCài_đặt/V :/CH Nếu/C áp_dụng/V luôn/R công_thức/N trên/E thì/C ta/P cần_dùng/Np bảng/N phương_án/N hai/M chiều/N ./CH\nTa/P có_thể/R nhận_xét/N rằng/C để/E tính/V dòng/N thứ/N i/M ,/CH ta/P chỉ_cần/Np dòng/N i-1/Np ./CH\nBảng/N phương_án/N khi/N đó/P chỉ_cần/Np 1/M mảng/N 1/M chiều/N L0/Np ./CH ./CH S/Y và/Cc được/V tính/V như_sau/Np :/CH L/Ny t/Nu :/CH =/CH 0/M ;/CH L/Ny 0/M :/CH =/CH 1/M ;/CH for/Np i/M :/CH =/CH 1/M to/A n/Ny do/E for/Np t/Nu :/CH =/CH S/Y downto/Np a/Ni i/M do/E if/Np (/CH L/Ny t/Nu =/CH 0/M )/CH and/Np (/CH L/Ny t/Nu -/CH a/Ni i/M =/CH 1/M )/CH then/Np L/Ny t/Nu :/CH =/CH 1/M ;/CH Dễ/A thấy/V độ/N phức_tạp/A bộ_nhớ/Np của/E cách/N cài_đặt/V trên/E là/V O(m)/Np ,/CH độ/N phức_tạp/A thời_gian/N là/V O(n/Np m)/Np ,/CH với/E m/Nu là/V tổng/N của/E n/Ny số/N ./CH\nHãy/R tự/P kiểm_tra/V xem/V tại_sao/X vòng/N for/Np thứ/N 2/M lại/R là/V for/Np downto/Np chứ/C không_phải/Np là/V for/Np to/A ./CH\nChia/V kẹo/N Bài_toán/N :/CH Cho/E n/Ny gói/V kẹo/N ,/CH gói/V thứ/N i/M có/V a_i/Np viên/Nc ./CH\nHãy/R chia/V các/L gói/V thành/V 2/M phần/N sao_cho/Np chênh_lệch/A giữa/N 2/M phần/N là/V ít_nhất/A ./CH\nHướng_dẫn/V :/CH Gọi_T/Np là/V tổng_số/N kẹo/N của/E n/Ny gói/V ./CH\nChúng_ta/P cần/V tìm/V số/N S/Y lớn/A nhất/A thoả_mãn/V :/CH S/Y \\le/Np T/Nu ./CH\nCó_một/Np dãy/Nc con/Nc của/E dãy/Nc a/Ni có/V tổng_bằng/Np S/Y ./CH\nKhi/N đó/P sẽ/R có/V cách/N chia/V với/E chênh_lệch/A 2/M phần/N là/V T-2S/Np là/V nhỏ/A nhất/A và/Cc dãy/Nc con/Nc có/V tổng_bằng/Np S/Y ở/E trên/E gồm/V các/L phần_tử/N là/V các/L gói/V kẹo_thuộc/Np phần/N thứ/N nhất/A ./CH\nPhần/N thứ_hai/N là/V các/L gói/V kẹo_còn/Np lại/R ./CH\nMarket/Np (Olympic/Np Balkan/Np 2000)/Np Bài_toán/N :/CH Người/N đánh_cá/V Clement/Np bắt_được/Np n/Ny con/Nc cá/N ,/CH khối_lượng/N mỗi/L con/Nc là/V a_i/Np ,/CH đem/V bán/V ngoài/E chợ/N ./CH\nỞ/E chợ/N cá/N ,/CH người_ta/P không/R mua/V cá/N theo/V từng/R con/Nc mà/C mua/V theo/V một/M lượng/N nào_đó/P ./CH\nChẳng_hạn/X 3/M kg/Nu ,/CH 5kg/Np ./CH ./CH ./CH\nVí_dụ/C :/CH có/V 3/M con/Nc cá/N ,/CH khối_lượng/N lần_lượt/R là/V :/CH 3/M ,/CH 2/M ,/CH 4/M ./CH\nMua/V lượng/N 6kg/Np sẽ/R phải/V lấy/V con/Nc cá/N thứ/N 2/M và/Cc và/Cc thứ/N 3/M ./CH\nMua/V lượng/N 3/M kg/Nu thì/C lấy/V con_thứ/Np nhất/A ./CH\nKhông_thể/R mua/V lượng/N 8/M kg/Nu ./CH\nNếu/C bạn/N là/V người/N đầu_tiên/A mua/V cá/N ,/CH có/V bao_nhiêu/P lượng/N bạn/N có_thể/R chọn/V ?/CH\nHướng_dẫn/V Thực_chất/N bài_toán/N là/V tìm/V các/L số/N S/Y mà/C có_một/Np dãy/Nc con/Nc của/E dãy/Nc a/Ni có/V tổng_bằng/Np S/Y ./CH\nTa/P có_thể/R dùng/V phương_pháp/N đánh_dấu/V của/E bài/N chia/V kẹo/N ở/E trên/E rồi/C đếm/V các/L giá_trị/N t/Nu mà/C Lt=1/Np ./CH\nĐiền_dấu/Np Bài_toán/N :/CH Cho/E n/Ny số_tự_nhiên/Np A_1/Np ,/CH A_2/Np ,/CH ./CH ./CH ./CH ,/CH A_N/Np ./CH\nBan_đầu/N các/L số/N được/V đặt/V liên_tiếp/A theo/V đúng/A thứ_tự/N cách/N nhau/N bởi/E dấu/N \"/CH ?/CH \"/CH :/CH A1/Np ?/CH\nA2/Np ?/CH\n./CH ./CH ./CH\n?/CH\nAN/A ./CH\nCho/E trước_số/Np nguyên/A S/Y ,/CH có/V cách/N nào/P thay/V các/L dấu/N ?/CH\nbằng/E dấu/N +/CH hay/Cc dấu/N −/Np để/E được/V một/M biểu_thức/Np số_học/Np cho/E giá_trị/N là/V S/Y không/R ?/CH\nHướng_dẫn/V :/CH Đặt_Li/Np ,/CH t=1/Np nếu/C có_thể/R điền_dấu/Np vào/E i/M số/N đầu_tiên/A và/Cc cho/E kết_quả/N bằng/E t/Nu ./CH\nTa/P có_công/Np thức/V sau/E để/E tính/V L/Ny :/CH L1/Np ,/CH a1/Np =/CH 1/M Li/Np ,/CH t/Nu =/CH 1/M nếu/C Li/Np -/CH 1/M ,/CH t/Nu +/CH ai/P =/CH 1/M hoặc/Cc Li/Np -/CH 1/M ,/CH t/Nu -/CH ai/P =/CH 1/M ./CH\nNếu_Ln/Np ,/CH S/Y =/CH 1/M thì/C câu/N trả_lời/V của/E bài_toán/N là/V có/V ./CH\nKhi/N cài_đặt/V ,/CH có_thể/R dùng/V một/M mảng/N 2/M chiều/N (lưu/Np toàn_bộ/L bảng/N phương/N án)/Np hoặc/Cc 2/M mảng/N một_chiều/Np (để/Np lưu/V dòng/N i/M và/Cc dòng/N i-1)/Np ./CH\nChú_ý/V là/V chỉ_số/N theo/V t/Nu của/E các/L mảng/N phải/V có/V cả/P phần/N âm/A (tức/Np là/V từ/E -T/Np đến/E T/Nu ,/CH với/E T/Nu là/V tổng/N của/E n/Ny số)/Np ,/CH vì/E trong/E bài/N này/P chúng_ta/P dùng/V cả/P dấu/N -/CH nên/C có_thể/R tạo/V ra/V các/L tổng_âm/Np ./CH\nBài/N này/P có_một/Np biến_thể/N là/V đặt/V dấu/N sao_cho/Np kết_quả/N là/V một_số/L chia_hết_cho/Np k/N ./CH\nTa/P có/V thuật_giải/Np tương_tự/A bài_toán/N trên/E bằng/E cách/N thay/V các/L phép_cộng/Np ,/CH trừ/V bằng/E các/L phép_cộng/Np và/Cc trừ/V theo/V modulo/Np k/N và/Cc dùng/V mảng/N đánh_dấu/V với/E các/L giá_trị/N từ/E 0/M đến/E k-1/Np (là/Np các/L số_dư/Np có_thể/R có_khi/R chia/V cho/E k)/Np ./CH\nĐáp_số/Np của/E bài_toán/N là/V Ln/Np ,/CH 0/M ./CH\nExpression/Np Bài_toán/N :/CH Cho/E n/Ny số_nguyên/Np ./CH\nHãy/R chia/V chúng/P thành/V 2/M nhóm/N sao_cho/Np tích/N của/E tổng/N 2/M nhóm/N là/V lớn/A nhất/A ./CH\nHướng_dẫn/V :/CH Gọi_T/Np là/V tổng/N n/Ny số_nguyên/Np đó/P ./CH\nGiả_sử_ta/Np chia/V dãy/Nc thành/V 2/M nhóm/N ,/CH gọi/V S/Y là/V tổng/N của/E một/M nhóm/N ,/CH tổng/N nhóm/N còn_lại/Np là/V T-S/Np và/Cc tích/N của/E tổng/N 2/M nhóm/N là/V S(T-S)/Np ./CH\nBằng/E phương_pháp/N đánh_dấu/V ta/P xác_định/V được/V mọi/L số/N S/Y là/V tổng/N của/E một/M nhóm/N (như/Np bài/N Market)/Np và/Cc tìm/V số/N S/Y sao_cho/Np S(T-S)/Np đạt/V max/Np ./CH\nFarmer/Np (IOI/Np 2004)/Np Bài_toán/N Một/M người/N có/V N/Ny mảnh_đất/Np và/Cc M/Nu dải_đất/Np ./CH\nCác/L mảnh_đất/Np có_thể/R coi/V là/V một/M tứ_giác/Np và/Cc các/L dải_đất/Np thì/C coi_như/Np một/M đường_thẳng/N ./CH\nDọc/A theo/V các/L dải_đất/Np ông/N ta/P trồng/V các/L cây/N bách/Np ,/CH dải_đất/Np thứ/N i/M có/V A_i/Np cây/N bách/Np ./CH\nÔng/N ta/P cũng/R trồng/V các/L cây/N bách/Np trên/E viền/N của/E các/L mảnh_đất/Np ,/CH mảnh_đất/Np thứ/N j/Np có/V B_j/Np cây/N bách/Np ./CH\nCả/P ở/E trên/E các/L mảnh_đất/Np và/Cc dải_đất/Np ,/CH xen/V giữa/N 2/M cây/N bách/Np ông/N ta/P trồng/V một/M cây/N ôliu/Np ./CH\nÔng/N ta/P cho/E con_trai/N được/V chọn/V các/L mảnh_đất/Np và/Cc dải_đất/Np tuỳ_ý/Np với/E điều_kiện/N tổng_số/N cây/N bách/Np không/R vượt_quá/Np Q/Ny ./CH\nNgười/N con_trai/N phải/V chọn/V thế_nào/P để/E có/V nhiều/A cây/N ôliu/Np (loài/Np cây/N mà/C anh/N ta/P thích)/Np nhất/A ./CH\nHướng_dẫn/V Dễ/A thấy/V mảnh_đất/Np thứ/N i/M có/V A_i/Np cây/N ôliu/Np và/Cc dải_đất/Np thứ/N j/Np có/V B_j-1/Np cây/N ôliu/Np ./CH\nCoi/V các/L mảnh_đất/Np và/Cc dải_đất/Np là/V các/L “đồ/Np vật”/Np ,/CH đồ_vật/N thứ/N k/N có/V khối_lượng/N W_k/Np và/Cc giá_trị/N V_k/Np (nếu/Np k/N là/V mảnh_đất/Np i/M thì/C W_k=V_k=A_i/Np ,/CH nếu/C k/N là/V dải_đất/Np j/Np thì/C W_k=B_j/Np ,/CH V_k=B_j-1)/Np ./CH\nTa/P cần/V chọn/V các/L “đồ/Np vật”/Np ,/CH sao_cho/Np tổng/N “khối/Np lượng”/Np của/E chúng/P không/R vượt/V Q/Ny và/Cc tổng/N “giá/Np trị”/Np là/V lớn/A nhất/A ./CH\nĐây/P chính/T là/V bài_toán/N xếp/V balô/N đã/R trình_bày/V ở/E trên/E ./CH\n3/M ./CH\nBiến_đổi/V xâu/Np 3/M ./CH 1/M ./CH Mô_hình/N Cho/E 2/M xâu/Np X/CH ,/CH F/Np ./CH\nXâu/Np gốc/N có/V n/Ny kí_tự/Np X_1/Np X_2/Np ./CH ./CH ./CH\nX_n/Np ,/CH xâu/Np đích/N có/V m/Nu kí_tự/Np F_1/Np F_2/Np ./CH ./CH ./CH\nF_m/Np ./CH\nCó/V 3/M phép/N biến_đổi/V :/CH Chèn/V 1/M kí_tự/Np vào/E sau/E kí_tự/Np thứ/N i/M :/CH I/M i/M C/Ni Thay_thế/V kí_tự/Np ở/E vị_trí/N thứ/N i/M bằng/E kí_tự/Np C/Ni :/CH R/Np i/M C_Xoá/Np kí_tự/Np ở/E vị_trí/N thứ/N i/M :/CH D/Ny i/M Hãy/R tìm/V số_ít/Np nhất/A các/L phép/N biến_đổi/V để/E biến/V xâu/Np X/CH thành/V xâu/Np F/Np ./CH\n3/M ./CH 2/M ./CH Hướng_dẫn/V Hàm_mục_tiêu/Np :/CH f/Np :/CH số/N phép/N biến_đổi/V ./CH\nDễ/A thấy/V số/N phép/N biến_đổi/V phụ_thuộc/V vào/E vị_trí/N i/M đang/R xét/V của/E xâu/Np X/CH và/Cc vị_trí/N j/Np đang/R xét/V của/E xâu/Np F/Np ./CH\nDo_vậy/C để/E cài_đặt/V cho/E bảng/N phương_án/N ta/P sẽ/R dùng/V mảng/N 2/M chiều/N ./CH\nGọi_Li/Np ,/CH j/Np là/V số/N phép/N biến_đổi/V ít_nhất/A để/E biến/V xâu/Np X_i/Np gồm/V i/M kí_tự/Np phần/N đầu/N của/E X/CH (X_i/Np =/CH X1/Np ./CH ./CH i)/Np thành/V xâu/Np F_j/Np gồm/V j/Np kí_tự/Np phần/N đầu/N của/E F/Np (F_j/Np =/CH F1/Ny ./CH ./CH j)/Np ./CH\nDễ/A thấy/V L0/Np ,/CH j=j/Np và/Cc Li/Np ,/CH 0=i/Np ./CH\nCó/V 2/M trường_hợp/N xảy_ra/Np :/CH Nếu_Xi/Np =/CH Fj/Np :/CH X_1/Np X_2/Np ./CH ./CH ./CH\nX_i-1/Np X_i/Np F_1/Np F_2/Np ./CH ./CH ./CH\nF_j-1/Np X_i/Np thì/C ta/P chỉ/R phải/V biến_đổi/V xâu/Np X_i-1/Np thành/V xâu/Np F_j-1/Np ./CH\nDo_đó/C Li/Np ,/CH j=Li-1/Np ,/CH j-1/Np ./CH\nNgược_lại/X ,/CH ta/P có/V 3/M cách/N biến_đổi/V :/CH Xoá/V kí_tự/Np X_i/Np :/CH X_1/Np X_2/Np ./CH ./CH ./CH\nX_i-1/Np F_1/Np F_2/Np ./CH ./CH ./CH\nF_j-1/Np F_j/Np Xâu/Np X_i-1/Np thành/V F_j/Np ./CH\nKhi/N đó/P Li/Np ,/CH j=Li-1/Np ,/CH j+1/Np ./CH\n(Cộng/Np 1/M là/V do/E ta/P đã/R dùng/V 1/M phép/N xóa)/Np Thay_thế/V X_i/Np bởi/E F_j/Np :/CH X_1/Np X_2/Np ./CH ./CH ./CH\nX_i-1/Np F_j/Np F_1/Np F_2/Np ./CH ./CH ./CH\nF_j-1/Np F_j/Np Xâu/Np X_i-1/Np thành/V F_j-1/Np ./CH\nKhi/N đó/P Li/Np ,/CH j=Li-1/Np ,/CH j-1+1/Np ./CH\nChèn/V F_j/Np vào/E sau/E X_i/Np :/CH X_1/Np X_2/Np ./CH ./CH ./CH\nX_i/Np F_j/Np F_1/Np F_2/Np ./CH ./CH ./CH\nF_j-1/Np F_j/Np Xâu/Np X_i/Np thành/V F_j-1/Np ./CH\nKhi/N đó/P Li/Np ,/CH j=Li/Np ,/CH j-1+1/Np Tổng_kết/V lại/R ,/CH ta/P có_công/Np thức/V QHĐ/Np :/CH L0/Np ,/CH j=j/Np Li/Np ,/CH 0=i/Np Li/Np ,/CH j/Np =Li−1/Np ,/CH j−1/Np nếu/C X_i/Np =/CH Y_j/Np ./CH\nLi/Np ,/CH j/Np =/CH min(Li−1/Np ,/CH j/Np ,/CH Li/Np ,/CH j−1/Np ,/CH Li−1/Np ,/CH j−1)/Np +/CH 1/M nếu/C X_i/Np \\ne/Np F_j/Np ./CH\nBài/N này/P ta/P có_thể/R tiết_kiệm/V biến/V hơn/A bằng/E cách/N dùng/V 2/M mảng/N 1/M chiều/N tính/V lẫn_nhau/Np và/Cc một/M mảng/N đánh_dấu/V 2/M chiều/N để/E truy/V vết/N ./CH\n3/M ./CH 3/M ./CH Một_số/L bài_toán/N khác/A Xâu/Np con/Nc chung/A dài/A nhất/A Bài_toán/N :/CH Cho/E 2/M xâu/Np X/CH ,/CH Y/N ./CH\nHãy/R tìm/V xâu/Np con/Nc của/E X/CH và/Cc của/E Y/N có/V độ_dài/Np lớn/A nhất/A ./CH\nBiết/V xâu/Np con/Nc của/E một/M xâu/Np thu/V được/V khi/N xóa_một/Np số/N kí_tự/Np thuộc/V xâu/Np đó/P (hoặc/Np không/R xóa/V kí_tự/Np nào)/Np ./CH\nCông_thức/N QHĐ/Np :/CH Gọi_Li/Np ,/CH j/Np là/V độ_dài/Np xâu/Np con/Nc chung/A dài/A nhất/A của/E xâu/Np X_i/Np gồm/V i/M kí_tự/Np phần/N đầu/N của/E X/CH (X_i/Np =/CH X1/Np ./CH ./CH i)/Np và/Cc xâu/Np Y_j/Np gồm/V j/Np kí_tự/Np phần/N đầu/N của/E Y/N (Y_j/Np =/CH Y1/Ni ./CH ./CH j)/Np ./CH\nTa/P có_công/Np thức/V quy_hoạch_động/Np như_sau/Np :/CH L0/Np ,/CH j/Np =/CH Li/Np ,/CH 0/M =/CH 0/M Li/Np ,/CH j/Np =/CH Li−1/Np ,/CH j−1/Np +/CH 1/M nếu/C X_i/Np =/CH Y_j/Np Li/Np ,/CH j/Np =/CH max(Li−1/Np ,/CH j/Np ,/CH Li/Np ,/CH j−1)/Np nếu/C X_i/Np \\ne/Np Y_j/Np ./CH\nCài_đặt/V :/CH Bảng/N phương_án/N là/V một/M mảng/N 2/M chiều/N L0/Np ./CH ./CH m/Nu ,/CH 0/M ./CH ./CH n/Ny để/E lưu/V các/L giá_trị/N của/E hàm/Np QHĐ_Li/Np ,/CH j/Np ./CH\nĐoạn/Nc chương_trình/N cài_đặt/V công_thức/N QHĐ/Np trên/E như_sau/Np :/CH for/Np i/M :/CH =/CH 0/M to/A m/Nu do/E L/Ny i/M ,/CH 0/M :/CH =/CH 0/M ;/CH for/Np j/Np :/CH =/CH 0/M to/A n/Ny do/E L/Ny 0/M ,/CH j/Np :/CH =/CH 0/M ;/CH for/Np i/M :/CH =/CH 1/M to/A m/Nu do/E for/Np j/Np :/CH =/CH 1/M to/A n/Ny do/E if/Np X/CH i/M =/CH Y/N j/Np then/Np L/Ny i/M ,/CH j/Np :/CH =/CH L/Ny i/M -/CH 1/M ,/CH j/Np -/CH 1/M +/CH 1/M else/Np L/Ny i/M ,/CH j/Np :/CH =/CH max/Np (/CH L/Ny i/M -/CH 1/M ,/CH j/Np ,/CH L/Ny i/M ,/CH j/Np -/CH 1/M );/CH Như_vậy/X độ/N phức_tạp/A bộ_nhớ/Np của/E bài_toán/N là/V O(n2)/Np ,/CH độ/N phức_tạp/A thời_gian/N là/V O(n2)/Np ./CH\nCó_một/Np phương_pháp/N cài_đặt/V tốt/A hơn/A ,/CH chỉ/R với/E độ/N phức_tạp/A bộ_nhớ/Np O(n)/Np dựa/V trên/E nhận_xét/N sau/E :/CH để/E tính/V ô/N Li/Np ,/CH j/Np của/E bảng/N phương_án/N ,/CH ta/P chỉ_cần/Np 3/M ô/N Li-1/Np ,/CH j-1/Np ,/CH Li-1/Np ,/CH j/Np và/Cc Li/Np ,/CH j-1/Np ./CH\nTức_là/V để/E tính/V dòng/N Li/Np thì/C chỉ_cần/Np dòng/N Li-1/Np ./CH\nDo_đó/C ta/P chỉ_cần/Np 2/M mảng/N 1/M chiều/N để/E lưu/V dòng/N vừa/R tính/V (P)/Np và/Cc dòng/N đang/R tính/V (L)/Np mà_thôi/T ./CH\nCách/N cài_đặt/V mới/R như_sau/Np :/CH for/Np j/Np :/CH =/CH 0/M to/A n/Ny do/E P/Ny j/Np :/CH =/CH 0/M ;/CH for/Np i/M :/CH =/CH 1/M to/A m/Nu do/E begin/Np L/Ny 0/M :/CH =/CH 0/M ;/CH for/Np j/Np :/CH =/CH 1/M to/A n/Ny do/E if/Np X/CH i/M =/CH Y/N j/Np then/Np L/Ny i/M ,/CH j/Np :/CH =/CH P/Ny j/Np -/CH 1/M +/CH 1/M else/Np L/Ny i/M ,/CH j/Np :/CH =/CH max/Np (/CH P/Ny j/Np ,/CH L/Ny j/Np -/CH 1/M );/CH P/Ny :/CH =/CH L/Ny ;/CH end/Np ;/CH Bắc_cầu/V Bài_toán/N :/CH Hai/M nước/N Alpha/Np và/Cc Beta/N nằm/V ở/E hai/M bên_bờ/Np sông/N Omega/Np ,/CH Alpha/Np nằm/V ở/E bờ/N bắc/N và/Cc có/V M/Nu thành_phố/N được/V đánh_số/Np từ/E 1/M đến/E M/Nu ,/CH Beta/N nằm/V ở/E bờ/N nam/N và/Cc có/V N/Ny thành_phố/N được/V đánh_số/Np từ/E 1/M đến/E N/Ny (theo/Np vị_trí/N từ/E đông/A sang/V tây)/Np ./CH\nMỗi/L thành_phố/N của/E nước/N này/P thường/R có/V quan_hệ/N kết_nghĩa/Np với/E một_số/L thành_phố/N của/E nước/N kia/P ./CH\nĐể/E tăng_cường/V tình/N hữu_nghị/A ,/CH hai/M nước/N muốn/V xây/V các/L cây/N cầu/N bắc/N qua_sông/Np ,/CH mỗi/L cây/N cầu/N sẽ/R là/V nhịp/N cầu_nối/N 2/M thành_phố/N kết_nghĩa/Np ./CH\nVới/E yêu_cầu/V là/V các/L cây/N cầu/N không/R được/V cắt/V nhau/N và/Cc mỗi/L thành_phố/N chỉ/R là/V đầu_cầu/Np cho/E nhiều/A nhất_là/X một/M cây/N cầu/N ,/CH hãy/R chỉ/R ra/V cách/N bắc_cầu/V được/V nhiều/A cầu/N nhất/A ./CH\nHướng_dẫn/V :/CH Gọi/V các/L thành_phố/N của/E Alpha/Np lần_lượt/R là/V A_1/Np ,/CH A_2/Np ,/CH ./CH ./CH ./CH ,/CH A_M;/Np các/L thành_phố/N của/E Beta/N là/V B_1/Np ,/CH B_2/Np ,/CH ./CH ./CH ./CH ,/CH B_N/Np ./CH\nNếu/C thành_phố/N A_i/Np và/Cc B_j/Np kết_nghĩa/Np với_nhau/Np thì/C coi/V A_i/Np \"bằng”/Np B_j/Np ./CH\nĐể/E các/L cây/N cầu/N không/R cắt/V nhau/N ,/CH nếu/C ta/P đã/R chọn/V cặp/N thành_phố/N (A_i/Np ,/CH B_j)/Np để/E xây/V cầu/N thì/C cặp/N tiếp_theo/V phải/V là/V cặp/N (A_u/Np ,/CH B_v)/Np sao_cho/Np ugt;i/Np và/Cc vgt;j/Np ./CH\nNhư_vậy/X các/L cặp/N thành_phố/N được/V chọn/V xây/V cầu/N có_thể/R coi/V là/V một/M dãy/Nc con/Nc chung/A của/E hai/M dãy/Nc A/Ni và/Cc B/Ni ./CH\nBài_toán/N của/E chúng_ta/P trở_thành/V bài_toán/N tìm/V dãy/Nc con/Nc chung/A dài/A nhất/A ,/CH ở/E đây/P hai/M phần_tử/N “bằng”/Np nhau/N nếu/C chúng/P có/V quan_hệ/N kết_nghĩa/Np ./CH\nPalindrome/Np (IOI/Np 2000)/Np Bài_toán/N :/CH Một/M xâu/Np gọi_là/V xâu/Np đối_xứng/Np (palindrome)/Np nếu/C xâu/Np đó/P đọc/V từ/E trái/Nc sang/V phải/V hay/Cc từ/E phải/V sang/V trái/Nc đều/R như_nhau/Np ./CH\nCho/E một/M xâu/Np S/Y ,/CH hãy/R tìm/V số/N kí_tự/Np ít_nhất/A cần/V thêm/V vào/E S/Y để/E S/Y trở_thành/V xâu/Np đối_xứng/Np ./CH\nHướng_dẫn/V :/CH Bài_toán/N này/P có_một/Np công_thức/N QHĐ/Np như_sau/Np :/CH Gọi_Li/Np ,/CH j/Np là/V số/N kí_tự/Np ít_nhất/A cần/V thêm/V vào/E xâu/Np con/Nc Si/Ny ./CH ./CH j/Np của/E S/Y để/E xâu/Np đó/P trở_thành/V đối_xứng/Np ./CH\nĐáp_số/Np của/E bài_toán/N sẽ/R là/V L1/Np ,/CH n/Ny với/E n/Ny là/V số/N kí_tự/Np của/E S/Y ./CH\nTa/P có_công/Np thức/V sau/E để/E tính/V Li/Np ,/CH j/Np :/CH L(i/Np ,/CH i)=0/Np ./CH\nL(i/Np ,/CH j)=L(i+1/Np ,/CH j-1)/Np nếu/C S_i=S_j/Np L(i/Np ,/CH j)=max(L(i+1/Np ,/CH j)/Np ,/CH L(i/Np ,/CH j-1))/Np nếu/C S_i/Np \\ne/Np S_j/Np Bạn_đọc/N dễ_dàng/A có_thể/R kiểm_chứng/Np công_thức/N đó/P ./CH\nTa/P có_thể/R cài_đặt/V trực_tiếp/A công_thức/N đó/P bằng/E phương_pháp/N đệ_quy/Np có/V nhớ/V ./CH\nTuy_nhiên/C khi/N đó/P độ/N phức_tạp/A bộ_nhớ/Np là/V O(n2)/Np ./CH\nCó_một/Np phương_pháp/N cài_đặt/V tiết_kiệm/V hơn/A ,/CH có_thể/R tham_khảo/V ở/E bài/N viết/V của/E Nguyễn_Hoành/Np Tiến_Ta/Np có/V thuật_toán/N đơn_giản/A hơn/A như_sau/Np :/CH Gọi_P/Np là/V xâu/Np đảo/N của/E S/Y và/Cc T/Nu là/V xâu/Np con/Nc chung/A dài/A nhất/A của/E S/Y và/Cc P/Ny ./CH\nKhi/N đó/P các/L kí_tự/Np của/E S/Y không/R thuộc/V T/Nu cũng/R là/V các/L kí_tự/Np cần/V thêm/V vào/E để/E S/Y trở_thành/V đối_xứng/Np ./CH\nĐáp_số/Np của/E bài_toán/N sẽ/R là/V n-k/Np ,/CH với/E k/N là/V độ_dài/Np của/E T/Nu ./CH\nVí_dụ/C :/CH S=edbabcd/Np ,/CH xâu/Np đảo/N của/E S/Y là/V P=dcbabde/Np ./CH\nXâu/Np con/Nc chung/A dài/A nhất/A của/E S/Y và/Cc P/Ny là/V T=dbabd/Np ./CH\nNhư_vậy/X cần/V thêm/V 2/M kí_tự/Np là/V e/Ni và/Cc c/Ni vào/E để/E S/Y trở_thành/V xâu/Np đối_xứng/Np ./CH\n4/M ./CH\nVali/Np (A)/Np 4/M ./CH 1/M ./CH Mô_hình/N Cho/E n/Ny vật/N ,/CH vật/N i/M nặng/A A_i/Np và/Cc có_giá/Np trị/V B_i/Np ./CH\nHãy/R chọn/V ra/V một_số/L vật/N để_cho/Np vào/E balô/N sao_cho/Np tổng/N khối_lượng/N không/R vượt_quá/Np W/Nu và/Cc tổng_giá/Np trị/V là/V lớn/A nhất/A ./CH\nChú_ý/V rằng/C mỗi/L vật/N có_thể/R được/V chọn/V nhiều/A lần/N ./CH\n4/M ./CH 2/M ./CH Công_thức/N Gọi_L(i/Np ,/CH j)/Np là/V tổng_giá/Np trị/V lớn/A nhất/A khi/N được/V chọn/V i/M vật/N từ/E 1/M đến/E i/M cho/E vào/E balô/N với/E tổng/N khối_lượng/N không/R vượt_quá/Np j/Np ./CH\nL(n/Np ,/CH W)/Np sẽ/R là/V đáp_số/Np của/E bài_toán/N (là/Np giá_trị/N lớn/A nhất/A có/V được/V nếu/C chọn/V n/Ny vật/N và/Cc tổng/N khối_lượng/N không/R vượt_quá/Np W)/Np ./CH\nCông_thức/N tính/V L(i/Np ,/CH t)/Np như_sau/Np :/CH L(i/Np ,/CH 0)/Np =/CH 0/M L(0/Np ,/CH t)/Np =/CH 0/M L(i/Np ,/CH t)/Np =/CH L(i-1/Np ,/CH t)/Np nếu/C tlt;A_i/Np L(i/Np ,/CH t)/Np =/CH max(L(i-1/Np ,/CH t)/Np ,/CH L(i/Np ,/CH t-A_i)/Np +/CH B_i)/Np nếu/C t/Nu \\ge/Np A_i/Np Trong/E đó/P :/CH L(i-1/Np ,/CH t)/Np là/V giá_trị/N có/V được/V nếu_không/Np đưa/V vật/N i/M vào/E balô/N ,/CH L(i/Np ,/CH t-A_i)/Np +/CH B_i/Np là/V giá_trị/N có/V được/V nếu/C chọn/V vật/N i/M ./CH\n4/M ./CH 3/M ./CH Cài_đặt/V Ta/P có_thể/R dùng/V một/M mảng/N 2/M chiều/N để/E lưu/V bảng/N phương_án/N ,/CH tuy_nhiên/C dựa/V trên/E nhận_xét/N rằng/C để/E tính/V dòng/N i/M của/E bảng/N phương_án/N chỉ_cần/Np dòng/N i-1/Np ,/CH ta/P chỉ_cần/Np dùng/V 2/M mảng/N một_chiều/Np P/Ny và/Cc L/Ny có/V chỉ_số/N từ/E 0/M đến/E m/Nu để/E lưu/V 2/M dòng/N đó/P ./CH\nĐoạn/Nc chương_trình/N con_tính/Np bảng/N phương_án/N như_sau/Np ./CH\nL/Ny t/Nu :/CH =/CH 0/M ;/CH với/E mọi/L t/Nu for/Np i/M :/CH =/CH 1/M to/A n/Ny do/E begin/Np P/Ny :/CH =/CH L/Ny ;/CH for/Np t/Nu :/CH =/CH 0/M to/A m/Nu do/E if/Np t/Nu lt;/Np a/Ni i/M then/Np L/Ny t/Nu :/CH =/CH P/Ny t/Nu else/Np L/Ny t/Nu :/CH =/CH max/Np (/CH P/Ny t/Nu ,/CH L/Ny t/Nu -/CH a/Ni i/M +/CH b/Ni i/M );/CH end/Np ;/CH Nếu/C để_ý/V kĩ/A bạn/N sẽ/R thấy/V rằng/C đoạn/Nc trình/V trên/E chỉ/R viết/V giống/N công_thức/N QHĐ/Np chứ/C chưa/R tối_ưu/A ./CH\nChẳng_hạn/X đã/R có/V lệnh/N gán/V P/Ny :/CH =L/Np ,/CH sau_đó/Np lại/R có/V gán/V Lt/Np :/CH =Pt/Np với/E các/L giá_trị/N tlt;ai/Np là/V không/R cần_thiết/A ./CH\nBạn_đọc/N có_thể/R tự/P cải_tiến/V để/E chương_trình/N tối_ưu/A hơn/A ./CH\nĐộ/N phức_tạp/A bộ_nhớ/Np là/V O(m)/Np và/Cc độ/N phức_tạp/A thời_gian/N là/V O(m/Np n)/Np ./CH\n4/M ./CH 4/M ./CH Một_số/L bài_toán/N khác/A Đổi_tiền/Np Bài_toán/N Ở/E đất_nước/N Omega/Np người_ta/P chỉ_tiêu/N tiền/N xu/N ./CH\nCó_N/Np loại/N tiền/N xu/N ,/CH loại/N thứ/N i/M có/V mệnh_giá/Np là/V A_i/Np đồng/Nu ./CH\nMột/M người/N khách_du/Np lịch/N đến/E Omega/Np du_lịch/V với/E số/N tiền/N M/Nu đồng/Nu ./CH\nÔng/N ta/P muốn/V đổi/V số/N tiền/N đó/P ra/V tiền/N xu/N Omega/Np để/E tiện/V tiêu_dùng/V ./CH\nÔng/N ta/P cũng/R muốn/V số/N đồng_tiền/N đổi/V được/V là/V ít_nhất/A (cho/Np túi_tiền/Np đỡ/V nặng/A khi/N đi/V đây/P đi/V đó)/Np ./CH\nBạn/N hãy/R giúp/V ông/N ta/P tìm/V cách/N đổi_tiền/Np ./CH\nHướng_dẫn/V Bài_toán/N này/P khá/R giống/N bài_toán/N xếp/V balô/N (“khối/Np lượng”/Np là/V mệnh_giá/Np ,/CH “giá/Np trị”/Np là/V 1)/Np ,/CH chỉ_có/Np một/M thay_đổi/V nhỏ/A :/CH tổng_giá/Np trị/V yêu_cầu/V là/V nhỏ/A nhất/A ./CH\nDo_đó/C ta/P cũng/R xây_dựng/V hàm/Np QHĐ/Np một_cách/N tương_tự/A :/CH Gọi_Li/Np ,/CH t/Nu là/V số/N đồng/Nu xu/N ít_nhất/A nếu/C đổi/V t/Nu đồng/Nu ra/V i/M loại/N tiền/N xu/N (từ/Np 1/M đến/E i)/Np ./CH\nCông_thức/N tính/V Li/Np ,/CH t/Nu như_sau/Np :/CH Li/Np ,/CH 0=0/Np L0/Np ,/CH t=/Np \\inf/Np với/E tgt;0/Np ./CH\nLi/Np ,/CH t=Li-1/Np ,/CH t/Nu nếu/C tlt;Ai/Np ./CH Li/Np ,/CH t=min(Li-1/Np ,/CH t/Nu ,/CH Li/Np ,/CH t-Ai+1)/Np nếu/C t/Nu \\ge/Np A_i/Np ./CH\nCông_thức/N này/P khác/A công_thức/N của/E bài/N xếp/V balô/N ở/E chỗ/N :/CH dùng/V hàm/Np min/Np chứ/C không_phải/Np hàm_max/Np (vì/Np cần/V tìm/V cách/N chọn/V ít/A hơn)/Np ./CH\n5/M ./CH\nNhân/N ma_trận/N 5/M ./CH 1/M ./CH Mô_hình/N Nhân/N một/M ma_trận/N kích_thước/N m/Nu n/Ny với/E một/M ma_trận/N n/Ny p/Ny ,/CH số/N phép_nhân/Np phải/V thực_hiện/V là/V m/Nu n/Ny p/Ny ./CH\nMặt_khác/X phép_nhân/Np các/L ma_trận/N có/V tính/V kết_hợp/V ,/CH tức_là/V :/CH (A/Np B)_C/Np =/CH A/Ni (B/Np C)/Np Do_đó/C khi/N tính/V tích/N nhiều/A ma_trận/N ,/CH ta/P có_thể/R thực_hiện/V theo/V các/L trình_tự/N khác_nhau/Np ,/CH mỗi/L trình_tự/N tính/V sẽ/R quyết_định/V số/N phép_nhân/Np cần/V thực_hiện/V ./CH\nCho_N/Np ma_trận/N A_1/Np ,/CH A_2/Np ,/CH ./CH ./CH ./CH ,/CH A_N/Np ,/CH ma_trận/N A/Ni có/V kích_thước/N là/V d_i-1/Np d_i/Np ./CH\nHãy/R xác_định/V trình_tự/N nhân/N ma_trận/N A_1/Np A_2/Np ./CH ./CH ./CH\nA_N/Np sao_cho/Np số/N phép_nhân/Np cần/V thực_hiện/V là/V ít_nhất/A ./CH\n5/M ./CH 2/M ./CH Công_thức/N Gọi_F(i/Np ,/CH j)/Np là/V số/N phép_nhân/Np để/E tính/V tích/N các/L ma_trận/N từ/E A_i/Np đến/E A_j/Np (A_i/Np A_i+1/Np ./CH ./CH ./CH\nA_j)/Np ./CH\nFi/Np ,/CH i=0/Np ./CH\nFi/Np ,/CH i+1=d_i-1/Np d_i/Np d_i+1/Np Fi/Np ,/CH j/Np =/CH min(Fi/Np ,/CH k+Fk+1/Np ,/CH j/Np +/CH d_i-1/Np d_i/Np d_i+1/Np với/E k=i+1/Np ,/CH i+2/Np ,/CH ./CH ./CH ./CH ,/CH j-1/Np Công_thức/N hơi/R phức_tạp/A nên/C tôi/P xin/V giải_thích/V như_sau/Np :/CH Fi/Np ,/CH i=0/Np là/V hiển_nhiên/Np ./CH\nFi/Np ,/CH i+1/Np là/V số/N phép_nhân/Np khi/N nhân/N A_i/Np và/Cc A_i+1/Np ./CH\nA_i/Np có/V kích_thước/N d_i-1/Np d_i/Np ,/CH A_i+1/Np có/V kích_thước/N d_i/Np d_i+1/Np ,/CH do_đó/C Fi/Np ,/CH i+1=d_i-1/Np d_i/Np d_i+1/Np Với/E jgt;i+1/Np thì/C ta/P thấy/V có_thể/R tính/V A_i/Np A_i+1/Np ./CH ./CH ./CH\nA_j/Np bằng/E cách/N chọn/V một/M vị_trí/N k/N nào_đó/P để/E đặt/V ngoặc/Np theo/V trình_tự/N :/CH A_i/Np A_i+1/Np ./CH ./CH ./CH\nA_j/Np =/CH (A_i/Np ./CH ./CH A_k)/Np (A_k+1/Np ./CH ./CH A_j)/Np Ma_trận/N kết_quả/N của/E phép_nhân/Np (A_i/Np ./CH ./CH A_k)/Np có/V kích_thước/N d_i-1/Np d_i/Np ,/CH ma_trận/N kết_quả/N của/E phép_nhân/Np (A_k+1/Np ./CH ./CH A_j)/Np có/V kích_thước/N d_k/Np d_j/Np ./CH\nVới/E cách/N đặt/V đó/P ta/P sẽ/R mất/V Fi/Np ,/CH k/N phép_nhân/Np để/E có/V kết_quả/N trong/E dấu/N ngoặc/Np thứ/N nhất/A ,/CH mất/V thêm/V Fk+1/Np ,/CH j/Np phép_nhân/Np để/E có/V kết_quả/N trong/E dấu/N ngoặc/Np thứ_hai/N ,/CH và/Cc cuối_cùng/A mất/V d_i-1/Np d_k/Np d_j/Np để/E nhân/N 2/M ma_trận/N kết_quả/N đó/P ./CH\nTừ_đó/Np tổng_số/N phép_nhân/Np của/E cách/N đặt/V đó/P là/V :/CH Fi/Np ,/CH k/N +/CH Fk+1/Np ,/CH j/Np +/CH d_i-1/Np d_k/Np d_j/Np ./CH\nTa/P chọn/V vị_trí/N k/N cho/E số/N phép_nhân/Np ít_nhất/A ./CH\n5/M ./CH 3/M ./CH Cài_đặt/V Bảng/N phương_án/N là/V một/M mảng/N 2/M chiều/N F/Np để/E lưu/V Fi/Np ,/CH j/Np ./CH\nChú_ý/V khi/N cài_đặt/V là/V để/E tính/V được/V Fi/Np ,/CH j/Np ,/CH ta/P phải/V tính/V Fi/Np ,/CH k/N và/Cc Fk+1/Np ,/CH j/Np trước/E ./CH\nPhương_pháp/N đơn_giản/A để/E làm/V điều/N đó/P là/V phương_pháp/N đệ_quy/Np có/V nhớ/V ./CH\nTuy_nhiên/C dựa/V vào/E nhận_xét/N là/V trong/E công_thức/N QHĐ/Np :/CH j-i/Np lớn/A hơn/A k-i/Np và/Cc j-k/Np ,/CH ta/P có_thể/R tính/V theo/V trình_tự/N khác/A :/CH tính/V các/L phần_tử/N Fi/Np ,/CH j/Np với/E j-i/Np từ/E nhỏ/A đến/E lớn/A (không/Np phải/V là/V tính/V các/L giá_trị/N Fi/Np ,/CH j/Np với/E i/M ,/CH j/Np từ/E nhỏ/A đến/E lớn/A như/C vẫn/R làm)/Np ./CH\nVới/E cách/N đó/P ,/CH khi/N tính/V đến/E Fi/Np ,/CH j/Np thì/C ta/P đã/R có/V Fi/Np ,/CH k/N và/Cc Fk+1/Np ,/CH j/Np ./CH\nĐoạn/Nc chương_trình/N tính/V bảng/N phương_án/N như_sau/Np :/CH for/Np i/M :/CH =/CH 1/M to/A n/Ny do/E F/Np i/M ,/CH i/M :/CH =/CH 0/M ;/CH for/Np i/M :/CH =/CH 1/M to/A n/Ny -/CH 1/M do/E F/Np i/M ,/CH i/M +/CH 1/M :/CH =/CH d/Ny i/M -/CH 1/M d/Ny i/M d/Ny i/M +/CH 1/M ;/CH for/Np m/Nu :/CH =/CH 2/M to/A n/Ny -/CH 1/M do/E begin/Np for/Np i/M :/CH =/CH 1/M to/A n/Ny -/CH m/Nu do/E begin/Np j/Np :/CH =/CH i/M +/CH m/Nu ;/CH F/Np i/M ,/CH j/Np :/CH =/CH oo/Np ;/CH for/Np k/N :/CH =/CH i/M +/CH 1/M to/A j/Np -/CH 1/M do/E F/Np i/M ,/CH j/Np :/CH =/CH min/Np (/CH F/Np i/M ,/CH j/Np ,/CH F/Np i/M ,/CH k/N +/CH F/Np k/N +/CH 1/M ,/CH j/Np +/CH d/Ny i/M -/CH 1/M d/Ny k/N d/Ny j/Np );/CH end/Np ;/CH end/Np ;/CH Với/E cách/N cài_đặt/V trên/E ,/CH độ/N phức_tạp/A bộ_nhớ/Np là/V O(n2)/Np ,/CH độ/N phức_tạp/A thời_gian/N là/V O(n3)/Np ./CH\n5/M ./CH 4/M ./CH Một_số/L bài_toán/N khác/A Chia/V đa_giác/Np Bài_toán/N Cho/E một/M đa_giác/Np lồi/Np N/Ny đỉnh/N ./CH\nBằng/E các/L đường_chéo/Np không/R cắt/V nhau/N ,/CH ta/P có_thể/R chia/V đa_giác/Np thành/V N-2/Np tam_giác/N ./CH\nHãy/R xác_định/V cách/N chia/V có/V tổng_các/Np đường_chéo/Np ngắn/A nhất/A ./CH\nHướng_dẫn/V Để/E đơn_giản/A ta/P coi/V mọi/L đoạn_thẳng/Np nối/V 2/M đỉnh/N đều/R là/V “đường/Np chéo”/Np (nếu/Np nối/V 2/M đỉnh/N trùng/V nhau/N hoặc/Cc 2/M đỉnh/N liên_tiếp/A thì_có/X độ_dài/Np bằng/E 0)/Np ./CH\nGọi_F(i/Np ,/CH j)/Np là/V tổng_độ/Np dài/A các/L đường_chéo/Np khi/N chia/V đa_giác/Np gồm/V các/L đỉnh/N từ/E i/M đến/E j/Np thành/V các/L tam_giác/N ./CH\nNếu/C jlt;i+3/Np thì/C đa_giác/Np đó/P có/V ít_hơn/Np 4/M đỉnh/N ,/CH không/R cần/V phải/V chia/V nên/C F(i/Np ,/CH j)=0/Np ./CH\nNgược_lại/X ta/P xét/V cách/N chia/V đa_giác/Np đó/P bằng/E cách/N chọn/V một/M đỉnh/N k/N nằm/V giữa/N i/M ,/CH j/Np và/Cc nối/V i/M ,/CH j/Np với/E k/N ./CH\nKhi/N đó/P Fi/Np ,/CH j=Fi/Np ,/CH k+Fk/Np ,/CH j+di/Np ,/CH k+dk/Np ,/CH j/Np với/E d(i/Np ,/CH k)/Np là/V độ_dài/Np đường_chéo/Np (i/Np ,/CH k)/Np ./CH\nTóm_lại/Np công_thức/N QHĐ/Np như_sau/Np :/CH Fi/Np ,/CH j=0/Np với/E jlt;i+3/Np ./CH\nFi/Np ,/CH j=min(Fi/Np ,/CH k+Fk/Np ,/CH j+di/Np ,/CH k+dk/Np ,/CH j)/Np với/E k=i+1/Np ,/CH ./CH ./CH ./CH j-1/Np ./CH\nF1/Ny ,/CH n/Ny là/V tổng/N đường_chéo/Np của/E cách/N chia/V tối_ưu/A ./CH\nBiểu_thức/Np số_học/Np (IOI/Np 1999)/Np Bài_toán/N Cho/E biểu_thức/Np A_1/Np \\cdot/Np A_2/Np \\cdot/Np ./CH ./CH ./CH\n\\cdot/Np A_N/Np ,/CH trong/E đó/P A_i/Np là/V các/L số_thực/Np không/R âm/A và/Cc \\cdot/Np là/V một_phép_toán/Np +/CH hoặc/Cc cho/E trước/E ./CH\nHãy/R đặt/V các/L dấu/N ngoặc/Np để/E biểu_thức/Np thu/V được/V có/V kết_quả/N lớn/A nhất/A ./CH\nHướng_dẫn/V Gọi_Fi/Np ,/CH j/Np là/V giá_trị/N lớn/A nhất/A có_thể/R có_của/Np biểu_thức/Np A_i/Np \\cdot/Np A_i+1/Np \\cdot/Np ./CH ./CH ./CH\n\\cdot/Np A_j/Np ./CH\nDễ/A thấy/V nếu/C i=j/Np thì/C Fi/Np ,/CH j=A_i/Np ,/CH nếu/C j=i+1/Np thì/C Fi/Np ,/CH j=A_i/Np \\cdot/Np A_j/Np ./CH\nNếu/C jgt;i+1/Np thì_có/X thể/N tính/V biểu_thức/Np A_i/Np \\cdot/Np A_i+1/Np \\cdot/Np ./CH ./CH ./CH\n\\cdot/Np A_j/Np bằng/E cách/N chia/V thành/V 2/M nhóm/N :/CH (A_i/Np \\cdot/Np A_i+1/Np \\cdot/Np ./CH ./CH ./CH\n\\cdot/Np A_k)/Np \\cdot/Np (A_k+1/Np \\cdot/Np ./CH ./CH ./CH\n\\cdot/Np A_j)/Np ,/CH Khi/N đó/P Fi/Np ,/CH j=Fi/Np ,/CH k/N \\cdot/Np Fk+1/Np ,/CH j/Np ./CH\nTóm_lại/Np ,/CH công_thức/N QHĐ/Np là/V :/CH Fi/Np ,/CH i=A_i/Np Fi/Np ,/CH i+1=A_i/Np \\cdot/Np A_i+1/Np Fi/Np ,/CH j=max(Fi/Np ,/CH k/N \\cdot/Np Fk+1/Np ,/CH j)/Np với/E k=i+1/Np ,/CH i+2/Np ,/CH ./CH ./CH j-1/Np ./CH\n(Chú/Np là_là/Np các/L hạng/N tử/V của/E dãy/Nc đều/R không/R âm/A và/Cc các/L phép_toán/Np là/V +/CH hoặc/Cc nên/C Fi/Np ,/CH k/N và/Cc Fk+1/Np ,/CH j/Np đạt/V max/Np thì/C Fi/Np ,/CH k/N \\cdot/Np Fk+1/Np ,/CH j/Np cũng/R đạt/V max)/Np ./CH\n6/M ./CH\nGhép_cặp/Np 6/M ./CH 1/M ./CH Mô_hình/N Có/V n/Ny lọ/N hoa/N sắp/R thẳng_hàng/Np và/Cc k/N bó/V hoa/N được/V đánh_số/Np thứ_tự/N từ/E nhỏ/A đến/E lớn/A ./CH\nCần/V cắm/V k/N bó/V hoa/N trên/E vào/E n/Ny lọ/N sao_cho/Np hoa/N có_số/Np thứ_tự/N nhỏ/A phải/V đứng/V trước/E hoa/N có_số/Np thứ_tự/N lớn/A ./CH\nGiá_trị/N thẩm_mỹ/Np tương_ứng/V khi/N cắm/V hoa/N i/M vào/E lọ/N thứ/N j/Np là/V v(i/Np ,/CH j)/Np ./CH\nHãy/R tìm/V 1/M cách/N cắm/V sao_cho/Np tổng_giá/Np trị/V thẫm/A mỹ/Np là/V lớn/A nhất/A ./CH\nChú_ý/V rằng/C mỗi/L bó/V hoa/N chỉ/R được/V cắm/V vào/E 1/M lọ/N và/Cc mỗi/L lọ/N cũng/R chỉ/R cắm/V được/V 1/M bó/V hoa/N ./CH\n6/M ./CH 2/M ./CH Công_thức/N Nhận_xét/N rằng/C bài_toán/N nêu/V trên/E là/V một/M bài_toán/N ghép_cặp/Np có/V yêu_cầu/V về/E thứ_tự/N nên/C ta/P có_thể/R giải_quyết/V bằng/E phương_pháp/N QHĐ/Np ./CH\nHàm_mục_tiêu/Np :/CH f/Np :/CH tổng_giá/Np trị/V thẩm_mỹ/Np của/E cách/N cắm/V ./CH\nGiá_trị/N thẩm_mỹ/Np phụ_thuộc/V vào/E các/L hoa/N và/Cc các/L lọ/N đang/R được/V xét/V nên/C ta/P sẽ/R dùng/V mảng/N 2/M chiều/N để/E lưu/V bảng/N phương_án/N ./CH\nL(i/Np ,/CH j)/Np :/CH tổng_giá/Np trị/V thẩm_mỹ/Np lớn/A nhất/A khi/N xét/V đến/E hoa/N i/M và/Cc lọ/N j/Np ./CH\nKhi/N tính/V L(i/Np ,/CH j)/Np hoa/N đang/R xét/V sẽ/R là/V hoa/N i/M và/Cc lọ/N j/Np ./CH\nNếu/C i/M =/CH j/Np ./CH\nChỉ_có/Np một_cách/N cắm/V Li/Np ,/CH i/M :/CH =/CH V1/Np ,/CH 1+V2/Np ,/CH 2+/Np ./CH ./CH ./CH +Vi/Np ,/CH i/M Nếu/C igt;j/Np ./CH\nKhông/R có/V cách/N cắm/V hợp_lý/A Nếu/C ilt;j/Np ./CH\nCó/V 2/M trường_hợp/N xảy_ra/Np :/CH Cắm/V hoa/N i/M vào/E lọ/N j/Np ./CH\nTổng_giá/Np trị/V thẩm_mỹ/Np là/V Li-1/Np ,/CH j-1+V(i/Np ,/CH j)/Np ./CH\n(Bằng/Np tổng_giá/Np trị/V trước_khi/Np cắm/V cộng/V với/E giá_trị/N thẩm_mỹ/Np khi/N cắm/V hoa/N i/M vào/E lọ/N j)/Np Không/R cắm/V hoa/N i/M vào/E lọ/N j/Np (có/Np thể/N cắm/V vào/E lọ/N trước/E j)/Np ,/CH giá_trị/N thẫm/A mỹ/Np của/E cách/N cắm/V là/V như_cũ/Np :/CH Li/Np ,/CH j-1/Np 6/M ./CH 3/M ./CH Cài_đặt/V L/Ny i/M ,/CH j/Np :/CH =/CH -/CH maxint/Np ;/CH For/Np i/M :/CH =/CH 1/M to/A k/N do/E For/Np j/Np :/CH =/CH i/M to/A n/Ny do/E If/Np i/M =/CH j/Np then/Np L/Ny i/M ,/CH j/Np :/CH =/CH sum/Np (/CH i/M )/CH else/Np if/Np i/M lt;/Np j/Np then/Np L/Ny i/M ,/CH j/Np :/CH =/CH max/Np (/CH L/Ny i/M -/CH 1/M ,/CH j/Np -/CH 1/M +/CH v/Nu i/M ,/CH j/Np ,/CH L/Ny i/M ,/CH j/Np -/CH 1/M );/CH 6/M ./CH 4/M ./CH Một_số/L bài_toán/N khác/A Câu_lạc_bộ/N Bài_toán/N Có/V n/Ny phòng_học/Np chuyên_đề/N và/Cc k/N nhóm/N học/V được/V đánh_số/Np thứ_tự/N từ/E nhỏ/A đến/E lớn/A ./CH\nCần/V xếp/V k/N nhóm/N trên/E vào/E n/Ny phòng_học/Np sao_cho/Np nhóm/N có_số/Np hiệu/N nhỏ/A được/V xếp/V vào/E phòng/N có_số/Np hiệu/N nhỏ/A ,/CH nhóm/N có_số/Np hiệu/N lớn/A phải/V được/V xếp/V vào/E phòng/N có_số/Np hiệu/N lớn/A ./CH\nVới/E mỗi/L phòng/N có_chứ/Np học_sinh/N ,/CH các/L ghế/N thừa/V phải/V được/V chuyển/V ra/V hết/V ,/CH nếu/C thiếu/A ghế/N thì/C lấy/V vào/E cho/E đủ/A ghế/N ./CH\nBiết/V phòng/N i/M có/V A_i/Np ghế/N ,/CH nhóm/N j/Np có/V B_j/Np học_sinh/N ./CH\nHãy/R chọn/V 1/M phương_án/N bố_trí/V sao_cho/Np tổng_số/N lần/N chuyển/V ghế/N ra/V và/Cc vào/E là/V ít_nhất/A ./CH\nHướng_dẫn/V Khi/N xếp/V nhóm/N i/M vào/E phòng/N j/Np thì/C số/N lần/N chuyển/V ghế/N chính/T là/V độ/N chênh_lệch/A giữa/N số/N ghế/N trong/E phòng/N i/M và/Cc số_học/Np sinh/V trong/E nhóm/N ./CH\nĐặt_Vi/Np ,/CH j/Np :/CH =A_i/Np -/CH B_j/Np Mua/V giày/N (Đề/Np QG/Np bảng/N B/Ni năm/N 2003)/Np Bài_toán/N Trong/E hiệu/N có/V n/Ny đôi/M giày/N ,/CH đôi/M giày/N i/M có/V kích_thước/N H_i/Np ./CH\nCó/V k/N người/N cần/V mua/V giày/N ,/CH người/N i/M cần/V mua/V đôi/M giày/N kích_thước/N S_i/Np ./CH\nKhi/N người/N i/M chọn/V mua/V đôi/M giày/N j/Np thì/C độ_lệch/Np sẽ/R là/V H_i-S_j/Np ./CH\nHãy/R tìm/V cách/N chọn/V mua/V giày/N cho/E k/N người/N trên/E sao_cho/Np tổng_độ/Np lệch/Np là/V ít_nhất/A ./CH\nBiết/V rằng/C mỗi/L người/N chỉ/R mua/V 1/M đôi/M giày/N và/Cc 1/M đôi/M giày/N cũng/R chỉ_có/Np một/M người/N mua/V ./CH\nHướng_dẫn/V Lập_công/Np thức/V giải/N như/C bài/N Câu_lạc_bộ/N ./CH\nChú_ý/V chứng_minh/V tính/V đúng_đắn/A của/E bổ_đề/Np heuristic/Np sau/E :/CH Cho/E 2/M dãy/Nc tăng/V dần/R các/L số_dương/Np A_1/Np ,/CH A_2/Np ,/CH ./CH ./CH ./CH ,/CH A_N/Np ,/CH B_1/Np ,/CH B_2/Np ,/CH ./CH ./CH ./CH ,/CH B_N/Np ./CH\nGọi/V C_1/Np ,/CH C_2/Np ,/CH ./CH ./CH ./CH ,/CH C_N/Np là/V một/M hoán_vị/Np bất_kỳ/A của/E dãy/Nc B/Ni ./CH\nKhi/N đó/P :/CH A_1-B_1/Np +/CH A_2-B_2/Np +/CH ./CH ./CH ./CH\n+/CH A_N-B_N/Np \\le/Np A_1-C_1/Np +/CH A_2/Np -/CH C_2/Np +/CH ./CH ./CH ./CH\n+/CH A_N-C_N/Np 7/M ./CH\nDi_chuyển/V 7/M ./CH 1/M ./CH Mô_hình/N Cho/E bảng/N A/Ni gồm/V M_N/Np ô/N ./CH\nTừ/E ô/N (i/Np ,/CH j)/Np có_thể/R di_chuyển/V sang/V 3/M ô/N (i+1/Np ,/CH j)/Np ,/CH (i+1/Np ,/CH j-1)/Np và/Cc (i+1/Np ,/CH j+1)/Np ./CH\nHãy/R xác_định/V một/M lộ_trình/N đi/V từ/E hàng/N 1/M đến/E hàng/N M/Nu sao_cho/Np tổng_các/Np ô/N đi_qua/Np là/V lớn/A nhất/A ./CH\n7/M ./CH 2/M ./CH Công_thức/N Gọi_F(i/Np ,/CH j)/Np là/V giá_trị/N lớn/A nhất/A có/V được/V khi/N di_chuyển/V đến/E ô/N (i/Np ,/CH j)/Np ./CH\nCó/V 3/M ô/N có_thể/R đi/V đến/E ô/N (i/Np ,/CH j)/Np là/V (i-1/Np ,/CH j)/Np ,/CH (i-1/Np ,/CH j-1)/Np và/Cc (i-1/Np ,/CH j+1)/Np ./CH\nDo_đó/C ta/P có_công/Np thức/V QHĐ/Np như_sau/Np :/CH F1/Ny ,/CH j=A1/Np ,/CH j/Np Fi/Np ,/CH j=max(Fi-1/Np ,/CH j/Np ,/CH F(i-1/Np ,/CH j-1/Np ,/CH Fi-1/Np ,/CH j+1)+Ai/Np ,/CH j/Np với/E igt;1/Np 7/M ./CH 3/M ./CH Cài_đặt/V Bảng/N phương_án/N là/V bảng/N 2/M chiều/N F0/Np ./CH ./CH m/Nu ,/CH 0/M ./CH ./CH n/Ny ./CH\n(Tất/Np cả/P các/L ô/N trên/E biên/N đều/R cho/E giá_trị/N bằng/E 0)/Np ./CH\nQuá_trình/N tính/V như_sau/Np :/CH for/Np i/M :/CH =/CH 1/M to/A m/Nu do/E for/Np j/Np :/CH =/CH 1/M to/A n/Ny do/E F/Np i/M ,/CH j/Np =/CH max/Np (/CH F/Np i/M -/CH 1/M ,/CH j/Np ,/CH F/Np i/M -/CH 1/M ,/CH j/Np -/CH 1/M ,/CH F/Np i/M -/CH 1/M ,/CH j/Np +/CH 1/M +/CH A/Ni i/M ,/CH j/Np );/CH Cách/N cài_đặt/V này/P cho/E độ/N phức_tạp/A bộ_nhớ/Np và/Cc thời_gian/N đều/R là/V O(n2)/Np ./CH\nTa/P có_thể/R tiết_kiệm/V không_gian/N nhớ/V bằng/E cách/N tính/V trực_tiếp/A trên/E mảng/N A/Ni ./CH\n7/M ./CH 4/M ./CH Một_số/L bài_toán/N khác/A Tam_giác/N (IOI/Np 1994)/Np Bài_toán/N Cho/E một/M tam_giác/N gồm/V các/L số_nguyên/Np không/R âm/A ./CH\nHãy/R tính/V tổng_lớn/Np nhất/A các/L số/N trên/E đường_đi/Np từ/E đỉnh/N tam_giác/N xuống/V một/M điểm/N nào_đó/P ở/E đáy/N tam_giác/N nào_đó/P ./CH\nTại/E mỗi/L ô/N ta/P chỉ_có/Np đi_thẳng/Np xuống/V ,/CH sang/V ô/N bên/N trái/Nc hoặc/Cc bên/N phải/V ./CH\nHướng_dẫn/V Mô_tả/V các/L phần_tử/N của/E tam_giác/N số/N như/C một/M ma_trận/N ,/CH Ai/P ,/CH j/Np là/V phần_tử/N thứ/N j/Np trên/E dòng/N i/M (với/Np 1/M \\le/Np i/M \\le/Np N/Ny và/Cc 1/M \\le/Np j/Np \\le/Np i)/Np ./CH\nCó/V 2/M ô/N có_thể/R di_chưyển/Np đến/E ô/N (i/Np ,/CH j)/Np là/V ô/N (i-1/Np ,/CH j-1)/Np và/Cc ô/N (i-1/Np ,/CH j)/Np ./CH\nGọi_F(i/Np ,/CH j)/Np là/V tổng_lớn/Np nhất/A có_thể/R có_khi/R đi/V đến/E ô/N (i/Np ,/CH j)/Np ta/P có/V :/CH F1/Ny ,/CH 1=A1/Np ,/CH 1/M Fi/Np ,/CH 1=Fi-1/Np ,/CH 1+Ai/Np ,/CH 1/M Fi/Np ,/CH j=max(/Np Fi-1/Np ,/CH j-1/Np ,/CH Fi-1/Np ,/CH j/Np )/CH +/CH Ai/P ,/CH j/Np\n", "title": "Một số bài toán quy hoạch động điển hình\n", "link": "http://vnoi.info/wiki/algo/dp/basic-problems\n"}