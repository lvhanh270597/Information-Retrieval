{"content": "Nơi tổng_hợp và chia_sẻ những kiến_thức liên_quan tới giải_thuật nói_chung và lý_thuyết khoa_học máy_tính nói_riêng .\nin Một trong số những bài_toán cơ_bản có rất nhiều ứng_dụng trong khoa_học máy_tính là bài_toán tìm điểm gần nhất .\nTrong bài này ta chỉ xét hàm khoảng_cách d( . , . ) là .\nCách đơn_giản nhất để thiết_kế cấu_trúc dữ_liệu như_vậy là ta sẽ tính khoảng_cách giữa mọi cặp điểm , và sau_đó lưu vào một mảng hai nhiều (ma trận) D\\ldots , \\ldots .\nMỗi khi ta nhận được điểm truy_vấn \\mathbfp , ta chỉ việc duyệt qua tất_cả các điểm khác và đưa_ra các điểm có khoảng_cách không quá r từ \\mathbfp .\nDễ thấy : Một_số cấu_trúc dữ_liệu như có_thể sử_dụng khi số chiều d nhỏ (thường là 2 hoặc 3 chiều) .\nTa có_thể xây_dựng các cấu_trúc này trong thời_gian O(n\\log n) và truy_vấn có_thể được trả_lời trong thời_gian O(\\log n) .\nTuy_nhiên , sự phụ_thuộc của hằng_số ẩn sau O( . ) trong các cấu_trúc này là lũy_thừa theo số chiều d (còn gọi_là hiện_tượng the curse of dimensionality) , do_đó , nó không phù_hợp ngay_cả khi d không quá lớn (d = 20 chẳng hạn) .\nTrong thời_đại big data hiện_nay , ta thường phải tìm điểm gần nhất khi P có tới hàng_triệu điểm và các điểm có_số chiều cũng lên tới hàng_triệu (d \\sim n \\geq 106) .\n(Ví dụ thuật_toán trong học máy (machine learning) là một biến_thể của bài_toán tìm điểm gần nhất trên . ) Do_đó , bài_toán trên trở_nên vô_cùng khó .\nCấu_trúc dữ_liệu bảng ở trên chỉ_có thể làm_việc khi , còn các cấu_trúc như k-d tree thì hoàn_toàn vô_dụng .\nLocality_Sensitive_Hashing (LSH) là một kĩ_thuật xấp_xỉ dùng để giải_quyết tìm điểm gần nhất một_cách hiệu_quả khi n và d đều vô_cùng lớn .\nKhái_niệm này được giới_thiệu bởi Indyk và Motwani 1 .\nTrình_bày trong bài này phỏng theo note của Matoušek 2 .\nÝ_tưởng của LSH là sử_dụng một hàm_băm h( . ) để băm các điểm dữ_liệu trong P vào một bảng T .\nsao_cho nếu hai điểm \\mathbfp , \\mathbfq gần nhau thì khả_năng cao \\mathbfp , \\mathbfq sẽ được băm vào cùng một ô .\nNgược_lại , \\mathbfp và \\mathbfq sẽ bị băm vào hai ô khác_nhau .\nKhi trả_lời truy_vấn , ta chỉ việc tính mã_băm h(\\mathbfp) và đưa_ra tất_cả các điểm lưu trong ô Th(\\mathbfp) .\nHàm_băm h( . ) như_vậy đưcọ gọi_là kiểu locality sensitive .\n: Minh_họa một hàm_băm locality sensitive . Trong định_nghĩa trên , ta mong_muốn p_\\mathrmfar gần 0 còn p_\\mathrmclose gần với 1 vì như_vậy , xác_suất hai điểm gần nhau được băm vào cùng một ô lớn , còn xác_suất hai điểm xa nhau bị băm vào cùng một ô sẽ nhỏ .\nTheo định_nghĩa trên , với các điểm mà khoảng_cách trong_khoảng r \\leq d(\\mathbfp , \\mathbfq) \\leq Cr thì ta không quan_tâm đến chúng sẽ bị băm vào một ô_hay không .\nNếu ta chọn hằng_số C càng gần 1 thì số các điểm như_vậy càng nhỏ , phương_pháp của chúng_ta cần chính_xác .\nTuy_nhiên , bạn sẽ thấy dưới_đây , thời_gian và bộ_nhớ của cấu_trúc sẽ phụ_thuộc vào C , theo nghĩa , chúng_ta càng muốn độ_chính_xác cao thì ta càng phải trả nhiều thời_gian và bộ_nhớ .\nTheo định_nghĩa trên không chỉ áp_dụng đối_với không_gian Euclidean mà với mọi không_gian metric .\nTrong phạm_vi của bài này , ta chỉ quan_tâm đến không_gian Euclidean . Để bài_toán trở_nên đơn_giản , ta sẽ giả_sử r = 1 bằng cách nhân tập các vector (hay điểm) trong P với 1/r .\nNhư_vậy ta đã tiết_kiệm được một tham_số .\nGọi \\mathbfZ = (Z_1 , Z_2 , \\ldots , Z_d) \\in \\mathbbRd là một vector ngẫu_nhiên , trong đó mỗi Z_i \\sim \\mathcalN(0 , 1) là một biến ngẫu_nhiên có phân_phối chuẩn () .\nGọi_U là một_số ngẫu_nhiên trong đoạn 0 , 1); U được chọn đồng_đều (uniformly) , và w là một tham_số thực mà ta sẽ định_nghĩa sau .\nĐịnh_nghĩa họ các hàm_băm \\mathcalH_\\mathrmGauss như_sau : h(\\mathbfx) = \\lfloor \\frac\\langle \\mathbfZ , \\mathbfx \\ranglew + U \\rfloor \\qquad(1) Ta sẽ chứng_minh xác_suất \\mathbfx và \\mathbfy bị băm vào cùng một ô xấp_xỉ tỉ_lệ_thuận với khoảng_cách giữa hai điểm \\mathbfx và \\mathbfy .\n\\mathrmPrh(\\mathbfx) \\not= h(\\mathbfy) = \\sqrt\\frac2\\pi\\fracd(\\mathbfx , \\mathbfy)w + o(\\frac1w) \\qquad(2) Trước_khi đi_vào chi_tiết chứng_minh , ta xét ý_nghĩa của Lemma 1 .\nDo w là tham_số ta có_thể tùy_chọn , ta sẽ chọn w đủ lớn .\nKhi đó phần o(\\frac1w)) trong phương_trình (2) sẽ đóng_góp không_đáng_kể và xác_suất \\mathrmPrh(\\mathbfx) \\not= h(\\mathbfy) .\nDo_đó , ta có_thể coi xác_suất này là tỉ_lệ_thuận với khoảng_cách giữa hai điểm \\mathbfx và \\mathbfy .\nĐiều đó có_nghĩa là \\mathbfx và \\mathbfy càng gần nhau thì xác_suất chúng được băm vào cùng một ô càng lớn .\nĐây chính là điều mà chúng_ta cần .\nChú_ý , trong phần này ta đang giả_sử r = 1 .\nTừ (2) ta suy ra , họ hàm_băm \\mathcalH định_nghĩa như trong phương_trình (1) là một họ (r , Cr , p_\\mathrmclose , p_\\mathrmfar)-sensitive với p_\\mathrmclose = 1 - \\sqrt\\frac2\\pi\\frac1w + o(\\frac1w) và p_\\mathrmfar = 1 - \\sqrt\\frac2\\pi\\fracCw + o(\\frac1w) .\nĐể chứng_minh Lemma 1 , ta cần sử_dụng hai tính_chất sau_đây : \\mathrmPr\\lfloor a + U \\rfloor \\not= \\lfloor b + U \\rfloor = \\min(1 , a-b) \\qquad(3) Z \\sim \\mathcalN(0 , a2+b2) \\qquad (4) Gọi s = d(\\mathbfx , \\mathbfy) là khoảng_cách giữa hai điểm \\mathbfx và \\mathbfy và p(s) là xác_suất \\mathbfx và \\mathbfy bị băm vào cùng một ô .\nTheo_Fact 1 , ta có : \\mathrmPrh(\\mathbfx) \\not= h(\\mathbfy) \\mathbfZ = \\min(1 , \\frac\\langle \\mathbfZ , \\mathbfx - \\mathbfy \\ranglew) \\qquad(5) Theo_Fact 2 , X = \\langle \\mathbfZ , \\mathbfx - \\mathbfy \\rangle là một phân_phối chuẩn có mean 0 và độ_lệch tiêu_chuẩn d2(\\mathbfx , \\mathbfy) = s2 .\nDo_đó , t = X/s phân_bố theo \\mathcalN(0 , 1) .\nTừ_đó suy ra : \\beginarray l p(s) = \\frac1\\sqrt2\\pi \\int_-\\infty+\\infty \\min(1 , \\fracswt) e-t2/2 dt \\\\ = \\mathrmPrt\\geq \\fracws + \\fracsw \\int_-w/sw/st e-t2/2 dt \\\\ = \\mathrmPrt\\geq \\fracws + \\fracsw Et + \\frac2\\sqrt2\\pi \\fracsw\\int_w/s+\\infty te-t2/2 \\endarray \\qquad (6) Trong các bài_tập dưới_đây , mình sẽ hướng_dẫn các bạn chứng_minh các tính_chất sau : Do_đó , từ (6) , ta suy ra dpcm . Có mấy vấn_đề mà chúng_ta chưa nói_rõ phần trước về họ hàm_băm \\mathcalH trong (1) .\nThứ nhất ta mới chỉ nói chọn w đủ lớn , nhưng chưa nói chọn w lớn bao_nhiêu là vừa .\nThứ_hai , đầu_ra của hàm_băm trong (1) là toàn_bộ không_gian \\mathbbZ , mà để thực_hiện được trên máy_tính , đầu_ra phải hữu_hạn (và phải không quá lớn so_với n để cấu_trúc của chúng_ta trở_nên hiệu quả) .\nCả hai vấn_đề sẽ được làm rõ trong phần này . Trước_hết , ta giả_sử đã có_sẵn một họ (r , Cr , p_\\mathrmclose , p_\\mathrmfar)-sensitive \\mathcalH .\nGọi : \\alpha = \\frac\\ln p_\\mathrmclose \\ln p_\\mathrmfar \\qquad (7) Theo định_nghĩa của \\mathcalH , ta chỉ biết rằng p_\\mathrmclose - p_\\mathrmfar > 0 , chứ ta chưa biết sự khác_biệt này lớn bao_nhiêu .\nĐầu_tiên_ta sẽ khuếch_đại (amplify) khoảng_cách này bằng cách ghép nhiều hàm_băm trong họ \\mathcalH lại với_nhau . Gọi t là một_số nguyên mà ta sẽ xác_định sau .\nTa định_nghĩa một họ hàm_băm mới \\mathcalG_t trong đó mỗi hàm_băm g \\in \\mathcalG_t là ghép của t hàm_băm độc_lập trong \\mathcalH .\nMột_cách hình_thức : \\mathcalG_t = \\ g= (h_1 , h_2 , \\ldots , h_t) : h_1 , h_2 , \\ldots , h_t \\in \\mathcalH \\ \\qquad (8) Dễ thấy , g(\\mathbfx) = g(\\mathbfy) khi và chỉ khi h_i(\\mathbfx) = h_i(\\mathbfy) với mọi i , 1\\leq i \\leq t .\nDo_đó , \\mathcalG_t là một họ (r , Cr , pt_\\mathrmclose , pt_\\mathrmfar)-sensitive .\nĐầu_ra của mỗi hàm_băm g( . ) trong \\mathcalG_t là một bộ t số_nguyên (t-tuple) chứ không_phải là một_số .\nTa có_thể sử_dụng thêm một hàm_băm nữa để băm đầu_ra của g( . ) về các số_nguyên trong_khoảng 0 , O(n) , phục_vụ cho mục_đích tìm_kiếm .\nThiết_kế hàm_băm đó như_thế nào thì bạn_đọc có_thể xem trong bài bảng_băm mình .\nMặc_dù băm thêm một_lần nữa có_thể vẫn xảy_ra đụng_độ , để phân_tích dưới_đây được đơn_giản , ta sẽ giả_sử không xảy_ra đụng_độ trong lần băm cuối_cùng .\nDo_đó , ta có_thể coi g( . ) như_là một hàm_băm để băm vào bảng lưu_trữ . Tiếp_theo , ta xây_dựng L bảng_băm T1 , T2 , \\ldots TL trong đó mỗi bằng băm Tj ta sử_dụng hàm_băm g_j chọn ngẫu_nhiên từ \\mathcalG_t để băm toàn_bộ các điểm dữ_liệu vào Tj . Gọi_G = \\g_1 , \\ldots , g_L\\ là tập L hàm_băm đã chọn ra từ \\mathcalG_t .\nThủ_tục tìm_kiếm các điểm gần nhất sẽ như_sau : Mục_đích của biến k ở trên là để ghi_nhớ xem chúng_ta đã kiểm_tra bao_nhiêu điểm \\mathbfq .\nNếu số điểm chúng_ta kiểm_tra lớn hơn 3L thì ta sẽ dừng và coi_như không có điểm nào gần \\mathbfp cả .\nThủ_tục trên chỉ trả về một điểm \\mathbfq có khoảng_cách tới \\mathbfp không quá Cr . Ta có_thể dễ_dàng sửa_đổi thủ_tục trên để trả về số điểm hơn (nếu có) .\nTính mỗi mã_băm g_j(\\mathbfp) mất thời_gian O(T_h t) .\nDo ta có L bảng_băm , tổng thời_gian để băm toàn_bộ P vào tất_cả các bảng là g_j(\\mathbfp)L .\nDo mỗi bảng_băm có bộ_nhớ O(n) , tổng_bộ_nhớ của L bảng_băm là O(Ln) .\nMỗi lần truy_vấn , ta phải trả thời_gian O(T_ht) để tính 1 mã_băm .\nDo_đó , tổng thời_gian để tính L mã_băm là O(T_htL) .\nTrong phần này ta sẽ xác_định hai tham_số quan_trọng t , L .\nCác tham_số này có ảnh_hưởng tới tốc_độ , bộ_nhớ cũng_như độ_chính_xác của cấu_trúc .\nTừ thủ_tục , ta dễ thấy nếu thủ_tục đó trả về một điểm \\mathbfq thì khoảng_cách d(\\mathbfp , \\mathbfq) \\leq Cr . Chú_ý , mục_tiêu ban_đầu của chúng_ta tìm điểm \\mathbfq sao_cho d(\\mathbfp , \\mathbfq) \\leq r .\nDo_đó , cấu_trúc này chỉ trả về một điểm xấp_xỉ gần với \\mathbfp . Nếu_không tồn_tại điểm \\mathbfq mà d(\\mathbfp , \\mathbfq) \\leq r thì thủ_tục có_thể trả về một điểm , nhưng cũng có_thể không trả về điểm nào cả .\nĐiều này không quan_trọng vì bài_toán của chúng_ta không yêu_cầu trả về nếu_như không tồn_tại điểm \\mathbfq như_vậy .\nTuy_nhiên , nếu tồn_tại ít_nhất một điểm \\mathbfq mà d(\\mathbfp , \\mathbfq) \\leq r thì thủ_tục có trả về hay_không ?\nPhần này ta sẽ tìm_hiểu câu trả_lời cho câu_hỏi này .\nChú_ý \\alpha là tham_số ta định_nghĩa trong phương_trình (7) .\nCó hai trường_hợp thuật_toán trả về \\emptyset mặc_dù vẫn tồn_tại điểm \\mathbfq có khoảng_cách tới \\mathbfp không quá r : () điểm \\mathbfq bị băm vào ô khác với \\mathbfp trong toàn_bộ L bảng_băm và () khi ta đã kiểm_tra 3L điểm mà vẫn không tìm_ra điểm nào nằm có khoảng_cách tới \\mathbfp không quá Cr . Ta lần_lượt tính xác_suất xảy_ra một trong 2 trường_hợp : TH1 : Do \\mathcalG là một họ (r , Cr , pt_\\mathrmclose , pt_\\mathrmfar)-sensitive , với mỗi j , xác_suất để g_j(\\mathbfq) \\not= g_j(\\mathbfp) là (1 - pt_\\mathrmclose) .\nDo_đó , xác_suất để TH1 xảy_ra là : P_1 = (1 - pt_\\mathrmclose)L \\leq e- pt_\\mathrmcloseL \\qquad (9) Ở trên , ta sử_dụng bất_đẳng_thức 1 - x \\leq e-x .\nTH2 : Trường_hợp này xả ra khi ít_nhất 3L điểm bị băm vào cùng ô với \\mathbfp mà điểm nào cũng có khoảng_cách lớn hơn Cr . Do \\mathcalG là một họ (r , Cr , pt_\\mathrmclose , pt_\\mathrmfar)-sensitive , xác_suất để một điểm có khoảng_cách lớn hơn Cr bị băm vào cùng ô Tjg_j(\\mathbfp) là không quá pt_\\mathrmfar .\nDo_đó , theo tính tuyến_tính của kì_vọng , kì_vọng số điểm bị băm cùng vào một ô với \\mathbfp trong L bảng_băm là không quá nLt_\\mathrmfar .\nTheo bất , xác_suất để xảy_ra nhiều hơn 3L điểm bị băm vào cùng ô với \\mathbfp như_vậy là không quá : P_2 = \\fracnLpt_\\mathrmfar3L= \\fracnpt_\\mathrmfar3 \\qquad (10) Chọn t = \\frac\\ln(n)\\ln (1/p_\\mathrmfar) , ta có P_2 \\leq 1/3 .\nChọn_L = p-t_\\mathrmclose = e\\ln(p_\\mathrmclose))\\ln(n)/\\ln(p_\\mathrmfar)) = n\\alpha \\qquad (11) từ (9) ta suy ra P_1 \\leq e-1 .\nDo_đó , xác_suất xảy_ra một trong hai trường_hợp , theo công_thức cộng xác_suất , là không quá 1/3 + e-1 \\leq 3/4 .\nPhần còn_lại của Theorem 1 , ta chỉ việc thay các tham_số t , L vào Lemma 2 .\nChú_ý , T_h = O(d) với d là số chiều của các điểm dữ_liệu . Bây_giờ ta quay trở_lại xác_định tham_số w trong phương_trình (1) .\nTrong phần phân_tích ở trên , ta đã chỉ ra , chỉ_cần chọn w đủ lớn thì p_\\mathrmclose \\sim 1 - \\sqrt\\frac2\\pi\\frac1w và p_\\mathrmfar \\sim 1 - \\sqrt\\frac2\\pi\\fracCw . Lúc_đó , ta sẽ có : \\alpha = \\frac\\ln (1 - \\sqrt\\frac2\\pi\\frac1w)\\ln(1 - \\sqrt\\frac2\\pi\\fracCw) \\sim \\frac- \\sqrt\\frac2\\pi\\frac1w- \\sqrt\\frac2\\pi\\fracCw = \\frac1C \\qquad (11) Ở phương_trình (11) , ta sử_dụng công_thức xấp_xỉ 1 - x \\sim e-x .\nCông_thức xấp_xỉ này gần chính_xác khi x \\rightarrow 0 , có_nghĩa là khi w\\rightarrow +\\infty (coi C như một hằng số) .\nTa có : Ý_nghĩa của Lemma 3 là nếu ta chấp_nhận tỉ_lệ xấp_xỉ C càng lớn thì thời_gian và bộ_nhớ của cấu_trúc NNS càng nhỏ .\nĐiểm cuối_cùng mà mình muốn nhấn_mạnh trước_khi kết_thúc bài này đó là xác_suất 0 . 25 trong Theorem 1 có_vẻ không tốt lắm .\nThực_ra con_số 0 . 25 phát_biểu trong đó chỉ làm_cho phép chứng_minh trở_nên đơn_giản hơn mà_thôi .\nCó nhiều cách để khuếch_đại xác_suất này lên 1-\\epsilon với \\epsilon nhỏ tùy_ý (ví dụ \\epsilon = 0 . 01 thì xác_suất là 0 . 99) .\nCách đơn_giản nhất_là sửa_đổi cách chọn t và L trong chứng_minh Theorem 1 .\nChi_tiết coi_như bài_tập cho bạn_đọc (bài tập 4) .\nNếu d \\sim n thì thời_gian truy_vấn của cấu_trúc NNS_O(n1+\\alpha) .\nThời_gian này vẫn quá lớn so_với thực_tế .\nMột_cách để giảm d về O(\\log n) là sử_dụng .\nNăm 2013 , Adoni and Indyk cải_tiến cấu_trúc NNS ở trên để đạt được thời_gian truy_vấn xấp_xỉ O(dn1/C2) (đối chiếu với Lemma 3) .\nTrên trang_web của Adoni còn rất nhiều tài_liệu liên_quan để các bạn tham_khảo : . 1 P .\nIndyk and R .\nMotwani .\nProceedings of the Thirtieth_Annual_ACM_Symposium on Theory of Computing .\nACM , 1998 .\n2 J .\nMatoušek .\n.\nTechnical_Report , ETH_Zürich , 2013 .\n3 A .\nAndoni and P .\nIndyk .\nThe 47th Annual_IEEE_Symposium on . Foundations of Computer_Science (FOCS06) , 2006 .\nChứng_minh Fact 1 .\nGợi_ý : không mất tính tổng_quát , giả_sử b \\geq a .\nViết b + U = a + (b-a) + U rồi xét các trường_hợp b-a \\geq 1 và b-a < 1 .\nChứng_minh rằng \\mathrmPrt \\geq w/s = o(1/w) khi t \\sim \\mathcalN(0 , 1) , giả_sử w rất lớn và s là một hằng_số .\nGợi_ý : sử_dụng bất_đẳng_thức ex \\geq x2/2 , ta có : \\mathrmPrt \\geq w/s = \\int_w/s+\\infty e-t2 dt \\leq \\int_w/s+\\infty 2t-4 dt Sử_dụng ý_tưởng trong lời_giải bài_tập 2 , chứng_minh các bất_đẳng_thức đã sử_dụng trong chứng_minh Lemma 1 sau_đây : Trong_Theorem 1 , ta đã chứng_minh xác_suất thuật_toán tìm được một điểm \\mathbfq có khoảng_cách tới \\mathbfp là 0 . 25 .\nChứng_minh rằng xác_suất này là 1-\\epsilon nếu ta chọn t = \\frac\\ln(n)\\ln (1/p_\\mathrmfar)\\epsilon và L = n\\alpha\\ln(\\frac1\\epsilon) .\nSử_dụng bất_đẳng_thức Chernoff để giảm sự phụ_thuộc của t vào \\epsilon xuống còn O(\\frac\\ln(n)\\ln (1/p_\\mathrmfar)\\ln(\\frac1\\epsilon) .\n, , , , Trackback link : Powered by and\n", "tagged": "Nơi/N tổng_hợp/V và/Cc chia_sẻ/V những/L kiến_thức/N liên_quan/V tới/E giải_thuật/Np nói_chung/X và/Cc lý_thuyết/Np khoa_học/N máy_tính/N nói_riêng/X ./CH\nin/V Một/M trong/E số/N những/L bài_toán/N cơ_bản/A có/V rất/R nhiều/A ứng_dụng/V trong/E khoa_học/N máy_tính/N là/V bài_toán/N tìm/V điểm/N gần/A nhất/A ./CH\nTrong/E bài/N này/P ta/P chỉ/R xét/V hàm/Np khoảng_cách/N d(/Np ./CH ,/CH ./CH )/CH là/V ./CH\nCách/N đơn_giản/A nhất/A để/E thiết_kế/V cấu_trúc/N dữ_liệu/N như_vậy/X là/V ta/P sẽ/R tính/V khoảng_cách/N giữa/N mọi/L cặp/N điểm/N ,/CH và/Cc sau_đó/Np lưu/V vào/E một/M mảng/N hai/M nhiều/A (ma/Np trận)/Np D\\ldots/Np ,/CH \\ldots/Np ./CH\nMỗi/L khi/N ta/P nhận/V được/V điểm/N truy_vấn/Np \\mathbfp/Np ,/CH ta/P chỉ/R việc/N duyệt/V qua/V tất_cả/P các/L điểm/N khác/A và/Cc đưa_ra/Np các/L điểm/N có/V khoảng_cách/N không/R quá/R r/Np từ/E \\mathbfp/Np ./CH\nDễ/A thấy/V :/CH Một_số/L cấu_trúc/N dữ_liệu/N như/C có_thể/R sử_dụng/V khi/N số/N chiều/N d/Ny nhỏ/A (thường/Np là/V 2/M hoặc/Cc 3/M chiều)/Np ./CH\nTa/P có_thể/R xây_dựng/V các/L cấu_trúc/N này/P trong/E thời_gian/N O(n\\log/Np n)/Np và/Cc truy_vấn/Np có_thể/R được/V trả_lời/V trong/E thời_gian/N O(\\log/Np n)/Np ./CH\nTuy_nhiên/C ,/CH sự/N phụ_thuộc/V của/E hằng_số/Np ẩn/V sau/E O(/Np ./CH )/CH trong/E các/L cấu_trúc/N này/P là/V lũy_thừa/Np theo/V số/N chiều/N d/Ny (còn/Np gọi_là/V hiện_tượng/N the/B curse/Np of/E dimensionality)/Np ,/CH do_đó/C ,/CH nó/P không/R phù_hợp/V ngay_cả/Np khi/N d/Ny không/R quá/R lớn/A (d/Np =/CH 20/M chẳng/R hạn)/Np ./CH\nTrong/E thời_đại/N big/Np data/Np hiện_nay/N ,/CH ta/P thường/R phải/V tìm/V điểm/N gần/A nhất/A khi/N P/Ny có/V tới/E hàng_triệu/Np điểm/N và/Cc các/L điểm/N có_số/Np chiều/N cũng/R lên/V tới/E hàng_triệu/Np (d/Np \\sim/Np n/Ny \\geq/Np 106)/Np ./CH\n(Ví/Np dụ/V thuật_toán/N trong/E học/V máy/N (machine/Np learning)/Np là/V một/M biến_thể/N của/E bài_toán/N tìm/V điểm/N gần/A nhất/A trên/E ./CH )/CH Do_đó/C ,/CH bài_toán/N trên/E trở_nên/V vô_cùng/R khó/A ./CH\nCấu_trúc/N dữ_liệu/N bảng/N ở/E trên/E chỉ_có/Np thể/N làm_việc/V khi/N ,/CH còn/R các/L cấu_trúc/N như/C k-d/Np tree/Np thì/C hoàn_toàn/A vô_dụng/Np ./CH\nLocality_Sensitive_Hashing/Np (LSH)/Np là/V một/M kĩ_thuật/N xấp_xỉ/A dùng/V để/E giải_quyết/V tìm/V điểm/N gần/A nhất/A một_cách/N hiệu_quả/N khi/N n/Ny và/Cc d/Ny đều/R vô_cùng/R lớn/A ./CH\nKhái_niệm/N này/P được/V giới_thiệu/V bởi/E Indyk/Np và/Cc Motwani/Np 1/M ./CH\nTrình_bày/V trong/E bài/N này/P phỏng/Np theo/V note/Np của/E Matoušek/Np 2/M ./CH\nÝ_tưởng/N của/E LSH/Np là/V sử_dụng/V một/M hàm_băm/Np h(/Np ./CH )/CH để/E băm/Np các/L điểm/N dữ_liệu/N trong/E P/Ny vào/E một/M bảng/N T/Nu ./CH\nsao_cho/Np nếu/C hai/M điểm/N \\mathbfp/Np ,/CH \\mathbfq/Np gần/A nhau/N thì/C khả_năng/N cao/A \\mathbfp/Np ,/CH \\mathbfq/Np sẽ/R được/V băm/Np vào/E cùng/A một/M ô/N ./CH\nNgược_lại/X ,/CH \\mathbfp/Np và/Cc \\mathbfq/Np sẽ/R bị/V băm/Np vào/E hai/M ô/N khác_nhau/Np ./CH\nKhi/N trả_lời/V truy_vấn/Np ,/CH ta/P chỉ/R việc/N tính/V mã_băm/Np h(\\mathbfp)/Np và/Cc đưa_ra/Np tất_cả/P các/L điểm/N lưu/V trong/E ô/N Th(\\mathbfp)/Np ./CH\nHàm_băm/Np h(/Np ./CH )/CH như_vậy/X đưcọ/Np gọi_là/V kiểu/N locality/Np sensitive/Np ./CH\n:/CH Minh_họa/V một/M hàm_băm/Np locality/Np sensitive/Np ./CH Trong/E định_nghĩa/N trên/E ,/CH ta/P mong_muốn/V p_\\mathrmfar/Np gần/A 0/M còn/R p_\\mathrmclose/Np gần/A với/E 1/M vì/E như_vậy/X ,/CH xác_suất/N hai/M điểm/N gần/A nhau/N được/V băm/Np vào/E cùng/A một/M ô/N lớn/A ,/CH còn/R xác_suất/N hai/M điểm/N xa/A nhau/N bị/V băm/Np vào/E cùng/A một/M ô/N sẽ/R nhỏ/A ./CH\nTheo/V định_nghĩa/N trên/E ,/CH với/E các/L điểm/N mà/C khoảng_cách/N trong_khoảng/Np r/Np \\leq/Np d(\\mathbfp/Np ,/CH \\mathbfq)/Np \\leq/Np Cr/Np thì/C ta/P không/R quan_tâm/V đến/E chúng/P sẽ/R bị/V băm/Np vào/E một/M ô_hay/Np không/R ./CH\nNếu/C ta/P chọn/V hằng_số/Np C/Ni càng/R gần/A 1/M thì/C số/N các/L điểm/N như_vậy/X càng/R nhỏ/A ,/CH phương_pháp/N của/E chúng_ta/P cần/V chính_xác/A ./CH\nTuy_nhiên/C ,/CH bạn/N sẽ/R thấy/V dưới_đây/Np ,/CH thời_gian/N và/Cc bộ_nhớ/Np của/E cấu_trúc/N sẽ/R phụ_thuộc/V vào/E C/Ni ,/CH theo/V nghĩa/N ,/CH chúng_ta/P càng/R muốn/V độ_chính_xác/Np cao/A thì/C ta/P càng/R phải/V trả/V nhiều/A thời_gian/N và/Cc bộ_nhớ/Np ./CH\nTheo/V định_nghĩa/N trên/E không/R chỉ/R áp_dụng/V đối_với/E không_gian/N Euclidean/Np mà/C với/E mọi/L không_gian/N metric/Np ./CH\nTrong/E phạm_vi/N của/E bài/N này/P ,/CH ta/P chỉ/R quan_tâm/V đến/E không_gian/N Euclidean/Np ./CH Để/E bài_toán/N trở_nên/V đơn_giản/A ,/CH ta/P sẽ/R giả_sử/Np r/Np =/CH 1/M bằng/E cách/N nhân/N tập/V các/L vector/Np (hay/Np điểm)/Np trong/E P/Ny với/E 1/M ./CH\nNhư_vậy/X ta/P đã/R tiết_kiệm/V được/V một/M tham_số/Np ./CH\nGọi/V \\mathbfZ/Np =/CH (Z_1/Np ,/CH Z_2/Np ,/CH \\ldots/Np ,/CH Z_d)/Np \\in/Np \\mathbbRd/Np là/V một/M vector/Np ngẫu_nhiên/A ,/CH trong/E đó/P mỗi/L Z_i/Np \\sim/Np \\mathcalN(0/Np ,/CH 1)/Np là/V một/M biến/V ngẫu_nhiên/A có/V phân_phối/V chuẩn/N ()/Np ./CH\nGọi_U/Np là/V một_số/L ngẫu_nhiên/A trong/E đoạn/Nc 0/M ,/CH 1);/Np U/N được/V chọn/V đồng_đều/N (uniformly)/Np ,/CH và/Cc w/Nu là/V một/M tham_số/Np thực/A mà/C ta/P sẽ/R định_nghĩa/N sau/E ./CH\nĐịnh_nghĩa/N họ/P các/L hàm_băm/Np \\mathcalH_\\mathrmGauss/Np như_sau/Np :/CH h(\\mathbfx)/Np =/CH \\lfloor/Np \\frac\\langle/Np \\mathbfZ/Np ,/CH \\mathbfx/Np \\ranglew/Np +/CH U/N \\rfloor/Np \\qquad(1)/Np Ta/P sẽ/R chứng_minh/V xác_suất/N \\mathbfx/Np và/Cc \\mathbfy/Np bị/V băm/Np vào/E cùng/A một/M ô/N xấp_xỉ/A tỉ_lệ_thuận/A với/E khoảng_cách/N giữa/N hai/M điểm/N \\mathbfx/Np và/Cc \\mathbfy/Np ./CH\n\\mathrmPrh(\\mathbfx)/Np \\not=/Np h(\\mathbfy)/Np =/CH \\sqrt\\frac2\\pi\\fracd(\\mathbfx/Np ,/CH \\mathbfy)w/Np +/CH o(\\frac1w)/Np \\qquad(2)/Np Trước_khi/Np đi_vào/Np chi_tiết/N chứng_minh/V ,/CH ta/P xét/V ý_nghĩa/N của/E Lemma/Np 1/M ./CH\nDo/E w/Nu là/V tham_số/Np ta/P có_thể/R tùy_chọn/Np ,/CH ta/P sẽ/R chọn/V w/Nu đủ/A lớn/A ./CH\nKhi/N đó/P phần/N o(\\frac1w))/Np trong/E phương_trình/Np (2)/Np sẽ/R đóng_góp/V không_đáng_kể/Np và/Cc xác_suất/N \\mathrmPrh(\\mathbfx)/Np \\not=/Np h(\\mathbfy)/Np ./CH\nDo_đó/C ,/CH ta/P có_thể/R coi/V xác_suất/N này/P là/V tỉ_lệ_thuận/A với/E khoảng_cách/N giữa/N hai/M điểm/N \\mathbfx/Np và/Cc \\mathbfy/Np ./CH\nĐiều/N đó/P có_nghĩa/A là/V \\mathbfx/Np và/Cc \\mathbfy/Np càng/R gần/A nhau/N thì/C xác_suất/N chúng/P được/V băm/Np vào/E cùng/A một/M ô/N càng/R lớn/A ./CH\nĐây/P chính/T là/V điều/N mà/C chúng_ta/P cần/V ./CH\nChú_ý/V ,/CH trong/E phần/N này/P ta/P đang/R giả_sử/Np r/Np =/CH 1/M ./CH\nTừ/E (2)/Np ta/P suy/V ra/V ,/CH họ/P hàm_băm/Np \\mathcalH/Np định_nghĩa/N như/C trong/E phương_trình/Np (1)/Np là/V một/M họ/P (r/Np ,/CH Cr/Np ,/CH p_\\mathrmclose/Np ,/CH p_\\mathrmfar)-sensitive/Np với/E p_\\mathrmclose/Np =/CH 1/M -/CH \\sqrt\\frac2\\pi\\frac1w/Np +/CH o(\\frac1w)/Np và/Cc p_\\mathrmfar/Np =/CH 1/M -/CH \\sqrt\\frac2\\pi\\fracCw/Np +/CH o(\\frac1w)/Np ./CH\nĐể/E chứng_minh/V Lemma/Np 1/M ,/CH ta/P cần/V sử_dụng/V hai/M tính_chất/N sau_đây/Np :/CH \\mathrmPr\\lfloor/Np a/Ni +/CH U/N \\rfloor/Np \\not=/Np \\lfloor/Np b/Ni +/CH U/N \\rfloor/Np =/CH \\min(1/Np ,/CH a-b)/Np \\qquad(3)/Np Z/Y \\sim/Np \\mathcalN(0/Np ,/CH a2+b2)/Np \\qquad/Np (4)/Np Gọi/V s/Y =/CH d(\\mathbfx/Np ,/CH \\mathbfy)/Np là/V khoảng_cách/N giữa/N hai/M điểm/N \\mathbfx/Np và/Cc \\mathbfy/Np và/Cc p(s)/Np là/V xác_suất/N \\mathbfx/Np và/Cc \\mathbfy/Np bị/V băm/Np vào/E cùng/A một/M ô/N ./CH\nTheo_Fact/Np 1/M ,/CH ta/P có/V :/CH \\mathrmPrh(\\mathbfx)/Np \\not=/Np h(\\mathbfy)/Np \\mathbfZ/Np =/CH \\min(1/Np ,/CH \\frac\\langle/Np \\mathbfZ/Np ,/CH \\mathbfx/Np -/CH \\mathbfy/Np \\ranglew)/Np \\qquad(5)/Np Theo_Fact/Np 2/M ,/CH X/CH =/CH \\langle/Np \\mathbfZ/Np ,/CH \\mathbfx/Np -/CH \\mathbfy/Np \\rangle/Np là/V một/M phân_phối/V chuẩn/N có/V mean/Np 0/M và/Cc độ_lệch/Np tiêu_chuẩn/N d2(\\mathbfx/Np ,/CH \\mathbfy)/Np =/CH s2/Np ./CH\nDo_đó/C ,/CH t/Nu =/CH X/CH phân_bố/V theo/V \\mathcalN(0/Np ,/CH 1)/Np ./CH\nTừ_đó/Np suy/V ra/V :/CH \\beginarray/Np l/Ny p(s)/Np =/CH \\frac1\\sqrt2\\pi/Np \\int_-\\infty+\\infty/Np \\min(1/Np ,/CH \\fracswt)/Np e-t2/Np dt/Np \\\\/Np =/CH \\mathrmPrt\\geq/Np \\fracws/Np +/CH \\fracsw/Np \\int_-w/sw/Np e-t2/Np dt/Np \\\\/Np =/CH \\mathrmPrt\\geq/Np \\fracws/Np +/CH \\fracsw/Np Et/Np +/CH \\frac2\\sqrt2\\pi/Np \\fracsw\\int_w/Np te-t2/Np \\endarray/Np \\qquad/Np (6)/Np Trong/E các/L bài_tập/Np dưới_đây/Np ,/CH mình/P sẽ/R hướng_dẫn/V các/L bạn/N chứng_minh/V các/L tính_chất/N sau/E :/CH Do_đó/C ,/CH từ/E (6)/Np ,/CH ta/P suy/V ra/V dpcm/Np ./CH Có/V mấy/L vấn_đề/N mà/C chúng_ta/P chưa/R nói_rõ/Np phần/N trước/E về/E họ/P hàm_băm/Np \\mathcalH/Np trong/E (1)/Np ./CH\nThứ/N nhất/A ta/P mới/R chỉ/R nói/V chọn/V w/Nu đủ/A lớn/A ,/CH nhưng/C chưa/R nói/V chọn/V w/Nu lớn/A bao_nhiêu/P là/V vừa/R ./CH\nThứ_hai/N ,/CH đầu_ra/N của/E hàm_băm/Np trong/E (1)/Np là/V toàn_bộ/L không_gian/N \\mathbbZ/Np ,/CH mà/C để/E thực_hiện/V được/V trên/E máy_tính/N ,/CH đầu_ra/N phải/V hữu_hạn/Np (và/Np phải/V không/R quá/R lớn/A so_với/Np n/Ny để/E cấu_trúc/N của/E chúng_ta/P trở_nên/V hiệu/N quả)/Np ./CH\nCả/P hai/M vấn_đề/N sẽ/R được/V làm/V rõ/A trong/E phần/N này/P ./CH Trước_hết/N ,/CH ta/P giả_sử/Np đã/R có_sẵn/Np một/M họ/P (r/Np ,/CH Cr/Np ,/CH p_\\mathrmclose/Np ,/CH p_\\mathrmfar)-sensitive/Np \\mathcalH/Np ./CH\nGọi/V :/CH \\alpha/Np =/CH \\frac\\ln/Np p_\\mathrmclose/Np \\ln/Np p_\\mathrmfar/Np \\qquad/Np (7)/Np Theo/V định_nghĩa/N của/E \\mathcalH/Np ,/CH ta/P chỉ/R biết/V rằng/C p_\\mathrmclose/Np -/CH p_\\mathrmfar/Np >/CH 0/M ,/CH chứ/C ta/P chưa/R biết/V sự/N khác_biệt/A này/P lớn/A bao_nhiêu/P ./CH\nĐầu_tiên_ta/Np sẽ/R khuếch_đại/Np (amplify)/Np khoảng_cách/N này/P bằng/E cách/N ghép/V nhiều/A hàm_băm/Np trong/E họ/P \\mathcalH/Np lại/R với_nhau/Np ./CH Gọi/V t/Nu là/V một_số/L nguyên/A mà/C ta/P sẽ/R xác_định/V sau/E ./CH\nTa/P định_nghĩa/N một/M họ/P hàm_băm/Np mới/R \\mathcalG_t/Np trong/E đó/P mỗi/L hàm_băm/Np g/Nu \\in/Np \\mathcalG_t/Np là/V ghép/V của/E t/Nu hàm_băm/Np độc_lập/A trong/E \\mathcalH/Np ./CH\nMột_cách/N hình_thức/N :/CH \\mathcalG_t/Np =/CH \\/Np g=/Np (h_1/Np ,/CH h_2/Np ,/CH \\ldots/Np ,/CH h_t)/Np :/CH h_1/Np ,/CH h_2/Np ,/CH \\ldots/Np ,/CH h_t/Np \\in/Np \\mathcalH/Np \\/Np \\qquad/Np (8)/Np Dễ/A thấy/V ,/CH g(\\mathbfx)/Np =/CH g(\\mathbfy)/Np khi/N và/Cc chỉ/R khi/N h_i(\\mathbfx)/Np =/CH h_i(\\mathbfy)/Np với/E mọi/L i/M ,/CH 1\\leq/Np i/M \\leq/Np t/Nu ./CH\nDo_đó/C ,/CH \\mathcalG_t/Np là/V một/M họ/P (r/Np ,/CH Cr/Np ,/CH pt_\\mathrmclose/Np ,/CH pt_\\mathrmfar)-sensitive/Np ./CH\nĐầu_ra/N của/E mỗi/L hàm_băm/Np g(/Np ./CH )/CH trong/E \\mathcalG_t/Np là/V một/M bộ/N t/Nu số_nguyên/Np (t-tuple)/Np chứ/C không_phải/Np là/V một_số/L ./CH\nTa/P có_thể/R sử_dụng/V thêm/V một/M hàm_băm/Np nữa/R để/E băm/Np đầu_ra/N của/E g(/Np ./CH )/CH về/E các/L số_nguyên/Np trong_khoảng/Np 0/M ,/CH O(n)/Np ,/CH phục_vụ/V cho/E mục_đích/N tìm_kiếm/V ./CH\nThiết_kế/V hàm_băm/Np đó/P như_thế/X nào/P thì/C bạn_đọc/N có_thể/R xem/V trong/E bài/N bảng_băm/Np mình/P ./CH\nMặc_dù/C băm/Np thêm/V một_lần/Np nữa/R có_thể/R vẫn/R xảy_ra/Np đụng_độ/V ,/CH để/E phân_tích/V dưới_đây/Np được/V đơn_giản/A ,/CH ta/P sẽ/R giả_sử/Np không/R xảy_ra/Np đụng_độ/V trong/E lần/N băm/Np cuối_cùng/A ./CH\nDo_đó/C ,/CH ta/P có_thể/R coi/V g(/Np ./CH )/CH như_là/V một/M hàm_băm/Np để/E băm/Np vào/E bảng/N lưu_trữ/Np ./CH Tiếp_theo/V ,/CH ta/P xây_dựng/V L/Ny bảng_băm/Np T1/M ,/CH T2/Ny ,/CH \\ldots/Np TL/N trong/E đó/P mỗi/L bằng/E băm/Np Tj/Np ta/P sử_dụng/V hàm_băm/Np g_j/Np chọn/V ngẫu_nhiên/A từ/E \\mathcalG_t/Np để/E băm/Np toàn_bộ/L các/L điểm/N dữ_liệu/N vào/E Tj/Np ./CH Gọi_G/Np =/CH \\g_1/Np ,/CH \\ldots/Np ,/CH g_L\\/Np là/V tập/V L/Ny hàm_băm/Np đã/R chọn/V ra/V từ/E \\mathcalG_t/Np ./CH\nThủ_tục/N tìm_kiếm/V các/L điểm/N gần/A nhất/A sẽ/R như_sau/Np :/CH Mục_đích/N của/E biến/V k/N ở/E trên/E là/V để/E ghi_nhớ/V xem/V chúng_ta/P đã/R kiểm_tra/V bao_nhiêu/P điểm/N \\mathbfq/Np ./CH\nNếu/C số/N điểm/N chúng_ta/P kiểm_tra/V lớn/A hơn/A 3L/Np thì/C ta/P sẽ/R dừng/V và/Cc coi_như/Np không/R có/V điểm/N nào/P gần/A \\mathbfp/Np cả/P ./CH\nThủ_tục/N trên/E chỉ/R trả/V về/E một/M điểm/N \\mathbfq/Np có/V khoảng_cách/N tới/E \\mathbfp/Np không/R quá/R Cr/Np ./CH Ta/P có_thể/R dễ_dàng/A sửa_đổi/V thủ_tục/N trên/E để/E trả/V về/E số/N điểm/N hơn/A (nếu/Np có)/Np ./CH\nTính/V mỗi/L mã_băm/Np g_j(\\mathbfp)/Np mất/V thời_gian/N O(T_h/Np t)/Np ./CH\nDo/E ta/P có/V L/Ny bảng_băm/Np ,/CH tổng/N thời_gian/N để/E băm/Np toàn_bộ/L P/Ny vào/E tất_cả/P các/L bảng/N là/V g_j(\\mathbfp)L/Np ./CH\nDo/E mỗi/L bảng_băm/Np có/V bộ_nhớ/Np O(n)/Np ,/CH tổng_bộ_nhớ/Np của/E L/Ny bảng_băm/Np là/V O(Ln)/Np ./CH\nMỗi/L lần/N truy_vấn/Np ,/CH ta/P phải/V trả/V thời_gian/N O(T_ht)/Np để/E tính/V 1/M mã_băm/Np ./CH\nDo_đó/C ,/CH tổng/N thời_gian/N để/E tính/V L/Ny mã_băm/Np là/V O(T_htL)/Np ./CH\nTrong/E phần/N này/P ta/P sẽ/R xác_định/V hai/M tham_số/Np quan_trọng/A t/Nu ,/CH L/Ny ./CH\nCác/L tham_số/Np này/P có/V ảnh_hưởng/V tới/E tốc_độ/N ,/CH bộ_nhớ/Np cũng_như/C độ_chính_xác/Np của/E cấu_trúc/N ./CH\nTừ/E thủ_tục/N ,/CH ta/P dễ/A thấy/V nếu/C thủ_tục/N đó/P trả/V về/E một/M điểm/N \\mathbfq/Np thì/C khoảng_cách/N d(\\mathbfp/Np ,/CH \\mathbfq)/Np \\leq/Np Cr/Np ./CH Chú_ý/V ,/CH mục_tiêu/N ban_đầu/N của/E chúng_ta/P tìm/V điểm/N \\mathbfq/Np sao_cho/Np d(\\mathbfp/Np ,/CH \\mathbfq)/Np \\leq/Np r/Np ./CH\nDo_đó/C ,/CH cấu_trúc/N này/P chỉ/R trả/V về/E một/M điểm/N xấp_xỉ/A gần/A với/E \\mathbfp/Np ./CH Nếu_không/Np tồn_tại/V điểm/N \\mathbfq/Np mà/C d(\\mathbfp/Np ,/CH \\mathbfq)/Np \\leq/Np r/Np thì/C thủ_tục/N có_thể/R trả/V về/E một/M điểm/N ,/CH nhưng/C cũng/R có_thể/R không/R trả/V về/E điểm/N nào/P cả/P ./CH\nĐiều/N này/P không/R quan_trọng/A vì/E bài_toán/N của/E chúng_ta/P không/R yêu_cầu/V trả/V về/E nếu_như/C không/R tồn_tại/V điểm/N \\mathbfq/Np như_vậy/X ./CH\nTuy_nhiên/C ,/CH nếu/C tồn_tại/V ít_nhất/A một/M điểm/N \\mathbfq/Np mà/C d(\\mathbfp/Np ,/CH \\mathbfq)/Np \\leq/Np r/Np thì/C thủ_tục/N có/V trả/V về/E hay_không/Np ?/CH\nPhần/N này/P ta/P sẽ/R tìm_hiểu/V câu/N trả_lời/V cho/E câu_hỏi/N này/P ./CH\nChú_ý/V \\alpha/Np là/V tham_số/Np ta/P định_nghĩa/N trong/E phương_trình/Np (7)/Np ./CH\nCó/V hai/M trường_hợp/N thuật_toán/N trả/V về/E \\emptyset/Np mặc_dù/C vẫn/R tồn_tại/V điểm/N \\mathbfq/Np có/V khoảng_cách/N tới/E \\mathbfp/Np không/R quá/R r/Np :/CH ()/Np điểm/N \\mathbfq/Np bị/V băm/Np vào/E ô/N khác/A với/E \\mathbfp/Np trong/E toàn_bộ/L L/Ny bảng_băm/Np và/Cc ()/Np khi/N ta/P đã/R kiểm_tra/V 3L/Np điểm/N mà/C vẫn/R không/R tìm_ra/Np điểm/N nào/P nằm/V có/V khoảng_cách/N tới/E \\mathbfp/Np không/R quá/R Cr/Np ./CH Ta/P lần_lượt/R tính/V xác_suất/N xảy_ra/Np một/M trong/E 2/M trường_hợp/N :/CH TH1/Np :/CH Do/E \\mathcalG/Np là/V một/M họ/P (r/Np ,/CH Cr/Np ,/CH pt_\\mathrmclose/Np ,/CH pt_\\mathrmfar)-sensitive/Np ,/CH với/E mỗi/L j/Np ,/CH xác_suất/N để/E g_j(\\mathbfq)/Np \\not=/Np g_j(\\mathbfp)/Np là/V (1/Np -/CH pt_\\mathrmclose)/Np ./CH\nDo_đó/C ,/CH xác_suất/N để/E TH1/Np xảy_ra/Np là/V :/CH P_1/Np =/CH (1/Np -/CH pt_\\mathrmclose)L/Np \\leq/Np e-/Np pt_\\mathrmcloseL/Np \\qquad/Np (9)/Np Ở/E trên/E ,/CH ta/P sử_dụng/V bất_đẳng_thức/Np 1/M -/CH x/CH \\leq/Np e-x/Np ./CH\nTH2/Np :/CH Trường_hợp/N này/P xả/V ra/V khi/N ít_nhất/A 3L/Np điểm/N bị/V băm/Np vào/E cùng/A ô/N với/E \\mathbfp/Np mà/C điểm/N nào/P cũng/R có/V khoảng_cách/N lớn/A hơn/A Cr/Np ./CH Do/E \\mathcalG/Np là/V một/M họ/P (r/Np ,/CH Cr/Np ,/CH pt_\\mathrmclose/Np ,/CH pt_\\mathrmfar)-sensitive/Np ,/CH xác_suất/N để/E một/M điểm/N có/V khoảng_cách/N lớn/A hơn/A Cr/Np bị/V băm/Np vào/E cùng/A ô/N Tjg_j(\\mathbfp)/Np là/V không/R quá/R pt_\\mathrmfar/Np ./CH\nDo_đó/C ,/CH theo/V tính/V tuyến_tính/Np của/E kì_vọng/V ,/CH kì_vọng/V số/N điểm/N bị/V băm/Np cùng/A vào/E một/M ô/N với/E \\mathbfp/Np trong/E L/Ny bảng_băm/Np là/V không/R quá/R nLt_\\mathrmfar/Np ./CH\nTheo/V bất/Z ,/CH xác_suất/N để/E xảy_ra/Np nhiều/A hơn/A 3L/Np điểm/N bị/V băm/Np vào/E cùng/A ô/N với/E \\mathbfp/Np như_vậy/X là/V không/R quá/R :/CH P_2/Np =/CH \\fracnLpt_\\mathrmfar3L=/Np \\fracnpt_\\mathrmfar3/Np \\qquad/Np (10)/Np Chọn/V t/Nu =/CH \\frac\\ln(n)\\ln/Np (1/Np ,/CH ta/P có/V P_2/Np \\leq/Np 1/M ./CH\nChọn_L/Np =/CH p-t_\\mathrmclose/Np =/CH e\\ln(p_\\mathrmclose))\\ln(n)/Np =/CH n\\alpha/Np \\qquad/Np (11)/Np từ/E (9)/Np ta/P suy/V ra/V P_1/Np \\leq/Np e-1/Np ./CH\nDo_đó/C ,/CH xác_suất/N xảy_ra/Np một/M trong/E hai/M trường_hợp/N ,/CH theo/V công_thức/N cộng/V xác_suất/N ,/CH là/V không/R quá/R 1/M +/CH e-1/Np \\leq/Np 3/M ./CH\nPhần/N còn_lại/Np của/E Theorem/Np 1/M ,/CH ta/P chỉ/R việc/N thay/V các/L tham_số/Np t/Nu ,/CH L/Ny vào/E Lemma/Np 2/M ./CH\nChú_ý/V ,/CH T_h/Np =/CH O(d)/Np với/E d/Ny là/V số/N chiều/N của/E các/L điểm/N dữ_liệu/N ./CH Bây_giờ/P ta/P quay/V trở_lại/V xác_định/V tham_số/Np w/Nu trong/E phương_trình/Np (1)/Np ./CH\nTrong/E phần/N phân_tích/V ở/E trên/E ,/CH ta/P đã/R chỉ/R ra/V ,/CH chỉ_cần/Np chọn/V w/Nu đủ/A lớn/A thì/C p_\\mathrmclose/Np \\sim/Np 1/M -/CH \\sqrt\\frac2\\pi\\frac1w/Np và/Cc p_\\mathrmfar/Np \\sim/Np 1/M -/CH \\sqrt\\frac2\\pi\\fracCw/Np ./CH Lúc_đó/Np ,/CH ta/P sẽ/R có/V :/CH \\alpha/Np =/CH \\frac\\ln/Np (1/Np -/CH \\sqrt\\frac2\\pi\\frac1w)\\ln(1/Np -/CH \\sqrt\\frac2\\pi\\fracCw)/Np \\sim/Np \\frac-/Np \\sqrt\\frac2\\pi\\frac1w-/Np \\sqrt\\frac2\\pi\\fracCw/Np =/CH \\frac1C/Np \\qquad/Np (11)/Np Ở/E phương_trình/Np (11)/Np ,/CH ta/P sử_dụng/V công_thức/N xấp_xỉ/A 1/M -/CH x/CH \\sim/Np e-x/Np ./CH\nCông_thức/N xấp_xỉ/A này/P gần/A chính_xác/A khi/N x/CH \\rightarrow/Np 0/M ,/CH có_nghĩa/A là/V khi/N w\\rightarrow/Np +\\infty/Np (coi/Np C/Ni như/C một/M hằng/R số)/Np ./CH\nTa/P có/V :/CH Ý_nghĩa/N của/E Lemma/Np 3/M là/V nếu/C ta/P chấp_nhận/V tỉ_lệ/N xấp_xỉ/A C/Ni càng/R lớn/A thì/C thời_gian/N và/Cc bộ_nhớ/Np của/E cấu_trúc/N NNS/Np càng/R nhỏ/A ./CH\nĐiểm/N cuối_cùng/A mà/C mình/P muốn/V nhấn_mạnh/V trước_khi/Np kết_thúc/V bài/N này/P đó/P là/V xác_suất/N 0/M ./CH 25/M trong/E Theorem/Np 1/M có_vẻ/X không/R tốt/A lắm/R ./CH\nThực_ra/X con_số/N 0/M ./CH 25/M phát_biểu/V trong/E đó/P chỉ/R làm_cho/Np phép/N chứng_minh/V trở_nên/V đơn_giản/A hơn/A mà_thôi/T ./CH\nCó/V nhiều/A cách/N để/E khuếch_đại/Np xác_suất/N này/P lên/V 1-\\epsilon/Np với/E \\epsilon/Np nhỏ/A tùy_ý/V (ví/Np dụ/V \\epsilon/Np =/CH 0/M ./CH 01/M thì/C xác_suất/N là/V 0/M ./CH 99)/Np ./CH\nCách/N đơn_giản/A nhất_là/X sửa_đổi/V cách/N chọn/V t/Nu và/Cc L/Ny trong/E chứng_minh/V Theorem/Np 1/M ./CH\nChi_tiết/N coi_như/Np bài_tập/Np cho/E bạn_đọc/N (bài/Np tập/V 4)/Np ./CH\nNếu/C d/Ny \\sim/Np n/Ny thì/C thời_gian/N truy_vấn/Np của/E cấu_trúc/N NNS_O(n1+\\alpha)/Np ./CH\nThời_gian/N này/P vẫn/R quá/R lớn/A so_với/Np thực_tế/N ./CH\nMột_cách/N để/E giảm/V d/Ny về/E O(\\log/Np n)/Np là/V sử_dụng/V ./CH\nNăm/N 2013/M ,/CH Adoni/Np and/Np Indyk/Np cải_tiến/V cấu_trúc/N NNS/Np ở/E trên/E để/E đạt/V được/V thời_gian/N truy_vấn/Np xấp_xỉ/A O(dn1/Np (đối/Np chiếu/N với/E Lemma/Np 3)/Np ./CH\nTrên/E trang_web/N của/E Adoni/Np còn/R rất/R nhiều/A tài_liệu/N liên_quan/V để/E các/L bạn/N tham_khảo/V :/CH ./CH 1/M P/Ny ./CH\nIndyk/Np and/Np R/Np ./CH\nMotwani/Np ./CH\nProceedings/Np of/E the/B Thirtieth_Annual_ACM_Symposium/Np on/Np Theory/Np of/E Computing/Np ./CH\nACM/Np ,/CH 1998/M ./CH\n2/M J/Np ./CH\nMatoušek/Np ./CH\n./CH\nTechnical_Report/Np ,/CH ETH_Zürich/Np ,/CH 2013/M ./CH\n3/M A/Ni ./CH\nAndoni/Np and/Np P/Ny ./CH\nIndyk/Np ./CH\nThe/B 47th/Np Annual_IEEE_Symposium/Np on/Np ./CH Foundations/Np of/E Computer_Science/Np (FOCS06)/Np ,/CH 2006/M ./CH\nChứng_minh/V Fact/Np 1/M ./CH\nGợi_ý/V :/CH không/R mất/V tính/V tổng_quát/Np ,/CH giả_sử/Np b/Ni \\geq/Np a/Ni ./CH\nViết/V b/Ni +/CH U/N =/CH a/Ni +/CH (b-a)/Np +/CH U/N rồi/C xét/V các/L trường_hợp/N b-a/Np \\geq/Np 1/M và/Cc b-a/Np </Np 1/M ./CH\nChứng_minh/V rằng/C \\mathrmPrt/Np \\geq/Np w/Nu =/CH o(1/Np khi/N t/Nu \\sim/Np \\mathcalN(0/Np ,/CH 1)/Np ,/CH giả_sử/Np w/Nu rất/R lớn/A và/Cc s/Y là/V một/M hằng_số/Np ./CH\nGợi_ý/V :/CH sử_dụng/V bất_đẳng_thức/Np ex/Np \\geq/Np x2/Np ,/CH ta/P có/V :/CH \\mathrmPrt/Np \\geq/Np w/Nu =/CH \\int_w/Np e-t2/Np dt/Np \\leq/Np \\int_w/Np 2t-4/Np dt/Np Sử_dụng/V ý_tưởng/N trong/E lời_giải/Np bài_tập/Np 2/M ,/CH chứng_minh/V các/L bất_đẳng_thức/Np đã/R sử_dụng/V trong/E chứng_minh/V Lemma/Np 1/M sau_đây/Np :/CH Trong_Theorem/Np 1/M ,/CH ta/P đã/R chứng_minh/V xác_suất/N thuật_toán/N tìm/V được/V một/M điểm/N \\mathbfq/Np có/V khoảng_cách/N tới/E \\mathbfp/Np là/V 0/M ./CH 25/M ./CH\nChứng_minh/V rằng/C xác_suất/N này/P là/V 1-\\epsilon/Np nếu/C ta/P chọn/V t/Nu =/CH \\frac\\ln(n)\\ln/Np (1/Np và/Cc L/Ny =/CH n\\alpha\\ln(\\frac1\\epsilon)/Np ./CH\nSử_dụng/V bất_đẳng_thức/Np Chernoff/Np để/E giảm/V sự/N phụ_thuộc/V của/E t/Nu vào/E \\epsilon/Np xuống/V còn/R O(\\frac\\ln(n)\\ln/Np (1/Np ./CH\n,/CH ,/CH ,/CH ,/CH Trackback/Np link/Np :/CH Powered/Np by/Np and/Np\n", "title": "Locality Sensitive Hashing\n", "link": "http://www.giaithuatlaptrinh.com/?p=2776\n"}