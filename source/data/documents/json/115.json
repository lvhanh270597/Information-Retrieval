{"content": "Nguồn : HackerEarth và 1 số bài viết trên Wikipedia_Người dịch : Bùi_Việt Dũng_Table of_Contents Thuật_toán \"ngây thơ\" Thuật_toán \"chia để trị\" Xét bài_toán tính ab\\%c , với \\% là dấu đồng dư_thức và b có_thể rất lớn (ví dụ b \\leq 1018) .\nThuật_toán \"ngây thơ\" ab có_thể viết là a . a . a . a . . .\nvới b chữ a .\nDo_đó ta có_thể_nhân b lần a để có được kết_quả .\nlong_long power ( long_long a , long_long b , long_long c ) long_long ans = 1 ; for ( int i = 1 ; i lt;= b ; i ++ ) ans = a ; ans %= c ; return ans ; Trong mỗi lần_lặp , biến ans chứa kết_quả được nhân với a .\nNgoài_ra , ta cần đảm_bảo a sẽ không vượt_quá c trong các lần_lặp , vì_thế ta lấy phần dư khi chia ans cho c ( ans = ans % c ) .\nTa làm được vậy là nhờ tính_chất (x . y) \\% n = ((x \\% n) . (y \\% n)) \\% n .\nVì_vậy trong code trên ta tính (ans . a)\\%c bằng cách tính ((ans\\%c) . (a\\%c))\\%c .\nĐộ phức_tạp của thuật_toán : O(b) .\nThuật_toán \"chia để trị\" Dễ_dàng nhận_thấy thuật_toán trên không hiệu_quả , vì_thế ta cần tìm thuật_toán hiệu_quả hơn .\nTa có_thể giải bài_toán này với độ phức_tạp O(\\log_2b) bằng kĩ_thuật lũy_thừa bằng cách bình_phương (exponentiation by squaring) .\nKĩ_thuật này chỉ_cần O(\\log_2b) lần bình_phương và O(\\log_2b) phép_nhân để ra kết_quả .\nRõ_ràng cách giải này hiệu_quả hơn nhiều lần so_với thuật_toán \"ngây thơ\" .\nTa biết rằng ab có_thể được viết dưới dạng : ab=(a\\fracb2)2 nếu b chia_hết_cho 2 .\nab=a . (a\\fracb2)2 nếu b không chia_hết_cho 2 .\nab=1 nếu b=0 .\nint sqr ( int x ) return x x ; int pow ( int a , int b , int MOD ) if ( b == 0 ) return 1 % MOD ; else if ( b % 2 == 0 ) return sqr ( pow ( a , b / 2 )) % MOD ; else return a ( sqr ( pow ( a , b / 2 )) % MOD ) % MOD ; Giả_sử_ta có a=2 , b=5 , c=5 , khi đó kết_quả là pow(2 , 5 , 5) Do b lẻ , nên hàm pow(2 , 5 , 5) gọi hàm pow(2 , 2 , 5) để tính 2 . pow(2 , 2 , 5) Trong hàm pow(2 , 2 , 5) , do b=2 chẵn nên pow(2 , 2 , 5)=pow(2 , 1 , 5)2 Trong hàm pow(2 , 1 , 5) , do b=1 lẻ nên pow(2 , 1 , 5)=2pow(2 , 0 , 5) .\nTrong hàm pow(2 , 0 , 5) , do b=0 nên ta trả về 1 .\nQuay_lại hàm pow(2 , 1 , 5) : hàm này trả về giá_trị 2 .\nQuay_lại hàm pow(2 , 2 , 5) : hàm này trả về giá_trị 4 .\nQuay_lại hàm pow(2 , 5 , 5) : hàm này trả về giá_trị (2 . 42)\\%5=32\\%5=2 .\nVậy_ta có 25\\%5=2 .\nĐộ phức_tạp của thuật_toán : O(\\log_2b)\n", "tagged": "Nguồn/N :/CH HackerEarth/Np và/Cc 1/M số/N bài/N viết/V trên/E Wikipedia_Người/Np dịch/N :/CH Bùi_Việt/Np Dũng_Table/Np of_Contents/Np Thuật_toán/N \"ngây/Np thơ\"/Np Thuật_toán/N \"chia/Np để/E trị\"/Np Xét/V bài_toán/N tính/V ab\\%c/Np ,/CH với/E \\%/Np là/V dấu/N đồng/Nu dư_thức/Np và/Cc b/Ni có_thể/R rất/R lớn/A (ví/Np dụ/V b/Ni \\leq/Np 1018)/Np ./CH\nThuật_toán/N \"ngây/Np thơ\"/Np ab/Np có_thể/R viết/V là/V a/Ni ./CH a/Ni ./CH a/Ni ./CH a/Ni ./CH ./CH ./CH\nvới/E b/Ni chữ/N a/Ni ./CH\nDo_đó/C ta/P có_thể_nhân/Np b/Ni lần/N a/Ni để/E có/V được/V kết_quả/N ./CH\nlong_long/Np power/Np (/CH long_long/Np a/Ni ,/CH long_long/Np b/Ni ,/CH long_long/Np c/Ni )/CH long_long/Np ans/Np =/CH 1/M ;/CH for/Np (/CH int/Np i/M =/CH 1/M ;/CH i/M lt;=/Np b/Ni ;/CH i/M ++/Np )/CH ans/Np =/CH a/Ni ;/CH ans/Np %=/Np c/Ni ;/CH return/Np ans/Np ;/CH Trong/E mỗi/L lần_lặp/Np ,/CH biến/V ans/Np chứa/V kết_quả/N được/V nhân/N với/E a/Ni ./CH\nNgoài_ra/X ,/CH ta/P cần/V đảm_bảo/V a/Ni sẽ/R không/R vượt_quá/Np c/Ni trong/E các/L lần_lặp/Np ,/CH vì_thế/C ta/P lấy/V phần/N dư/A khi/N chia/V ans/Np cho/E c/Ni (/CH ans/Np =/CH ans/Np %/CH c/Ni )/CH ./CH\nTa/P làm/V được/V vậy/P là/V nhờ/V tính_chất/N (x/Np ./CH y)/Np \\%/Np n/Ny =/CH ((x/Np \\%/Np n)/Np ./CH (y/Np \\%/Np n))/Np \\%/Np n/Ny ./CH\nVì_vậy/C trong/E code/Np trên/E ta/P tính/V (ans/Np ./CH a)\\%c/Np bằng/E cách/N tính/V ((ans\\%c)/Np ./CH (a\\%c))\\%c/Np ./CH\nĐộ/N phức_tạp/A của/E thuật_toán/N :/CH O(b)/Np ./CH\nThuật_toán/N \"chia/Np để/E trị\"/Np Dễ_dàng/A nhận_thấy/Np thuật_toán/N trên/E không/R hiệu_quả/N ,/CH vì_thế/C ta/P cần/V tìm/V thuật_toán/N hiệu_quả/N hơn/A ./CH\nTa/P có_thể/R giải/N bài_toán/N này/P với/E độ/N phức_tạp/A O(\\log_2b)/Np bằng/E kĩ_thuật/N lũy_thừa/Np bằng/E cách/N bình_phương/Np (exponentiation/Np by/Np squaring)/Np ./CH\nKĩ_thuật/N này/P chỉ_cần/Np O(\\log_2b)/Np lần/N bình_phương/Np và/Cc O(\\log_2b)/Np phép_nhân/Np để/E ra/V kết_quả/N ./CH\nRõ_ràng/A cách/N giải/N này/P hiệu_quả/N hơn/A nhiều/A lần/N so_với/Np thuật_toán/N \"ngây/Np thơ\"/Np ./CH\nTa/P biết/V rằng/C ab/Np có_thể/R được/V viết/V dưới/E dạng/N :/CH ab=(a\\fracb2)2/Np nếu/C b/Ni chia_hết_cho/Np 2/M ./CH\nab=a/Np ./CH (a\\fracb2)2/Np nếu/C b/Ni không/R chia_hết_cho/Np 2/M ./CH\nab=1/Np nếu/C b=0/Np ./CH\nint/Np sqr/Np (/CH int/Np x/CH )/CH return/Np x/CH x/CH ;/CH int/Np pow/Np (/CH int/Np a/Ni ,/CH int/Np b/Ni ,/CH int/Np MOD/Np )/CH if/Np (/CH b/Ni ==/Np 0/M )/CH return/Np 1/M %/CH MOD/Np ;/CH else/Np if/Np (/CH b/Ni %/CH 2/M ==/Np 0/M )/CH return/Np sqr/Np (/CH pow/Np (/CH a/Ni ,/CH b/Ni //CH 2/M ))/Np %/CH MOD/Np ;/CH else/Np return/Np a/Ni (/CH sqr/Np (/CH pow/Np (/CH a/Ni ,/CH b/Ni //CH 2/M ))/Np %/CH MOD/Np )/CH %/CH MOD/Np ;/CH Giả_sử_ta/Np có/V a=2/Np ,/CH b=5/Np ,/CH c=5/Np ,/CH khi/N đó/P kết_quả/N là/V pow(2/Np ,/CH 5/M ,/CH 5)/Np Do/E b/Ni lẻ/A ,/CH nên/C hàm/Np pow(2/Np ,/CH 5/M ,/CH 5)/Np gọi/V hàm/Np pow(2/Np ,/CH 2/M ,/CH 5)/Np để/E tính/V 2/M ./CH pow(2/Np ,/CH 2/M ,/CH 5)/Np Trong/E hàm/Np pow(2/Np ,/CH 2/M ,/CH 5)/Np ,/CH do/E b=2/Np chẵn/Np nên/C pow(2/Np ,/CH 2/M ,/CH 5)=pow(2/Np ,/CH 1/M ,/CH 5)2/Np Trong/E hàm/Np pow(2/Np ,/CH 1/M ,/CH 5)/Np ,/CH do/E b=1/Np lẻ/A nên/C pow(2/Np ,/CH 1/M ,/CH 5)=2pow(2/Np ,/CH 0/M ,/CH 5)/Np ./CH\nTrong/E hàm/Np pow(2/Np ,/CH 0/M ,/CH 5)/Np ,/CH do/E b=0/Np nên/C ta/P trả/V về/E 1/M ./CH\nQuay_lại/Np hàm/Np pow(2/Np ,/CH 1/M ,/CH 5)/Np :/CH hàm/Np này/P trả/V về/E giá_trị/N 2/M ./CH\nQuay_lại/Np hàm/Np pow(2/Np ,/CH 2/M ,/CH 5)/Np :/CH hàm/Np này/P trả/V về/E giá_trị/N 4/M ./CH\nQuay_lại/Np hàm/Np pow(2/Np ,/CH 5/M ,/CH 5)/Np :/CH hàm/Np này/P trả/V về/E giá_trị/N (2/Np ./CH 42)\\%5=32\\%5=2/Np ./CH\nVậy_ta/Np có/V 25\\%5=2/Np ./CH\nĐộ/N phức_tạp/A của/E thuật_toán/N :/CH O(\\log_2b)/Np\n", "title": "Số học 3 - Tính (a^b) % c\n", "link": "http://vnoi.info/wiki/translate/he/Number-Theory-3\n"}