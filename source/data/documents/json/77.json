{"content": "Nơi tổng_hợp và chia_sẻ những kiến_thức liên_quan tới giải_thuật nói_chung và lý_thuyết khoa_học máy_tính nói_riêng .\nin Đây là bài thứ 3 trong loạt bài về cây khung nhỏ nhất .\nMình khuyến_khích bạn_đọc xem_lại bài thuật_toán Kruskal và thuật_toán Prim .\nMột_số tính_chất của cây khung mình không nhắc_lại ở đây nữa . Thuật_toán Borůvka có_lẽ là một trong số những thuật_toán có \"tuổi đời\" khá lớn trong các thuật_toán mà mình blog .\nThuật_toán được phát_triển bởi 1 Otakar_Borůvka năm 1926 .\nTrọng_tâm của thuật_toán này là phép (edge contraction) , một trong ba phép phổ_biến (xóa cạnh , xóa_đỉnh và co cạnh) hay áp_dụng trong lý_thuyết đồ_thị .\nHình dưới_đây minh_họa một_phép co cạnh .\nHình (3) là đồ_thị thu được sau khi co cạnh màu đỏ trong hình (1) Phép co một cạnh còn có_thể được mở_rộng ra một_tập cạnh .\nGọi_là một_tập cạnh .\nĐồ_thị thu được sau phép co_tập cạnh , kí_hiệu là , là đồ_thị thu được sau lần liên_tục co lần_lượt các cạnh trong (thứ tự cạnh nào được co trước , co sau không quan trọng) . Hình dưới_đây minh_họa một_phép co một_tập cạnh .\nHình (3) là đồ_thị thu được sau khi co_tập cạnh màu đỏ trong hình (1) Phép co cạnh thì_có liên_quan gì đến cây khung ?\nThực_ra hai thuật_toán Kruskal và Prim mà chúng_ta tìm_hiểu ở hai bài trước đều có_thể được nhìn dưới góc_độ phép co cạnh .\nLấy thuật_toán Kruskal làm ví_dụ .\nThuật_toán Kruskal ban_đầu sắp_xếp các cạnh theo thứ_tự tăng dần của trọng số , sau_đó xét từng cạnh theo thứ_tự đã sắp_xếp và thêm cạnh vào rừng (kết quả trung_gian là một rừng (forest) chứ không_phải cây) hiện_tại .\nNếu thêm cạnh đó vào mà không tạo ra chu_trình của rừng hiện_tại thì ta thêm .\nNếu_không , ta xét cạnh tiếp_theo .\nMình khuyến_khích bạn_đọc xem_lại ví_dụ trong bài trước .\nNhìn dưới góc_độ của phép co cạnh , ta sẽ thực_hiện thuật_toán Kruskal bằng một câu như_sau : Tìm cạnh có trọng số nhỏ nhất và co . Ví_dụ thực_hiện ý_tưởng trên cho đồ_thị được minh_họa trong hình dưới_đây .\nChú_ý khi co cạnh với đồ_thị có trọng số , ta sẽ giữ_lại cạnh có trong số các cạnh song_song .\nThứ_tự các cạnh được co màu đỏ cũng chính là thứ_tự các cạnh được thêm vào cây khung trong thuật_toán Kruskal .\nThuật_toán Borůvka có_ý tưởng tương_tự như_trên .\nĐể phát_biểu thuật_toán , ta sẽ cần thêm khái_niệm (safe edge) : Chú_ý cụm_từ .\nVí_dụ cạnh màu đỏ trong (1) là cạnh an_toàn ứng với đỉnh nhưng không_phải là cạnh an toán ứng với đỉnh .\nCác cạnh màu đỏ trong (2) là tập các cạnh an_toàn .\nĐể việc mô_tả thuật_toán trở_nên đơn_giản , ta sẽ giả_thiết : Không có hai cạnh nào của đồ_thị đầu_vào có cùng trọng số .\nTa sẽ sử_dụng giả_thiết này để chứng_minh tính đúng_đắn của thuật_toán Borůvka .\nCuối bài ta sẽ thảo_luận phương_pháp để loại_bỏ giả_thiết này .\nThuật_toán Borůvka có_thể được mô_tả đơn_giản bằng một câu sau : Tìm , thêm vào cây khung và co tất_cả các cạnh an_toàn cho_đến khi đồ_thị chỉ còn một đỉnh . Ví_dụ với đồ_thị hình dưới_đây , thuật_toán Borůvka chỉ_cần 3 bước để tìm_ra cây khung (là tập các cạnh màu đỏ bị co) . Giả mã : Thực_thi giả mã trên khá phức_tạp .\nTrước_khi đi_vào chi_tiết , chúng_ta thử phân_tích tính đúng_đắn và thời_gian_thực hiện của thuật_toán .\nTa sẽ chứng_minh_tập các cạnh trả về ở cuối thuật_toán là cây khung nhỏ nhất .\nDễ thấy phải là liên_thông vì cuối_cùng chỉ là một đỉnh .\nĐể chứng_minh là một cây , ta sẽ chứng_minh_tập các cạnh an_toàn mà ta đưa_vào tập trong mỗi bước không chứa chu_trình .\nThật_vậy , giả_sử là một chu_trình của .\nTheo định_nghĩa của cạnh an_toàn , ta có < .\nKhông mất tính tổng_quát , ta giả_sử < .\nDo là cạnh an_toàn và < , ta suy ra < .\nLập_luận tương_tự , ta có : < < < < < Đó là điều không_thể xảy_ra .\nNhư_vậy phải là một cây . Để chứng_minh có trọng số nhỏ nhất , ta dựa vào nhận_xét : cạnh là an_toàn khi và chỉ khi nó là cạnh nhỏ nhất của ít_nhất một trong 2 lát cắt .\nTheo tính_chất (số 6 tại ) của cây khung nhỏ nhất , cạnh an_toàn phải nằm trong cây khung nhỏ nhất .\nDo_đó , tập cạnh an_toàn mà ta thực_hiện co tại mỗi bước phải nằm trong cây khung nhỏ nhất của đồ_thị tại bước đó .\nĐiều này đã đủ để kết_luận tập cạnh an_toàn sẽ nằm trong cây khung nhỏ nhất của ?\nThực_ra là chưa .\nChúng_ta cần thêm một tính_chất nữa đó là : nếu là cây khung nhỏ nhất của thì_là cây khung nhỏ nhất của .\nChứng_minh tính_chất này không khó và coi_như bài_tập cho bạn_đọc . Do_đó , đầu_ra là cây khung nhỏ nhất của đồ_thị .\nMỗi lần_ta co một_tập cạnh trong mỗi bước lặp , số đỉnh của đồ_thị giảm đi ít_nhất một_nửa .\nSố đỉnh giảm đúng một_nửa khi và chỉ khi là một cặp ghép hoàn_hảo () .\nDo_đó , sau bước lặp , số đỉnh của đồ_thị chỉ còn_lại 1 .\nLúc_này vòng_lặp kết_thúc . Nhiệm_vụ còn_lại của chúng_ta là thực_thi đoạn code trong_vòng lặp_while .\nNếu chúng_ta thực_hiện được trong thời_gian thì , theo Lemma 1 , chúng_ta sẽ thu được thuật_toán . Trước_hết chúng_ta sẽ nghiên_cứu xem làm thế_nào để thực_thi phép co cạnh .\nCó 2 cách thực_thi thường được dùng : Cách đầu_tiên thì thường ít được dùng vì nó liên_quan đến việc sửa_đổi đồ thì và chúng_ta cũng có_thể \"cảm nhận\" thấy co cạnh theo cách đầu_tiên \"thực sự\" phức_tạp và có_thể mất thời_gian lên tới cho mỗi thao_tác co cạnh .\nMặc_dù ta có_thể mở_rộng cách đầu_tiên ra để co với thời_gian , thực_hiện co thực_sự vẫn là một thao_tác tốn_kém .\nLợi_thế của cách thực_thi này là kích_thước của đồ_thị thực_sự giảm sau mỗi phép co .\nĐiều này có_ý nghĩa về_mặt lý_thuyết , như Eisner 3 đã chỉ ra (trang 19) , độ phức_tạp của thuật_toán với thực_thi co cạnh thực_sự là .\nThuật_toán này thực_sự nhanh hơn các thực_thi của Kruskal và Prim mà chúng_ta đã tìm_hiểu trong blog này . Với cách thứ_hai , co một cạnh tương_ứng với gọi thao_tác và thao_tác kiểm_tra xem có thuộc cùng một_tập hay_không tương_ứng với .\nCấu_trúc này có_thể được thực_thi kiểu danh_sách hoặc bằng cây (các bạn xem_lại bài ) .\nTrong thuật_toán , chúng_ta sẽ không thực_sự thực_hiện Union-Find giống_như thuật_toán Kruskal mà thực_hiện sử_dụng mảng nhãn (chi tiết xem tại dưới đây) , vì cách thực_thi này đơn_giản hơn mà có cùng (thậm chí tốt hơn) thời_gian tiệm_cận .\nMột vấn_đề nữa_là ta không thực_sự xóa cạnh/đỉnh khỏi đồ_thị , do_đó , sau khi co cạnh , kích_thước của đồ_thị không thay_đổi .\nTa cần phải chú_ý điều này khi phân_tích các thuật_toán với phép co cạnh hàm_ẩn .\nỞ đây ta có hai đồ_thị : đồ_thị gốc và đồ_thị thu được sau khi đã co một (tập) cạnh .\nTa sẽ gọi đỉnh và cạnh của đồ_thị_co (tại bước hiện_tại của thuật toán) lần_lượt là và .\nĐỉnh co thực_chất là một_tập hợp các đỉnh còn cạnh co thực_chất là cạnh của đồ_thị với trọng số nhỏ nhất trong số các cạnh song_song giữa hai đỉnh co .\nSự nhập_nhằng giữa 2 đồ_thị này có_thể làm thuật_toán hơi khó_hiểu một_chút và mình sẽ cố_gắng viết rõ_ràng nhất có_thể .\nMọi câu_hỏi xin để_lại ở phần comment . Ta sẽ dùng một mảng nhãn để biểu_diễn các đỉnh sau khi đã thực_hiện co cạnh .\nCụ_thể , nếu thuộc đỉnh co trong đồ_thị_co .\nBan_đầu , ta khởi tạo .\nTa sẽ sử_dụng thêm một biến để đếm_số đỉnh trong đồ_thị hiện_tại sau khi đã co .\nNhãn của các đỉnh sẽ có_giá trị từ tới .\nTa sẽ không biểu_diễn đồ_thị_co một_cách trực_tiếp , mà sẽ thao_tác với nó thông_qua nhãn của các đỉnh của đồ_thị gốc .\nTa sẽ lần_lượt thực_thi từng dọng trong_vòng lặp của thuật_toán ở trên . Để tìm các cạnh an_toàn , ta sẽ duyệt qua tất_cả các cạnh của đồ_thị_co bằng cách duyệt qua các cạnh của đồ_thị gốc .\nVới mỗi đỉnh co , ta sẽ lưu một_số và một cạnh (của đồ_thị gốc) trong đó , nếu cạnh co nhỏ nhất kề với mà ta phát_hiện_tại bước duyệt cạnh hiện_tại có trọng số , và nếu là cạnh của đồ_thị gốc tương_ứng với cạnh co nhỏ nhất kề với đó .\nKhi duyệt cạnh , ta sẽ : Mảng cạnh chính là các cạnh an_toàn của đồ_thị_co .\nChú_ý là có_thể với hai đỉnh co khác_nhau .\nDo_đó , trước_khi trả_lại M , ta sẽ xóa các cạnh trùng_lặp .\nDễ thấy thao_tác này có_thể thực_hiện trong thời_gian .\nGiả mã : Code_C : Ta sẽ biểu_diễn rừng trung_gian bằng danh_sách kề .\nDo_đó , để đưa mỗi cạnh vào rừng hiện_tại , ta chỉ việc xét mỗi cạnh trong tập và cập_nhật danh_sách kề .\nCode_C : Co_tập cạnh thực_chất là cập_nhật lại nhãn của các đỉnh .\nĐể cập_nhật lại nhãn ta duyệt (dùng BFS hay DFS) để gán cho đỉnh của mỗi thành_phần liên_thông của một nhãn .\nCuối_cùng ta_cập nhật lại biến , là số_thành_phần liên_thông của .\nThao_tác này có_thể thực_hiện trong thời_gian .\nCode_C : Như_vậy ta đã thực_thi được vòng_lặp một_cách trọn_vẹn .\nViệc còn_lại là chúng_ta ghép mọi thứ lại với_nhau .\nDễ thấy , trong thực_thi ở trên , mỗi thủ_tục con mất thời_gian .\nTa có : Trong thuật_toán Borůvka là mỗi vòng_lặp , ta có_thể thực_hiện co_tập các cạnh an_toàn cùng một_lúc .\nDo_đó , ta có_thể dễ_dàng song_song_hóa thuật_toán Borůvka .\nNếu biểu_diễn rừng trung_gian bằng danh_sách cạnh , bước thêm cạnh vào rừng đơn_giản chỉ là thêm phần_tử vào một danh_sách .\nTuy_nhiên , khi đó ta không_thể dùng BFS hay DFS để gán lại nhãn trong bước co_tập cạnh (DFS và BFS với biểu_diễn d . s cạnh mất thời_gian bình phương) .\nMặc_dù vậy , ta có cách khác để gán lại nhãn trong thời_gian .\nMình không trình_bày phương_pháp này ở đây vì nó chỉ là vấn_đề kĩ_thuật và có_khi làm phức_tạp thêm bài_toán .\nChi_tiết cụ_thể coi_như bài_tập cho bạn_đọc . Phần này ta sẽ thảo_luận phương_pháp để loại_bỏ giả_thiết trọng số duy_nhất ở trên .\nTại_sao ta cần các cạnh có trọng số duy_nhất ?\nXét đồ_thị tam_giác , với 3 cạnh bằng_nhau dưới_đây .\nTheo định_nghĩa của cạnh an_toàn , bất_kì cạnh nào cũng có_thể là cạnh an_toàn tương_ứng với các đỉnh_đầu mút .\nDo_đó , bước tìm cạnh an_toàn có_thể trả về tập cạnh là cả 3 cạnh này .\nHay nói_cách_khác , tập trong giả mã có_thể chứa chu_trình , và khi thêm vào , không còn là một cây nữa .\nMay_mắn là trường_hợp này chỉ xảy_ra khi đồ_thị có_một chu_trình mà tất_cả các cạnh trong chu_trình bằng_nhau ( bạn có_thể chứng_minh ? ) .\nĐây cũng là chìa_khóa để chúng_ta giải_quyết trường_hợp cạnh của đồ_thị có trọng số duy_nhất . Ta sẽ định_nghĩa một cạnh có trọng số \"nhỏ hơn\" một cạnh nếu một trong ba trường_hợp sau xảy_ra . Ta kí_hiệu \"nhỏ hơn\" là .\nVới định_nghĩa như_vậy , áp_dụng vào đồ_thị tam_giác trên ta sẽ có thứ_tự : Giả mã : Như_vậy , không có bất_kì hai cạnh nào có cùng trọng số theo thứ_tự mới này , và do_đó , ta đã biến trọng số của đồ_thị đầu_vào thành duy_nhất .\nTrong code đầy_đủ được attach dưới_đây , ta sẽ sử_dụng ý_tưởng này để giải_thuật đúng_với cả trường_hợp đồ_thị trọng số_không duy_nhất . Code đầy_đủ : .\n1 Borůvka , Otakar (1926) .\n\"Příspěvek k řešení otázky ekonomické stavby elektrovodních sítí (Contribution to the solution of a problem of economical construction of electrical networks)\" .\nElektronický_Obzor (in Czech) 15 : 153–154 .\n2 Jeff_Erickson .\n.\nUIUC , 2014 .\n3 Jason_Eisner .\n, University of Pennsylvania , 1997 .\n4 Uri_Zwick .\n.\nTel_Aviv_University , 2013 .\n, , , Trackback link : Powered by and\n", "tagged": "Nơi/N tổng_hợp/V và/Cc chia_sẻ/V những/L kiến_thức/N liên_quan/V tới/E giải_thuật/Np nói_chung/X và/Cc lý_thuyết/Np khoa_học/N máy_tính/N nói_riêng/X ./CH\nin/V Đây/P là/V bài/N thứ/N 3/M trong/E loạt/N bài/N về/E cây/N khung/N nhỏ/A nhất/A ./CH\nMình/P khuyến_khích/V bạn_đọc/N xem_lại/V bài/N thuật_toán/N Kruskal/Np và/Cc thuật_toán/N Prim/Np ./CH\nMột_số/L tính_chất/N của/E cây/N khung/N mình/P không/R nhắc_lại/Np ở/E đây/P nữa/R ./CH Thuật_toán/N Borůvka/Np có_lẽ/X là/V một/M trong/E số/N những/L thuật_toán/N có/V \"tuổi/Np đời\"/Np khá/R lớn/A trong/E các/L thuật_toán/N mà/C mình/P blog/Np ./CH\nThuật_toán/N được/V phát_triển/V bởi/E 1/M Otakar_Borůvka/Np năm/N 1926/Np ./CH\nTrọng_tâm/A của/E thuật_toán/N này/P là/V phép/N (edge/Np contraction)/Np ,/CH một/M trong/E ba/M phép/N phổ_biến/V (xóa/Np cạnh/N ,/CH xóa_đỉnh/Np và/Cc co/V cạnh)/Np hay/Cc áp_dụng/V trong/E lý_thuyết/Np đồ_thị/Np ./CH\nHình/N dưới_đây/Np minh_họa/V một_phép/Np co/V cạnh/N ./CH\nHình/N (3)/Np là/V đồ_thị/Np thu/V được/V sau/E khi/N co/V cạnh/N màu/N đỏ/A trong/E hình/N (1)/Np Phép/N co/V một/M cạnh/N còn/R có_thể/R được/V mở_rộng/V ra/V một_tập/Np cạnh/N ./CH\nGọi_là/V một_tập/Np cạnh/N ./CH\nĐồ_thị/Np thu/V được/V sau/E phép/N co_tập/Np cạnh/N ,/CH kí_hiệu/Np là/V ,/CH là/V đồ_thị/Np thu/V được/V sau/E lần/N liên_tục/A co/V lần_lượt/R các/L cạnh/N trong/E (thứ/Np tự/P cạnh/N nào/P được/V co/V trước/E ,/CH co/V sau/E không/R quan/N trọng)/Np ./CH Hình/N dưới_đây/Np minh_họa/V một_phép/Np co/V một_tập/Np cạnh/N ./CH\nHình/N (3)/Np là/V đồ_thị/Np thu/V được/V sau/E khi/N co_tập/Np cạnh/N màu/N đỏ/A trong/E hình/N (1)/Np Phép/N co/V cạnh/N thì_có/X liên_quan/V gì/P đến/E cây/N khung/N ?/CH\nThực_ra/X hai/M thuật_toán/N Kruskal/Np và/Cc Prim/Np mà/C chúng_ta/P tìm_hiểu/V ở/E hai/M bài/N trước/E đều/R có_thể/R được/V nhìn/V dưới/E góc_độ/N phép/N co/V cạnh/N ./CH\nLấy/V thuật_toán/N Kruskal/Np làm/V ví_dụ/C ./CH\nThuật_toán/N Kruskal/Np ban_đầu/N sắp_xếp/V các/L cạnh/N theo/V thứ_tự/N tăng/V dần/R của/E trọng/Np số/N ,/CH sau_đó/Np xét/V từng/R cạnh/N theo/V thứ_tự/N đã/R sắp_xếp/V và/Cc thêm/V cạnh/N vào/E rừng/N (kết/Np quả/N trung_gian/N là/V một/M rừng/N (forest)/Np chứ/C không_phải/Np cây)/Np hiện_tại/N ./CH\nNếu/C thêm/V cạnh/N đó/P vào/E mà/C không/R tạo/V ra/V chu_trình/N của/E rừng/N hiện_tại/N thì/C ta/P thêm/V ./CH\nNếu_không/Np ,/CH ta/P xét/V cạnh/N tiếp_theo/V ./CH\nMình/P khuyến_khích/V bạn_đọc/N xem_lại/V ví_dụ/C trong/E bài/N trước/E ./CH\nNhìn/V dưới/E góc_độ/N của/E phép/N co/V cạnh/N ,/CH ta/P sẽ/R thực_hiện/V thuật_toán/N Kruskal/Np bằng/E một/M câu/N như_sau/Np :/CH Tìm/V cạnh/N có/V trọng/Np số/N nhỏ/A nhất/A và/Cc co/V ./CH Ví_dụ/C thực_hiện/V ý_tưởng/N trên/E cho/E đồ_thị/Np được/V minh_họa/V trong/E hình/N dưới_đây/Np ./CH\nChú_ý/V khi/N co/V cạnh/N với/E đồ_thị/Np có/V trọng/Np số/N ,/CH ta/P sẽ/R giữ_lại/Np cạnh/N có/V trong/E số/N các/L cạnh/N song_song/A ./CH\nThứ_tự/N các/L cạnh/N được/V co/V màu/N đỏ/A cũng/R chính/T là/V thứ_tự/N các/L cạnh/N được/V thêm/V vào/E cây/N khung/N trong/E thuật_toán/N Kruskal/Np ./CH\nThuật_toán/N Borůvka/Np có_ý/Np tưởng/V tương_tự/A như_trên/Np ./CH\nĐể/E phát_biểu/V thuật_toán/N ,/CH ta/P sẽ/R cần/V thêm/V khái_niệm/N (safe/Np edge)/Np :/CH Chú_ý/V cụm_từ/N ./CH\nVí_dụ/C cạnh/N màu/N đỏ/A trong/E (1)/Np là/V cạnh/N an_toàn/A ứng/V với/E đỉnh/N nhưng/C không_phải/Np là/V cạnh/N an/A toán/N ứng/V với/E đỉnh/N ./CH\nCác/L cạnh/N màu/N đỏ/A trong/E (2)/Np là/V tập/V các/L cạnh/N an_toàn/A ./CH\nĐể/E việc/N mô_tả/V thuật_toán/N trở_nên/V đơn_giản/A ,/CH ta/P sẽ/R giả_thiết/N :/CH Không/R có/V hai/M cạnh/N nào/P của/E đồ_thị/Np đầu_vào/N có/V cùng/A trọng/Np số/N ./CH\nTa/P sẽ/R sử_dụng/V giả_thiết/N này/P để/E chứng_minh/V tính/V đúng_đắn/A của/E thuật_toán/N Borůvka/Np ./CH\nCuối/N bài/N ta/P sẽ/R thảo_luận/V phương_pháp/N để/E loại_bỏ/V giả_thiết/N này/P ./CH\nThuật_toán/N Borůvka/Np có_thể/R được/V mô_tả/V đơn_giản/A bằng/E một/M câu/N sau/E :/CH Tìm/V ,/CH thêm/V vào/E cây/N khung/N và/Cc co/V tất_cả/P các/L cạnh/N an_toàn/A cho_đến/E khi/N đồ_thị/Np chỉ/R còn/R một/M đỉnh/N ./CH Ví_dụ/C với/E đồ_thị/Np hình/N dưới_đây/Np ,/CH thuật_toán/N Borůvka/Np chỉ_cần/Np 3/M bước/V để/E tìm_ra/Np cây/N khung/N (là/Np tập/V các/L cạnh/N màu/N đỏ/A bị/V co)/Np ./CH Giả/A mã/N :/CH Thực_thi/V giả/A mã/N trên/E khá/R phức_tạp/A ./CH\nTrước_khi/Np đi_vào/Np chi_tiết/N ,/CH chúng_ta/P thử/V phân_tích/V tính/V đúng_đắn/A và/Cc thời_gian_thực/Np hiện/N của/E thuật_toán/N ./CH\nTa/P sẽ/R chứng_minh_tập/Np các/L cạnh/N trả/V về/E ở/E cuối/N thuật_toán/N là/V cây/N khung/N nhỏ/A nhất/A ./CH\nDễ/A thấy/V phải/V là/V liên_thông/V vì/E cuối_cùng/A chỉ/R là/V một/M đỉnh/N ./CH\nĐể/E chứng_minh/V là/V một/M cây/N ,/CH ta/P sẽ/R chứng_minh_tập/Np các/L cạnh/N an_toàn/A mà/C ta/P đưa_vào/Np tập/V trong/E mỗi/L bước/V không/R chứa/V chu_trình/N ./CH\nThật_vậy/Np ,/CH giả_sử/Np là/V một/M chu_trình/N của/E ./CH\nTheo/V định_nghĩa/N của/E cạnh/N an_toàn/A ,/CH ta/P có/V </Np ./CH\nKhông/R mất/V tính/V tổng_quát/Np ,/CH ta/P giả_sử/Np </Np ./CH\nDo/E là/V cạnh/N an_toàn/A và/Cc </Np ,/CH ta/P suy/V ra/V </Np ./CH\nLập_luận/N tương_tự/A ,/CH ta/P có/V :/CH </Np </Np </Np </Np </Np Đó/P là/V điều/N không_thể/R xảy_ra/Np ./CH\nNhư_vậy/X phải/V là/V một/M cây/N ./CH Để/E chứng_minh/V có/V trọng/Np số/N nhỏ/A nhất/A ,/CH ta/P dựa/V vào/E nhận_xét/N :/CH cạnh/N là/V an_toàn/A khi/N và/Cc chỉ/R khi/N nó/P là/V cạnh/N nhỏ/A nhất/A của/E ít_nhất/A một/M trong/E 2/M lát/N cắt/V ./CH\nTheo/V tính_chất/N (số/Np 6/M tại/E )/CH của/E cây/N khung/N nhỏ/A nhất/A ,/CH cạnh/N an_toàn/A phải/V nằm/V trong/E cây/N khung/N nhỏ/A nhất/A ./CH\nDo_đó/C ,/CH tập/V cạnh/N an_toàn/A mà/C ta/P thực_hiện/V co/V tại/E mỗi/L bước/V phải/V nằm/V trong/E cây/N khung/N nhỏ/A nhất/A của/E đồ_thị/Np tại/E bước/V đó/P ./CH\nĐiều/N này/P đã/R đủ/A để/E kết_luận/V tập/V cạnh/N an_toàn/A sẽ/R nằm/V trong/E cây/N khung/N nhỏ/A nhất/A của/E ?/CH\nThực_ra/X là/V chưa/R ./CH\nChúng_ta/P cần/V thêm/V một/M tính_chất/N nữa/R đó/P là/V :/CH nếu/C là/V cây/N khung/N nhỏ/A nhất/A của/E thì_là/Np cây/N khung/N nhỏ/A nhất/A của/E ./CH\nChứng_minh/V tính_chất/N này/P không/R khó/A và/Cc coi_như/Np bài_tập/Np cho/E bạn_đọc/N ./CH Do_đó/C ,/CH đầu_ra/N là/V cây/N khung/N nhỏ/A nhất/A của/E đồ_thị/Np ./CH\nMỗi/L lần_ta/Np co/V một_tập/Np cạnh/N trong/E mỗi/L bước/V lặp/V ,/CH số/N đỉnh/N của/E đồ_thị/Np giảm/V đi/V ít_nhất/A một_nửa/N ./CH\nSố/N đỉnh/N giảm/V đúng/A một_nửa/N khi/N và/Cc chỉ/R khi/N là/V một/M cặp/N ghép/V hoàn_hảo/A ()/Np ./CH\nDo_đó/C ,/CH sau/E bước/V lặp/V ,/CH số/N đỉnh/N của/E đồ_thị/Np chỉ/R còn_lại/Np 1/M ./CH\nLúc_này/Np vòng_lặp/Np kết_thúc/V ./CH Nhiệm_vụ/N còn_lại/Np của/E chúng_ta/P là/V thực_thi/V đoạn/Nc code/Np trong_vòng/Np lặp_while/Np ./CH\nNếu/C chúng_ta/P thực_hiện/V được/V trong/E thời_gian/N thì/C ,/CH theo/V Lemma/Np 1/M ,/CH chúng_ta/P sẽ/R thu/V được/V thuật_toán/N ./CH Trước_hết/N chúng_ta/P sẽ/R nghiên_cứu/V xem/V làm/V thế_nào/P để/E thực_thi/V phép/N co/V cạnh/N ./CH\nCó/V 2/M cách/N thực_thi/V thường/R được/V dùng/V :/CH Cách/N đầu_tiên/A thì/C thường/R ít/A được/V dùng/V vì/E nó/P liên_quan/V đến/E việc/N sửa_đổi/V đồ/N thì/C và/Cc chúng_ta/P cũng/R có_thể/R \"cảm/Np nhận\"/Np thấy/V co/V cạnh/N theo/V cách/N đầu_tiên/A \"thực/Np sự\"/Np phức_tạp/A và/Cc có_thể/R mất/V thời_gian/N lên/V tới/E cho/E mỗi/L thao_tác/V co/V cạnh/N ./CH\nMặc_dù/C ta/P có_thể/R mở_rộng/V cách/N đầu_tiên/A ra/V để/E co/V với/E thời_gian/N ,/CH thực_hiện/V co/V thực_sự/A vẫn/R là/V một/M thao_tác/V tốn_kém/V ./CH\nLợi_thế/N của/E cách/N thực_thi/V này/P là/V kích_thước/N của/E đồ_thị/Np thực_sự/A giảm/V sau/E mỗi/L phép/N co/V ./CH\nĐiều/N này/P có_ý/Np nghĩa/N về_mặt/Np lý_thuyết/Np ,/CH như/C Eisner/Np 3/M đã/R chỉ/R ra/V (trang/Np 19)/Np ,/CH độ/N phức_tạp/A của/E thuật_toán/N với/E thực_thi/V co/V cạnh/N thực_sự/A là/V ./CH\nThuật_toán/N này/P thực_sự/A nhanh/A hơn/A các/L thực_thi/V của/E Kruskal/Np và/Cc Prim/Np mà/C chúng_ta/P đã/R tìm_hiểu/V trong/E blog/Np này/P ./CH Với/E cách/N thứ_hai/N ,/CH co/V một/M cạnh/N tương_ứng/V với/E gọi/V thao_tác/V và/Cc thao_tác/V kiểm_tra/V xem/V có/V thuộc/V cùng/A một_tập/Np hay_không/Np tương_ứng/V với/E ./CH\nCấu_trúc/N này/P có_thể/R được/V thực_thi/V kiểu/N danh_sách/N hoặc/Cc bằng/E cây/N (các/Np bạn/N xem_lại/V bài/N )/CH ./CH\nTrong/E thuật_toán/N ,/CH chúng_ta/P sẽ/R không/R thực_sự/A thực_hiện/V Union-Find/Np giống_như/Np thuật_toán/N Kruskal/Np mà/C thực_hiện/V sử_dụng/V mảng/N nhãn/N (chi/Np tiết/N xem/V tại/E dưới/E đây)/Np ,/CH vì/E cách/N thực_thi/V này/P đơn_giản/A hơn/A mà/C có/V cùng/A (thậm/Np chí/N tốt/A hơn)/Np thời_gian/N tiệm_cận/Np ./CH\nMột/M vấn_đề/N nữa_là/X ta/P không/R thực_sự/A xóa/V cạnh/N khỏi/V đồ_thị/Np ,/CH do_đó/C ,/CH sau/E khi/N co/V cạnh/N ,/CH kích_thước/N của/E đồ_thị/Np không/R thay_đổi/V ./CH\nTa/P cần/V phải/V chú_ý/V điều/N này/P khi/N phân_tích/V các/L thuật_toán/N với/E phép/N co/V cạnh/N hàm_ẩn/Np ./CH\nỞ/E đây/P ta/P có/V hai/M đồ_thị/Np :/CH đồ_thị/Np gốc/N và/Cc đồ_thị/Np thu/V được/V sau/E khi/N đã/R co/V một/M (tập)/Np cạnh/N ./CH\nTa/P sẽ/R gọi/V đỉnh/N và/Cc cạnh/N của/E đồ_thị_co/Np (tại/Np bước/V hiện_tại/N của/E thuật/Np toán)/Np lần_lượt/R là/V và/Cc ./CH\nĐỉnh/N co/V thực_chất/N là/V một_tập/Np hợp/V các/L đỉnh/N còn/R cạnh/N co/V thực_chất/N là/V cạnh/N của/E đồ_thị/Np với/E trọng/Np số/N nhỏ/A nhất/A trong/E số/N các/L cạnh/N song_song/A giữa/N hai/M đỉnh/N co/V ./CH\nSự/N nhập_nhằng/Np giữa/N 2/M đồ_thị/Np này/P có_thể/R làm/V thuật_toán/N hơi/R khó_hiểu/Np một_chút/L và/Cc mình/P sẽ/R cố_gắng/V viết/V rõ_ràng/A nhất/A có_thể/R ./CH\nMọi/L câu_hỏi/N xin/V để_lại/Np ở/E phần/N comment/Np ./CH Ta/P sẽ/R dùng/V một/M mảng/N nhãn/N để/E biểu_diễn/V các/L đỉnh/N sau/E khi/N đã/R thực_hiện/V co/V cạnh/N ./CH\nCụ_thể/A ,/CH nếu/C thuộc/V đỉnh/N co/V trong/E đồ_thị_co/Np ./CH\nBan_đầu/N ,/CH ta/P khởi/V tạo/V ./CH\nTa/P sẽ/R sử_dụng/V thêm/V một/M biến/V để/E đếm_số/Np đỉnh/N trong/E đồ_thị/Np hiện_tại/N sau/E khi/N đã/R co/V ./CH\nNhãn/N của/E các/L đỉnh/N sẽ/R có_giá/Np trị/V từ/E tới/E ./CH\nTa/P sẽ/R không/R biểu_diễn/V đồ_thị_co/Np một_cách/N trực_tiếp/A ,/CH mà/C sẽ/R thao_tác/V với/E nó/P thông_qua/V nhãn/N của/E các/L đỉnh/N của/E đồ_thị/Np gốc/N ./CH\nTa/P sẽ/R lần_lượt/R thực_thi/V từng/R dọng/Np trong_vòng/Np lặp/V của/E thuật_toán/N ở/E trên/E ./CH Để/E tìm/V các/L cạnh/N an_toàn/A ,/CH ta/P sẽ/R duyệt/V qua/V tất_cả/P các/L cạnh/N của/E đồ_thị_co/Np bằng/E cách/N duyệt/V qua/V các/L cạnh/N của/E đồ_thị/Np gốc/N ./CH\nVới/E mỗi/L đỉnh/N co/V ,/CH ta/P sẽ/R lưu/V một_số/L và/Cc một/M cạnh/N (của/Np đồ_thị/Np gốc)/Np trong/E đó/P ,/CH nếu/C cạnh/N co/V nhỏ/A nhất/A kề/V với/E mà/C ta/P phát_hiện_tại/Np bước/V duyệt/V cạnh/N hiện_tại/N có/V trọng/Np số/N ,/CH và/Cc nếu/C là/V cạnh/N của/E đồ_thị/Np gốc/N tương_ứng/V với/E cạnh/N co/V nhỏ/A nhất/A kề/V với/E đó/P ./CH\nKhi/N duyệt/V cạnh/N ,/CH ta/P sẽ/R :/CH Mảng/N cạnh/N chính/T là/V các/L cạnh/N an_toàn/A của/E đồ_thị_co/Np ./CH\nChú_ý/V là/V có_thể/R với/E hai/M đỉnh/N co/V khác_nhau/Np ./CH\nDo_đó/C ,/CH trước_khi/Np trả_lại/Np M/Nu ,/CH ta/P sẽ/R xóa/V các/L cạnh/N trùng_lặp/Np ./CH\nDễ/A thấy/V thao_tác/V này/P có_thể/R thực_hiện/V trong/E thời_gian/N ./CH\nGiả/A mã/N :/CH Code_C/Np :/CH Ta/P sẽ/R biểu_diễn/V rừng/N trung_gian/N bằng/E danh_sách/N kề/V ./CH\nDo_đó/C ,/CH để/E đưa/V mỗi/L cạnh/N vào/E rừng/N hiện_tại/N ,/CH ta/P chỉ/R việc/N xét/V mỗi/L cạnh/N trong/E tập/V và/Cc cập_nhật/V danh_sách/N kề/V ./CH\nCode_C/Np :/CH Co_tập/Np cạnh/N thực_chất/N là/V cập_nhật/V lại/R nhãn/N của/E các/L đỉnh/N ./CH\nĐể/E cập_nhật/V lại/R nhãn/N ta/P duyệt/V (dùng/Np BFS/Np hay/Cc DFS)/Np để/E gán/V cho/E đỉnh/N của/E mỗi/L thành_phần/N liên_thông/V của/E một/M nhãn/N ./CH\nCuối_cùng/A ta_cập/Np nhật/N lại/R biến/V ,/CH là/V số_thành_phần/Np liên_thông/V của/E ./CH\nThao_tác/V này/P có_thể/R thực_hiện/V trong/E thời_gian/N ./CH\nCode_C/Np :/CH Như_vậy/X ta/P đã/R thực_thi/V được/V vòng_lặp/Np một_cách/N trọn_vẹn/A ./CH\nViệc/N còn_lại/Np là/V chúng_ta/P ghép/V mọi/L thứ/N lại/R với_nhau/Np ./CH\nDễ/A thấy/V ,/CH trong/E thực_thi/V ở/E trên/E ,/CH mỗi/L thủ_tục/N con/Nc mất/V thời_gian/N ./CH\nTa/P có/V :/CH Trong/E thuật_toán/N Borůvka/Np là/V mỗi/L vòng_lặp/Np ,/CH ta/P có_thể/R thực_hiện/V co_tập/Np các/L cạnh/N an_toàn/A cùng/A một_lúc/Np ./CH\nDo_đó/C ,/CH ta/P có_thể/R dễ_dàng/A song_song_hóa/Np thuật_toán/N Borůvka/Np ./CH\nNếu/C biểu_diễn/V rừng/N trung_gian/N bằng/E danh_sách/N cạnh/N ,/CH bước/V thêm/V cạnh/N vào/E rừng/N đơn_giản/A chỉ/R là/V thêm/V phần_tử/N vào/E một/M danh_sách/N ./CH\nTuy_nhiên/C ,/CH khi/N đó/P ta/P không_thể/R dùng/V BFS/Np hay/Cc DFS/Np để/E gán/V lại/R nhãn/N trong/E bước/V co_tập/Np cạnh/N (DFS/Np và/Cc BFS/Np với/E biểu_diễn/V d/Ny ./CH s/Y cạnh/N mất/V thời_gian/N bình/N phương)/Np ./CH\nMặc_dù/C vậy/P ,/CH ta/P có/V cách/N khác/A để/E gán/V lại/R nhãn/N trong/E thời_gian/N ./CH\nMình/P không/R trình_bày/V phương_pháp/N này/P ở/E đây/P vì/E nó/P chỉ/R là/V vấn_đề/N kĩ_thuật/N và/Cc có_khi/R làm/V phức_tạp/A thêm/V bài_toán/N ./CH\nChi_tiết/N cụ_thể/A coi_như/Np bài_tập/Np cho/E bạn_đọc/N ./CH Phần/N này/P ta/P sẽ/R thảo_luận/V phương_pháp/N để/E loại_bỏ/V giả_thiết/N trọng/Np số/N duy_nhất/A ở/E trên/E ./CH\nTại_sao/X ta/P cần/V các/L cạnh/N có/V trọng/Np số/N duy_nhất/A ?/CH\nXét/V đồ_thị/Np tam_giác/N ,/CH với/E 3/M cạnh/N bằng_nhau/Np dưới_đây/Np ./CH\nTheo/V định_nghĩa/N của/E cạnh/N an_toàn/A ,/CH bất_kì/R cạnh/N nào/P cũng/R có_thể/R là/V cạnh/N an_toàn/A tương_ứng/V với/E các/L đỉnh_đầu/Np mút/N ./CH\nDo_đó/C ,/CH bước/V tìm/V cạnh/N an_toàn/A có_thể/R trả/V về/E tập/V cạnh/N là/V cả/P 3/M cạnh/N này/P ./CH\nHay/Cc nói_cách_khác/Np ,/CH tập/V trong/E giả/A mã/N có_thể/R chứa/V chu_trình/N ,/CH và/Cc khi/N thêm/V vào/E ,/CH không/R còn/R là/V một/M cây/N nữa/R ./CH\nMay_mắn/A là/V trường_hợp/N này/P chỉ/R xảy_ra/Np khi/N đồ_thị/Np có_một/Np chu_trình/N mà/C tất_cả/P các/L cạnh/N trong/E chu_trình/N bằng_nhau/Np (/CH bạn/N có_thể/R chứng_minh/V ?/CH )/CH ./CH\nĐây/P cũng/R là/V chìa_khóa/N để/E chúng_ta/P giải_quyết/V trường_hợp/N cạnh/N của/E đồ_thị/Np có/V trọng/Np số/N duy_nhất/A ./CH Ta/P sẽ/R định_nghĩa/N một/M cạnh/N có/V trọng/Np số/N \"nhỏ/Np hơn\"/Np một/M cạnh/N nếu/C một/M trong/E ba/M trường_hợp/N sau/E xảy_ra/Np ./CH Ta/P kí_hiệu/Np \"nhỏ/Np hơn\"/Np là/V ./CH\nVới/E định_nghĩa/N như_vậy/X ,/CH áp_dụng/V vào/E đồ_thị/Np tam_giác/N trên/E ta/P sẽ/R có/V thứ_tự/N :/CH Giả/A mã/N :/CH Như_vậy/X ,/CH không/R có/V bất_kì/R hai/M cạnh/N nào/P có/V cùng/A trọng/Np số/N theo/V thứ_tự/N mới/R này/P ,/CH và/Cc do_đó/C ,/CH ta/P đã/R biến/V trọng/Np số/N của/E đồ_thị/Np đầu_vào/N thành/V duy_nhất/A ./CH\nTrong/E code/Np đầy_đủ/A được/V attach/Np dưới_đây/Np ,/CH ta/P sẽ/R sử_dụng/V ý_tưởng/N này/P để/E giải_thuật/Np đúng_với/Np cả/P trường_hợp/N đồ_thị/Np trọng/Np số_không/Np duy_nhất/A ./CH Code/Np đầy_đủ/A :/CH ./CH\n1/M Borůvka/Np ,/CH Otakar/Np (1926)/Np ./CH\n\"Příspěvek/Np k/N řešení/Np otázky/Np ekonomické/Np stavby/Np elektrovodních/Np sítí/Np (Contribution/Np to/A the/B solution/Np of/E a/Ni problem/Np of/E economical/Np construction/Np of/E electrical/Np networks)\"/Np ./CH\nElektronický_Obzor/Np (in/Np Czech)/Np 15/M :/CH 153–154/Np ./CH\n2/M Jeff_Erickson/Np ./CH\n./CH\nUIUC/Np ,/CH 2014/M ./CH\n3/M Jason_Eisner/Np ./CH\n,/CH University/Np of/E Pennsylvania/Np ,/CH 1997/M ./CH\n4/M Uri_Zwick/Np ./CH\n./CH\nTel_Aviv_University/Np ,/CH 2013/M ./CH\n,/CH ,/CH ,/CH Trackback/Np link/Np :/CH Powered/Np by/Np and/Np\n", "title": "Cây khung nhỏ nhất: thuật toán Borůvka -- Borůvka Algorithm\n", "link": "http://www.giaithuatlaptrinh.com/?p=1204\n"}