{"content": "Nguồn : HackerEarth_Người dịch : Bùi_Việt Dũng_Table of_Contents Bao_hàm - loại_trừ (Inclusion-Exclusion) Phát_biểu công_thức Công_thức dành cho tập_hợp Lập_công thức bằng biểu_đồ Venn (Venn diagrams) Công_thức dành cho xác_suất Chứng_minh công_thức bao_hàm - loại_trừ Ứng_dụng : Đếm_số số_nguyên_tố cùng_nhau với một_số cho trước trong một đoạn Bao_hàm - loại_trừ (Inclusion-Exclusion) Phát_biểu công_thức Công_thức bao_hàm - loại_trừ được phát_biểu như_sau : Để tính lực_lượng của hợp của nhiều tập_hợp , ta tính tổng_lực_lượng các tập_hợp đó , rồi trừ đi lực_lượng của giao của các cặp hai tập_hợp khác_nhau , rồi cộng lực_lượng của giao các bộ_ba tập_hợp khác_nhau , rồi trừ đi lực_lượng của các bộ bốn tập_hợp , và cứ thế cho_đến khi ta xét đến giao của tất_cả các tập_hợp .\nCông_thức dành cho tập_hợp Công_thức bao_hàm - loại_trừ có dạng như_sau : \\bigcup_i=1n A_i = \\sum_i=1n A_i - \\sum_i \\ne j A_i \\cap A_j + A_1 \\cap A_2 \\cap A_3 + A_1 \\cap A_2 \\cap A_4 + . . .\n+ A_n-2 \\cap A_n-1 \\cap A_n - . . .\n- (-1)nA_1 \\cap A_2 \\cap . . .\n\\cap A_n Ta có_thể viết công_thức này một_cách gọn hơn bằng cách tính tổng của các tập_con .\nGọi_B là tập_hợp các tập_hợp A_i .\nKhi đó công_thức bao_hàm - loại_trừ có dạng : \\bigcup_i=1n A_i = \\sum_C \\subset B (-1)C-1 \\bigcap_e \\in C e Lập_công thức bằng biểu_đồ Venn (Venn diagrams) Ta có biểu_đồ sau biểu_diễn ba tập_hợp A , B và C .\nKhi đó ta thấy lực_lượng của A \\cup B \\cup C bằng lực_lượng của A , B , C trừ đi lực_lượng của A \\cap B , B \\cap C , C \\cap A rồi cộng thêm lực_lượng của A \\cap B \\cap C .\nA \\cup B \\cup C = A + B + C - A \\cap B - B \\cap C - C \\cap A + A \\cap B \\cap C Tương_tự , ta có_thể lập_công thức với n tập_hợp .\nCông_thức dành cho xác_suất Nếu ta có n biến_cố A_1 , A_2 , . . . , A_n , P(A_i) là xác_suất của biến_cố A_i , xác_suất của biến_cố hợp của chúng (nghĩa là biến_cố \"có ít_nhất một trong số n biến_cố A_1 , A_2 , . . . , A_n xảy ra\") là P(\\bigcup_i=1n A_i) = \\sum_i=1n P(A_i) - \\sum_i \\ne j P(A_i A_j) + P(A_1 A_2 A_3) + P(A_1 A_2 A_4) + . . .\n+ P(A_n-2 A_n-1 A_n) - . . .\n- (-1)n . P(A_1 A_2 . . .\nA_n) Nếu gọi B là tập_hợp các tập_hợp A_i , công_thức này cũng có_thể viết gọn như_sau : P(\\bigcup_i=1n A_i) = \\sum_C \\subset B (-1)C-1 .\nP(\\bigcap_e \\in C e) Chứng_minh công_thức bao_hàm - loại_trừ Để thuật tiện trong chứng_minh , ta sử_dụng công_thức viết gọn sau : \\bigcup_i=1n A_i = \\sum_C \\subset B (-1)C-1 \\bigcap_e \\in C e với B là tập_hợp các tập_hợp A_i .\nTa cần chứng_minh một phần_tử bất_kì thuộc ít_nhất một_tập A_i , sẽ chỉ được đếm một_lần trong công_thức .\nXét một phần_tử x bất_kì thuộc k \\geq 1 tập_hợp A_i .\nTa thấy Trong công_thức , khi C = 1 , x được đếm thêm k lần .\nTrong công_thức , khi C = 2 , x được đếm bớt đi \\binomk2 lần bởi x bị đếm bớt đi khi ta xét một cặp 2 tập_hợp khác_nhau trong số k tập_hợp chứa phần_tử x .\nTrong công_thức , khi C = 3 , x được đếm thêm \\binomk3 lần .\n. . .\nTrong công_thức , khi C = k , x được đếm \\binomkk lần .\nNếu k lẻ thì x được đếm thêm , nếu k chẵn thì x được đếm bớt .\nTrong công_thức , khi C gt; k , x không được đếm .\nVì_vậy , số lần x được đếm là T = \\binomk1 - \\binomk2 + \\binomk3 - . . .\n+ (-1)i-1 . \\binomki + . . .\n+ (-1)k-1 . \\binomkk .\nĐể tính T , ta khai_triển (1-x)k bằng nhị_thức Niu-tơn (Newton binomial) : (1-x)k = \\binomk0 - \\binomk1 . x + \\binomk2 . x2 - \\binomk3 . x3 + . . .\n+ (-1)k . \\binomkk . xk .\nTa thấy với x=1 , (1-x)k = T-1 , do_đó T = (1-1)k+1 = 1 hay điều phải chứng_minh .\nỨng_dụng : Đếm_số số_nguyên_tố cùng_nhau với một_số cho trước trong một đoạn Đây là một bài_toán dễ dựa trên công_thức bao_hàm - loại_trừ .\nCho hai số_nguyên n và r , đếm_số số_nguyên_tố cùng_nhau với n trong đoạn 1;r .\nThuật_toán : Tìm phần bù (the inverse) : Đếm_số số_không nguyên_tố cùng_nhau với n .\nXét các ước nguyên_tố của n , đánh_số chúng từ 1 đến k .\nTa có_thể tính số số trong đoạn 1;r chia_hết_cho p_i bằng công_thức \\fracrp_i .\nTuy_vậy , nếu ta chỉ tính tổng tất_cả các số này , ta sẽ ra kết qủa sai .\nĐó là do một_số số có_thể chia_hết_cho nhiều p_i .\nVì_vậy ta cần sử_dụng đến công_thức bao_hàm - loại_trừ .\nint solve ( int n , int r ) vector lt; int gt; p ; for ( int i = 2 ; i i lt;= n ; ++ i ) if ( n % i == 0 ) p .\npush_back ( i ); while ( n % i == 0 ) n /= i ; if ( n gt; 1 ) p .\npush_back ( n ); int sum = 0 ; for ( int msk = 1 ; msk lt; ( 1 lt;lt; p .\nsize ()); ++ msk ) int mult = 1 , bits = 0 ; for ( int i = 0 ; i lt; ( int ) p .\nsize (); ++ i ) if ( msk amp; ( 1 lt;lt; i )) ++ bits ; mult = p i ; int cur = r / mult ; if ( bits % 2 == 1 ) sum += cur ; else_sum -= cur ; return r - sum ;\n", "tagged": "Nguồn/N :/CH HackerEarth_Người/Np dịch/N :/CH Bùi_Việt/Np Dũng_Table/Np of_Contents/Np Bao_hàm/Np -/CH loại_trừ/V (Inclusion-Exclusion)/Np Phát_biểu/V công_thức/N Công_thức/N dành/V cho/E tập_hợp/N Lập_công/Np thức/V bằng/E biểu_đồ/N Venn/Np (Venn/Np diagrams)/Np Công_thức/N dành/V cho/E xác_suất/N Chứng_minh/V công_thức/N bao_hàm/Np -/CH loại_trừ/V Ứng_dụng/V :/CH Đếm_số/Np số_nguyên_tố/Np cùng_nhau/Np với/E một_số/L cho/E trước/E trong/E một/M đoạn/Nc Bao_hàm/Np -/CH loại_trừ/V (Inclusion-Exclusion)/Np Phát_biểu/V công_thức/N Công_thức/N bao_hàm/Np -/CH loại_trừ/V được/V phát_biểu/V như_sau/Np :/CH Để/E tính/V lực_lượng/N của/E hợp/V của/E nhiều/A tập_hợp/N ,/CH ta/P tính/V tổng_lực_lượng/Np các/L tập_hợp/N đó/P ,/CH rồi/C trừ/V đi/V lực_lượng/N của/E giao/V của/E các/L cặp/N hai/M tập_hợp/N khác_nhau/Np ,/CH rồi/C cộng/V lực_lượng/N của/E giao/V các/L bộ_ba/Np tập_hợp/N khác_nhau/Np ,/CH rồi/C trừ/V đi/V lực_lượng/N của/E các/L bộ/N bốn/M tập_hợp/N ,/CH và/Cc cứ/R thế/P cho_đến/E khi/N ta/P xét/V đến/E giao/V của/E tất_cả/P các/L tập_hợp/N ./CH\nCông_thức/N dành/V cho/E tập_hợp/N Công_thức/N bao_hàm/Np -/CH loại_trừ/V có/V dạng/N như_sau/Np :/CH \\bigcup_i=1n/Np A_i/Np =/CH \\sum_i=1n/Np A_i/Np -/CH \\sum_i/Np \\ne/Np j/Np A_i/Np \\cap/Np A_j/Np +/CH A_1/Np \\cap/Np A_2/Np \\cap/Np A_3/Np +/CH A_1/Np \\cap/Np A_2/Np \\cap/Np A_4/Np +/CH ./CH ./CH ./CH\n+/CH A_n-2/Np \\cap/Np A_n-1/Np \\cap/Np A_n/Np -/CH ./CH ./CH ./CH\n-/CH (-1)nA_1/Np \\cap/Np A_2/Np \\cap/Np ./CH ./CH ./CH\n\\cap/Np A_n/Np Ta/P có_thể/R viết/V công_thức/N này/P một_cách/N gọn/A hơn/A bằng/E cách/N tính/V tổng/N của/E các/L tập_con/Np ./CH\nGọi_B/Np là/V tập_hợp/N các/L tập_hợp/N A_i/Np ./CH\nKhi/N đó/P công_thức/N bao_hàm/Np -/CH loại_trừ/V có/V dạng/N :/CH \\bigcup_i=1n/Np A_i/Np =/CH \\sum_C/Np \\subset/Np B/Ni (-1)C-1/Np \\bigcap_e/Np \\in/Np C/Ni e/Ni Lập_công/Np thức/V bằng/E biểu_đồ/N Venn/Np (Venn/Np diagrams)/Np Ta/P có/V biểu_đồ/N sau/E biểu_diễn/V ba/M tập_hợp/N A/Ni ,/CH B/Ni và/Cc C/Ni ./CH\nKhi/N đó/P ta/P thấy/V lực_lượng/N của/E A/Ni \\cup/Np B/Ni \\cup/Np C/Ni bằng/E lực_lượng/N của/E A/Ni ,/CH B/Ni ,/CH C/Ni trừ/V đi/V lực_lượng/N của/E A/Ni \\cap/Np B/Ni ,/CH B/Ni \\cap/Np C/Ni ,/CH C/Ni \\cap/Np A/Ni rồi/C cộng/V thêm/V lực_lượng/N của/E A/Ni \\cap/Np B/Ni \\cap/Np C/Ni ./CH\nA/Ni \\cup/Np B/Ni \\cup/Np C/Ni =/CH A/Ni +/CH B/Ni +/CH C/Ni -/CH A/Ni \\cap/Np B/Ni -/CH B/Ni \\cap/Np C/Ni -/CH C/Ni \\cap/Np A/Ni +/CH A/Ni \\cap/Np B/Ni \\cap/Np C/Ni Tương_tự/A ,/CH ta/P có_thể/R lập_công/Np thức/V với/E n/Ny tập_hợp/N ./CH\nCông_thức/N dành/V cho/E xác_suất/N Nếu/C ta/P có/V n/Ny biến_cố/N A_1/Np ,/CH A_2/Np ,/CH ./CH ./CH ./CH ,/CH A_n/Np ,/CH P(A_i)/Np là/V xác_suất/N của/E biến_cố/N A_i/Np ,/CH xác_suất/N của/E biến_cố/N hợp/V của/E chúng/P (nghĩa/Np là/V biến_cố/N \"có/Np ít_nhất/A một/M trong/E số/N n/Ny biến_cố/N A_1/Np ,/CH A_2/Np ,/CH ./CH ./CH ./CH ,/CH A_n/Np xảy/V ra\")/Np là/V P(\\bigcup_i=1n/Np A_i)/Np =/CH \\sum_i=1n/Np P(A_i)/Np -/CH \\sum_i/Np \\ne/Np j/Np P(A_i/Np A_j)/Np +/CH P(A_1/Np A_2/Np A_3)/Np +/CH P(A_1/Np A_2/Np A_4)/Np +/CH ./CH ./CH ./CH\n+/CH P(A_n-2/Np A_n-1/Np A_n)/Np -/CH ./CH ./CH ./CH\n-/CH (-1)n/Np ./CH P(A_1/Np A_2/Np ./CH ./CH ./CH\nA_n)/Np Nếu/C gọi/V B/Ni là/V tập_hợp/N các/L tập_hợp/N A_i/Np ,/CH công_thức/N này/P cũng/R có_thể/R viết/V gọn/A như_sau/Np :/CH P(\\bigcup_i=1n/Np A_i)/Np =/CH \\sum_C/Np \\subset/Np B/Ni (-1)C-1/Np ./CH\nP(\\bigcap_e/Np \\in/Np C/Ni e)/Np Chứng_minh/V công_thức/N bao_hàm/Np -/CH loại_trừ/V Để/E thuật/Np tiện/V trong/E chứng_minh/V ,/CH ta/P sử_dụng/V công_thức/N viết/V gọn/A sau/E :/CH \\bigcup_i=1n/Np A_i/Np =/CH \\sum_C/Np \\subset/Np B/Ni (-1)C-1/Np \\bigcap_e/Np \\in/Np C/Ni e/Ni với/E B/Ni là/V tập_hợp/N các/L tập_hợp/N A_i/Np ./CH\nTa/P cần/V chứng_minh/V một/M phần_tử/N bất_kì/R thuộc/V ít_nhất/A một_tập/Np A_i/Np ,/CH sẽ/R chỉ/R được/V đếm/V một_lần/Np trong/E công_thức/N ./CH\nXét/V một/M phần_tử/N x/CH bất_kì/R thuộc/V k/N \\geq/Np 1/M tập_hợp/N A_i/Np ./CH\nTa/P thấy/V Trong/E công_thức/N ,/CH khi/N C/Ni =/CH 1/M ,/CH x/CH được/V đếm/V thêm/V k/N lần/N ./CH\nTrong/E công_thức/N ,/CH khi/N C/Ni =/CH 2/M ,/CH x/CH được/V đếm/V bớt/V đi/V \\binomk2/Np lần/N bởi/E x/CH bị/V đếm/V bớt/V đi/V khi/N ta/P xét/V một/M cặp/N 2/M tập_hợp/N khác_nhau/Np trong/E số/N k/N tập_hợp/N chứa/V phần_tử/N x/CH ./CH\nTrong/E công_thức/N ,/CH khi/N C/Ni =/CH 3/M ,/CH x/CH được/V đếm/V thêm/V \\binomk3/Np lần/N ./CH\n./CH ./CH ./CH\nTrong/E công_thức/N ,/CH khi/N C/Ni =/CH k/N ,/CH x/CH được/V đếm/V \\binomkk/Np lần/N ./CH\nNếu/C k/N lẻ/A thì/C x/CH được/V đếm/V thêm/V ,/CH nếu/C k/N chẵn/Np thì/C x/CH được/V đếm/V bớt/V ./CH\nTrong/E công_thức/N ,/CH khi/N C/Ni gt;/Np k/N ,/CH x/CH không/R được/V đếm/V ./CH\nVì_vậy/C ,/CH số/N lần/N x/CH được/V đếm/V là/V T/Nu =/CH \\binomk1/Np -/CH \\binomk2/Np +/CH \\binomk3/Np -/CH ./CH ./CH ./CH\n+/CH (-1)i-1/Np ./CH \\binomki/Np +/CH ./CH ./CH ./CH\n+/CH (-1)k-1/Np ./CH \\binomkk/Np ./CH\nĐể/E tính/V T/Nu ,/CH ta/P khai_triển/Np (1-x)k/Np bằng/E nhị_thức/Np Niu-tơn/Np (Newton/Np binomial)/Np :/CH (1-x)k/Np =/CH \\binomk0/Np -/CH \\binomk1/Np ./CH x/CH +/CH \\binomk2/Np ./CH x2/Np -/CH \\binomk3/Np ./CH x3/Np +/CH ./CH ./CH ./CH\n+/CH (-1)k/Np ./CH \\binomkk/Np ./CH xk/Np ./CH\nTa/P thấy/V với/E x=1/Np ,/CH (1-x)k/Np =/CH T-1/Np ,/CH do_đó/C T/Nu =/CH (1-1)k+1/Np =/CH 1/M hay/Cc điều/N phải/V chứng_minh/V ./CH\nỨng_dụng/V :/CH Đếm_số/Np số_nguyên_tố/Np cùng_nhau/Np với/E một_số/L cho/E trước/E trong/E một/M đoạn/Nc Đây/P là/V một/M bài_toán/N dễ/A dựa/V trên/E công_thức/N bao_hàm/Np -/CH loại_trừ/V ./CH\nCho/E hai/M số_nguyên/Np n/Ny và/Cc r/Np ,/CH đếm_số/Np số_nguyên_tố/Np cùng_nhau/Np với/E n/Ny trong/E đoạn/Nc 1;r/Np ./CH\nThuật_toán/N :/CH Tìm/V phần/N bù/V (the/Np inverse)/Np :/CH Đếm_số/Np số_không/Np nguyên_tố/N cùng_nhau/Np với/E n/Ny ./CH\nXét/V các/L ước/V nguyên_tố/N của/E n/Ny ,/CH đánh_số/Np chúng/P từ/E 1/M đến/E k/N ./CH\nTa/P có_thể/R tính/V số/N số/N trong/E đoạn/Nc 1;r/Np chia_hết_cho/Np p_i/Np bằng/E công_thức/N \\fracrp_i/Np ./CH\nTuy_vậy/C ,/CH nếu/C ta/P chỉ/R tính/V tổng/N tất_cả/P các/L số/N này/P ,/CH ta/P sẽ/R ra/V kết/V qủa/Np sai/A ./CH\nĐó/P là/V do/E một_số/L số/N có_thể/R chia_hết_cho/Np nhiều/A p_i/Np ./CH\nVì_vậy/C ta/P cần/V sử_dụng/V đến/E công_thức/N bao_hàm/Np -/CH loại_trừ/V ./CH\nint/Np solve/Np (/CH int/Np n/Ny ,/CH int/Np r/Np )/CH vector/Np lt;/Np int/Np gt;/Np p/Ny ;/CH for/Np (/CH int/Np i/M =/CH 2/M ;/CH i/M i/M lt;=/Np n/Ny ;/CH ++/Np i/M )/CH if/Np (/CH n/Ny %/CH i/M ==/Np 0/M )/CH p/Ny ./CH\npush_back/Np (/CH i/M );/CH while/Np (/CH n/Ny %/CH i/M ==/Np 0/M )/CH n/Ny /=/Np i/M ;/CH if/Np (/CH n/Ny gt;/Np 1/M )/CH p/Ny ./CH\npush_back/Np (/CH n/Ny );/CH int/Np sum/Np =/CH 0/M ;/CH for/Np (/CH int/Np msk/Np =/CH 1/M ;/CH msk/Np lt;/Np (/CH 1/M lt;lt;/Np p/Ny ./CH\nsize/Nb ());/Np ++/Np msk/Np )/CH int/Np mult/Np =/CH 1/M ,/CH bits/Np =/CH 0/M ;/CH for/Np (/CH int/Np i/M =/CH 0/M ;/CH i/M lt;/Np (/CH int/Np )/CH p/Ny ./CH\nsize/Nb ();/Np ++/Np i/M )/CH if/Np (/CH msk/Np amp;/Np (/CH 1/M lt;lt;/Np i/M ))/Np ++/Np bits/Np ;/CH mult/Np =/CH p/Ny i/M ;/CH int/Np cur/Np =/CH r/Np //CH mult/Np ;/CH if/Np (/CH bits/Np %/CH 2/M ==/Np 1/M )/CH sum/Np +=/Np cur/Np ;/CH else_sum/Np -=/Np cur/Np ;/CH return/Np r/Np -/CH sum/Np ;/CH\n", "title": "Số học 7 - Bao hàm - Loại trừ (Inclusion-Exclusion)\n", "link": "http://vnoi.info/wiki/translate/he/Number-Theory-7\n"}