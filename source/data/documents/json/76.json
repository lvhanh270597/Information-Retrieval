{"content": "Nơi tổng_hợp và chia_sẻ những kiến_thức liên_quan tới giải_thuật nói_chung và lý_thuyết khoa_học máy_tính nói_riêng .\nin Trong loạt bài này mình giới_thiệu các thuật_toán thao_tác với các xâu kí_tự .\nChúng_ta bắt_đầu bằng bài_toán cơ_bản nhất : tìm sự xuất_hiện của một xâu kí_tự trong một văn_bản .\nVí_dụ : đoạn văn_bản và xâu mẫu , xuất_hiện ở vị_trí 7 của văn_bản .\nTrong ví_dụ này bảng_chữ_cái gồm các kí_tự latin viết thường . Chúng_ta bắt_đầu với thuật_toán trâu_bò (brute force) , đôi_khi còn gọi_là vét cạn .\nCác thuật_toán trâu_bò thường chậm tuy_nhiên dễ thiết_kế , cài_đặt và thường là bước_đầu tiên trước_khi chúng_ta phát_triển các thuật_toán cải_tiến cao_cấp hơn .\nÝ_tưởng của thuật_toán trâu_bò khá đơn_giản như_sau : bắt_đầu_từ kí_tự đầu_tiên của văn_bản , dịch dần xâu về bên phải từng kí_tự một .\nNếu ta dịch đến kí_tự thứ , so_sánh với .\nNếu ta tìm_thấy xâu mẫu , i . e , , ta trả về vị_trí .\nNếu_không ta tiếp_tục dịch sang vị_trí .\nGiả mã như_sau : Code của thuật_toán bằng C : Có_thể thấy với mỗi vòng_lặp , chúng_ta mất tối_đa phép so_sánh để kiểm_tra xâu có xuất_hiện trong văn_bản hay_không .\nDo_đó : Thuật_toán được Knuth , Morris và Pratt phát_triển vào năm 1977 là thuật_toán tìm_kiếm có thời_gian tuyến_tính .\nThuật_toán này chạy khá tốt trong thực_tế , tuy_nhiên cũng khá khó_hiểu , vì_thế khó_gỡ lỗi .\nTrước_hết_mình trình_bày một biến_thể của thuật_toán (biến thể này được trình_bày trong 1) với thời_gian tính cỡ .\nThuật_toán này có hai điểm mạnh : Mình khuyến_khích bạn_đọc thêm bài về để hiểu hơn về thuật_toán KMP . Ý_tưởng của thuật_toán KMP dựa trên quan_sát rằng trong thuật_toán trâu_bò có nhiều bước so_sánh dư_thừa .\nCụ_thể , khi so_sánh phần_tử với , nếu , ta đã có thông_tin : Thuật_toán trâu_bò dịch sang lên 1 đơn_vị bằng cách và thiết_lập biến chạy trên xâu mẫu mà thông_tin này .\nTrong phần này , thay_vì nói \"dịch xâu mẫu lên đơn vị\" ta sẽ nói \"lùi biến chạy về vị_trí \" .\nHai cách nói này về cơ_bản là tương_đương . Như_vậy tại_sao thông_tin này lại có_ích ?\nXét văn_bản và xâu mẫu trong ví_dụ đầu_tiên .\nKhi so_sánh với , chúng_ta thấy hai xâu này không khớp tại_vị trí () .\nThay_vì thiết_lập biến chạy như trong thuật_toán trâu_bò , ta thiết_lập và tiếp_tục so_sánh với .\nCứ làm như_vậy , thì mỗi vòng_lặp biến chạy trên văn_bản luôn tăng và do_đó thời_gian tính_toán sẽ là nếu_như ta có_thể tính được vị_trí cần lùi lại của biến chạy trong thời_gian .\nTại_sao trong ví_dụ trên ta lại lùi biến chạy về vị_trí .\nQuan_sát kĩ_ta thấy chúng_ta lùi về vị_trí là do , tức_là kết_thúc tại của khớp với bắt_đầu_từ của .\nTổng_kết lại , quy_luật lùi biến chạy như_sau : : Lùi về vị_trí sao_cho tiền_tố kết_thúc tại của (chính là ) khớp với hậu_tố bắt_đầu tại của (chính là ) và độ_dài của đoạn khớp này (chính là ) lớn nhất . Ta gọi kí_tự là kí_tự .\nTrong ví_dụ trên , nếu ta lùi lại thì khới với .\nNếu ta lùi lại thì khới với và độ_dài đoạn khớp này là .\nTương_tự , nếu ta lùi thì khới với và độ_dài đoạn khớp là .\nTheo luật trên , ta lùi về vị_trí sao_cho độ_dài đoạn khớp là lớn nhất , do_đó , ta lùi .\nNhận_xét thấy vị_trí lùi lại phụ_thuộc vào hai yếu_tố : Trường_hợp kí_tự chốt không xuất_hiện trong , ta lùi lại (hay nói_cách_khác ta dịch lên đơn vị) .\nVí_dụ nếu thì ta có_thể dịch lên đơn_vị .\nDựa trên nhận_xét trên , ta sẽ tính trước_mảng trong đó là giá_trị ta sẽ lùi lại nếu là kí_tự thứ trong bảng_chữ_cái và vị_trí xảy_ra không khớp là trong xâu mẫu .\nVí_dụ trong ví_dụ trên (tương đương với nếu ) và , thì .\nGiả_sử_ta đã tính được bảng bằng thủ_tục (ở dưới) , thuật_toán tìm xâu sẽ như_sau : Code của giả mã bằng C : Với mỗi vòng_lặp ta mất thời_gian , do_đó , tổng thời_gian là trong đó là thời_gian tính bảng .\nĐể tính bảng , ta sử_dụng chính ý_tưởng lùi biến chạy ở trên kết_hợp với quy_hoạch_động . Gọi_là mảng trong đó là chỉ_số lớn nhất sao_cho khớp với .\nGọi_là chỉ_số của trong bảng_chữ_cái .\nvà có_thể được tính thông_qua dựa trên công_thức quy_hoạch_động sau : Khởi tạo với mọi và (why ? ) .\nGiả mã như_sau : Code của giả mã bằng C : Do và chỉ phụ_thuộc vào , ta có_thể tiết_kiệm một_chút bộ_nhớ bằng cách chỉ dùng một biến thay_vì dùng cả mảng .\nDễ thấy thuật_toán trên mất thời_gian để cập_nhật bảng , do_đó : Trong thuật_toán trước , sự phụ_thuộc thời_gian vào kích_thước bảng_chữ_cái dường_như dễ_hiểu vì kí_tự chốt có_thể là bất_kì kí_tự nào trong bảng_chữ_cái .\nĐể xóa_bỏ sự phụ_thuộc này , ta chọn kí_tự chốt là .\nDo , kí_tự này luôn xuất_hiện trong .\nQuy_luật lùi biến chạy có_thể phát_biểu lại như_sau : : Lùi về vị_trí sao_cho tiền_tố kết_thúc tại của (chính là ) khớp với hậu_tố bắt_đầu tại của (chính là ) và độ_dài của đoạn khớp này (chính là ) lớn nhất . Sự khác_biệt cơ_bản giữa quy_luật 1 và quy_luật 3/2 đó là : sau mỗi lần lùi biến chạy , quy_luật 1 luôn đảm_bảo và do_đó ta tiếp_tục xét kí_tự tiếp_theo .\nCòn quy_luật 3/2 không đảm_bảo điều này , do_đó , sau mỗi lần lùi biến chạy , nếu , ta phải tiếp_tục lùi biến chạy một_lần nữa (nghe hơi giống đệ quy) .\nDường_như thuật_toán này mất nhiều phép so sa_nhơn thuật_toán trước .\nTuy_nhiên , phân_tích dưới_đây chỉ ra rằng số lần lùi lại như_vậy không nhiều . Do , quy_luật trên có_thể được phát_biểu lại như_sau : : Lùi về vị_trí sao_cho tiền_tố kết_thúc tại của (chính là ) khớp với hậu_tố bắt_đầu tại của (chính là ) và độ_dài của đoạn khớp này (chính là ) lớn nhất . Trong ví_dụ trên , nếu ta lùi lại thì tiền_tố của khới với hậu_tố .\nNếu ta lùi lại thì tiền_tố của với hậu_tố của và độ_dài đoạn khớp này là .\nTương_tự , nếu ta lùi thì với và độ_dài đoạn khớp là .\nTheo luật trên , ta lùi về vị_trí sao_cho độ_dài đoạn khớp là lớn nhất , do_đó , ta lùi . Theo quy_luật 2 , ta có_thể thấy vị_trí lùi lại chỉ phụ_thuộc vào vị_trí xảy_ra không khớp trong (chính là ) , không phụ_thuộc vào .\nGọi_là vị_trí phải lùi về khi .\nGiả_sử_ta đã tính được bằng thủ_tục (ở dưới) , thuật_toán tìm xâu sẽ như_sau : Code_bằng C của giả mã : Giả_sử thủ_tục () sử_dụng phép so_sánh , ta sẽ chứng_minh rằng số phép so_sánh của thuật_toán () là .\nKhông dễ để có_thể thấy được điều này vì sự xuất_hiện vòng_lặp while bên_trong vòng_lặp for .\nTrước_hết ta thấy sau mỗi phép so_sánh bằng () , cả và đều tăng lên 1 .\nDo_đó , số phép so_sánh bằng tối_đa là .\nVòng_lặp while giảm_giá_trị của mỗi khi ta bắt_gặp một_phép so_sánh không_bằng () .\nTuy_nhiên , số_lượng giảm của không_thể vượt_quá giá_trị mà đã tăng lên (sau mỗi phép so_sánh bằng) qua các vòng_lặp trước đó .\nĐiều đó có_nghĩa là tổng_số phép so_sánh không_bằng không_thể vượt_quá tổng_số phép so_sánh bằng , do_đó , tối_đa là .\nNhư_vậy , tổng_số phép so_sánh là .\ncó_thể được tính dựa vào định_nghĩa của và quy_luật 2 trong thời_gian .\nCụ_thể , để tính , ta sẽ kiểm_tra tất_cả các chỉ_số từ đến sao_cho khớp với và chọn ra chỉ_số lớn nhất thỏa_mãn điều_kiện này .\nTuy_nhiên , Knuth-Morris-Pratt chỉ ra rằng bảng có_thể được tính trong thời_gian bằng cách sửa_đổi thuật_toán đối_sánh với chính nó .\nCode_bằng C của giả mã : Tại_sao đối_sánh với chính nó lại cho ra kết_quả ta mong_muốn .\nVề_mặt trực_quan , để_ý quy_luật 3/2 , nếu thay trong quy_luật này bởi , và bởi , giá_trị trong quy_luật 3/2 chính là .\nThủ_tục về cơ_bản thực_thi quy_luật này , do_đó , ta có_thể sử_dụng chính thủ_tục này để tính . Một_cách hiểu khác của thủ_tục này là như_sau : giả_sử , ta biết rằng .\nDo_đó , ta tìm các , bắt_đầu_từ ứng_viên lớn nhất (chính là ) , sao_cho : Nếu thì chính là .\nNếu , ứng_viên tiếp_theo sẽ là (theo định_nghĩa của bảng ) , do_đó ở dòng () , ta gán .\nDo ta xét các ứng_cử_viên từ lớn đến nhỏ , giá_trị tìm được sẽ tương_ứng với đoạn khớp lớn nhất .\nPhân_tích tương_tự như_trên , số phép so_sánh trong thủ_tục là .\nDo_đó , Ví_dụ : bảng ứng với mẫu như_sau : Code : , , 1 Sedgewick , R . , Wayne , K .\n(2011) .\n, Chapter 5 .\nAddison-Wesley .\nISBN : 978-0-321-57351-3 2 Knuth , Donald_E . , James_H .\nMorris , Jr , and Vaughan_R .\nPratt .\nSIAM_Journal on Computing 6 . 2 (1977) : 323-350 .\n3 Jeff_Erickson , , UIUC .\n4 Cormen , Thomas_H . ; Leiserson , Charles_E . , Rivest , Ronald_L . , Stein , Clifford .\n, Chapter 32 .\nMIT_Press and McGraw-Hill (2001) .\nISBN 0-262-03293-7 , , Trackback link : Powered by and\n", "tagged": "Nơi/N tổng_hợp/V và/Cc chia_sẻ/V những/L kiến_thức/N liên_quan/V tới/E giải_thuật/Np nói_chung/X và/Cc lý_thuyết/Np khoa_học/N máy_tính/N nói_riêng/X ./CH\nin/V Trong/E loạt/N bài/N này/P mình/P giới_thiệu/V các/L thuật_toán/N thao_tác/V với/E các/L xâu/Np kí_tự/Np ./CH\nChúng_ta/P bắt_đầu/V bằng/E bài_toán/N cơ_bản/A nhất/A :/CH tìm/V sự/N xuất_hiện/V của/E một/M xâu/Np kí_tự/Np trong/E một/M văn_bản/N ./CH\nVí_dụ/C :/CH đoạn/Nc văn_bản/N và/Cc xâu/Np mẫu/N ,/CH xuất_hiện/V ở/E vị_trí/N 7/M của/E văn_bản/N ./CH\nTrong/E ví_dụ/C này/P bảng_chữ_cái/Np gồm/V các/L kí_tự/Np latin/Np viết/V thường/R ./CH Chúng_ta/P bắt_đầu/V với/E thuật_toán/N trâu_bò/N (brute/Np force)/Np ,/CH đôi_khi/R còn/R gọi_là/V vét/V cạn/A ./CH\nCác/L thuật_toán/N trâu_bò/N thường/R chậm/A tuy_nhiên/C dễ/A thiết_kế/V ,/CH cài_đặt/V và/Cc thường/R là/V bước_đầu/N tiên/N trước_khi/Np chúng_ta/P phát_triển/V các/L thuật_toán/N cải_tiến/V cao_cấp/A hơn/A ./CH\nÝ_tưởng/N của/E thuật_toán/N trâu_bò/N khá/R đơn_giản/A như_sau/Np :/CH bắt_đầu_từ/Np kí_tự/Np đầu_tiên/A của/E văn_bản/N ,/CH dịch/N dần/R xâu/Np về/E bên/N phải/V từng/R kí_tự/Np một/M ./CH\nNếu/C ta/P dịch/N đến/E kí_tự/Np thứ/N ,/CH so_sánh/V với/E ./CH\nNếu/C ta/P tìm_thấy/Np xâu/Np mẫu/N ,/CH i/M ./CH e/Ni ,/CH ,/CH ta/P trả/V về/E vị_trí/N ./CH\nNếu_không/Np ta/P tiếp_tục/V dịch/N sang/V vị_trí/N ./CH\nGiả/A mã/N như_sau/Np :/CH Code/Np của/E thuật_toán/N bằng/E C/Ni :/CH Có_thể/R thấy/V với/E mỗi/L vòng_lặp/Np ,/CH chúng_ta/P mất/V tối_đa/A phép/N so_sánh/V để/E kiểm_tra/V xâu/Np có/V xuất_hiện/V trong/E văn_bản/N hay_không/Np ./CH\nDo_đó/C :/CH Thuật_toán/N được/V Knuth/Np ,/CH Morris/Np và/Cc Pratt/Np phát_triển/V vào/E năm/N 1977/M là/V thuật_toán/N tìm_kiếm/V có/V thời_gian/N tuyến_tính/Np ./CH\nThuật_toán/N này/P chạy/V khá/R tốt/A trong/E thực_tế/N ,/CH tuy_nhiên/C cũng/R khá/R khó_hiểu/Np ,/CH vì_thế/C khó_gỡ/Np lỗi/N ./CH\nTrước_hết_mình/Np trình_bày/V một/M biến_thể/N của/E thuật_toán/N (biến/Np thể/N này/P được/V trình_bày/V trong/E 1)/Np với/E thời_gian/N tính/V cỡ/N ./CH\nThuật_toán/N này/P có/V hai/M điểm/N mạnh/A :/CH Mình/P khuyến_khích/V bạn_đọc/N thêm/V bài/N về/E để/E hiểu/V hơn/A về/E thuật_toán/N KMP/Np ./CH Ý_tưởng/N của/E thuật_toán/N KMP/Np dựa/V trên/E quan_sát/V rằng/C trong/E thuật_toán/N trâu_bò/N có/V nhiều/A bước/V so_sánh/V dư_thừa/N ./CH\nCụ_thể/A ,/CH khi/N so_sánh/V phần_tử/N với/E ,/CH nếu/C ,/CH ta/P đã/R có/V thông_tin/N :/CH Thuật_toán/N trâu_bò/N dịch/N sang/V lên/V 1/M đơn_vị/N bằng/E cách/N và/Cc thiết_lập/V biến/V chạy/V trên/E xâu/Np mẫu/N mà/C thông_tin/N này/P ./CH\nTrong/E phần/N này/P ,/CH thay_vì/X nói/V \"dịch/Np xâu/Np mẫu/N lên/V đơn/N vị\"/Np ta/P sẽ/R nói/V \"lùi/Np biến/V chạy/V về/E vị_trí/N \"/CH ./CH\nHai/M cách/N nói/V này/P về/E cơ_bản/A là/V tương_đương/A ./CH Như_vậy/X tại_sao/X thông_tin/N này/P lại/R có_ích/A ?/CH\nXét/V văn_bản/N và/Cc xâu/Np mẫu/N trong/E ví_dụ/C đầu_tiên/A ./CH\nKhi/N so_sánh/V với/E ,/CH chúng_ta/P thấy/V hai/M xâu/Np này/P không/R khớp/N tại_vị/Np trí/Np ()/Np ./CH\nThay_vì/X thiết_lập/V biến/V chạy/V như/C trong/E thuật_toán/N trâu_bò/N ,/CH ta/P thiết_lập/V và/Cc tiếp_tục/V so_sánh/V với/E ./CH\nCứ/R làm/V như_vậy/X ,/CH thì/C mỗi/L vòng_lặp/Np biến/V chạy/V trên/E văn_bản/N luôn/R tăng/V và/Cc do_đó/C thời_gian/N tính_toán/V sẽ/R là/V nếu_như/C ta/P có_thể/R tính/V được/V vị_trí/N cần/V lùi/V lại/R của/E biến/V chạy/V trong/E thời_gian/N ./CH\nTại_sao/X trong/E ví_dụ/C trên/E ta/P lại/R lùi/V biến/V chạy/V về/E vị_trí/N ./CH\nQuan_sát/V kĩ_ta/Np thấy/V chúng_ta/P lùi/V về/E vị_trí/N là/V do/E ,/CH tức_là/V kết_thúc/V tại/E của/E khớp/N với/E bắt_đầu_từ/Np của/E ./CH\nTổng_kết/V lại/R ,/CH quy_luật/N lùi/V biến/V chạy/V như_sau/Np :/CH :/CH Lùi/V về/E vị_trí/N sao_cho/Np tiền_tố/Np kết_thúc/V tại/E của/E (chính/Np là/V )/CH khớp/N với/E hậu_tố/Np bắt_đầu/V tại/E của/E (chính/Np là/V )/CH và/Cc độ_dài/Np của/E đoạn/Nc khớp/N này/P (chính/Np là/V )/CH lớn/A nhất/A ./CH Ta/P gọi/V kí_tự/Np là/V kí_tự/Np ./CH\nTrong/E ví_dụ/C trên/E ,/CH nếu/C ta/P lùi/V lại/R thì/C khới/Np với/E ./CH\nNếu/C ta/P lùi/V lại/R thì/C khới/Np với/E và/Cc độ_dài/Np đoạn/Nc khớp/N này/P là/V ./CH\nTương_tự/A ,/CH nếu/C ta/P lùi/V thì/C khới/Np với/E và/Cc độ_dài/Np đoạn/Nc khớp/N là/V ./CH\nTheo/V luật/N trên/E ,/CH ta/P lùi/V về/E vị_trí/N sao_cho/Np độ_dài/Np đoạn/Nc khớp/N là/V lớn/A nhất/A ,/CH do_đó/C ,/CH ta/P lùi/V ./CH\nNhận_xét/N thấy/V vị_trí/N lùi/V lại/R phụ_thuộc/V vào/E hai/M yếu_tố/N :/CH Trường_hợp/N kí_tự/Np chốt/V không/R xuất_hiện/V trong/E ,/CH ta/P lùi/V lại/R (hay/Np nói_cách_khác/Np ta/P dịch/N lên/V đơn/N vị)/Np ./CH\nVí_dụ/C nếu/C thì/C ta/P có_thể/R dịch/N lên/V đơn_vị/N ./CH\nDựa/V trên/E nhận_xét/N trên/E ,/CH ta/P sẽ/R tính/V trước_mảng/Np trong/E đó/P là/V giá_trị/N ta/P sẽ/R lùi/V lại/R nếu/C là/V kí_tự/Np thứ/N trong/E bảng_chữ_cái/Np và/Cc vị_trí/N xảy_ra/Np không/R khớp/N là/V trong/E xâu/Np mẫu/N ./CH\nVí_dụ/C trong/E ví_dụ/C trên/E (tương/Np đương/Np với/E nếu/C )/CH và/Cc ,/CH thì/C ./CH\nGiả_sử_ta/Np đã/R tính/V được/V bảng/N bằng/E thủ_tục/N (ở/Np dưới)/Np ,/CH thuật_toán/N tìm/V xâu/Np sẽ/R như_sau/Np :/CH Code/Np của/E giả/A mã/N bằng/E C/Ni :/CH Với/E mỗi/L vòng_lặp/Np ta/P mất/V thời_gian/N ,/CH do_đó/C ,/CH tổng/N thời_gian/N là/V trong/E đó/P là/V thời_gian/N tính/V bảng/N ./CH\nĐể/E tính/V bảng/N ,/CH ta/P sử_dụng/V chính/T ý_tưởng/N lùi/V biến/V chạy/V ở/E trên/E kết_hợp/V với/E quy_hoạch_động/Np ./CH Gọi_là/V mảng/N trong/E đó/P là/V chỉ_số/N lớn/A nhất/A sao_cho/Np khớp/N với/E ./CH\nGọi_là/V chỉ_số/N của/E trong/E bảng_chữ_cái/Np ./CH\nvà/Cc có_thể/R được/V tính/V thông_qua/V dựa/V trên/E công_thức/N quy_hoạch_động/Np sau/E :/CH Khởi/V tạo/V với/E mọi/L và/Cc (why/Np ?/CH )/CH ./CH\nGiả/A mã/N như_sau/Np :/CH Code/Np của/E giả/A mã/N bằng/E C/Ni :/CH Do/E và/Cc chỉ/R phụ_thuộc/V vào/E ,/CH ta/P có_thể/R tiết_kiệm/V một_chút/L bộ_nhớ/Np bằng/E cách/N chỉ/R dùng/V một/M biến/V thay_vì/X dùng/V cả/P mảng/N ./CH\nDễ/A thấy/V thuật_toán/N trên/E mất/V thời_gian/N để/E cập_nhật/V bảng/N ,/CH do_đó/C :/CH Trong/E thuật_toán/N trước/E ,/CH sự/N phụ_thuộc/V thời_gian/N vào/E kích_thước/N bảng_chữ_cái/Np dường_như/X dễ_hiểu/Np vì/E kí_tự/Np chốt/V có_thể/R là/V bất_kì/R kí_tự/Np nào/P trong/E bảng_chữ_cái/Np ./CH\nĐể/E xóa_bỏ/V sự/N phụ_thuộc/V này/P ,/CH ta/P chọn/V kí_tự/Np chốt/V là/V ./CH\nDo/E ,/CH kí_tự/Np này/P luôn/R xuất_hiện/V trong/E ./CH\nQuy_luật/N lùi/V biến/V chạy/V có_thể/R phát_biểu/V lại/R như_sau/Np :/CH :/CH Lùi/V về/E vị_trí/N sao_cho/Np tiền_tố/Np kết_thúc/V tại/E của/E (chính/Np là/V )/CH khớp/N với/E hậu_tố/Np bắt_đầu/V tại/E của/E (chính/Np là/V )/CH và/Cc độ_dài/Np của/E đoạn/Nc khớp/N này/P (chính/Np là/V )/CH lớn/A nhất/A ./CH Sự/N khác_biệt/A cơ_bản/A giữa/N quy_luật/N 1/M và/Cc quy_luật/N 3/M đó/P là/V :/CH sau/E mỗi/L lần/N lùi/V biến/V chạy/V ,/CH quy_luật/N 1/M luôn/R đảm_bảo/V và/Cc do_đó/C ta/P tiếp_tục/V xét/V kí_tự/Np tiếp_theo/V ./CH\nCòn/R quy_luật/N 3/M không/R đảm_bảo/V điều/N này/P ,/CH do_đó/C ,/CH sau/E mỗi/L lần/N lùi/V biến/V chạy/V ,/CH nếu/C ,/CH ta/P phải/V tiếp_tục/V lùi/V biến/V chạy/V một_lần/Np nữa/R (nghe/Np hơi/R giống/N đệ/N quy)/Np ./CH\nDường_như/X thuật_toán/N này/P mất/V nhiều/A phép/N so/V sa_nhơn/Np thuật_toán/N trước/E ./CH\nTuy_nhiên/C ,/CH phân_tích/V dưới_đây/Np chỉ/R ra/V rằng/C số/N lần/N lùi/V lại/R như_vậy/X không/R nhiều/A ./CH Do/E ,/CH quy_luật/N trên/E có_thể/R được/V phát_biểu/V lại/R như_sau/Np :/CH :/CH Lùi/V về/E vị_trí/N sao_cho/Np tiền_tố/Np kết_thúc/V tại/E của/E (chính/Np là/V )/CH khớp/N với/E hậu_tố/Np bắt_đầu/V tại/E của/E (chính/Np là/V )/CH và/Cc độ_dài/Np của/E đoạn/Nc khớp/N này/P (chính/Np là/V )/CH lớn/A nhất/A ./CH Trong/E ví_dụ/C trên/E ,/CH nếu/C ta/P lùi/V lại/R thì/C tiền_tố/Np của/E khới/Np với/E hậu_tố/Np ./CH\nNếu/C ta/P lùi/V lại/R thì/C tiền_tố/Np của/E với/E hậu_tố/Np của/E và/Cc độ_dài/Np đoạn/Nc khớp/N này/P là/V ./CH\nTương_tự/A ,/CH nếu/C ta/P lùi/V thì/C với/E và/Cc độ_dài/Np đoạn/Nc khớp/N là/V ./CH\nTheo/V luật/N trên/E ,/CH ta/P lùi/V về/E vị_trí/N sao_cho/Np độ_dài/Np đoạn/Nc khớp/N là/V lớn/A nhất/A ,/CH do_đó/C ,/CH ta/P lùi/V ./CH Theo/V quy_luật/N 2/M ,/CH ta/P có_thể/R thấy/V vị_trí/N lùi/V lại/R chỉ/R phụ_thuộc/V vào/E vị_trí/N xảy_ra/Np không/R khớp/N trong/E (chính/Np là/V )/CH ,/CH không/R phụ_thuộc/V vào/E ./CH\nGọi_là/V vị_trí/N phải/V lùi/V về/E khi/N ./CH\nGiả_sử_ta/Np đã/R tính/V được/V bằng/E thủ_tục/N (ở/Np dưới)/Np ,/CH thuật_toán/N tìm/V xâu/Np sẽ/R như_sau/Np :/CH Code_bằng/Np C/Ni của/E giả/A mã/N :/CH Giả_sử/Np thủ_tục/N ()/Np sử_dụng/V phép/N so_sánh/V ,/CH ta/P sẽ/R chứng_minh/V rằng/C số/N phép/N so_sánh/V của/E thuật_toán/N ()/Np là/V ./CH\nKhông/R dễ/A để/E có_thể/R thấy/V được/V điều/N này/P vì/E sự/N xuất_hiện/V vòng_lặp/Np while/Np bên_trong/Np vòng_lặp/Np for/Np ./CH\nTrước_hết/N ta/P thấy/V sau/E mỗi/L phép/N so_sánh/V bằng/E ()/Np ,/CH cả/P và/Cc đều/R tăng/V lên/V 1/M ./CH\nDo_đó/C ,/CH số/N phép/N so_sánh/V bằng/E tối_đa/A là/V ./CH\nVòng_lặp/Np while/Np giảm_giá_trị/Np của/E mỗi/L khi/N ta/P bắt_gặp/V một_phép/Np so_sánh/V không_bằng/Np ()/Np ./CH\nTuy_nhiên/C ,/CH số_lượng/N giảm/V của/E không_thể/R vượt_quá/Np giá_trị/N mà/C đã/R tăng/V lên/V (sau/Np mỗi/L phép/N so_sánh/V bằng)/Np qua/V các/L vòng_lặp/Np trước/E đó/P ./CH\nĐiều/N đó/P có_nghĩa/A là/V tổng_số/N phép/N so_sánh/V không_bằng/Np không_thể/R vượt_quá/Np tổng_số/N phép/N so_sánh/V bằng/E ,/CH do_đó/C ,/CH tối_đa/A là/V ./CH\nNhư_vậy/X ,/CH tổng_số/N phép/N so_sánh/V là/V ./CH\ncó_thể/R được/V tính/V dựa/V vào/E định_nghĩa/N của/E và/Cc quy_luật/N 2/M trong/E thời_gian/N ./CH\nCụ_thể/A ,/CH để/E tính/V ,/CH ta/P sẽ/R kiểm_tra/V tất_cả/P các/L chỉ_số/N từ/E đến/E sao_cho/Np khớp/N với/E và/Cc chọn/V ra/V chỉ_số/N lớn/A nhất/A thỏa_mãn/V điều_kiện/N này/P ./CH\nTuy_nhiên/C ,/CH Knuth-Morris-Pratt/Np chỉ/R ra/V rằng/C bảng/N có_thể/R được/V tính/V trong/E thời_gian/N bằng/E cách/N sửa_đổi/V thuật_toán/N đối_sánh/Np với/E chính/T nó/P ./CH\nCode_bằng/Np C/Ni của/E giả/A mã/N :/CH Tại_sao/X đối_sánh/Np với/E chính/T nó/P lại/R cho/E ra/V kết_quả/N ta/P mong_muốn/V ./CH\nVề_mặt/Np trực_quan/Np ,/CH để_ý/V quy_luật/N 3/M ,/CH nếu/C thay/V trong/E quy_luật/N này/P bởi/E ,/CH và/Cc bởi/E ,/CH giá_trị/N trong/E quy_luật/N 3/M chính/T là/V ./CH\nThủ_tục/N về/E cơ_bản/A thực_thi/V quy_luật/N này/P ,/CH do_đó/C ,/CH ta/P có_thể/R sử_dụng/V chính/T thủ_tục/N này/P để/E tính/V ./CH Một_cách/N hiểu/V khác/A của/E thủ_tục/N này/P là/V như_sau/Np :/CH giả_sử/Np ,/CH ta/P biết/V rằng/C ./CH\nDo_đó/C ,/CH ta/P tìm/V các/L ,/CH bắt_đầu_từ/Np ứng_viên/N lớn/A nhất/A (chính/Np là/V )/CH ,/CH sao_cho/Np :/CH Nếu/C thì/C chính/T là/V ./CH\nNếu/C ,/CH ứng_viên/N tiếp_theo/V sẽ/R là/V (theo/Np định_nghĩa/N của/E bảng/N )/CH ,/CH do_đó/C ở/E dòng/N ()/Np ,/CH ta/P gán/V ./CH\nDo/E ta/P xét/V các/L ứng_cử_viên/N từ/E lớn/A đến/E nhỏ/A ,/CH giá_trị/N tìm/V được/V sẽ/R tương_ứng/V với/E đoạn/Nc khớp/N lớn/A nhất/A ./CH\nPhân_tích/V tương_tự/A như_trên/Np ,/CH số/N phép/N so_sánh/V trong/E thủ_tục/N là/V ./CH\nDo_đó/C ,/CH Ví_dụ/C :/CH bảng/N ứng/V với/E mẫu/N như_sau/Np :/CH Code/Np :/CH ,/CH ,/CH 1/M Sedgewick/Np ,/CH R/Np ./CH ,/CH Wayne/Np ,/CH K/N ./CH\n(2011)/Np ./CH\n,/CH Chapter/Np 5/M ./CH\nAddison-Wesley/Np ./CH\nISBN/Np :/CH 978-0-321-57351-3/Np 2/M Knuth/Np ,/CH Donald_E/Np ./CH ,/CH James_H/Np ./CH\nMorris/Np ,/CH Jr/Np ,/CH and/Np Vaughan_R/Np ./CH\nPratt/Np ./CH\nSIAM_Journal/Np on/Np Computing/Np 6/M ./CH 2/M (1977)/Np :/CH 323-350/Np ./CH\n3/M Jeff_Erickson/Np ,/CH ,/CH UIUC/Np ./CH\n4/M Cormen/Np ,/CH Thomas_H/Np ./CH ;/CH Leiserson/Np ,/CH Charles_E/Np ./CH ,/CH Rivest/Np ,/CH Ronald_L/Np ./CH ,/CH Stein/Np ,/CH Clifford/Np ./CH\n,/CH Chapter/Np 32/M ./CH\nMIT_Press/Np and/Np McGraw-Hill/Np (2001)/Np ./CH\nISBN/Np 0-262-03293-7/Np ,/CH ,/CH Trackback/Np link/Np :/CH Powered/Np by/Np and/Np\n", "title": "Thuật toán Knuth-Morris-Pratt -- KMP string matching\n", "link": "http://www.giaithuatlaptrinh.com/?p=238\n"}