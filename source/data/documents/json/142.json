{"content": "Table of_Contents Vài nét lịch_sử Phép_nhân hai đa_thức Biểu_diễn đa_thức qua ma_trận Vandermonde_Nghiệm nguyên_thủy Một_số tính_chất đặc_biệt của ma_trận Vandermonde nghiệm nguyên_thủy Phép biến_đổi Fourier nhanh Thuật_toán nhân hai đa_thức Lưu_ý về kỹ_thuật cài_đặt Khai_báo Chuẩn hóa bậc đa_thức Đệ_quy và Khử đệ_quy Bài_tập luyện_tập Tài_liệu tham_khảo Tác_giả : ngmq Trong bài này chúng_ta sẽ tìm_hiểu về thuật_toán nhân nhanh hai đa_thức sử_dụng phép biến_đổi Fourier nhanh ( Fast_Fourier_Transform - FFT ) và cách cài_đặt của nó .\nBài viết này sẽ chỉ nêu chứng_minh sơ_lược của một_vài tính_chất được sử_dụng .\nCác chứng_minh chi_tiết có_thể tìm_thấy ở mục tài_liệu tham_khảo phía cuối của bài viết .\nVài nét lịch_sử Phép biến_đổi Fourier ( Fourier_Transform ) là một trong số những phát_kiến toán_học đặc_sắc có lịch_sử hào_hùng , gắn_liền với những phát_kiến khoa_học và chiến_tranh quân_sự ở thế_kỷ 19 và 20 .\nJoseph_Fourier (1768-1830) là một nhà_khoa_học làm_việc trong đội_quân thám_hiểm Ai_Cập của Napoleon từ năm 1798 .\nSau khi cách_mạng Pháp kết_thúc năm 1799 , Fourier trở_về Pháp và tham_gia xây_dựng lại đất_nước trong vai_trò một giáo_sư của đại_học École_Polytechnique .\nTrong quá_trình làm_việc với các công_trình xây_dựng cầu_đường và đóng tàu , ông đặc_biệt quan_tâm tới bài_toán mô_tả quá_trình truyền_dẫn nhiệt trong kim_loại , điều dẫn tới sự ra_đời của phép biến_đổi Fourier liên_tục vào năm 1807 trong một báo_cáo của ông tại viện hoàng_gia Paris .\nTrong đó , ông mô_tả mọi hàm_số , kể_cả các hàm_số không liên_tục đều có_thể được biểu_diễn dưới dạng tổng của một_số vô_hạn các hàm_số lượng_giác .\nPhát_biểu này của Fourier gây chấn_động và ấn_tượng tới_mức nhà toán_học Pháp cùng_thời là Lagrange cho_rằng việc nghĩ_ra phát_kiến này là gần_như không_thể (\"nothing short of impossible\") 1 .\nTrong hơn một trăm_năm sau_đó phép biến_đổi Fourier trở_thành một đối_tượng nghiên_cứu_phổ biến và liên_tục được phát_triển , hoàn_thiện bởi vô_số các tên_tuổi lớn của toán lý_thuyết 2 .\nTrong_khi phiên_bản nguyên_thủy có lịch_sử hoành_tráng như_vậy , phép biến_đổi Fourier nhanh , dù được cho_là ra_đời trước , lại được quan_tâm chậm hơn nhiều .\nNgười_ta cho_rằng những ý_tưởng đầu_tiên về biến_đổi Fourier nhanh được phát_triển bởi nhà toán_học Đức_Carl_Friedrich_Gauss (1777 - 1855) vào năm 1805 khi ông cố_gắng xác_định quỹ_đạo của các thiên_thạch 3 , nhưng khi đó ông không công_bố kết_quả của mình .\nMối liên_hệ giữa Gauss và phép biến_đổi Fourier nhanh chỉ được phát_hiện khi các công_trình của ông được tập_hợp và công_bố vào năm 1866 .\nMặc_dù vậy , vào thời đó không có ai quan_tâm tới công_trình này vì lý_thuyết độ phức_tạp tính_toán chưa phát_triển (mãi tới năm 1936 Alan_Turing mới phát_triển mô_hình tính_toán đầu_tiên , và phải tới năm 1965 thì lịch_sử ngành nghiên_cứu về độ phức_tạp tính_toán mới bắt_đầu với công_trình của Hartmanis và Stearns 4) .\nCũng trong năm 1965 hai nhà toán_học trong ban cố_vấn khoa_học của tổng_thống Mỹ_Kennedy là James_Cooley và John_Tukey đã tự tìm_ra phép biến_đổi nhanh Fourier trong_khi thiết_kế hệ_thống phát_hiện các vụ thử hạt_nhân của chính_quyền Xô_Viết 3 .\nKể_từ thời_điểm đó phép biến_đổi nhanh Fourier mới chính_thức được quan_tâm và nghiên_cứu ứng_dụng trong rất nhiều các lĩnh_vực nghiên_cứu khác_nhau của vật_lý , sinh_học , điện_tử , y_tế , điều_khiển_học . . .\nNghiên_cứu chỉ ra rằng mắt và tai người , động_vật có \"cài đặt\" sẵn thuật_toán biến_đổi Fourier để giúp chúng_ta nhìn và nghe , vì_vậy nó được GS_Ronald_Coifman của đại_học Yale gọi_là Phương_pháp phân_tích dữ_liệu của tự_nhiên (\"Natures way of analyzing data\") 1 .\nPhép_nhân hai đa_thức Cho hai đa_thức p(x) , q(x) có bậc d , e như_sau : p(x) = a_0 + a_1 x + a_2 x2 + . . .\n+ a_d xd q(x) = b_0 + b_1 x + b_2 x2 + . . .\n+ b_e xe Ta cần tìm tích c(x) của hai đa_thức trên , có dạng : c(x) = p(x)q(x) = c_0 + c_1 x + c_x x2 + . . .\n+ c_d+e xd+e trong đó c_j = \\sum_i=0j a_ib_j-i \\qquad j = 0 , 1 , . . . , d+e Cách làm_theo định_nghĩa_là ta nhân mỗi hệ_số của p(x) với tất_cả các hệ_số của q(x) rồi cộng các hệ_số của cùng tổng_số mũ .\nVì hai đa_thức có d+1 và e+1 hệ_số nên cách làm này có độ phức_tạp là O((d+1)(e+1)) = O(de) .\nKhi d và e tương_đối lớn cỡ 103 hoặc 104 trở_lên thì độ phức_tạp này là quá lớn để chạy trên máy_tính , đặc_biệt là các máy_tính nhúng đòi_hỏi tốc_độ tính_toán nhanh .\nPhép biến_đổi FFT giúp thực_hiện phép_nhân nói trên trong độ phức_tạp O(NlogN) trong đó N là lũy_thừa của 2 nhỏ nhất lớn hơn d và e .\nBiểu_diễn đa_thức qua ma_trận Vandermonde Kể_từ phần này trở_về sau , ta quy_ước n là số_hệ số của đa_thức (bậc n-1) và n là một_lũy thừa của 2 (n = 2 , 4 , 8 , 16 , 32 , 64 . . . ) .\nXét đa_thức p(x) = a_0 + a_1 x + a_2 x2 + . . .\n+ a_n-1 xn-1 với bậc n-1 và các hệ_số_phức a_i \\in \\mathbbC .\nBiểu_thức tính n giá_trị của p(x) tại n điểm z_0 , z_1 , . . .\nz_n-1 có_thể biểu_diễn qua phép_nhân ma_trận như_sau : \\beginbmatrix 1 amp; z_01 amp; z_02 amp; \\dots amp; z_0n-1 \\newline 1 amp; z_1 amp; z_12 amp; \\dots amp; z_1n-1 \\newline \\ldots amp; \\ldots amp; \\ldots amp; \\ldots amp; \\ldots\\newline 1 amp; z_n-11 amp; z_n-12 amp; \\dots amp; z_n-1n-1 \\endbmatrix \\beginbmatrix a_0 \\newline a_1 \\newline \\vdots \\newline a_n-1 \\endbmatrix = \\beginbmatrix p(z_0) \\newline p(z_1) \\newline \\vdots \\newline p(z_n-1) \\endbmatrix \\space (1) Ma_trận vuông V kích_cỡ nn của z_0 : n-1 ở trên được gọi_là ma_trận Vandermonde .\nTa có các định_lý sau : Định_lý 1 : Định_thức của ma_trận Vandermonde là det(V) = \\prod_0 \\leq i lt; j \\leq n-1(z_j - z_i) Chứng_minh (sơ lược) : Với mỗi hàng i = 0 , 1 , . . . n-2 của định_thức ta liên_tục thay hàng j = i+1 , i+2 , . . . n-1 bằng hiệu của các hệ_số của hàng j trừ đi hàng i .\nĐây là phép biến_đổi cơ_bản ( elementary operation ) nên giá_trị định_thức cần tính không_đổi .\nLấy nhân_tử chung z_j - z_i ở tất_cả các hàng ra ngoài và xét tiếp hàng i+1 .\nSau khi xét xong i = n-2 ta được một ma_trận chéo có đường_chéo chỉ gồm z_ii = 1 , định_thức của ma_trận này hiển_nhiên bằng 1 .\nVì_vậy định_thức cần tính là tích của tất_cả các nhân_tử chung bỏ ra ngoài ở các bước trước đó .\nPhép chứng_minh bằng quy_nạp có_thể xem thêm tại đây Định_lý 2 : Đa_thức p(x) được xác_định duy_nhất bởi các giá_trị của nó p(z_0) , p(z_1) , . . .\np(z_n-1) khi n giá_trị z_0 , z_1 , . . .\nz_n-1 phân_biệt .\nTa gọi đây là phép biến_đổi ngược .\nChứng_minh : Coi phương_trình (1) là một hệ_phương_trình n ẩn với bộ nghiệm a_0 , a_1 , . . . a_n-1 .\nĐể đa_thức p(x) xác_định và duy_nhất thì định_thức của ma_trận V ở trên phải khác 0 .\nTheo Định_lý 1 ta có_điều phải chứng_minh .\nHệ_quả : khi V khả_nghịch , hệ_số a_0 , a_1 , . . . a_n-1 được xác_định thông_qua tích của ma_trận nghịch_đảo V-1 của V và p(z_0) , p(z_1) , . . . p(z_n-1) .\nTừ định_lý 2 , ta thấy rằng 1 đa_thức bất_kỳ có 2 cách biểu_diễn : Dùng n hệ_số a_i Dùng n cặp giá_trị z_i , p(z_i) .\nĐây chính là nền_tảng của việc tính nhanh tích của 2 đa_thức sử_dụng FFT : Chọn 1 dãy z_i gồm N phần_tử .\nz_i có_thể chọn tuỳ_ý miễn_sao giá_trị của chúng là đôi một khác_nhau để các đa_thức p(x) , q(x) và c(x) là xác_định và duy_nhất .\nChuyển 2 đa_thức p(x) và q(x) sang cách biểu_diễn 2 .\n(dùng FFT)_Tính tích của 2 đa_thức trong cách biểu_diễn 2 trong O(N) .\nĐiều này cực_kỳ đơn_giản , vì khi ta đã cố_định dãy z_i , ta có_thể tính tất_cả c(z_i) = p(z_i) q(z_i) trong O(N) .\nChuyển đa_thức c(x) về cách biểu_diễn 1 (dùng FFT) .\nNghiệm nguyên_thủy Như đã phân_tích ở trên , ta cần chọn dãy z_i sao_cho việc biến_đổi đa_thức giữa 2 cách biểu_diễn có_thể thực_hiện một_cách hiệu_quả .\nNếu ta chọn z_i là các nghiệm nguyên_thủy thoả_mãn : zn = 1 \\qquad z \\in \\mathbbC \\qquad (2) với n như đã quy_ước và cũng là số nghiệm của phương_trình (2) mà ta cần .\nCông_thức Euler xác_định nghiệm thứ k của phương_trình (2) là z_k = w_nk = (e 2\\pi i\\over n)k = e 2\\pi ik\\over n = cos2\\pi k\\over n + isin2\\pi k\\over n \\qquad k = 0 , 1 , . . .\nn - 1 trong đó w_n là nghiệm mũ 1 : w_n = e 2\\pi i\\over n = cos2\\pi\\over n + isin2\\pi\\over n Dễ thấy là nghiệm nguyên_thủy thứ k có_thể được tính trong O(1) với n đã biết .\nMột_số tính_chất đặc_biệt của ma_trận Vandermonde nghiệm nguyên_thủy Tính_chất 1 : Ma_trận nghịch_đảo V-1 được tính theo công_thức : V-1i , j = Vi , j-1 \\over n với i , j = 0 , 1 , . . . n-1 là chỉ_số hàng và cột của ma_trận .\nChứng_minh (sơ lược) : gọi B là ma_trận kích_cỡ n n tạo bởi Bi , j = Vi , j-1 \\qquad \\forall i , j = 0 , 1 , . . . n-1 Ta sẽ chứng_minh tích P = B_V = V_B = n I , trong đó I là ma_trận đơn_vị .\nXét phép_nhân hàng i của ma_trận V và cột k của ma_trận B , ta có : Pi , k = \\sum_j=0n-1w_nijw_n-jk = \\sum_j=0n-1w_nj(i-k) Nếu i = k : Pi , k = Pi , i = \\sum_j=0n-1w_n0 = n \\qquad \\forall i = 0 , 1 , . . . n-1 .\nNếu i \\neq k : Pi , k = \\sum_j=0n-1w_ni-kj = 1 - w_ni-kn \\over 1-w_ni-k = 0 Vậy_P = nI hay_là V_B/n = B/n_V = I , vậy B = V-1 .\nHệ_quả : Độ phức_tạp tính_toán cho V-1 bằng với độ phức_tạp tính V .\nTính_chất 2 : Chia ma_trận V thành 4 phần bằng_nhau kích_cỡ n/2 n/2 theo 2 tiêu_chí : độ lớn của hàng so_với n/2 và tính chẵn_lẻ của các cột .\nPhần_I gồm các phần_tử có chỉ_số hàng 0 , 1 , . . . n/2 - 1 và chỉ_số cột là chẵn 0 , 2 , 4 , . . . n-2 .\nPhần_II gồm các phần_tử có chỉ_số hàng 0 , 1 , . . . n/2 - 1 và chỉ_số cột là lẻ 1 , 3 , 5 , . . . n-1 .\nPhần_III gồm các phần_tử có chỉ_số hàng n/2 , n/2+1 , . . . n-1 và chỉ_số cột là chẵn 0 , 2 , 4 , . . . n-2 .\nPhần_IV gồm các phần_tử có chỉ_số hàng n/2 , n/2+1 , . . . n-1 và chỉ_số cột là lẻ 1 , 3 , 5 , . . . n-1 .\n( Image_Courtesy of Aalto_University ) Nói_cách_khác , ta tạo một ma_trận mới K bằng cách chuyển tất_cả các cột có chỉ_số_chẵn của ma_trận V lên trước , các cột có chỉ_số lẻ về_sau , giữ_nguyên thứ_tự tương_đối của các cột cùng chỉ_số_chẵn hoặc cùng chỉ_số lẻ .\nỞ ma_trận K này cột n-2 của V nằm ngay trước cột 1 của V .\nBốn phần I , II , III , IV được tạo bởi cắt đều ma_trận K thành 4 phần bằng_nhau .\nKý_hiệu K_I , K_II , K_III , K_IV là bốn ma_trận con của K .\nTất_cả các phần_tử trong phần II , III , IV đều có_thể tính được từ phần I theo công_thức sau : K_IIi , j = w_ni K_Ii , j \\qquad \\forall i , j = 0 , 1 , . . . n/2 - 1 K_IIIi , j = K_Ii , j \\qquad \\forall i , j = 0 , 1 , . . . n/2 - 1 K_IVi , j = -w_ni K_Ii , j \\qquad \\forall i , j = 0 , 1 , . . . n/2 - 1 Chứng_minh : các bạn tự chứng_minh hoặc xem slide số 23 trong tài_liệu của trường DH_Aalto ở phần tài_liệu tham_khảo .\nTính_chất 3 : ma_trận nghịch_đảo V-1 cũng có_thể chia thành 4 phần bằng_nhau với các phần II , III , IV tính được qua phần I giống_như Tính_chất 2 .\nHệ_quả : Phép biến_đổi Fourier ngược ( inverse Fourier transform ) có cùng độ phức_tạp với phép biển đổi Fourier .\nPhép biến_đổi Fourier nhanh Trong phần trên ta đã thấy vai_trò của ma_trận Vandermonde_V là biến_đổi một vector cột a_0 , a_1 , . . . a_n-1 thành một vector cột khác cùng kích_cỡ p(z_0) , p(z_1) , . . . p(z_n-1) .\nPhép biến_đổi này được gọi_là \"Biến đổi Fourier rời rạc\" ( Discrete_Fourier_Transform ) .\nLưu_ý là mặc_dù hai khái_niệm \"Biến đổi Fourier rời rạc\" ( DFT ) và \"Phép biến_đổi Fourier nhanh\" ( FFT ) là khác_nhau nhưng vì khi cài_đặt DFT người_ta luôn sử_dụng FFT nên hai khái_niệm này được coi_như đồng_nhất .\nĐịnh_lý 3 : Tồn_tại thuật_toán biến_đổi Fourier rời_rạc có độ phức_tạp là O(nlog_2n) .\nChứng_minh : Sử_dụng lại ký_hiệu trong hình_vẽ ở phần trên , ta gọi X là vector cần biến_đổi Fourier và Y là vector kết_quả tương_ứng .\nThay_vì sử_dụng ma_trận V để nhân với X , ta sử_dụng ma_trận K là kết_quả của phép biến_đổi như trong Định_lý 2 để nhân với X .\nLưu_ý là_vì V đã đổi thứ_tự cột nên X cũng phải đổi thứ_tự hàng : tất_cả các hàng có chỉ_số_chẵn của X được chuyển lên trên và các hàng chỉ_số lẻ chuyển xuống dưới .\nHình minh_họa với n = 4 và 4 nghiệm để thay vào ma_trận Vandermonde là 1 , i , -1 , -i : ( Image_Courtesy : Aalto_University ) Tách vector kết_quả Y thành hai phần theo n/2 , ta được : ( Image_Courtesy : Aalto_University ) Ta quan_sát là công_thức tính nửa trên và nửa dưới của vector cột kết_quả Y sử_dụng chung hai hạng tử và chỉ khác_nhau về dấu của hạng tử thứ_hai .\nNói_cách_khác , chỉ_cần tính được hai hạng tử tạo_thành kết_quả của vector kích_cỡ n/2 là ta thu được kết_quả của cả vector kích_cỡ n trong O(n) .\nTheo định_lý tổng_quát , độ phức_tạp của cả quá_trình là O(nlog_2n) Công_thức truy_hồi : Từ_tính chất đặc_biệt của ma_trận K , ta có_công thức truy_hồi để biến_đổi một vector cột X thành vector cột Y_như sau : FFT(x_i=0 , 1 , 2 , . . . n/2 - 1) = FFT(x_i=0 , 2 , 4 , . . . x_n-2) + w_ni FFT(x_i=1 , 3 , 5 . . . n-1) FFT(x_i=n/2 , n/2+1 , n/2+2 , . . . n-1) = FFT(x_i=0 , 2 , 4 , . . . x_n-2) - w_ni FFT(x_i=1 , 3 , 5 . . . n-1) Thuật_toán nhân hai đa_thức Đến đây ta đã có_thể hoàn_thiện chương_trình nhân 2 đa_thức p(x) , q(x) và lưu kết_quả thành h(x) : function NhânĐaThức( p(x) , q(x) , n ) // Lưu_ý : n là số_hệ số của đa_thức kết_quả // Nếu p(x) có bậc d và q(x) có bậc e thì n = d + e + 1 fp = FFT(p(x) , n) // biến_đổi Fourier cho p(x) và lưu các giá_trị vào mảng fp fq = FFT(q(x) , n) // biến_đổi Fourier cho q(x) và lưu các giá_trị vào mảng fq for(i = 0; i lt; n; ++i) fhi = fpi fqi; // nhân tương_ứng các giá_trị của fp và fq , lưu vào mảng fh h(x) = FFT_ngược(fh) // biến_đổi Fourier ngược và lưu vào kết_quả end function Lưu_ý về kỹ_thuật cài_đặt Vì_FFT đòi_hỏi phải sử_dụng số_phức và (trong nhiều trường hợp) khử đệ_quy nên có_thể gây khó_khăn cho các bạn chưa quen , phần này sẽ hướng_dẫn sơ_lược về cách cài_đặt sử_dụng C++ .\nKhai_báo Để sử_dụng số_phức trong C++ ta cần khai_báo thư_viện complex : include lt;complexgt; Vì_C++ cài_đặt complex là một lớp ( class ) gồm 2 trường thực ( real() ) và ảo ( imag() ) nên khi sử_dụng ta cần chỉ_định kiểu dữ_liệu cho hai trường này .\nHai kiểu dữ_liệu thông_dụng là double hoặc long double : typedef complex lt; double gt; base ; typedef vector lt; base gt; vb ; Sau khi được định_nghĩa bằng lệnh typedef thì để khai_báo biến và vector kiểu phức , ta chỉ_cần viết base x và vb v là được .\nMột_số phiên_bản cài_đặt tự định_nghĩa lớp số_ảo bằng một struct hoặc class .\nNếu lớp tự viết này không có chức_năng đặc_biệt nào thì việc này là không cần_thiết vì bản_thân lt;complexgt; đã_là một lớp rồi .\nBạn có_thể xem qua file thư_viện trong thư_mục cài_đặt trình biên_dịch , ví_dụ với CodeBlocks thì đường_dẫn có dạng CodeBlocks\\MinGW\\lib\\gcc\\mingw32\\4 . 7 . 1\\include\\c++\\complex (file ko có phần mở rộng) .\nChuẩn hóa bậc đa_thức Trong các phần trên ta đã giả_sử rằng n là lũy_thừa của 2 .\nĐể đảm_bảo tính đối_xứng và thuận_tiện khi cài_đặt , nếu đề_bài không cho trước n bậc của đa_thức là lũy_thừa của 2 thì ta cần chuẩn hóa thành số lũy_thừa nhỏ nhất mà lớn hơn n .\nChẳng_hạn với n = 105 thì giá_trị chuẩn hóa là 217 = 131072 vì 216 = 65536 lt; 105 .\nCác hệ_số của bậc cao hơn giá_trị_n ban_đầu gán bằng 0 .\nĐệ_quy và Khử đệ_quy Đệ_quy : Xét một đoạn mã C++ cài_đặt hàm FFT sử_dụng đệ_quy như_sau : void fft_slow ( int n , vb amp; a ) // biến_đổi fft của vector a , lưu kết_quả vào chính nó if ( n == 1 ) return ; int i , j , k ; // Bước 1 .\nKhai_báo kết_quả fft chẵn và lẻ vb a_even ( n / 2 ) , a_odd ( n / 2 ); // Bước 2 .\nTách hàng chẵn và hàng lẻ for ( i = j = 0 ; i lt; n ; i += 2 ) a_even j = a i ; a_odd j = a i + 1 ; ++ j ; // Bước 3 .\nBiến_đổi FFT với các hàng chẵn , lẻ fft_slow ( n / 2 , a_even ); fft_slow ( n / 2 , a_odd ); // Bước 4 : Ghép hoàn_chỉnh kết_quả double ang = 2 PI / n ; base w ( 1 ) , wn ( cos ( ang ) , sin ( ang )); for ( i = 0 ; i lt; n / 2 ; ++ i ) a i = a_even i + w a_odd i ; a i + n / 2 = a_even i - w a_odd i ; w = wn ; Có nhiều nguyên_nhân làm_cho FFT đệ_quy chạy chậm , như trong Bước 1 thì khai_báo hai vector kích_cỡ n/2 lớn như_vậy và lại khai_báo liên_tục ở các mức đệ_quy .\nBản_thân chương_trình đệ_quy cũng chạy chậm vì chương_trình phải lưu rất nhiều con_trỏ stack và liên_tục giải_phóng bộ_nhớ của biến cục_bộ ở mỗi mức đệ_quy .\nNhìn_chung đệ_quy chỉ_có ý_nghĩa như trong thuật_toán Quy_Hoạch_Động khi ta muốn tìm kết_quả của một công_thức truy_hồi mà chỉ duyệt qua những trạng_thái liên_quan trực_tiếp tới kết_quả .\nTrong FFT_ta luôn phải thăm hết các ma_trận con nên cài_đặt FFT bằng đệ_quy không có_lợi về tốc_độ thực_hiện .\nĐể_cho đầy_đủ thì ta cũng có hàm biến_đổi FFT_ngược như_sau : void inverse_fft_slow ( int n , vb amp; a ) if ( n == 1 ) return ; int i , j , k ; vb a_even , a_odd ; for ( i = 0 ; i lt; n ; ++ i ) if ( i amp; 1 ) a_odd .\npush_back ( a i ); else a_even .\npush_back ( a i ); inverse_fft_slow ( n / 2 , a_even ); inverse_fft_slow ( n / 2 , a_odd ); double ang = - 2 PI / n ; base w ( 1 ) , wn ( cos ( ang ) , sin ( ang )); for ( i = 0 ; i lt; n / 2 ; ++ i ) a i = a_even i + w a_odd i ; a i /= 2 ; a i + n / 2 = a_even i - w a_odd i ; a i + n / 2 /= 2 ; w = wn ; Khử đệ_quy : Để khử đệ_quy thì ta cần phân_tích mối liên_hệ giữa các lời gọi đệ_quy và xem các phần_tử được tính theo thứ_tự nào .\nHình_vẽ sau_đây minh_họa trường_hợp n = 8 : Màu đỏ là các nhóm chẵn và màu xanh là các nhóm lẻ .\nCác bạn hãy dựa vào tính chẵn_lẻ và để_ý các số nhị_phân 0 , 1 trong hình_vẽ để tự viết chương_trình FFT khử đệ_quy hoặc giải_thích tính đúng_đắn của đoạn mã sau (đây là hàm FFT đã được dùng để giải bài POST2) define PI acos(-1) const int NBIT = 18 ; const int N = 1 lt;lt; 18 ; // chuẩn hóa bậc của đa_thức là 18 base W_N ; // mảng lưu các nghiệm nguyên_thủy // Hàm reverse bit : Đảo_ngược nbit đầu_tiên trong mã nhị_phân của số mask int revBit ( int nbit , int mask ) int i , j ; for ( i = 0 , j = nbit - 1 ; i lt;= j ; ++ i , -- j ) if ( ( mask gt;gt; i amp; 1 ) ! = ( mask gt;gt; j amp; 1 ) ) mask = 1 lt;lt; i ; mask = 1 lt;lt; j ; return mask ; // Biến_đổi FFT của mảng a void fft ( int n , vb amp; a ) if ( n == 1 ) return ; int i , j , k ; // Đi từ dưới lên trên của cây đệ_quy : Hàng cuối_cùng giá_trị bằng với mảng được cho ban_đầu nhưng hóa đổi vị_trí // theo số có biểu_diễn nhị_phân ngược với chỉ_số for ( i = 0 ; i lt; n ; ++ i ) j = revBit ( NBIT , i ); if ( i lt; j ) swap ( a i , a j ); vb anext ( n ); // hàng tiếp_theo // chiều_cao cây bằng Log(n) // biến \"step\" lưu_số phần_tử nằm trong một nhóm chẵn hoặc lẻ for ( int step = 1 ; step lt; n ; step lt;lt;= 1 ) double ang = PI / step ; //2PI/(step 2); base w ( 1 ) , wn ( cos ( ang ) , sin ( ang )); // Lưu trước_mảng nghiệm nguyên_thủy for ( i = 0 ; i lt; step ; ++ i ) W i = w ; w = wn ; // Cứ một nhóm chẵn và một nhóm lẻ cạnh nhau thì tạo_thành kết_quả cho hàng ở trên // Duyệt qua tất_cả các nhóm chẵn và nhóm lẻ cạnh nó // even = chẵn , odd = lẻ int start_even = 0 ; int start_odd = start_even + step ; while ( start_even lt; n ) for ( i = 0 ; i lt; step ; ++ i ) anext start_even + i = a start_even + i + W i a start_odd + i ; anext start_even + i + step = a start_even + i - W i a start_odd + i ; start_even += 2 step ; start_odd = start_even + step ; for ( i = 0 ; i lt; n ; ++ i ) a i = anext i ; Sau_đây là cài_đặt cho cả FFT xuôi và ngược .\nBiến invert = true cho FFT_ngược .\nvoid fft ( int n , vb amp; a , bool invert ) if ( n == 1 ) return ; int i , j , k ; for ( i = 0 ; i lt; n ; ++ i ) j = revBit ( NBIT , i ); if ( i lt; j ) swap ( a i , a j ); vb anext ( n ); for ( int step = 1 ; step lt; n ; step lt;lt;= 1 ) double ang = PI / step ; if ( invert ) ang = - ang ; base w ( 1 ) , wn ( cos ( ang ) , sin ( ang )); for ( i = 0 ; i lt; step ; ++ i ) W i = w ; w = wn ; int start_even = 0 ; int start_odd = start_even + step ; while ( start_even lt; n ) for ( i = 0 ; i lt; step ; ++ i ) anext start_even + i = a start_even + i + W i a start_odd + i ; anext start_even + i + step = a start_even + i - W i a start_odd + i ; start_even += 2 step ; start_odd = start_even + step ; for ( i = 0 ; i lt; n ; ++ i ) a i = anext i ; if ( invert ) for ( i = 0 ; i lt; n ; ++ i ) a i /= n ; Một_số cách cài_đặt khác sử_dụng con_trỏ cũng làm tăng_tốc_độ thực_thi , có_thể xem thêm trong trang của emaxx phần tài_liệu tham_khảo .\nCũng trong trang của emaxx có_thể tìm_thấy cách cài_đặt gộp hai hàm fft và inverse_fft lại làm một sử_dụng một biến bool invert làm_cho code ngắn_gọn hơn .\nBài_tập luyện_tập VOJ_POST2_FFT problems on Codeforces_FFT problems by a2oj . com SumOfArrays - Topcoder_SRM 603 và Hướng_dẫn_giải Tài_liệu tham_khảo 1 Rohit_Thummalapalli .\nFourier_Transform : Nature’s_Way of Analyzing_Data .\nYale_Scientific , 2010 .\nLink 2 Alejandro_Dominguez .\nHighlights in the History of the Fourier_Transform .\nIEEE_Pulse , 2016 .\nLink 3 Stefan_Woerner .\nFast_Fourier_Transform .\nNumerical_Analysis_Seminar , Swiss_Federal_Institute of Technology_Zurich , 2008 .\nLink 4 Fortnow and Homer .\nA_Short_History of Computational_Complexity .\nBulletin of the_European Association for Theoretical_Computer_Science 80 , June 2003 .\nLink Bài_toán nhân đa_thức , phép biến_đổi Fourier nhanh trên csstudyfun . wordpress . com (có chứng_minh các tính_chất được đề_cập trong bài Bài_giảng của trường DH_Aalto , Phần_Lan Code cài_đặt của e-maxx \"Tutorial on FFT — The tough made simple . \" trên Codeforces\n", "tagged": "Table/Np of_Contents/Np Vài/L nét/N lịch_sử/N Phép_nhân/Np hai/M đa_thức/Np Biểu_diễn/V đa_thức/Np qua/V ma_trận/N Vandermonde_Nghiệm/Np nguyên_thủy/Np Một_số/L tính_chất/N đặc_biệt/A của/E ma_trận/N Vandermonde/Np nghiệm/V nguyên_thủy/Np Phép/N biến_đổi/V Fourier/Np nhanh/A Thuật_toán/N nhân/N hai/M đa_thức/Np Lưu_ý/V về/E kỹ_thuật/N cài_đặt/V Khai_báo/V Chuẩn/N hóa/Z bậc/N đa_thức/Np Đệ_quy/Np và/Cc Khử/N đệ_quy/Np Bài_tập/Np luyện_tập/V Tài_liệu/N tham_khảo/V Tác_giả/N :/CH ngmq/Np Trong/E bài/N này/P chúng_ta/P sẽ/R tìm_hiểu/V về/E thuật_toán/N nhân/N nhanh/A hai/M đa_thức/Np sử_dụng/V phép/N biến_đổi/V Fourier/Np nhanh/A (/CH Fast_Fourier_Transform/Np -/CH FFT/Np )/CH và/Cc cách/N cài_đặt/V của/E nó/P ./CH\nBài/N viết/V này/P sẽ/R chỉ/R nêu/V chứng_minh/V sơ_lược/A của/E một_vài/L tính_chất/N được/V sử_dụng/V ./CH\nCác/L chứng_minh/V chi_tiết/N có_thể/R tìm_thấy/Np ở/E mục/N tài_liệu/N tham_khảo/V phía/N cuối/N của/E bài/N viết/V ./CH\nVài/L nét/N lịch_sử/N Phép/N biến_đổi/V Fourier/Np (/CH Fourier_Transform/Np )/CH là/V một/M trong/E số/N những/L phát_kiến/Np toán_học/N đặc_sắc/A có/V lịch_sử/N hào_hùng/A ,/CH gắn_liền/Np với/E những/L phát_kiến/Np khoa_học/N và/Cc chiến_tranh/N quân_sự/N ở/E thế_kỷ/N 19/M và/Cc 20/M ./CH\nJoseph_Fourier/Np (1768-1830)/Np là/V một/M nhà_khoa_học/N làm_việc/V trong/E đội_quân/Np thám_hiểm/Np Ai_Cập/Np của/E Napoleon/Np từ/E năm/N 1798/Np ./CH\nSau/E khi/N cách_mạng/N Pháp/Np kết_thúc/V năm/N 1799/Np ,/CH Fourier/Np trở_về/V Pháp/Np và/Cc tham_gia/V xây_dựng/V lại/R đất_nước/N trong/E vai_trò/N một/M giáo_sư/N của/E đại_học/N École_Polytechnique/Np ./CH\nTrong/E quá_trình/N làm_việc/V với/E các/L công_trình/N xây_dựng/V cầu_đường/N và/Cc đóng/V tàu/N ,/CH ông/N đặc_biệt/A quan_tâm/V tới/E bài_toán/N mô_tả/V quá_trình/N truyền_dẫn/Np nhiệt/N trong/E kim_loại/N ,/CH điều/N dẫn/V tới/E sự/N ra_đời/V của/E phép/N biến_đổi/V Fourier/Np liên_tục/A vào/E năm/N 1807/Np trong/E một/M báo_cáo/N của/E ông/N tại/E viện/N hoàng_gia/Np Paris/Np ./CH\nTrong/E đó/P ,/CH ông/N mô_tả/V mọi/L hàm_số/Np ,/CH kể_cả/X các/L hàm_số/Np không/R liên_tục/A đều/R có_thể/R được/V biểu_diễn/V dưới/E dạng/N tổng/N của/E một_số/L vô_hạn/Np các/L hàm_số/Np lượng_giác/Np ./CH\nPhát_biểu/V này/P của/E Fourier/Np gây/V chấn_động/N và/Cc ấn_tượng/N tới_mức/Np nhà/N toán_học/N Pháp/Np cùng_thời/Np là/V Lagrange/Np cho_rằng/Np việc/N nghĩ_ra/Np phát_kiến/Np này/P là/V gần_như/R không_thể/R (\"nothing/Np short/Np of/E impossible\")/Np 1/M ./CH\nTrong/E hơn/A một/M trăm_năm/Np sau_đó/Np phép/N biến_đổi/V Fourier/Np trở_thành/V một/M đối_tượng/N nghiên_cứu_phổ/Np biến/V và/Cc liên_tục/A được/V phát_triển/V ,/CH hoàn_thiện/V bởi/E vô_số/L các/L tên_tuổi/N lớn/A của/E toán/N lý_thuyết/Np 2/M ./CH\nTrong_khi/Np phiên_bản/N nguyên_thủy/Np có/V lịch_sử/N hoành_tráng/A như_vậy/X ,/CH phép/N biến_đổi/V Fourier/Np nhanh/A ,/CH dù/C được/V cho_là/Np ra_đời/V trước/E ,/CH lại/R được/V quan_tâm/V chậm/A hơn/A nhiều/A ./CH\nNgười_ta/P cho_rằng/Np những/L ý_tưởng/N đầu_tiên/A về/E biến_đổi/V Fourier/Np nhanh/A được/V phát_triển/V bởi/E nhà/N toán_học/N Đức_Carl_Friedrich_Gauss/Np (1777/Np -/CH 1855)/Np vào/E năm/N 1805/Np khi/N ông/N cố_gắng/V xác_định/V quỹ_đạo/Np của/E các/L thiên_thạch/Np 3/M ,/CH nhưng/C khi/N đó/P ông/N không/R công_bố/V kết_quả/N của/E mình/P ./CH\nMối/N liên_hệ/V giữa/N Gauss/Np và/Cc phép/N biến_đổi/V Fourier/Np nhanh/A chỉ/R được/V phát_hiện/V khi/N các/L công_trình/N của/E ông/N được/V tập_hợp/N và/Cc công_bố/V vào/E năm/N 1866/Np ./CH\nMặc_dù/C vậy/P ,/CH vào/E thời/N đó/P không/R có/V ai/P quan_tâm/V tới/E công_trình/N này/P vì/E lý_thuyết/Np độ/N phức_tạp/A tính_toán/V chưa/R phát_triển/V (mãi/Np tới/E năm/N 1936/Np Alan_Turing/Np mới/R phát_triển/V mô_hình/N tính_toán/V đầu_tiên/A ,/CH và/Cc phải/V tới/E năm/N 1965/M thì/C lịch_sử/N ngành/N nghiên_cứu/V về/E độ/N phức_tạp/A tính_toán/V mới/R bắt_đầu/V với/E công_trình/N của/E Hartmanis/Np và/Cc Stearns/Np 4)/Np ./CH\nCũng/R trong/E năm/N 1965/M hai/M nhà/N toán_học/N trong/E ban/N cố_vấn/N khoa_học/N của/E tổng_thống/N Mỹ_Kennedy/Np là/V James_Cooley/Np và/Cc John_Tukey/Np đã/R tự/P tìm_ra/Np phép/N biến_đổi/V nhanh/A Fourier/Np trong_khi/Np thiết_kế/V hệ_thống/N phát_hiện/V các/L vụ/N thử/V hạt_nhân/Np của/E chính_quyền/N Xô_Viết/Np 3/M ./CH\nKể_từ/Np thời_điểm/N đó/P phép/N biến_đổi/V nhanh/A Fourier/Np mới/R chính_thức/A được/V quan_tâm/V và/Cc nghiên_cứu/V ứng_dụng/V trong/E rất/R nhiều/A các/L lĩnh_vực/N nghiên_cứu/V khác_nhau/Np của/E vật_lý/N ,/CH sinh_học/N ,/CH điện_tử/N ,/CH y_tế/N ,/CH điều_khiển_học/Np ./CH ./CH ./CH\nNghiên_cứu/V chỉ/R ra/V rằng/C mắt/N và/Cc tai/N người/N ,/CH động_vật/N có/V \"cài/Np đặt\"/Np sẵn/A thuật_toán/N biến_đổi/V Fourier/Np để/E giúp/V chúng_ta/P nhìn/V và/Cc nghe/V ,/CH vì_vậy/C nó/P được/V GS_Ronald_Coifman/Np của/E đại_học/N Yale/Np gọi_là/V Phương_pháp/N phân_tích/V dữ_liệu/N của/E tự_nhiên/A (\"Natures/Np way/Np of/E analyzing/Np data\")/Np 1/M ./CH\nPhép_nhân/Np hai/M đa_thức/Np Cho/E hai/M đa_thức/Np p(x)/Np ,/CH q(x)/Np có/V bậc/N d/Ny ,/CH e/Ni như_sau/Np :/CH p(x)/Np =/CH a_0/Np +/CH a_1/Np x/CH +/CH a_2/Np x2/Np +/CH ./CH ./CH ./CH\n+/CH a_d/Np xd/Np q(x)/Np =/CH b_0/Np +/CH b_1/Np x/CH +/CH b_2/Np x2/Np +/CH ./CH ./CH ./CH\n+/CH b_e/Np xe/N Ta/P cần/V tìm/V tích/N c(x)/Np của/E hai/M đa_thức/Np trên/E ,/CH có/V dạng/N :/CH c(x)/Np =/CH p(x)q(x)/Np =/CH c_0/Np +/CH c_1/Np x/CH +/CH c_x/Np x2/Np +/CH ./CH ./CH ./CH\n+/CH c_d+e/Np xd+e/Np trong/E đó/P c_j/Np =/CH \\sum_i=0j/Np a_ib_j-i/Np \\qquad/Np j/Np =/CH 0/M ,/CH 1/M ,/CH ./CH ./CH ./CH ,/CH d+e/Np Cách/N làm_theo/Np định_nghĩa_là/Np ta/P nhân/N mỗi/L hệ_số/N của/E p(x)/Np với/E tất_cả/P các/L hệ_số/N của/E q(x)/Np rồi/C cộng/V các/L hệ_số/N của/E cùng/A tổng_số/N mũ/N ./CH\nVì/E hai/M đa_thức/Np có/V d+1/Np và/Cc e+1/Np hệ_số/N nên/C cách/N làm/V này/P có/V độ/N phức_tạp/A là/V O((d+1)(e+1))/Np =/CH O(de)/Np ./CH\nKhi/N d/Ny và/Cc e/Ni tương_đối/A lớn/A cỡ/N 103/M hoặc/Cc 104/M trở_lên/A thì/C độ/N phức_tạp/A này/P là/V quá/R lớn/A để/E chạy/V trên/E máy_tính/N ,/CH đặc_biệt/A là/V các/L máy_tính/N nhúng/V đòi_hỏi/V tốc_độ/N tính_toán/V nhanh/A ./CH\nPhép/N biến_đổi/V FFT/Np giúp/V thực_hiện/V phép_nhân/Np nói/V trên/E trong/E độ/N phức_tạp/A O(NlogN)/Np trong/E đó/P N/Ny là/V lũy_thừa/Np của/E 2/M nhỏ/A nhất/A lớn/A hơn/A d/Ny và/Cc e/Ni ./CH\nBiểu_diễn/V đa_thức/Np qua/V ma_trận/N Vandermonde/Np Kể_từ/Np phần/N này/P trở_về/V sau/E ,/CH ta/P quy_ước/N n/Ny là/V số_hệ/Np số/N của/E đa_thức/Np (bậc/Np n-1)/Np và/Cc n/Ny là/V một_lũy/Np thừa/V của/E 2/M (n/Np =/CH 2/M ,/CH 4/M ,/CH 8/M ,/CH 16/M ,/CH 32/M ,/CH 64/M ./CH ./CH ./CH )/CH ./CH\nXét/V đa_thức/Np p(x)/Np =/CH a_0/Np +/CH a_1/Np x/CH +/CH a_2/Np x2/Np +/CH ./CH ./CH ./CH\n+/CH a_n-1/Np xn-1/Np với/E bậc/N n-1/Np và/Cc các/L hệ_số_phức/Np a_i/Np \\in/Np \\mathbbC/Np ./CH\nBiểu_thức/Np tính/V n/Ny giá_trị/N của/E p(x)/Np tại/E n/Ny điểm/N z_0/Np ,/CH z_1/Np ,/CH ./CH ./CH ./CH\nz_n-1/Np có_thể/R biểu_diễn/V qua/V phép_nhân/Np ma_trận/N như_sau/Np :/CH \\beginbmatrix/Np 1/M amp;/Np z_01/Np amp;/Np z_02/Np amp;/Np \\dots/Np amp;/Np z_0n-1/Np \\newline/Np 1/M amp;/Np z_1/Np amp;/Np z_12/Np amp;/Np \\dots/Np amp;/Np z_1n-1/Np \\newline/Np \\ldots/Np amp;/Np \\ldots/Np amp;/Np \\ldots/Np amp;/Np \\ldots/Np amp;/Np \\ldots\\newline/Np 1/M amp;/Np z_n-11/Np amp;/Np z_n-12/Np amp;/Np \\dots/Np amp;/Np z_n-1n-1/Np \\endbmatrix/Np \\beginbmatrix/Np a_0/Np \\newline/Np a_1/Np \\newline/Np \\vdots/Np \\newline/Np a_n-1/Np \\endbmatrix/Np =/CH \\beginbmatrix/Np p(z_0)/Np \\newline/Np p(z_1)/Np \\newline/Np \\vdots/Np \\newline/Np p(z_n-1)/Np \\endbmatrix/Np \\space/Np (1)/Np Ma_trận/N vuông/N V/Nu kích_cỡ/N nn/Ny của/E z_0/Np :/CH n-1/Np ở/E trên/E được/V gọi_là/V ma_trận/N Vandermonde/Np ./CH\nTa/P có/V các/L định_lý/Np sau/E :/CH Định_lý/Np 1/M :/CH Định_thức/Np của/E ma_trận/N Vandermonde/Np là/V det(V)/Np =/CH \\prod_0/Np \\leq/Np i/M lt;/Np j/Np \\leq/Np n-1(z_j/Np -/CH z_i)/Np Chứng_minh/V (sơ/Np lược)/Np :/CH Với/E mỗi/L hàng/N i/M =/CH 0/M ,/CH 1/M ,/CH ./CH ./CH ./CH n-2/Np của/E định_thức/Np ta/P liên_tục/A thay/V hàng/N j/Np =/CH i+1/Np ,/CH i+2/Np ,/CH ./CH ./CH ./CH n-1/Np bằng/E hiệu/N của/E các/L hệ_số/N của/E hàng/N j/Np trừ/V đi/V hàng/N i/M ./CH\nĐây/P là/V phép/N biến_đổi/V cơ_bản/A (/CH elementary/Np operation/Np )/CH nên/C giá_trị/N định_thức/Np cần/V tính/V không_đổi/Np ./CH\nLấy/V nhân_tử/Np chung/A z_j/Np -/CH z_i/Np ở/E tất_cả/P các/L hàng/N ra/V ngoài/E và/Cc xét/V tiếp/V hàng/N i+1/Np ./CH\nSau/E khi/N xét/V xong/V i/M =/CH n-2/Np ta/P được/V một/M ma_trận/N chéo/A có/V đường_chéo/Np chỉ/R gồm/V z_ii/Np =/CH 1/M ,/CH định_thức/Np của/E ma_trận/N này/P hiển_nhiên/Np bằng/E 1/M ./CH\nVì_vậy/C định_thức/Np cần/V tính/V là/V tích/N của/E tất_cả/P các/L nhân_tử/Np chung/A bỏ/V ra/V ngoài/E ở/E các/L bước/V trước/E đó/P ./CH\nPhép/N chứng_minh/V bằng/E quy_nạp/Np có_thể/R xem/V thêm/V tại/E đây/P Định_lý/Np 2/M :/CH Đa_thức/Np p(x)/Np được/V xác_định/V duy_nhất/A bởi/E các/L giá_trị/N của/E nó/P p(z_0)/Np ,/CH p(z_1)/Np ,/CH ./CH ./CH ./CH\np(z_n-1)/Np khi/N n/Ny giá_trị/N z_0/Np ,/CH z_1/Np ,/CH ./CH ./CH ./CH\nz_n-1/Np phân_biệt/V ./CH\nTa/P gọi/V đây/P là/V phép/N biến_đổi/V ngược/A ./CH\nChứng_minh/V :/CH Coi/V phương_trình/Np (1)/Np là/V một/M hệ_phương_trình/Np n/Ny ẩn/V với/E bộ/N nghiệm/V a_0/Np ,/CH a_1/Np ,/CH ./CH ./CH ./CH a_n-1/Np ./CH\nĐể/E đa_thức/Np p(x)/Np xác_định/V và/Cc duy_nhất/A thì/C định_thức/Np của/E ma_trận/N V/Nu ở/E trên/E phải/V khác/A 0/M ./CH\nTheo/V Định_lý/Np 1/M ta/P có_điều/X phải/V chứng_minh/V ./CH\nHệ_quả/Np :/CH khi/N V/Nu khả_nghịch/Np ,/CH hệ_số/N a_0/Np ,/CH a_1/Np ,/CH ./CH ./CH ./CH a_n-1/Np được/V xác_định/V thông_qua/V tích/N của/E ma_trận/N nghịch_đảo/Np V-1/Np của/E V/Nu và/Cc p(z_0)/Np ,/CH p(z_1)/Np ,/CH ./CH ./CH ./CH p(z_n-1)/Np ./CH\nTừ/E định_lý/Np 2/M ,/CH ta/P thấy/V rằng/C 1/M đa_thức/Np bất_kỳ/A có/V 2/M cách/N biểu_diễn/V :/CH Dùng/V n/Ny hệ_số/N a_i/Np Dùng/V n/Ny cặp/N giá_trị/N z_i/Np ,/CH p(z_i)/Np ./CH\nĐây/P chính/T là/V nền_tảng/N của/E việc/N tính/V nhanh/A tích/N của/E 2/M đa_thức/Np sử_dụng/V FFT/Np :/CH Chọn/V 1/M dãy/Nc z_i/Np gồm/V N/Ny phần_tử/N ./CH\nz_i/Np có_thể/R chọn/V tuỳ_ý/Np miễn_sao/E giá_trị/N của/E chúng/P là/V đôi/M một/M khác_nhau/Np để/E các/L đa_thức/Np p(x)/Np ,/CH q(x)/Np và/Cc c(x)/Np là/V xác_định/V và/Cc duy_nhất/A ./CH\nChuyển/V 2/M đa_thức/Np p(x)/Np và/Cc q(x)/Np sang/V cách/N biểu_diễn/V 2/M ./CH\n(dùng/Np FFT)_Tính/Np tích/N của/E 2/M đa_thức/Np trong/E cách/N biểu_diễn/V 2/M trong/E O(N)/Np ./CH\nĐiều/N này/P cực_kỳ/R đơn_giản/A ,/CH vì/E khi/N ta/P đã/R cố_định/A dãy/Nc z_i/Np ,/CH ta/P có_thể/R tính/V tất_cả/P c(z_i)/Np =/CH p(z_i)/Np q(z_i)/Np trong/E O(N)/Np ./CH\nChuyển/V đa_thức/Np c(x)/Np về/E cách/N biểu_diễn/V 1/M (dùng/Np FFT)/Np ./CH\nNghiệm/V nguyên_thủy/Np Như/C đã/R phân_tích/V ở/E trên/E ,/CH ta/P cần/V chọn/V dãy/Nc z_i/Np sao_cho/Np việc/N biến_đổi/V đa_thức/Np giữa/N 2/M cách/N biểu_diễn/V có_thể/R thực_hiện/V một_cách/N hiệu_quả/N ./CH\nNếu/C ta/P chọn/V z_i/Np là/V các/L nghiệm/V nguyên_thủy/Np thoả_mãn/V :/CH zn/Np =/CH 1/M \\qquad/Np z/Y \\in/Np \\mathbbC/Np \\qquad/Np (2)/Np với/E n/Ny như/C đã/R quy_ước/N và/Cc cũng/R là/V số/N nghiệm/V của/E phương_trình/Np (2)/Np mà/C ta/P cần/V ./CH\nCông_thức/N Euler/Np xác_định/V nghiệm/V thứ/N k/N của/E phương_trình/Np (2)/Np là/V z_k/Np =/CH w_nk/Np =/CH (e/Np 2\\pi/Np i\\over/Np n)k/Np =/CH e/Ni 2\\pi/Np ik\\over/Np n/Ny =/CH cos2\\pi/Np k\\over/Np n/Ny +/CH isin2\\pi/Np k\\over/Np n/Ny \\qquad/Np k/N =/CH 0/M ,/CH 1/M ,/CH ./CH ./CH ./CH\nn/Ny -/CH 1/M trong/E đó/P w_n/Np là/V nghiệm/V mũ/N 1/M :/CH w_n/Np =/CH e/Ni 2\\pi/Np i\\over/Np n/Ny =/CH cos2\\pi\\over/Np n/Ny +/CH isin2\\pi\\over/Np n/Ny Dễ/A thấy/V là/V nghiệm/V nguyên_thủy/Np thứ/N k/N có_thể/R được/V tính/V trong/E O(1)/Np với/E n/Ny đã/R biết/V ./CH\nMột_số/L tính_chất/N đặc_biệt/A của/E ma_trận/N Vandermonde/Np nghiệm/V nguyên_thủy/Np Tính_chất/N 1/M :/CH Ma_trận/N nghịch_đảo/Np V-1/Np được/V tính/V theo/V công_thức/N :/CH V-1i/Np ,/CH j/Np =/CH Vi/Np ,/CH j-1/Np \\over/Np n/Ny với/E i/M ,/CH j/Np =/CH 0/M ,/CH 1/M ,/CH ./CH ./CH ./CH n-1/Np là/V chỉ_số/N hàng/N và/Cc cột/N của/E ma_trận/N ./CH\nChứng_minh/V (sơ/Np lược)/Np :/CH gọi/V B/Ni là/V ma_trận/N kích_cỡ/N n/Ny n/Ny tạo/V bởi/E Bi/Np ,/CH j/Np =/CH Vi/Np ,/CH j-1/Np \\qquad/Np \\forall/Np i/M ,/CH j/Np =/CH 0/M ,/CH 1/M ,/CH ./CH ./CH ./CH n-1/Np Ta/P sẽ/R chứng_minh/V tích/N P/Ny =/CH B_V/Np =/CH V_B/Np =/CH n/Ny I/M ,/CH trong/E đó/P I/M là/V ma_trận/N đơn_vị/N ./CH\nXét/V phép_nhân/Np hàng/N i/M của/E ma_trận/N V/Nu và/Cc cột/N k/N của/E ma_trận/N B/Ni ,/CH ta/P có/V :/CH Pi/Np ,/CH k/N =/CH \\sum_j=0n-1w_nijw_n-jk/Np =/CH \\sum_j=0n-1w_nj(i-k)/Np Nếu/C i/M =/CH k/N :/CH Pi/Np ,/CH k/N =/CH Pi/Np ,/CH i/M =/CH \\sum_j=0n-1w_n0/Np =/CH n/Ny \\qquad/Np \\forall/Np i/M =/CH 0/M ,/CH 1/M ,/CH ./CH ./CH ./CH n-1/Np ./CH\nNếu/C i/M \\neq/Np k/N :/CH Pi/Np ,/CH k/N =/CH \\sum_j=0n-1w_ni-kj/Np =/CH 1/M -/CH w_ni-kn/Np \\over/Np 1-w_ni-k/Np =/CH 0/M Vậy_P/Np =/CH nI/Np hay_là/Cc V_B/Np =/CH B/Ni =/CH I/M ,/CH vậy/P B/Ni =/CH V-1/Np ./CH\nHệ_quả/Np :/CH Độ/N phức_tạp/A tính_toán/V cho/E V-1/Np bằng/E với/E độ/N phức_tạp/A tính/V V/Nu ./CH\nTính_chất/N 2/M :/CH Chia/V ma_trận/N V/Nu thành/V 4/M phần/N bằng_nhau/Np kích_cỡ/N n/Ny n/Ny theo/V 2/M tiêu_chí/N :/CH độ/N lớn/A của/E hàng/N so_với/Np n/Ny và/Cc tính/V chẵn_lẻ/Np của/E các/L cột/N ./CH\nPhần_I/Np gồm/V các/L phần_tử/N có/V chỉ_số/N hàng/N 0/M ,/CH 1/M ,/CH ./CH ./CH ./CH n/Ny -/CH 1/M và/Cc chỉ_số/N cột/N là/V chẵn/Np 0/M ,/CH 2/M ,/CH 4/M ,/CH ./CH ./CH ./CH n-2/Np ./CH\nPhần_II/Np gồm/V các/L phần_tử/N có/V chỉ_số/N hàng/N 0/M ,/CH 1/M ,/CH ./CH ./CH ./CH n/Ny -/CH 1/M và/Cc chỉ_số/N cột/N là/V lẻ/A 1/M ,/CH 3/M ,/CH 5/M ,/CH ./CH ./CH ./CH n-1/Np ./CH\nPhần_III/Np gồm/V các/L phần_tử/N có/V chỉ_số/N hàng/N n/Ny ,/CH n/Ny ,/CH ./CH ./CH ./CH n-1/Np và/Cc chỉ_số/N cột/N là/V chẵn/Np 0/M ,/CH 2/M ,/CH 4/M ,/CH ./CH ./CH ./CH n-2/Np ./CH\nPhần_IV/Np gồm/V các/L phần_tử/N có/V chỉ_số/N hàng/N n/Ny ,/CH n/Ny ,/CH ./CH ./CH ./CH n-1/Np và/Cc chỉ_số/N cột/N là/V lẻ/A 1/M ,/CH 3/M ,/CH 5/M ,/CH ./CH ./CH ./CH n-1/Np ./CH\n(/CH Image_Courtesy/Np of/E Aalto_University/Np )/CH Nói_cách_khác/Np ,/CH ta/P tạo/V một/M ma_trận/N mới/R K/N bằng/E cách/N chuyển/V tất_cả/P các/L cột/N có/V chỉ_số_chẵn/Np của/E ma_trận/N V/Nu lên/V trước/E ,/CH các/L cột/N có/V chỉ_số/N lẻ/A về_sau/Np ,/CH giữ_nguyên/Np thứ_tự/N tương_đối/A của/E các/L cột/N cùng/A chỉ_số_chẵn/Np hoặc/Cc cùng/A chỉ_số/N lẻ/A ./CH\nỞ/E ma_trận/N K/N này/P cột/N n-2/Np của/E V/Nu nằm/V ngay/R trước/E cột/N 1/M của/E V/Nu ./CH\nBốn/M phần/N I/M ,/CH II/M ,/CH III/M ,/CH IV/M được/V tạo/V bởi/E cắt/V đều/R ma_trận/N K/N thành/V 4/M phần/N bằng_nhau/Np ./CH\nKý_hiệu/Np K_I/Np ,/CH K_II/Np ,/CH K_III/Np ,/CH K_IV/Np là/V bốn/M ma_trận/N con/Nc của/E K/N ./CH\nTất_cả/P các/L phần_tử/N trong/E phần/N II/M ,/CH III/M ,/CH IV/M đều/R có_thể/R tính/V được/V từ/E phần/N I/M theo/V công_thức/N sau/E :/CH K_IIi/Np ,/CH j/Np =/CH w_ni/Np K_Ii/Np ,/CH j/Np \\qquad/Np \\forall/Np i/M ,/CH j/Np =/CH 0/M ,/CH 1/M ,/CH ./CH ./CH ./CH n/Ny -/CH 1/M K_IIIi/Np ,/CH j/Np =/CH K_Ii/Np ,/CH j/Np \\qquad/Np \\forall/Np i/M ,/CH j/Np =/CH 0/M ,/CH 1/M ,/CH ./CH ./CH ./CH n/Ny -/CH 1/M K_IVi/Np ,/CH j/Np =/CH -w_ni/Np K_Ii/Np ,/CH j/Np \\qquad/Np \\forall/Np i/M ,/CH j/Np =/CH 0/M ,/CH 1/M ,/CH ./CH ./CH ./CH n/Ny -/CH 1/M Chứng_minh/V :/CH các/L bạn/N tự/P chứng_minh/V hoặc/Cc xem/V slide/Np số/N 23/M trong/E tài_liệu/N của/E trường/N DH_Aalto/Np ở/E phần/N tài_liệu/N tham_khảo/V ./CH\nTính_chất/N 3/M :/CH ma_trận/N nghịch_đảo/Np V-1/Np cũng/R có_thể/R chia/V thành/V 4/M phần/N bằng_nhau/Np với/E các/L phần/N II/M ,/CH III/M ,/CH IV/M tính/V được/V qua/V phần/N I/M giống_như/Np Tính_chất/N 2/M ./CH\nHệ_quả/Np :/CH Phép/N biến_đổi/V Fourier/Np ngược/A (/CH inverse/Np Fourier/Np transform/Np )/CH có/V cùng/A độ/N phức_tạp/A với/E phép/N biển/N đổi/V Fourier/Np ./CH\nPhép/N biến_đổi/V Fourier/Np nhanh/A Trong/E phần/N trên/E ta/P đã/R thấy/V vai_trò/N của/E ma_trận/N Vandermonde_V/Np là/V biến_đổi/V một/M vector/Np cột/N a_0/Np ,/CH a_1/Np ,/CH ./CH ./CH ./CH a_n-1/Np thành/V một/M vector/Np cột/N khác/A cùng/A kích_cỡ/N p(z_0)/Np ,/CH p(z_1)/Np ,/CH ./CH ./CH ./CH p(z_n-1)/Np ./CH\nPhép/N biến_đổi/V này/P được/V gọi_là/V \"Biến/Np đổi/V Fourier/Np rời/V rạc\"/Np (/CH Discrete_Fourier_Transform/Np )/CH ./CH\nLưu_ý/V là/V mặc_dù/C hai/M khái_niệm/N \"Biến/Np đổi/V Fourier/Np rời/V rạc\"/Np (/CH DFT/Np )/CH và/Cc \"Phép/Np biến_đổi/V Fourier/Np nhanh\"/Np (/CH FFT/Np )/CH là/V khác_nhau/Np nhưng/C vì/E khi/N cài_đặt/V DFT/Np người_ta/P luôn/R sử_dụng/V FFT/Np nên/C hai/M khái_niệm/N này/P được/V coi_như/Np đồng_nhất/A ./CH\nĐịnh_lý/Np 3/M :/CH Tồn_tại/V thuật_toán/N biến_đổi/V Fourier/Np rời_rạc/A có/V độ/N phức_tạp/A là/V O(nlog_2n)/Np ./CH\nChứng_minh/V :/CH Sử_dụng/V lại/R ký_hiệu/Np trong/E hình_vẽ/Np ở/E phần/N trên/E ,/CH ta/P gọi/V X/CH là/V vector/Np cần/V biến_đổi/V Fourier/Np và/Cc Y/N là/V vector/Np kết_quả/N tương_ứng/V ./CH\nThay_vì/X sử_dụng/V ma_trận/N V/Nu để/E nhân/N với/E X/CH ,/CH ta/P sử_dụng/V ma_trận/N K/N là/V kết_quả/N của/E phép/N biến_đổi/V như/C trong/E Định_lý/Np 2/M để/E nhân/N với/E X/CH ./CH\nLưu_ý/V là_vì/Np V/Nu đã/R đổi/V thứ_tự/N cột/N nên/C X/CH cũng/R phải/V đổi/V thứ_tự/N hàng/N :/CH tất_cả/P các/L hàng/N có/V chỉ_số_chẵn/Np của/E X/CH được/V chuyển/V lên/V trên/E và/Cc các/L hàng/N chỉ_số/N lẻ/A chuyển/V xuống/V dưới/E ./CH\nHình/N minh_họa/V với/E n/Ny =/CH 4/M và/Cc 4/M nghiệm/V để/E thay/V vào/E ma_trận/N Vandermonde/Np là/V 1/M ,/CH i/M ,/CH -1/Np ,/CH -i/Np :/CH (/CH Image_Courtesy/Np :/CH Aalto_University/Np )/CH Tách/V vector/Np kết_quả/N Y/N thành/V hai/M phần/N theo/V n/Ny ,/CH ta/P được/V :/CH (/CH Image_Courtesy/Np :/CH Aalto_University/Np )/CH Ta/P quan_sát/V là/V công_thức/N tính/V nửa/M trên/E và/Cc nửa/M dưới/E của/E vector/Np cột/N kết_quả/N Y/N sử_dụng/V chung/A hai/M hạng/N tử/V và/Cc chỉ/R khác_nhau/Np về/E dấu/N của/E hạng/N tử/V thứ_hai/N ./CH\nNói_cách_khác/Np ,/CH chỉ_cần/Np tính/V được/V hai/M hạng/N tử/V tạo_thành/Np kết_quả/N của/E vector/Np kích_cỡ/N n/Ny là/V ta/P thu/V được/V kết_quả/N của/E cả/P vector/Np kích_cỡ/N n/Ny trong/E O(n)/Np ./CH\nTheo/V định_lý/Np tổng_quát/Np ,/CH độ/N phức_tạp/A của/E cả/P quá_trình/N là/V O(nlog_2n)/Np Công_thức/N truy_hồi/Np :/CH Từ_tính/Np chất/N đặc_biệt/A của/E ma_trận/N K/N ,/CH ta/P có_công/Np thức/V truy_hồi/Np để/E biến_đổi/V một/M vector/Np cột/N X/CH thành/V vector/Np cột/N Y_như/A sau/E :/CH FFT(x_i=0/Np ,/CH 1/M ,/CH 2/M ,/CH ./CH ./CH ./CH n/Ny -/CH 1)/Np =/CH FFT(x_i=0/Np ,/CH 2/M ,/CH 4/M ,/CH ./CH ./CH ./CH x_n-2)/Np +/CH w_ni/Np FFT(x_i=1/Np ,/CH 3/M ,/CH 5/M ./CH ./CH ./CH n-1)/Np FFT(x_i=n/Np ,/CH n/Ny ,/CH n/Ny ,/CH ./CH ./CH ./CH n-1)/Np =/CH FFT(x_i=0/Np ,/CH 2/M ,/CH 4/M ,/CH ./CH ./CH ./CH x_n-2)/Np -/CH w_ni/Np FFT(x_i=1/Np ,/CH 3/M ,/CH 5/M ./CH ./CH ./CH n-1)/Np Thuật_toán/N nhân/N hai/M đa_thức/Np Đến/E đây/P ta/P đã/R có_thể/R hoàn_thiện/V chương_trình/N nhân/N 2/M đa_thức/Np p(x)/Np ,/CH q(x)/Np và/Cc lưu/V kết_quả/N thành/V h(x)/Np :/CH function/Np NhânĐaThức(/Np p(x)/Np ,/CH q(x)/Np ,/CH n/Ny )/CH //CH Lưu_ý/V :/CH n/Ny là/V số_hệ/Np số/N của/E đa_thức/Np kết_quả/N //CH Nếu/C p(x)/Np có/V bậc/N d/Ny và/Cc q(x)/Np có/V bậc/N e/Ni thì/C n/Ny =/CH d/Ny +/CH e/Ni +/CH 1/M fp/Np =/CH FFT(p(x)/Np ,/CH n)/Np //CH biến_đổi/V Fourier/Np cho/E p(x)/Np và/Cc lưu/V các/L giá_trị/N vào/E mảng/N fp/Np fq/Np =/CH FFT(q(x)/Np ,/CH n)/Np //CH biến_đổi/V Fourier/Np cho/E q(x)/Np và/Cc lưu/V các/L giá_trị/N vào/E mảng/N fq/Np for(i/Np =/CH 0;/Np i/M lt;/Np n;/Np ++i)/Np fhi/Np =/CH fpi/Np fqi;/Np //CH nhân/N tương_ứng/V các/L giá_trị/N của/E fp/Np và/Cc fq/Np ,/CH lưu/V vào/E mảng/N fh/Np h(x)/Np =/CH FFT_ngược(fh)/Np //CH biến_đổi/V Fourier/Np ngược/A và/Cc lưu/V vào/E kết_quả/N end/Np function/Np Lưu_ý/V về/E kỹ_thuật/N cài_đặt/V Vì_FFT/Np đòi_hỏi/V phải/V sử_dụng/V số_phức/Np và/Cc (trong/Np nhiều/A trường/N hợp)/Np khử/N đệ_quy/Np nên/C có_thể/R gây/V khó_khăn/A cho/E các/L bạn/N chưa/R quen/V ,/CH phần/N này/P sẽ/R hướng_dẫn/V sơ_lược/A về/E cách/N cài_đặt/V sử_dụng/V C++/Np ./CH\nKhai_báo/V Để/E sử_dụng/V số_phức/Np trong/E C++/Np ta/P cần/V khai_báo/V thư_viện/N complex/Np :/CH include/Np lt;complexgt;/Np Vì_C++/Np cài_đặt/V complex/Np là/V một/M lớp/N (/CH class/Np )/CH gồm/V 2/M trường/N thực/A (/CH real()/Np )/CH và/Cc ảo/Np (/CH imag()/Np )/CH nên/C khi/N sử_dụng/V ta/P cần/V chỉ_định/V kiểu/N dữ_liệu/N cho/E hai/M trường/N này/P ./CH\nHai/M kiểu/N dữ_liệu/N thông_dụng/A là/V double/Np hoặc/Cc long/Np double/Np :/CH typedef/Np complex/Np lt;/Np double/Np gt;/Np base/Np ;/CH typedef/Np vector/Np lt;/Np base/Np gt;/Np vb/Np ;/CH Sau/E khi/N được/V định_nghĩa/N bằng/E lệnh/N typedef/Np thì/C để/E khai_báo/V biến/V và/Cc vector/Np kiểu/N phức/Np ,/CH ta/P chỉ_cần/Np viết/V base/Np x/CH và/Cc vb/Np v/Nu là/V được/V ./CH\nMột_số/L phiên_bản/N cài_đặt/V tự/P định_nghĩa/N lớp/N số_ảo/Np bằng/E một/M struct/Np hoặc/Cc class/Np ./CH\nNếu/C lớp/N tự/P viết/V này/P không/R có/V chức_năng/N đặc_biệt/A nào/P thì/C việc/N này/P là/V không/R cần_thiết/A vì/E bản_thân/N lt;complexgt;/Np đã_là/Np một/M lớp/N rồi/C ./CH\nBạn/N có_thể/R xem/V qua/V file/Np thư_viện/N trong/E thư_mục/Np cài_đặt/V trình/V biên_dịch/Np ,/CH ví_dụ/C với/E CodeBlocks/Np thì/C đường_dẫn/Np có/V dạng/N CodeBlocks\\MinGW\\lib\\gcc\\mingw32\\4/Np ./CH 7/M ./CH 1\\include\\c++\\complex/Np (file/Np ko/Np có/V phần/N mở/V rộng)/Np ./CH\nChuẩn/N hóa/Z bậc/N đa_thức/Np Trong/E các/L phần/N trên/E ta/P đã/R giả_sử/Np rằng/C n/Ny là/V lũy_thừa/Np của/E 2/M ./CH\nĐể/E đảm_bảo/V tính/V đối_xứng/Np và/Cc thuận_tiện/N khi/N cài_đặt/V ,/CH nếu/C đề_bài/Np không/R cho/E trước/E n/Ny bậc/N của/E đa_thức/Np là/V lũy_thừa/Np của/E 2/M thì/C ta/P cần/V chuẩn/N hóa/Z thành/V số/N lũy_thừa/Np nhỏ/A nhất/A mà/C lớn/A hơn/A n/Ny ./CH\nChẳng_hạn/X với/E n/Ny =/CH 105/Np thì/C giá_trị/N chuẩn/N hóa/Z là/V 217/Np =/CH 131072/Np vì/E 216/Np =/CH 65536/Np lt;/Np 105/Np ./CH\nCác/L hệ_số/N của/E bậc/N cao/A hơn/A giá_trị_n/Np ban_đầu/N gán/V bằng/E 0/M ./CH\nĐệ_quy/Np và/Cc Khử/N đệ_quy/Np Đệ_quy/Np :/CH Xét/V một/M đoạn/Nc mã/N C++/Np cài_đặt/V hàm/Np FFT/Np sử_dụng/V đệ_quy/Np như_sau/Np :/CH void/Np fft_slow/Np (/CH int/Np n/Ny ,/CH vb/Np amp;/Np a/Ni )/CH //CH biến_đổi/V fft/Np của/E vector/Np a/Ni ,/CH lưu/V kết_quả/N vào/E chính/T nó/P if/Np (/CH n/Ny ==/Np 1/M )/CH return/Np ;/CH int/Np i/M ,/CH j/Np ,/CH k/N ;/CH //CH Bước/V 1/M ./CH\nKhai_báo/V kết_quả/N fft/Np chẵn/Np và/Cc lẻ/A vb/Np a_even/Np (/CH n/Ny //CH 2/M )/CH ,/CH a_odd/Np (/CH n/Ny //CH 2/M );/CH //CH Bước/V 2/M ./CH\nTách/V hàng/N chẵn/Np và/Cc hàng/N lẻ/A for/Np (/CH i/M =/CH j/Np =/CH 0/M ;/CH i/M lt;/Np n/Ny ;/CH i/M +=/Np 2/M )/CH a_even/Np j/Np =/CH a/Ni i/M ;/CH a_odd/Np j/Np =/CH a/Ni i/M +/CH 1/M ;/CH ++/Np j/Np ;/CH //CH Bước/V 3/M ./CH\nBiến_đổi/V FFT/Np với/E các/L hàng/N chẵn/Np ,/CH lẻ/A fft_slow/Np (/CH n/Ny //CH 2/M ,/CH a_even/Np );/CH fft_slow/Np (/CH n/Ny //CH 2/M ,/CH a_odd/Np );/CH //CH Bước/V 4/M :/CH Ghép/V hoàn_chỉnh/V kết_quả/N double/Np ang/Np =/CH 2/M PI/Np //CH n/Ny ;/CH base/Np w/Nu (/CH 1/M )/CH ,/CH wn/Np (/CH cos/Np (/CH ang/Np )/CH ,/CH sin/N (/CH ang/Np ));/Np for/Np (/CH i/M =/CH 0/M ;/CH i/M lt;/Np n/Ny //CH 2/M ;/CH ++/Np i/M )/CH a/Ni i/M =/CH a_even/Np i/M +/CH w/Nu a_odd/Np i/M ;/CH a/Ni i/M +/CH n/Ny //CH 2/M =/CH a_even/Np i/M -/CH w/Nu a_odd/Np i/M ;/CH w/Nu =/CH wn/Np ;/CH Có/V nhiều/A nguyên_nhân/N làm_cho/Np FFT/Np đệ_quy/Np chạy/V chậm/A ,/CH như/C trong/E Bước/V 1/M thì/C khai_báo/V hai/M vector/Np kích_cỡ/N n/Ny lớn/A như_vậy/X và/Cc lại/R khai_báo/V liên_tục/A ở/E các/L mức/N đệ_quy/Np ./CH\nBản_thân/N chương_trình/N đệ_quy/Np cũng/R chạy/V chậm/A vì/E chương_trình/N phải/V lưu/V rất/R nhiều/A con_trỏ/Np stack/Np và/Cc liên_tục/A giải_phóng/V bộ_nhớ/Np của/E biến/V cục_bộ/A ở/E mỗi/L mức/N đệ_quy/Np ./CH\nNhìn_chung/X đệ_quy/Np chỉ_có/Np ý_nghĩa/N như/C trong/E thuật_toán/N Quy_Hoạch_Động/Np khi/N ta/P muốn/V tìm/V kết_quả/N của/E một/M công_thức/N truy_hồi/Np mà/C chỉ/R duyệt/V qua/V những/L trạng_thái/N liên_quan/V trực_tiếp/A tới/E kết_quả/N ./CH\nTrong/E FFT_ta/Np luôn/R phải/V thăm/V hết/V các/L ma_trận/N con/Nc nên/C cài_đặt/V FFT/Np bằng/E đệ_quy/Np không/R có_lợi/Np về/E tốc_độ/N thực_hiện/V ./CH\nĐể_cho/Np đầy_đủ/A thì/C ta/P cũng/R có/V hàm/Np biến_đổi/V FFT_ngược/Np như_sau/Np :/CH void/Np inverse_fft_slow/Np (/CH int/Np n/Ny ,/CH vb/Np amp;/Np a/Ni )/CH if/Np (/CH n/Ny ==/Np 1/M )/CH return/Np ;/CH int/Np i/M ,/CH j/Np ,/CH k/N ;/CH vb/Np a_even/Np ,/CH a_odd/Np ;/CH for/Np (/CH i/M =/CH 0/M ;/CH i/M lt;/Np n/Ny ;/CH ++/Np i/M )/CH if/Np (/CH i/M amp;/Np 1/M )/CH a_odd/Np ./CH\npush_back/Np (/CH a/Ni i/M );/CH else/Np a_even/Np ./CH\npush_back/Np (/CH a/Ni i/M );/CH inverse_fft_slow/Np (/CH n/Ny //CH 2/M ,/CH a_even/Np );/CH inverse_fft_slow/Np (/CH n/Ny //CH 2/M ,/CH a_odd/Np );/CH double/Np ang/Np =/CH -/CH 2/M PI/Np //CH n/Ny ;/CH base/Np w/Nu (/CH 1/M )/CH ,/CH wn/Np (/CH cos/Np (/CH ang/Np )/CH ,/CH sin/N (/CH ang/Np ));/Np for/Np (/CH i/M =/CH 0/M ;/CH i/M lt;/Np n/Ny //CH 2/M ;/CH ++/Np i/M )/CH a/Ni i/M =/CH a_even/Np i/M +/CH w/Nu a_odd/Np i/M ;/CH a/Ni i/M /=/Np 2/M ;/CH a/Ni i/M +/CH n/Ny //CH 2/M =/CH a_even/Np i/M -/CH w/Nu a_odd/Np i/M ;/CH a/Ni i/M +/CH n/Ny //CH 2/M /=/Np 2/M ;/CH w/Nu =/CH wn/Np ;/CH Khử/N đệ_quy/Np :/CH Để/E khử/N đệ_quy/Np thì/C ta/P cần/V phân_tích/V mối/N liên_hệ/V giữa/N các/L lời/N gọi/V đệ_quy/Np và/Cc xem/V các/L phần_tử/N được/V tính/V theo/V thứ_tự/N nào/P ./CH\nHình_vẽ/Np sau_đây/Np minh_họa/V trường_hợp/N n/Ny =/CH 8/M :/CH Màu/N đỏ/A là/V các/L nhóm/N chẵn/Np và/Cc màu/N xanh/A là/V các/L nhóm/N lẻ/A ./CH\nCác/L bạn/N hãy/R dựa/V vào/E tính/V chẵn_lẻ/Np và/Cc để_ý/V các/L số/N nhị_phân/Np 0/M ,/CH 1/M trong/E hình_vẽ/Np để/E tự/P viết/V chương_trình/N FFT/Np khử/N đệ_quy/Np hoặc/Cc giải_thích/V tính/V đúng_đắn/A của/E đoạn/Nc mã/N sau/E (đây/Np là/V hàm/Np FFT/Np đã/R được/V dùng/V để/E giải/N bài/N POST2)/Np define/Np PI/Np acos(-1)/Np const/Np int/Np NBIT/Np =/CH 18/M ;/CH const/Np int/Np N/Ny =/CH 1/M lt;lt;/Np 18/M ;/CH //CH chuẩn/N hóa/Z bậc/N của/E đa_thức/Np là/V 18/M base/Np W_N/Np ;/CH //CH mảng/N lưu/V các/L nghiệm/V nguyên_thủy/Np //CH Hàm/Np reverse/Np bit/Np :/CH Đảo_ngược/V nbit/Np đầu_tiên/A trong/E mã/N nhị_phân/Np của/E số/N mask/Np int/Np revBit/Np (/CH int/Np nbit/Np ,/CH int/Np mask/Np )/CH int/Np i/M ,/CH j/Np ;/CH for/Np (/CH i/M =/CH 0/M ,/CH j/Np =/CH nbit/Np -/CH 1/M ;/CH i/M lt;=/Np j/Np ;/CH ++/Np i/M ,/CH --/Np j/Np )/CH if/Np (/CH (/CH mask/Np gt;gt;/Np i/M amp;/Np 1/M )/CH !/CH =/CH (/CH mask/Np gt;gt;/Np j/Np amp;/Np 1/M )/CH )/CH mask/Np =/CH 1/M lt;lt;/Np i/M ;/CH mask/Np =/CH 1/M lt;lt;/Np j/Np ;/CH return/Np mask/Np ;/CH //CH Biến_đổi/V FFT/Np của/E mảng/N a/Ni void/Np fft/Np (/CH int/Np n/Ny ,/CH vb/Np amp;/Np a/Ni )/CH if/Np (/CH n/Ny ==/Np 1/M )/CH return/Np ;/CH int/Np i/M ,/CH j/Np ,/CH k/N ;/CH //CH Đi/V từ/E dưới/E lên/V trên/E của/E cây/N đệ_quy/Np :/CH Hàng/N cuối_cùng/A giá_trị/N bằng/E với/E mảng/N được/V cho/E ban_đầu/N nhưng/C hóa/Z đổi/V vị_trí/N //CH theo/V số/N có/V biểu_diễn/V nhị_phân/Np ngược/A với/E chỉ_số/N for/Np (/CH i/M =/CH 0/M ;/CH i/M lt;/Np n/Ny ;/CH ++/Np i/M )/CH j/Np =/CH revBit/Np (/CH NBIT/Np ,/CH i/M );/CH if/Np (/CH i/M lt;/Np j/Np )/CH swap/Np (/CH a/Ni i/M ,/CH a/Ni j/Np );/CH vb/Np anext/Np (/CH n/Ny );/CH //CH hàng/N tiếp_theo/V //CH chiều_cao/N cây/N bằng/E Log(n)/Np //CH biến/V \"step\"/Np lưu_số/Np phần_tử/N nằm/V trong/E một/M nhóm/N chẵn/Np hoặc/Cc lẻ/A for/Np (/CH int/Np step/Np =/CH 1/M ;/CH step/Np lt;/Np n/Ny ;/CH step/Np lt;lt;=/Np 1/M )/CH double/Np ang/Np =/CH PI/Np //CH step/Np ;/CH //2PI/Np 2);/Np base/Np w/Nu (/CH 1/M )/CH ,/CH wn/Np (/CH cos/Np (/CH ang/Np )/CH ,/CH sin/N (/CH ang/Np ));/Np //CH Lưu/V trước_mảng/Np nghiệm/V nguyên_thủy/Np for/Np (/CH i/M =/CH 0/M ;/CH i/M lt;/Np step/Np ;/CH ++/Np i/M )/CH W/Nu i/M =/CH w/Nu ;/CH w/Nu =/CH wn/Np ;/CH //CH Cứ/R một/M nhóm/N chẵn/Np và/Cc một/M nhóm/N lẻ/A cạnh/N nhau/N thì/C tạo_thành/Np kết_quả/N cho/E hàng/N ở/E trên/E //CH Duyệt/V qua/V tất_cả/P các/L nhóm/N chẵn/Np và/Cc nhóm/N lẻ/A cạnh/N nó/P //CH even/Np =/CH chẵn/Np ,/CH odd/Np =/CH lẻ/A int/Np start_even/Np =/CH 0/M ;/CH int/Np start_odd/Np =/CH start_even/Np +/CH step/Np ;/CH while/Np (/CH start_even/Np lt;/Np n/Ny )/CH for/Np (/CH i/M =/CH 0/M ;/CH i/M lt;/Np step/Np ;/CH ++/Np i/M )/CH anext/Np start_even/Np +/CH i/M =/CH a/Ni start_even/Np +/CH i/M +/CH W/Nu i/M a/Ni start_odd/Np +/CH i/M ;/CH anext/Np start_even/Np +/CH i/M +/CH step/Np =/CH a/Ni start_even/Np +/CH i/M -/CH W/Nu i/M a/Ni start_odd/Np +/CH i/M ;/CH start_even/Np +=/Np 2/M step/Np ;/CH start_odd/Np =/CH start_even/Np +/CH step/Np ;/CH for/Np (/CH i/M =/CH 0/M ;/CH i/M lt;/Np n/Ny ;/CH ++/Np i/M )/CH a/Ni i/M =/CH anext/Np i/M ;/CH Sau_đây/Np là/V cài_đặt/V cho/E cả/P FFT/Np xuôi/N và/Cc ngược/A ./CH\nBiến/V invert/Np =/CH true/Np cho/E FFT_ngược/Np ./CH\nvoid/Np fft/Np (/CH int/Np n/Ny ,/CH vb/Np amp;/Np a/Ni ,/CH bool/Np invert/Np )/CH if/Np (/CH n/Ny ==/Np 1/M )/CH return/Np ;/CH int/Np i/M ,/CH j/Np ,/CH k/N ;/CH for/Np (/CH i/M =/CH 0/M ;/CH i/M lt;/Np n/Ny ;/CH ++/Np i/M )/CH j/Np =/CH revBit/Np (/CH NBIT/Np ,/CH i/M );/CH if/Np (/CH i/M lt;/Np j/Np )/CH swap/Np (/CH a/Ni i/M ,/CH a/Ni j/Np );/CH vb/Np anext/Np (/CH n/Ny );/CH for/Np (/CH int/Np step/Np =/CH 1/M ;/CH step/Np lt;/Np n/Ny ;/CH step/Np lt;lt;=/Np 1/M )/CH double/Np ang/Np =/CH PI/Np //CH step/Np ;/CH if/Np (/CH invert/Np )/CH ang/Np =/CH -/CH ang/Np ;/CH base/Np w/Nu (/CH 1/M )/CH ,/CH wn/Np (/CH cos/Np (/CH ang/Np )/CH ,/CH sin/N (/CH ang/Np ));/Np for/Np (/CH i/M =/CH 0/M ;/CH i/M lt;/Np step/Np ;/CH ++/Np i/M )/CH W/Nu i/M =/CH w/Nu ;/CH w/Nu =/CH wn/Np ;/CH int/Np start_even/Np =/CH 0/M ;/CH int/Np start_odd/Np =/CH start_even/Np +/CH step/Np ;/CH while/Np (/CH start_even/Np lt;/Np n/Ny )/CH for/Np (/CH i/M =/CH 0/M ;/CH i/M lt;/Np step/Np ;/CH ++/Np i/M )/CH anext/Np start_even/Np +/CH i/M =/CH a/Ni start_even/Np +/CH i/M +/CH W/Nu i/M a/Ni start_odd/Np +/CH i/M ;/CH anext/Np start_even/Np +/CH i/M +/CH step/Np =/CH a/Ni start_even/Np +/CH i/M -/CH W/Nu i/M a/Ni start_odd/Np +/CH i/M ;/CH start_even/Np +=/Np 2/M step/Np ;/CH start_odd/Np =/CH start_even/Np +/CH step/Np ;/CH for/Np (/CH i/M =/CH 0/M ;/CH i/M lt;/Np n/Ny ;/CH ++/Np i/M )/CH a/Ni i/M =/CH anext/Np i/M ;/CH if/Np (/CH invert/Np )/CH for/Np (/CH i/M =/CH 0/M ;/CH i/M lt;/Np n/Ny ;/CH ++/Np i/M )/CH a/Ni i/M /=/Np n/Ny ;/CH Một_số/L cách/N cài_đặt/V khác/A sử_dụng/V con_trỏ/Np cũng/R làm/V tăng_tốc_độ/Np thực_thi/V ,/CH có_thể/R xem/V thêm/V trong/E trang/N của/E emaxx/Np phần/N tài_liệu/N tham_khảo/V ./CH\nCũng/R trong/E trang/N của/E emaxx/Np có_thể/R tìm_thấy/Np cách/N cài_đặt/V gộp/V hai/M hàm/Np fft/Np và/Cc inverse_fft/Np lại/R làm/V một/M sử_dụng/V một/M biến/V bool/Np invert/Np làm_cho/Np code/Np ngắn_gọn/A hơn/A ./CH\nBài_tập/Np luyện_tập/V VOJ_POST2_FFT/Np problems/Np on/Np Codeforces_FFT/Np problems/Np by/Np a2oj/Np ./CH com/Np SumOfArrays/Np -/CH Topcoder_SRM/Np 603/Np và/Cc Hướng_dẫn_giải/Np Tài_liệu/N tham_khảo/V 1/M Rohit_Thummalapalli/Np ./CH\nFourier_Transform/Np :/CH Nature’s_Way/Np of/E Analyzing_Data/Np ./CH\nYale_Scientific/Np ,/CH 2010/M ./CH\nLink/Np 2/M Alejandro_Dominguez/Np ./CH\nHighlights/Np in/V the/B History/Np of/E the/B Fourier_Transform/Np ./CH\nIEEE_Pulse/Np ,/CH 2016/Np ./CH\nLink/Np 3/M Stefan_Woerner/Np ./CH\nFast_Fourier_Transform/Np ./CH\nNumerical_Analysis_Seminar/Np ,/CH Swiss_Federal_Institute/Np of/E Technology_Zurich/Np ,/CH 2008/M ./CH\nLink/Np 4/M Fortnow/Np and/Np Homer/Np ./CH\nA_Short_History/Np of/E Computational_Complexity/Np ./CH\nBulletin/Np of/E the_European/Np Association/Np for/Np Theoretical_Computer_Science/Np 80/M ,/CH June/Np 2003/M ./CH\nLink/Np Bài_toán/N nhân/N đa_thức/Np ,/CH phép/N biến_đổi/V Fourier/Np nhanh/A trên/E csstudyfun/Np ./CH wordpress/Np ./CH com/Np (có/Np chứng_minh/V các/L tính_chất/N được/V đề_cập/V trong/E bài/N Bài_giảng/Np của/E trường/N DH_Aalto/Np ,/CH Phần_Lan/Np Code/Np cài_đặt/V của/E e-maxx/Np \"Tutorial/Np on/Np FFT/Np —/Np The/B tough/Np made/Np simple/Np ./CH \"/CH trên/E Codeforces/Np\n", "title": "FFT\n", "link": "http://vnoi.info/wiki/algo/trick/FFT\n"}