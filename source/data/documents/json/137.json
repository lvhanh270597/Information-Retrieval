{"content": "Nơi tổng_hợp và chia_sẻ những kiến_thức liên_quan tới giải_thuật nói_chung và lý_thuyết khoa_học máy_tính nói_riêng .\nin Trong , chúng_ta đã làm_quen với thuật_toán duyệt theo chiều_sâu DFS trên đồ_thị (vô hướng) .\nChúng_ta cũng chưa có dịp để thảo_luận về các ứng_dụng của thuật_toán DFS mặc_dù đây là một thuật_toán có rất nhiều ứng_dụng trong thiết_kế giải_thuật .\nTrong phần này chúng_ta sẽ làm_quen với ứng_dụng của DFS trong bài_toán sắp_xếp Topo (Topological Sort) .\n.\nĐể dễ phân biết , ta kí_hiệu đồ_thị có hướng là .\nĐồ_thị vô_hướng thu được từ bằng cách bỏ_qua hướng của cạnh ta sẽ kí_hiệu là .\nMột_số khái_niệm khác ở chúng_ta sẽ không nhắc_lại ở đây nữa .\nGiả mã của thuật_toán DFS cơ_bản thăm đồ_thị như_sau : Gọi_là các đỉnh được thăm ở dòng .\nMột đỉnh được gọi_là (reachable from ) nếu tồn_tại một đường_đi có hướng từ tới .\nDễ thấy với mọi , đỉnh nằm trong tầm với một trong các đỉnh của .\nBây_giờ ta muốn xem mỗi đỉnh nằm trong tầm với của đỉnh nào trong .\nMột đỉnh có_thể nằm trong tầm với của hai hay nhiều đỉnh khác_nhau trong , nhưng ở đây ta chỉ quan_tâm để đỉnh_đầu tiên trong , i . e , đỉnh có chỉ_số nhỏ nhất , mà nằm trong tầm với của đỉnh đó .\nNgoài_ra , nếu nằm trong tầm với của , ta muốn in ra đường_đi từ đến .\nTa gọi mỗi đỉnh là của . Để thu được thông_tin đó , ta sẽ sửa_đổi DFS một_chút bằng cách thêm một_vài mảng đánh_dấu .\nTa sử_dụng mảng trong đó nếu là nguồn của .\nBan_đầu khởi tạo với mỗi .\nĐể lưu vết đường_đi từ đến , ta sẽ lưu một mảng trong đó nếu cung nằm trong đường_đi từ tới .\nHay nói_cách_khác , đứng ngay trước trong đường_đi có hướng từ tới .\nTa gọi cung là bởi DFS .\nKhi ta đã có mảng thì đường_đi từ tới (viết theo thứ_tự ngược) là : .\nThủ_tục in ra đường_đi từ tới theo thứ_tự ngược (in thứ_tự xuôi coi_như bài_tập cho bạn đọc) : Code_C : Giả mã của DFS sửa_đổi : Code_C : Ví_dụ thực_thi thủ_tục trên trong hình dưới_đây .\nCác cung màu đỏ là các cung được thăm bởi DFS .\nNhìn vào hình_vẽ ta thấy các cung này sẽ tạo_thành một rừng (forest) gọi_là (DFS forest) , trong đó gốc của mỗi cây (đỉnh được tô màu) trong rừng là một đỉnh trong .\nTa sẽ chứng_minh điều này một_cách hình_thức hơn trong Lemma 1 . Gọi_là tập các cung được thăm bởi DFS .\nTa có : Ta sẽ chứng_minh mỗi là một cây có hướng gốc tại .\nViệc chứng_minh các đỉnh của đều đến được từ coi_như bài_tập cho bạn_đọc .\nTừ thủ_tục DFS ở trên , ta có nhận_xét : Mỗi đỉnh , tồn_tại duy_nhất một đỉnh sao_cho . Xét cây vô_hướng tương_ứng , giả_sử có ít_nhất một chu_trình .\nXét một chu_trình (vô hướng) nào_đó của có đỉnh .\nGọi_là một đỉnh của được thăm đầu_tiên bởi DFS .\nGọi_là thứ_tự các đỉnh dọc theo sao_cho kề với .\nDo là đỉnh được thăm đầu_tiên , được thăm sau .\nDo các cạnh thăm bởi DFS đều có dạng và là duy_nhất , ta suy ra .\nLập_luận tương_tự ta có : Do , ta dễ_dàng suy ra hoặc .\nDo và , ta có .\nNhưng điều này trái với giả_thiết là đỉnh được thăm đầu_tiên của .\nDo_đó , chu_trình không tồn_tại .\nHay nói_cách_khác , là một cây . Xét các cung được thăm và không được thăm bởi DFS , ta có 4 loại cung sau : Các cung của cây DFS khá là dễ phân bệt và đó chính là cung trong đó là đỉnh được gọi ở dòng (trong giả mã có đoạn mã màu đỏ ở trên) .\nTrong điều kiên ở vòng for ở thủ_tục , các cung mà là visitted sẽ có_thể là một trong 3 loại cung : chéo , ngược hoặc xuối .\nDo_đó , chỉ với hai nhãn này thì ta chưa phân biết được cung ngược với các cung khác (bài này ta chưa cần phân_biệt cung chéo và cung xuôi) .\nNhắc_lại , cung ngược là cung từ một đỉnh tới một đỉnh tổ_tiên của nó trong cùng một cây của rừng DFS . Để phát_hiện ra cung xuôi_ta phải dùng thêm một nhãn nữa_là nhãn , bên_cạnh hai nhãn là visitted và unvissited .\nÝ_nghĩa các nhãn như_sau : Dựa vào định_nghĩa của các nhãn , ta suy ra : khi đang thăm đỉnh (có nhãn visitting) , nếu ta bắt_gặp đỉnh mà : Như_vậy ta \"gần như\" đã phân_loại được được các cạnh của DFS .\nĐể phân_biệt cung xuôi và cung chéo , ta cần sửa_đổi DFS hơn_nữa .\nVấn_đề này ta sẽ tìm_hiểu trong bài sau .\nGiả mã như_sau : Code_C : Một đồ_thị có hướng được gọi_là (directed acyclic graph -- đồ_thị có hướng và không có chu trình) nếu .\nỞ đây ta nhấn_mạnh cụm_từ .\nĐiều đó có_nghĩa là đồ_thị vô_hướng tương_ứng vẫn có_thể có chu_trình .\nĐồ_thị trong ví_dụ ở trên không_phải là DAG do đồ_thị đó có chu_trình .\nĐồ_thị trong hình dưới_đây là một DAG .\nTa có bài_toán sau : Gọi_là đồ_thị thu được bằng cách đảo_ngược các cung của .\nTa có nhận_xét sau : Đỉnh của đồ_thị được gọi_là một (source vertex) nếu_như không tồn_tại sao_cho .\nNói_cách_khác , là phát nếu bậc tới (in-degree) của bằng .\nĐỉnh của đồ_thị được gọi_là một (sink vertex) nếu_như không tồn_tại sao_cho .\nHay nói_cách_khác , là đỉnh thu nếu bậc lui (out-degree) của bằng .\nVí_dụ trong hình dưới_đây , các đỉnh là các đỉnh phát , các đỉnh là các đỉnh thu .\nTa có bổ_đề sau : Nhận_xét đỉnh phát của chính là đỉnh thu của .\nDo_đó , dựa vào Fact 1 , ta chỉ_cần chứng_minh luôn có_một đỉnh phátChọn một đỉnh và đánh_dấu đỉnh .\nGọi_là đỉnh sao_cho .\nNếu_không tồn_tại thì_là đỉnh thu , bổ_đề là đúng .\nNếu tồn_tại , ta tiếp_tục đánh_dấu và lặp_lại quá_trình đánh_dấu như_vậy cho_đến khi ta gặp một đỉnh là đỉnh thu hoặc tồn_tại một đỉnh sao_cho và đã được đánh_dấu .\nTrong trường_hợp sau , ta sẽ tìm được một chu_trình có hướng bao_gồm các đỉnh đã đánh_dấu , trái với giả_thiết là DAG . Gọi_là tập các đỉnh nguồn của .\nThêm vào một đỉnh và thêm cung .\nGọi_là đồ_thị thu được .\nDễ thấy : nếu là DAG thì cũng là DAG và ngược_lại .\nNgoài_ra , nếu ta thực_hiện DFS bắt_đầu_từ , ta sẽ chỉ thu được duy_nhất một cây DFS gốc tại (tại sao ? ) .\nTa có bổ_đề sau : Chiều thuận của bổ_đề khá dễ để chứng_minh .\nNếu cây DFS gốc tại có cung là cung ngược , và đều có nhãn unvisiting .\nDo_đó là cung ngược , sẽ là tổ tiền_của trong cây DFS .\nHay nói_cách_khác , có_một đường_đi từ đến .\nĐường_đi đó kết_hợp với cạnh sẽ tạo_thành một chu_trình có hướng .\nDo_đó không_phải là DAG . Ta chứng_minh chiều ngược_lại bằng phản_chứng .\nGiả_sử không_phải là DAG , gọi_là một chu_trình có hướng của .\nGọi_là đỉnh_đầu tiên của được thăm bởi DFS và là đỉnh mà .\nĐỉnh chỉ được đánh_dấu là visited sau khi tất_cả các đỉnh trong tầm với của (reachable from ) , trong đó có , đã được đánh_dấu là visited .\nDo_đó , khi ta thăm , đỉnh_đang được đánh_dấu là visiting .\nNhư_vậy , là cung ngược , trái với giả_thiết là cây DFS không có cung ngược .\nTừ_Lemma 3 , ta có_thể giải Problem 1 bằng cách thay_đổi một_chút thủ_tục như_sau : Code_C : Nếu biểu_diễn đồ_thị bằng danh_sách kề , mỗi đỉnh có hai danh_sách : một danh_sách các đỉnh (gọi là các đỉnh tới) sao_cho và một danh_sách khác lưu các đỉnh (gọi là các đỉnh lui) sao_cho thì việc phát_hiện các đỉnh phát (sink) có_thể được thực_hiện trong thời_gian .\nNếu ta chỉ lưu một danh_sách là các đỉnh tới thì việc phát_hiện nguồn có_thể thực_hiện trong thời_gian bằng cách duyệt qua các cung và đánh_dấu các đỉnh cuối của mỗi cung .\nCác đỉnh không bị đánh_dấu chính là các đỉnh nguồn .\nViệc thêm đỉnh vào đồ_thị cũng có_thể được thực_hiện trong thời_gian .\nThuật_toán DFS có thời_gian .\nDo_đó thời_gian của thuật_toán là .\n: Đỉnh thêm vào đồ_thị để việc trình_bày thuật toạn được đơn_giản hơn .\nKhi thực_thi thuật_toán , ta không nhất_thiết phải thêm vào đỉnh này .\nNgoài_ra , dựa vào chứng_minh của Lemma 3 , ta có_thể dễ_dàng mở_rộng thuật_toán để in ra một chu_trình có hướng trong trường_hợp không_phải là DAG .\nChi_tiết coi_như bài_tập cho bạn_đọc .\ncủa một đồ_thị có hướng là một_cách sắp_xếp các đỉnh trên một đường_thẳng sao_cho với mỗi cung , đỉnh nằm bên trái đỉnh trên đường_thẳng đó .\nVí_dụ hình (6) dưới_đây là một sắp_xếp topo của đồ_thị trong hình (5) .\nTừ định_nghĩa của săp xếp Topo ta có_thể dễ_dàng thấy rằng nếu có_một sắp_xếp Topo thì không_thể có_một chu_trình có hướng .\nHay nói_cách_khác , là một DAG .\nNgược_lại , cho một DAG , luôn tồn_tại một sắp_xếp Topo cho .\nTa sẽ chứng_minh điều này bằng cách thiết_kế một giải_thuật để tìm sắp_xếp Topo đó .\nTa có : Ta có_thể coi sắp_xếp Topo giống_như gán lại chỉ_số trong tập cho mỗi đỉnh sao_cho với mỗi cung , đỉnh được gán chỉ_số nhỏ hơn .\nĐể biểu_diễn thứ_tự của sắp_xếp Topo , ta sẽ dùng một mảng trong đó nếu thì .\nGọi_là tập các đỉnh nguồn của .\nTa có : Ta có_thể đổi chỗ các đỉnh trong tập trong một sắp_xếp Topo của mà thứ_tự các đỉnh sau khi đổi chỗ vẫn là thứ_tự của một sắp_xếp Topo (khác) của . Dựa vào nhận_xét trên , ta có_thể tìm một sắp_xếp Topo của DAG như_sau : Mỗi lần_ta phát_hiện ra một đỉnh nguồn mới , ta sẽ đưa đỉnh đó vào vị_trí còn trống đầu_tiên của mảng và xóa_đỉnh nguồn đó từ đồ_thị .\nNgoài_ra , ta sẽ dùng một_tập hợp để lưu_trữ các đỉnh nguồn của đồ_thị hiện_tại .\nThuật_toán như_sau : Trong thực_tế cài_đặt , ta sẽ không thực_sự \"xóa\" đỉnh ra khỏi đồ_thị mà ta chỉ_cần dùng mảng để đánh_dấu là đỉnh đó đã bị \"xóa\" .\nTa sẽ chứng_minh : Ta sẽ chứng_minh nếu thì sẽ được gán chỉ_số nhỏ hơn .\nGiả_sử ngược_lại , tồn_tại cung mà được gán chỉ_số lớn hơn .\nTừ_đó suy ra khi ta gán chỉ_số cho , đã được gán chỉ_số rồi , và do_đó , sẽ bị xóa_khỏi đồ_thị .\nDo_đó , đã được đưa_vào trong khỏi .\nNhưng điều đó có_nghĩa là khi vào , cung vẫn thuộc , trái với điều_kiện khi ta đưa_vào .\nDo_đó , cung như_vậy không tồn_tại .\nHay nói_cách_khác , đầu_ra của thuật_toán là một sắp_xếp Topo .\nTa sẽ dùng danh_sách kề , với mỗi đỉnh , danh_sách kề của chỉ lưu các đỉnh mà .\nHay nói_cách_khác , danh_sách kề của chỉ lưu các out-neighbor của .\nTa sẽ dùng một mảng để đánh_dấu đỉnh nào đã bị \"xóa\" ra khỏi đồ_thị , i . e nếu bị xóa và nếu ngược_lại .\nThao_tác khó nhất_là kiểm_tra xem sau khi xóa_khỏi đồ_thị , có_trở thành đỉnh nguồn hay_không (dòng if có comment ở giả mã trên) .\nTa có_thể thực_thi bằng cách duyệt qua các hàng_xóm tới (in-neighbors) của và kiểm_tra xem hay_không .\nNếu mọi hàng_xóm tới của đều đã bị xóa , sẽ là đỉnh nguồn và ta đưa_vào .\nTuy_nhiên , để làm như_vậy , ta phải lưu thêm một danh_sách các hàng_xóm tới cho mỗi đỉnh , và nếu_không cẩn_thận , mỗi thao_tác duyệt sẽ mất thời_gian là bậc tới của , do_đó làm_cho tổng thời_gian thành .\nĐể giải_quyết tình_trạng này , ta sẽ lưu thêm một mảng trong đó nếu bậc tới (in-degree) của là trong đồ_thị hiện_tại (không tính các đỉnh đã \"xóa\") .\nDo_đó , mỗi lần \"xóa\" ra khỏi đồ_thị , ta chỉ việc cập_nhật lại mảng và đỉnh điều_kiện ở dòng if sẽ trở_thành (xem giả mã dưới đây) .\nDo_đó , thao_tác kiểm_tra này mất .\nNhư_vậy , tổng thời_gian của thuật_toán là .\nGiả mã : Code_C : Theo , giải_thuật sắp_xếp Topo mà ta mô_tả ở đây được phát_triển bởi Kahn 1 năm 1966 .\nNgoài_ra còn giải_thuật khác sử_dụng DFS khá giống với thủ_tục .\nGiải_thuật này được mô_tả bởi Tarjan 2 vào năm 1974 và được sử_dụng trong textbook CLRS3 .\nCode đầy_đủ : , , .\n1 Kahn , Arthur_B .\nCommunications of the ACM 5 . 11 (1962) : 558-562 .\n2 Tarjan , Robert_Endre .\nComputer_Science_Department , School of Humanities and Sciences , Stanford_University , 1974 .\n3 Cormen , Thomas_H . ; Leiserson , Charles_E . ; Rivest , Ronald_L . ; Stein , Clifford (2001) 1990 .\n(2nd ed . ) .\nChapter 22 . 5 . MIT_Press and McGraw-Hill .\n, , , , Trackback link : Powered by and\n", "tagged": "Nơi/N tổng_hợp/V và/Cc chia_sẻ/V những/L kiến_thức/N liên_quan/V tới/E giải_thuật/Np nói_chung/X và/Cc lý_thuyết/Np khoa_học/N máy_tính/N nói_riêng/X ./CH\nin/V Trong/E ,/CH chúng_ta/P đã/R làm_quen/V với/E thuật_toán/N duyệt/V theo/V chiều_sâu/Np DFS/Np trên/E đồ_thị/Np (vô/Np hướng)/Np ./CH\nChúng_ta/P cũng/R chưa/R có/V dịp/N để/E thảo_luận/V về/E các/L ứng_dụng/V của/E thuật_toán/N DFS/Np mặc_dù/C đây/P là/V một/M thuật_toán/N có/V rất/R nhiều/A ứng_dụng/V trong/E thiết_kế/V giải_thuật/Np ./CH\nTrong/E phần/N này/P chúng_ta/P sẽ/R làm_quen/V với/E ứng_dụng/V của/E DFS/Np trong/E bài_toán/N sắp_xếp/V Topo/Np (Topological/Np Sort)/Np ./CH\n./CH\nĐể/E dễ/A phân/V biết/V ,/CH ta/P kí_hiệu/Np đồ_thị/Np có/V hướng/N là/V ./CH\nĐồ_thị/Np vô_hướng/Np thu/V được/V từ/E bằng/E cách/N bỏ_qua/V hướng/N của/E cạnh/N ta/P sẽ/R kí_hiệu/Np là/V ./CH\nMột_số/L khái_niệm/N khác/A ở/E chúng_ta/P sẽ/R không/R nhắc_lại/Np ở/E đây/P nữa/R ./CH\nGiả/A mã/N của/E thuật_toán/N DFS/Np cơ_bản/A thăm/V đồ_thị/Np như_sau/Np :/CH Gọi_là/V các/L đỉnh/N được/V thăm/V ở/E dòng/N ./CH\nMột/M đỉnh/N được/V gọi_là/V (reachable/Np from/Np )/CH nếu/C tồn_tại/V một/M đường_đi/Np có/V hướng/N từ/E tới/E ./CH\nDễ/A thấy/V với/E mọi/L ,/CH đỉnh/N nằm/V trong/E tầm/N với/E một/M trong/E các/L đỉnh/N của/E ./CH\nBây_giờ/P ta/P muốn/V xem/V mỗi/L đỉnh/N nằm/V trong/E tầm/N với/E của/E đỉnh/N nào/P trong/E ./CH\nMột/M đỉnh/N có_thể/R nằm/V trong/E tầm/N với/E của/E hai/M hay/Cc nhiều/A đỉnh/N khác_nhau/Np trong/E ,/CH nhưng/C ở/E đây/P ta/P chỉ/R quan_tâm/V để/E đỉnh_đầu/Np tiên/N trong/E ,/CH i/M ./CH e/Ni ,/CH đỉnh/N có/V chỉ_số/N nhỏ/A nhất/A ,/CH mà/C nằm/V trong/E tầm/N với/E của/E đỉnh/N đó/P ./CH\nNgoài_ra/X ,/CH nếu/C nằm/V trong/E tầm/N với/E của/E ,/CH ta/P muốn/V in/V ra/V đường_đi/Np từ/E đến/E ./CH\nTa/P gọi/V mỗi/L đỉnh/N là/V của/E ./CH Để/E thu/V được/V thông_tin/N đó/P ,/CH ta/P sẽ/R sửa_đổi/V DFS/Np một_chút/L bằng/E cách/N thêm/V một_vài/L mảng/N đánh_dấu/V ./CH\nTa/P sử_dụng/V mảng/N trong/E đó/P nếu/C là/V nguồn/N của/E ./CH\nBan_đầu/N khởi/V tạo/V với/E mỗi/L ./CH\nĐể/E lưu/V vết/N đường_đi/Np từ/E đến/E ,/CH ta/P sẽ/R lưu/V một/M mảng/N trong/E đó/P nếu/C cung/N nằm/V trong/E đường_đi/Np từ/E tới/E ./CH\nHay/Cc nói_cách_khác/Np ,/CH đứng/V ngay/R trước/E trong/E đường_đi/Np có/V hướng/N từ/E tới/E ./CH\nTa/P gọi/V cung/N là/V bởi/E DFS/Np ./CH\nKhi/N ta/P đã/R có/V mảng/N thì/C đường_đi/Np từ/E tới/E (viết/Np theo/V thứ_tự/N ngược)/Np là/V :/CH ./CH\nThủ_tục/N in/V ra/V đường_đi/Np từ/E tới/E theo/V thứ_tự/N ngược/A (in/Np thứ_tự/N xuôi/N coi_như/Np bài_tập/Np cho/E bạn/N đọc)/Np :/CH Code_C/Np :/CH Giả/A mã/N của/E DFS/Np sửa_đổi/V :/CH Code_C/Np :/CH Ví_dụ/C thực_thi/V thủ_tục/N trên/E trong/E hình/N dưới_đây/Np ./CH\nCác/L cung/N màu/N đỏ/A là/V các/L cung/N được/V thăm/V bởi/E DFS/Np ./CH\nNhìn/V vào/E hình_vẽ/Np ta/P thấy/V các/L cung/N này/P sẽ/R tạo_thành/Np một/M rừng/N (forest)/Np gọi_là/V (DFS/Np forest)/Np ,/CH trong/E đó/P gốc/N của/E mỗi/L cây/N (đỉnh/Np được/V tô/Np màu)/Np trong/E rừng/N là/V một/M đỉnh/N trong/E ./CH\nTa/P sẽ/R chứng_minh/V điều/N này/P một_cách/N hình_thức/N hơn/A trong/E Lemma/Np 1/M ./CH Gọi_là/V tập/V các/L cung/N được/V thăm/V bởi/E DFS/Np ./CH\nTa/P có/V :/CH Ta/P sẽ/R chứng_minh/V mỗi/L là/V một/M cây/N có/V hướng/N gốc/N tại/E ./CH\nViệc/N chứng_minh/V các/L đỉnh/N của/E đều/R đến/E được/V từ/E coi_như/Np bài_tập/Np cho/E bạn_đọc/N ./CH\nTừ/E thủ_tục/N DFS/Np ở/E trên/E ,/CH ta/P có/V nhận_xét/N :/CH Mỗi/L đỉnh/N ,/CH tồn_tại/V duy_nhất/A một/M đỉnh/N sao_cho/Np ./CH Xét/V cây/N vô_hướng/Np tương_ứng/V ,/CH giả_sử/Np có/V ít_nhất/A một/M chu_trình/N ./CH\nXét/V một/M chu_trình/N (vô/Np hướng)/Np nào_đó/P của/E có/V đỉnh/N ./CH\nGọi_là/V một/M đỉnh/N của/E được/V thăm/V đầu_tiên/A bởi/E DFS/Np ./CH\nGọi_là/V thứ_tự/N các/L đỉnh/N dọc/A theo/V sao_cho/Np kề/V với/E ./CH\nDo/E là/V đỉnh/N được/V thăm/V đầu_tiên/A ,/CH được/V thăm/V sau/E ./CH\nDo/E các/L cạnh/N thăm/V bởi/E DFS/Np đều/R có/V dạng/N và/Cc là/V duy_nhất/A ,/CH ta/P suy/V ra/V ./CH\nLập_luận/N tương_tự/A ta/P có/V :/CH Do/E ,/CH ta/P dễ_dàng/A suy/V ra/V hoặc/Cc ./CH\nDo/E và/Cc ,/CH ta/P có/V ./CH\nNhưng/C điều/N này/P trái/Nc với/E giả_thiết/N là/V đỉnh/N được/V thăm/V đầu_tiên/A của/E ./CH\nDo_đó/C ,/CH chu_trình/N không/R tồn_tại/V ./CH\nHay/Cc nói_cách_khác/Np ,/CH là/V một/M cây/N ./CH Xét/V các/L cung/N được/V thăm/V và/Cc không/R được/V thăm/V bởi/E DFS/Np ,/CH ta/P có/V 4/M loại/N cung/N sau/E :/CH Các/L cung/N của/E cây/N DFS/Np khá/R là/V dễ/A phân/V bệt/Np và/Cc đó/P chính/T là/V cung/N trong/E đó/P là/V đỉnh/N được/V gọi/V ở/E dòng/N (trong/Np giả/A mã/N có/V đoạn/Nc mã/N màu/N đỏ/A ở/E trên)/Np ./CH\nTrong/E điều/N kiên/Np ở/E vòng/N for/Np ở/E thủ_tục/N ,/CH các/L cung/N mà/C là/V visitted/Np sẽ/R có_thể/R là/V một/M trong/E 3/M loại/N cung/N :/CH chéo/A ,/CH ngược/A hoặc/Cc xuối/Np ./CH\nDo_đó/C ,/CH chỉ/R với/E hai/M nhãn/N này/P thì/C ta/P chưa/R phân/V biết/V được/V cung/N ngược/A với/E các/L cung/N khác/A (bài/Np này/P ta/P chưa/R cần/V phân_biệt/V cung/N chéo/A và/Cc cung/N xuôi)/Np ./CH\nNhắc_lại/Np ,/CH cung/N ngược/A là/V cung/N từ/E một/M đỉnh/N tới/E một/M đỉnh/N tổ_tiên/N của/E nó/P trong/E cùng/A một/M cây/N của/E rừng/N DFS/Np ./CH Để/E phát_hiện/V ra/V cung/N xuôi_ta/Np phải/V dùng/V thêm/V một/M nhãn/N nữa_là/X nhãn/N ,/CH bên_cạnh/R hai/M nhãn/N là/V visitted/Np và/Cc unvissited/Np ./CH\nÝ_nghĩa/N các/L nhãn/N như_sau/Np :/CH Dựa/V vào/E định_nghĩa/N của/E các/L nhãn/N ,/CH ta/P suy/V ra/V :/CH khi/N đang/R thăm/V đỉnh/N (có/Np nhãn/N visitting)/Np ,/CH nếu/C ta/P bắt_gặp/V đỉnh/N mà/C :/CH Như_vậy/X ta/P \"gần/Np như\"/Np đã/R phân_loại/V được/V được/V các/L cạnh/N của/E DFS/Np ./CH\nĐể/E phân_biệt/V cung/N xuôi/N và/Cc cung/N chéo/A ,/CH ta/P cần/V sửa_đổi/V DFS/Np hơn_nữa/C ./CH\nVấn_đề/N này/P ta/P sẽ/R tìm_hiểu/V trong/E bài/N sau/E ./CH\nGiả/A mã/N như_sau/Np :/CH Code_C/Np :/CH Một/M đồ_thị/Np có/V hướng/N được/V gọi_là/V (directed/Np acyclic/Np graph/Np --/Np đồ_thị/Np có/V hướng/N và/Cc không/R có/V chu/Np trình)/Np nếu/C ./CH\nỞ/E đây/P ta/P nhấn_mạnh/V cụm_từ/N ./CH\nĐiều/N đó/P có_nghĩa/A là/V đồ_thị/Np vô_hướng/Np tương_ứng/V vẫn/R có_thể/R có/V chu_trình/N ./CH\nĐồ_thị/Np trong/E ví_dụ/C ở/E trên/E không_phải/Np là/V DAG/Np do/E đồ_thị/Np đó/P có/V chu_trình/N ./CH\nĐồ_thị/Np trong/E hình/N dưới_đây/Np là/V một/M DAG/Np ./CH\nTa/P có/V bài_toán/N sau/E :/CH Gọi_là/V đồ_thị/Np thu/V được/V bằng/E cách/N đảo_ngược/V các/L cung/N của/E ./CH\nTa/P có/V nhận_xét/N sau/E :/CH Đỉnh/N của/E đồ_thị/Np được/V gọi_là/V một/M (source/Np vertex)/Np nếu_như/C không/R tồn_tại/V sao_cho/Np ./CH\nNói_cách_khác/Np ,/CH là/V phát/V nếu/C bậc/N tới/E (in-degree)/Np của/E bằng/E ./CH\nĐỉnh/N của/E đồ_thị/Np được/V gọi_là/V một/M (sink/Np vertex)/Np nếu_như/C không/R tồn_tại/V sao_cho/Np ./CH\nHay/Cc nói_cách_khác/Np ,/CH là/V đỉnh/N thu/V nếu/C bậc/N lui/V (out-degree)/Np của/E bằng/E ./CH\nVí_dụ/C trong/E hình/N dưới_đây/Np ,/CH các/L đỉnh/N là/V các/L đỉnh/N phát/V ,/CH các/L đỉnh/N là/V các/L đỉnh/N thu/V ./CH\nTa/P có/V bổ_đề/Np sau/E :/CH Nhận_xét/N đỉnh/N phát/V của/E chính/T là/V đỉnh/N thu/V của/E ./CH\nDo_đó/C ,/CH dựa/V vào/E Fact/Np 1/M ,/CH ta/P chỉ_cần/Np chứng_minh/V luôn/R có_một/Np đỉnh/N phátChọn/Np một/M đỉnh/N và/Cc đánh_dấu/V đỉnh/N ./CH\nGọi_là/V đỉnh/N sao_cho/Np ./CH\nNếu_không/Np tồn_tại/V thì_là/Np đỉnh/N thu/V ,/CH bổ_đề/Np là/V đúng/A ./CH\nNếu/C tồn_tại/V ,/CH ta/P tiếp_tục/V đánh_dấu/V và/Cc lặp_lại/Np quá_trình/N đánh_dấu/V như_vậy/X cho_đến/E khi/N ta/P gặp/V một/M đỉnh/N là/V đỉnh/N thu/V hoặc/Cc tồn_tại/V một/M đỉnh/N sao_cho/Np và/Cc đã/R được/V đánh_dấu/V ./CH\nTrong/E trường_hợp/N sau/E ,/CH ta/P sẽ/R tìm/V được/V một/M chu_trình/N có/V hướng/N bao_gồm/V các/L đỉnh/N đã/R đánh_dấu/V ,/CH trái/Nc với/E giả_thiết/N là/V DAG/Np ./CH Gọi_là/V tập/V các/L đỉnh/N nguồn/N của/E ./CH\nThêm/V vào/E một/M đỉnh/N và/Cc thêm/V cung/N ./CH\nGọi_là/V đồ_thị/Np thu/V được/V ./CH\nDễ/A thấy/V :/CH nếu/C là/V DAG/Np thì/C cũng/R là/V DAG/Np và/Cc ngược_lại/X ./CH\nNgoài_ra/X ,/CH nếu/C ta/P thực_hiện/V DFS/Np bắt_đầu_từ/Np ,/CH ta/P sẽ/R chỉ/R thu/V được/V duy_nhất/A một/M cây/N DFS/Np gốc/N tại/E (tại/Np sao/P ?/CH )/CH ./CH\nTa/P có/V bổ_đề/Np sau/E :/CH Chiều/N thuận/A của/E bổ_đề/Np khá/R dễ/A để/E chứng_minh/V ./CH\nNếu/C cây/N DFS/Np gốc/N tại/E có/V cung/N là/V cung/N ngược/A ,/CH và/Cc đều/R có/V nhãn/N unvisiting/Np ./CH\nDo_đó/C là/V cung/N ngược/A ,/CH sẽ/R là/V tổ/N tiền_của/Np trong/E cây/N DFS/Np ./CH\nHay/Cc nói_cách_khác/Np ,/CH có_một/Np đường_đi/Np từ/E đến/E ./CH\nĐường_đi/Np đó/P kết_hợp/V với/E cạnh/N sẽ/R tạo_thành/Np một/M chu_trình/N có/V hướng/N ./CH\nDo_đó/C không_phải/Np là/V DAG/Np ./CH Ta/P chứng_minh/V chiều/N ngược_lại/X bằng/E phản_chứng/Np ./CH\nGiả_sử/Np không_phải/Np là/V DAG/Np ,/CH gọi_là/V một/M chu_trình/N có/V hướng/N của/E ./CH\nGọi_là/V đỉnh_đầu/Np tiên/N của/E được/V thăm/V bởi/E DFS/Np và/Cc là/V đỉnh/N mà/C ./CH\nĐỉnh/N chỉ/R được/V đánh_dấu/V là/V visited/Np sau/E khi/N tất_cả/P các/L đỉnh/N trong/E tầm/N với/E của/E (reachable/Np from/Np )/CH ,/CH trong/E đó/P có/V ,/CH đã/R được/V đánh_dấu/V là/V visited/Np ./CH\nDo_đó/C ,/CH khi/N ta/P thăm/V ,/CH đỉnh_đang/Np được/V đánh_dấu/V là/V visiting/Np ./CH\nNhư_vậy/X ,/CH là/V cung/N ngược/A ,/CH trái/Nc với/E giả_thiết/N là/V cây/N DFS/Np không/R có/V cung/N ngược/A ./CH\nTừ_Lemma/Np 3/M ,/CH ta/P có_thể/R giải/N Problem/Np 1/M bằng/E cách/N thay_đổi/V một_chút/L thủ_tục/N như_sau/Np :/CH Code_C/Np :/CH Nếu/C biểu_diễn/V đồ_thị/Np bằng/E danh_sách/N kề/V ,/CH mỗi/L đỉnh/N có/V hai/M danh_sách/N :/CH một/M danh_sách/N các/L đỉnh/N (gọi/Np là/V các/L đỉnh/N tới)/Np sao_cho/Np và/Cc một/M danh_sách/N khác/A lưu/V các/L đỉnh/N (gọi/Np là/V các/L đỉnh/N lui)/Np sao_cho/Np thì/C việc/N phát_hiện/V các/L đỉnh/N phát/V (sink)/Np có_thể/R được/V thực_hiện/V trong/E thời_gian/N ./CH\nNếu/C ta/P chỉ/R lưu/V một/M danh_sách/N là/V các/L đỉnh/N tới/E thì/C việc/N phát_hiện/V nguồn/N có_thể/R thực_hiện/V trong/E thời_gian/N bằng/E cách/N duyệt/V qua/V các/L cung/N và/Cc đánh_dấu/V các/L đỉnh/N cuối/N của/E mỗi/L cung/N ./CH\nCác/L đỉnh/N không/R bị/V đánh_dấu/V chính/T là/V các/L đỉnh/N nguồn/N ./CH\nViệc/N thêm/V đỉnh/N vào/E đồ_thị/Np cũng/R có_thể/R được/V thực_hiện/V trong/E thời_gian/N ./CH\nThuật_toán/N DFS/Np có/V thời_gian/N ./CH\nDo_đó/C thời_gian/N của/E thuật_toán/N là/V ./CH\n:/CH Đỉnh/N thêm/V vào/E đồ_thị/Np để/E việc/N trình_bày/V thuật/Np toạn/Np được/V đơn_giản/A hơn/A ./CH\nKhi/N thực_thi/V thuật_toán/N ,/CH ta/P không/R nhất_thiết/R phải/V thêm/V vào/E đỉnh/N này/P ./CH\nNgoài_ra/X ,/CH dựa/V vào/E chứng_minh/V của/E Lemma/Np 3/M ,/CH ta/P có_thể/R dễ_dàng/A mở_rộng/V thuật_toán/N để/E in/V ra/V một/M chu_trình/N có/V hướng/N trong/E trường_hợp/N không_phải/Np là/V DAG/Np ./CH\nChi_tiết/N coi_như/Np bài_tập/Np cho/E bạn_đọc/N ./CH\ncủa/E một/M đồ_thị/Np có/V hướng/N là/V một_cách/N sắp_xếp/V các/L đỉnh/N trên/E một/M đường_thẳng/N sao_cho/Np với/E mỗi/L cung/N ,/CH đỉnh/N nằm/V bên/N trái/Nc đỉnh/N trên/E đường_thẳng/N đó/P ./CH\nVí_dụ/C hình/N (6)/Np dưới_đây/Np là/V một/M sắp_xếp/V topo/Np của/E đồ_thị/Np trong/E hình/N (5)/Np ./CH\nTừ/E định_nghĩa/N của/E săp/Np xếp/V Topo/Np ta/P có_thể/R dễ_dàng/A thấy/V rằng/C nếu/C có_một/Np sắp_xếp/V Topo/Np thì/C không_thể/R có_một/Np chu_trình/N có/V hướng/N ./CH\nHay/Cc nói_cách_khác/Np ,/CH là/V một/M DAG/Np ./CH\nNgược_lại/X ,/CH cho/E một/M DAG/Np ,/CH luôn/R tồn_tại/V một/M sắp_xếp/V Topo/Np cho/E ./CH\nTa/P sẽ/R chứng_minh/V điều/N này/P bằng/E cách/N thiết_kế/V một/M giải_thuật/Np để/E tìm/V sắp_xếp/V Topo/Np đó/P ./CH\nTa/P có/V :/CH Ta/P có_thể/R coi/V sắp_xếp/V Topo/Np giống_như/Np gán/V lại/R chỉ_số/N trong/E tập/V cho/E mỗi/L đỉnh/N sao_cho/Np với/E mỗi/L cung/N ,/CH đỉnh/N được/V gán/V chỉ_số/N nhỏ/A hơn/A ./CH\nĐể/E biểu_diễn/V thứ_tự/N của/E sắp_xếp/V Topo/Np ,/CH ta/P sẽ/R dùng/V một/M mảng/N trong/E đó/P nếu/C thì/C ./CH\nGọi_là/V tập/V các/L đỉnh/N nguồn/N của/E ./CH\nTa/P có/V :/CH Ta/P có_thể/R đổi/V chỗ/N các/L đỉnh/N trong/E tập/V trong/E một/M sắp_xếp/V Topo/Np của/E mà/C thứ_tự/N các/L đỉnh/N sau/E khi/N đổi/V chỗ/N vẫn/R là/V thứ_tự/N của/E một/M sắp_xếp/V Topo/Np (khác)/Np của/E ./CH Dựa/V vào/E nhận_xét/N trên/E ,/CH ta/P có_thể/R tìm/V một/M sắp_xếp/V Topo/Np của/E DAG/Np như_sau/Np :/CH Mỗi/L lần_ta/Np phát_hiện/V ra/V một/M đỉnh/N nguồn/N mới/R ,/CH ta/P sẽ/R đưa/V đỉnh/N đó/P vào/E vị_trí/N còn/R trống/A đầu_tiên/A của/E mảng/N và/Cc xóa_đỉnh/Np nguồn/N đó/P từ/E đồ_thị/Np ./CH\nNgoài_ra/X ,/CH ta/P sẽ/R dùng/V một_tập/Np hợp/V để/E lưu_trữ/Np các/L đỉnh/N nguồn/N của/E đồ_thị/Np hiện_tại/N ./CH\nThuật_toán/N như_sau/Np :/CH Trong/E thực_tế/N cài_đặt/V ,/CH ta/P sẽ/R không/R thực_sự/A \"xóa\"/Np đỉnh/N ra/V khỏi/V đồ_thị/Np mà/C ta/P chỉ_cần/Np dùng/V mảng/N để/E đánh_dấu/V là/V đỉnh/N đó/P đã/R bị/V \"xóa\"/Np ./CH\nTa/P sẽ/R chứng_minh/V :/CH Ta/P sẽ/R chứng_minh/V nếu/C thì/C sẽ/R được/V gán/V chỉ_số/N nhỏ/A hơn/A ./CH\nGiả_sử/Np ngược_lại/X ,/CH tồn_tại/V cung/N mà/C được/V gán/V chỉ_số/N lớn/A hơn/A ./CH\nTừ_đó/Np suy/V ra/V khi/N ta/P gán/V chỉ_số/N cho/E ,/CH đã/R được/V gán/V chỉ_số/N rồi/C ,/CH và/Cc do_đó/C ,/CH sẽ/R bị/V xóa_khỏi/Np đồ_thị/Np ./CH\nDo_đó/C ,/CH đã/R được/V đưa_vào/Np trong/E khỏi/V ./CH\nNhưng/C điều/N đó/P có_nghĩa/A là/V khi/N vào/E ,/CH cung/N vẫn/R thuộc/V ,/CH trái/Nc với/E điều_kiện/N khi/N ta/P đưa_vào/Np ./CH\nDo_đó/C ,/CH cung/N như_vậy/X không/R tồn_tại/V ./CH\nHay/Cc nói_cách_khác/Np ,/CH đầu_ra/N của/E thuật_toán/N là/V một/M sắp_xếp/V Topo/Np ./CH\nTa/P sẽ/R dùng/V danh_sách/N kề/V ,/CH với/E mỗi/L đỉnh/N ,/CH danh_sách/N kề/V của/E chỉ/R lưu/V các/L đỉnh/N mà/C ./CH\nHay/Cc nói_cách_khác/Np ,/CH danh_sách/N kề/V của/E chỉ/R lưu/V các/L out-neighbor/Np của/E ./CH\nTa/P sẽ/R dùng/V một/M mảng/N để/E đánh_dấu/V đỉnh/N nào/P đã/R bị/V \"xóa\"/Np ra/V khỏi/V đồ_thị/Np ,/CH i/M ./CH e/Ni nếu/C bị/V xóa/V và/Cc nếu/C ngược_lại/X ./CH\nThao_tác/V khó/A nhất_là/X kiểm_tra/V xem/V sau/E khi/N xóa_khỏi/Np đồ_thị/Np ,/CH có_trở/Np thành/V đỉnh/N nguồn/N hay_không/Np (dòng/Np if/Np có/V comment/Np ở/E giả/A mã/N trên)/Np ./CH\nTa/P có_thể/R thực_thi/V bằng/E cách/N duyệt/V qua/V các/L hàng_xóm/N tới/E (in-neighbors)/Np của/E và/Cc kiểm_tra/V xem/V hay_không/Np ./CH\nNếu/C mọi/L hàng_xóm/N tới/E của/E đều/R đã/R bị/V xóa/V ,/CH sẽ/R là/V đỉnh/N nguồn/N và/Cc ta/P đưa_vào/Np ./CH\nTuy_nhiên/C ,/CH để/E làm/V như_vậy/X ,/CH ta/P phải/V lưu/V thêm/V một/M danh_sách/N các/L hàng_xóm/N tới/E cho/E mỗi/L đỉnh/N ,/CH và/Cc nếu_không/Np cẩn_thận/A ,/CH mỗi/L thao_tác/V duyệt/V sẽ/R mất/V thời_gian/N là/V bậc/N tới/E của/E ,/CH do_đó/C làm_cho/Np tổng/N thời_gian/N thành/V ./CH\nĐể/E giải_quyết/V tình_trạng/N này/P ,/CH ta/P sẽ/R lưu/V thêm/V một/M mảng/N trong/E đó/P nếu/C bậc/N tới/E (in-degree)/Np của/E là/V trong/E đồ_thị/Np hiện_tại/N (không/Np tính/V các/L đỉnh/N đã/R \"xóa\")/Np ./CH\nDo_đó/C ,/CH mỗi/L lần/N \"xóa\"/Np ra/V khỏi/V đồ_thị/Np ,/CH ta/P chỉ/R việc/N cập_nhật/V lại/R mảng/N và/Cc đỉnh/N điều_kiện/N ở/E dòng/N if/Np sẽ/R trở_thành/V (xem/Np giả/A mã/N dưới/E đây)/Np ./CH\nDo_đó/C ,/CH thao_tác/V kiểm_tra/V này/P mất/V ./CH\nNhư_vậy/X ,/CH tổng/N thời_gian/N của/E thuật_toán/N là/V ./CH\nGiả/A mã/N :/CH Code_C/Np :/CH Theo/V ,/CH giải_thuật/Np sắp_xếp/V Topo/Np mà/C ta/P mô_tả/V ở/E đây/P được/V phát_triển/V bởi/E Kahn/Np 1/M năm/N 1966/M ./CH\nNgoài_ra/X còn/R giải_thuật/Np khác/A sử_dụng/V DFS/Np khá/R giống/N với/E thủ_tục/N ./CH\nGiải_thuật/Np này/P được/V mô_tả/V bởi/E Tarjan/Np 2/M vào/E năm/N 1974/M và/Cc được/V sử_dụng/V trong/E textbook/Np CLRS3/Np ./CH\nCode/Np đầy_đủ/A :/CH ,/CH ,/CH ./CH\n1/M Kahn/Np ,/CH Arthur_B/Np ./CH\nCommunications/Np of/E the/B ACM/Np 5/M ./CH 11/M (1962)/Np :/CH 558-562/Np ./CH\n2/M Tarjan/Np ,/CH Robert_Endre/Np ./CH\nComputer_Science_Department/Np ,/CH School/Np of/E Humanities/Np and/Np Sciences/Np ,/CH Stanford_University/Np ,/CH 1974/M ./CH\n3/M Cormen/Np ,/CH Thomas_H/Np ./CH ;/CH Leiserson/Np ,/CH Charles_E/Np ./CH ;/CH Rivest/Np ,/CH Ronald_L/Np ./CH ;/CH Stein/Np ,/CH Clifford/Np (2001)/Np 1990/M ./CH\n(2nd/Np ed/Np ./CH )/CH ./CH\nChapter/Np 22/M ./CH 5/M ./CH MIT_Press/Np and/Np McGraw-Hill/Np ./CH\n,/CH ,/CH ,/CH ,/CH Trackback/Np link/Np :/CH Powered/Np by/Np and/Np\n", "title": "DFS, phân loại cung và sắp xếp Topo -- DFS, Arc Classification and Topological Sort\n", "link": "http://www.giaithuatlaptrinh.com/?p=590\n"}