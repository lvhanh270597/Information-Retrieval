{"content": "Nguồn : wcipeg Table of_Contents Giải_thích trực_quan về bao lồi trên mặt_phẳng Thuật_toán tìm bao lồi trên mặt_phẳng Thuật_toán bọc gói Thuật_toán Graham Cài_đặt Thuật_toán chuỗi đơn_điệu Cài_đặt Xử_lí trường_hợp suy_biến Ứng_dụng Bao lồi 3D Bài_tập áp_dụng Trong hình_học tính_toán ( computational geometry ) , bao lồi ( convex_hull ) của một_tập điểm là tập lồi nhỏ nhất (theo diện_tích , thể_tích , . . . ) mà tất_cả các điểm đều nằm trong tập đó .\nGiải_thích trực_quan về bao lồi trên mặt_phẳng Nếu ta coi các điểm trong một_tập hợp là các cái đinh đóng trên một tấm gỗ , bao lồi của tập điểm đó có viền ngoài tạo bởi sợi dây_chun mắc vào các cái đinh sau khi bị kéo_căng về các phía .\nNếu ta coi các điểm trong một_tập hợp là các con cừu trên đồng_cỏ , bao lồi của tập điểm đó có viền ngoài là hàng_rào có độ_dài nhỏ nhất bao_quanh tất_cả các con cừu Nếu ta coi các điểm trong một_tập hợp là các đầu_mút có_thể của các hàng_rào , bao lồi của tập điểm đó có viền ngoài là các hàng_rào thẳng có điểm đầu và điểm cuối thuộc tập điểm đó và bao_quanh diện_tích lớn nhất .\nNếu ta coi các điểm trong một_tập hợp là các cái cây , chu_vi của bao lồi là độ_dài tối_thiểu của dải ruy_băng bao_quanh tất_cả các cây đó .\nThuật_toán tìm bao lồi trên mặt_phẳng Bài_toán tìm bao lồi của một_tập điểm trên mặt_phẳng là một trong những bài_toán được nghiên_cứu nhiều nhất trong hình_học tính_toán và có rất nhiều thuật_toán để giải bài_toán này .\nSau_đây là ba thuật_toán phổ_biến nhất , được giới_thiệu theo thứ_tự tăng dần về độ khó .\nThuật_toán bọc gói Thuật_toán bọc gói ( Gift wrapping algorithm ) hay còn gọi_là thuật_toán Jarvis march là một trong những thuật_toán tìm bao lồi đơn_giản và dễ_hiểu nhất .\nTên thuật_toán xuất_phát từ sự tương_tự của thuật_toán với việc đi_bộ xung_quanh các điểm và cầm theo một dải_băng gói quà .\nBước_đầu tiên của thuật_toán là chọn một điểm chắc_chắn nằm trong bao lồi , ví_dụ , điểm có tung_độ lớn nhất (nếu có nhiều điểm cùng có tung_độ lớn nhất_thì có_thể chọn điểm tung_độ lớn nhất và hoành_độ lớn nhất) .\nXuất_phát từ điểm này , mục_tiêu của ta là sẽ lần_lượt đi đến các điểm khác cho_đến khi quay trở_lại điểm ta chọn lúc đầu .\nBan_đầu , ta nhìn về phía bên phải .\nKhi đi đến các điểm khác , ta sẽ lưu lại : Điểm_P mà ta đang chọn vector \\vecv chỉ hướng ta đang nhìn .\nTiếp_theo , thuật_toán sẽ lặp_lại liên_tục các bước sau cho_đến khi tìm được bao lồi .\nTa quay mặt theo chiều kim_đồng_hồ cho_đến khi ta nhìn_thấy một điểm , gọi điểm đó là Q .\nRồi ta cầm theo dải_băng và đi đến điểm Q .\nKhi ta đến điểm đấy , ta thay : \\vecv thành \\vecPQ P thành Q .\nThuật_toán kết_thúc , khi ta quay trở_về điểm ban_đầu .\nLúc_này ta đã đi đến tất_cả các đỉnh của bao lồi theo chiều kim_đồng_hồ .\nĐể xác_định điểm ta nhìn_thấy đầu_tiên khi ta quay mặt theo chiều kim_đồng_hồ , ta duyệt tất_cả các điểm R trong tập , ngoại_trừ điểm P .\nVới mỗi điểm , ta xét vector \\vecu=\\vecPR; \\vecu tạo với \\vecv một góc \\theta nhỏ nhất sẽ tương_ứng với điểm Q (dễ dàng chứng_minh được điều này) .\nĐể tìm \\theta nhỏ nhất , ta tìm \\cos\\theta lớn nhất , mà ta lại dễ_dàng tính được \\cos\\theta bằng công_thức \\frac\\vecu . \\vecv\\vecu\\vecv .\nVới mỗi lần tìm điểm tiếp_theo , ta cần duyệt qua tất_cả các điểm trong tập , vì_vậy độ phức_tạp của mỗi lần tìm điểm là O(n) với n là số_lượng điểm trong tập .\nSố lần tìm điểm tiếp_theo phụ_thuộc vào số_lượng điểm là đỉnh của bao lồi , gọi số_lượng điểm đó là h , khi đó độ phức_tạp của cả thuật_toán là O(nh) .\nTrong trường_hợp xấu nhất , h=n hay tất_cả các điểm trong dữ_liệu vào tạo_thành một đa_giác lồi , độ phức_tạp của thuật_toán là O(n2) , không đủ nhanh khi ngt;5000 .\nThuật_toán Graham Thuật_toán Graham có độ phức_tạp trong trường_hợp xấu nhất nhỏ hơn thuật_toán bọc gói , song thuật_toán Graham lại phức_tạp hơn .\nĐầu_tiên , ta xác_định một điểm mà chắc_chắn thuộc bao lồi .\nThông_thường , khi cài_đặt người_ta chọn điểm có tung_độ nhỏ nhất (nếu có nhiều điểm như_vậy thì chọn điểm trái nhất) .\nGọi điểm này là điểm O .\nChọn hệ trục tọa_độ có gốc là điểm vừa chọn , đổi các tọa_độ các điểm còn_lại theo hệ trục tọa_độ mới (chú ý lúc cài_đặt thường_ta không_đổi trục tọa_độ , nhưng khi tính góc hoặc sắp_xếp ở bước tiếp_theo cần chú_ý tránh nhầm lẫn) .\nTiếp_theo , ta sắp_xếp các điểm còn_lại theo thứ_tự tăng dần của góc tạo bởi trục_hoành theo chiều dương và \\vecOI với I là một trong các điểm còn_lại .\nTa xét các điểm theo thứ_tự ta vừa sắp_xếp , với mỗi điểm ta sửa_lại bao lồi H .\nGọi điểm đầu_tiên được cho vào bao lồi H là H_1 , điểm cuối_cùng là H_h (ban đầu h = 0) .\nKhi xét mỗi điểm ta làm như_sau : Thêm điểm P vào cuối bao lồi H .\nTức_là ta tăng h lên 1 và đặt H_h=P .\nNếu hlt;3 , xét tiếp_điểm tiếp_theo , ngược_lại làm bước 3 .\nXét 3 điểm H_h , H_h−1 và H_h−2 .\nCó_thể sau khi cho thêm điểm H_h , ta biết được điểm H_h−1 chắc_chắn không nằm trong bao .\nGọi \\vecu =\\overrightarrowH_h−2H_h−1 và \\vecv =\\overrightarrowH_h−1H_h .\nNếu khi đi_theo hướng \\vecv rồi đi_theo hướng \\vecu là ta đã bẻ góc ngược_chiều kim_đồng_hồ , hay \\vecu \\times \\vecv gt; 0 , thì cả ba điểm đều tạm thuộc bao , và ta xét tiếp_điểm tiếp_theo .\nNhưng nếu \\vecu \\times \\vecv lt; 0 , thì góc \\widehatH_h−2H_h−1H_h sẽ tạo ra_đa giác lõm và điểm H_h−1 phải bị loại_bỏ , có_nghĩa là H_h−1 được đặt là H_h và h giảm đi 1 .\nSau_đó quay_lại bước 2 cho_đến khi xét hết các điểm .\nHình minh_họa : Ta đang xây_dựng bao lồi , đến vị_trí h = 4 Góc \\widehatH_h−2H_h−1H_h lõm , nên ta cần bỏ điểm H_3 khỏi bao lồi Sau quá_trình trên , ta đã có_một bao lồi H_1 , H_2 , . . . , H_h sắp_xếp ngược_chiều kim_đồng_hồ .\nĐể đảm_bảo ta loại_bỏ điểm và thêm điểm với độ phức_tạp O(1) , ta có_thể dùng cấu_trúc dữ_liệu stack .\nVề độ phức_tạp của thuật_toán , ta thấy bước sắp_xếp các điểm có độ phức_tạp O(n \\logn) .\nMỗi điểm được cho vào bao nhiều nhất một_lần nên tổng_độ phức_tạp của các bước thêm điểm là O(n) , và mỗi điểm bị loại ra khỏi bao nhiều nhất một_lần nên tổng_độ phức_tạp của các bước xóa điểm là O(n) , do_đó độ phức_tạp của bước xét các điểm là O(n) .\nVậy , độ phức_tạp của thuật_toán Graham là O(n \\logn) , phù_hợp cho hầu_hết các bài_toán .\nCài_đặt type Point = record // Kiểu dữ_liệu điểm x , y : real ; ind : integer ; // chỉ_số trong mảng ban_đầu end ; var n : integer ; // số điểm a , b : array 1 .\n.\nmaxn of Point ; // a : mảng input , b : bao lồi Procedure_Swap ( var p1 , p2 : Point ); // Hàm đổi chỗ 2 điểm Var temp : Point ; Begin temp : = p1 ; p1 : = p2 ; p2 : = temp ; End ; Function_CCW ( p1 , p2 , p3 : Point ) : integer ; // Xem từ p1 --gt; p2 --gt; p3 là rẽ trái (1) , đi_thẳng (0) hay rẽ phải (-1) Var t , a1 , a2 , b1 , b2 : real ; Begin a1 : = p2 .\nx - p1 .\nx ; b1 : = p2 .\ny - p1 .\ny ; a2 : = p3 .\nx - p2 .\nx ; b2 : = p3 .\ny - p2 .\ny ; t : = a1 b2 - a2 b1 ; If abs ( t ) lt; esp then CCW : = 0 else if t lt; 0 then CCW : =- 1 else CCW : = 1 ; End ; Function_Lower ( p1 , p2 : Point ) : boolean ; // So_sánh để sắp_xếp các điểm theo góc Var c : integer ; Begin c : = CCW ( a 1 , p1 , p2 ); Lower : = false ; If ( c gt; 0 ) then Lower : = true else If ( c = 0 ) and (( p1 .\nx lt; p2 .\nx ) or (( p1 .\nx = p2 .\nx ) and ( p1 .\ny lt; p2 .\ny ))) then Lower : = true ; End ; Procedure_QuickSort ; // Sắp_xếp các điểm của mảng a theo góc Procedure_Sort ( l , r : integer ); Var i , j : integer ; x : Point ; Begin i : = l ; j : = r ; x : = a ( l + r ) div 2 ; repeat while lower ( a i , x ) do inc ( i ); while lower ( x , a j ) do dec ( j ); if i lt;= j then begin Swap ( a i , a j ); inc ( i ); dec ( j ); end ; until i gt; j ; if i lt; r then Sort ( i , r ); if l lt; j then Sort ( l , j ); End ; Begin_If n gt; 2 then Sort ( 2 , n ); End ; Procedure_Graham ; Var i , c : integer ; Begin // Tìm điểm có tung_độ nhỏ nhất c : = 1 ; For i : = 2 to n do If ( a i .\ny lt; a c .\ny ) or (( a i .\ny = a c .\ny ) and ( a i .\nx lt; a c .\nx )) then c : = i ; // Đổi chỗ điểm tung_độ nhỏ nhất về a1 Swap ( a c , a 1 ); m : = 2 ; b 1 : = a 1 ; b 2 : = a 2 ; b 1 .\nind : = 1 ; b 2 .\nind : = 2 ; For i : = 3 to n do begin // Loại_bỏ bm nếu ta xác_định được nó không thuộc bao lồi while ( m gt; 1 ) and ( CCW ( b m - 1 , b m , a i ) = - 1 ) do dec ( m ); // Thêm điểm ai vào bao lồi inc ( m ); b m : = a i ; b m .\nind : = i ; end ; End ; Bạn cũng có_thể tham_khảo thêm cài_đặt C++ ở đây Thuật_toán chuỗi đơn_điệu Thuật_toán chuỗi đơn_điệu ( Monotone chain ) vừa dễ cài_đặt , vừa là thuật_toán nhanh nhất trong số 3 thuật_toán được giới_thiệu trong bài viết này .\nThuật_toán dựa trên việc tìm hai chuỗi đơn_điệu của bao lồi : chuỗi trên và chuỗi dưới .\nTa thấy điểm ở xa về phía bên phải nhất (từ đây gọi_là điểm phải nhất) và điểm ở xa về phía bên trái nhất (từ đây gọi_là điểm trái nhất) trong dữ_liệu vào luôn là hai đỉnh của bao lồi .\nPhần bao lồi theo chiều kim_đồng_hồ tính_từ điểm trái nhất và ngược_chiều kim_đồng_hồ tính_từ điểm phải nhất gọi_là chuỗi trên , phần còn_lại của bao lồi gọi_là chuỗi dưới .\nTa sẽ tìm chuỗi trên và chuỗi dưới độc_lập với_nhau .\nBước_đầu tiên là sắp_xếp các điểm được cho theo thứ_tự tăng dần theo hoành_độ .\nNếu hai điểm có cùng hoành_độ , điểm có tung_độ nhỏ hơn sẽ đứng trước .\nTa xét việc xây_dựng chuỗi trên .\nGọi_H là chuỗi trên hiện_tại và độ lớn của bao là h .\nĐiểm đầu của chuỗi là H_1 và điểm cuối là H_h .\nVới mỗi điểm được xét : Thêm điểm này vào H .\nNếu hlt;3 , xét tiếp_điểm tiếp_theo .\nGọi \\vecu=\\overrightarrowH_h-2H_h-1 và \\vecv=\\overrightarrowH_h-1H_h .\nLần này , do ta đang di_chuyển theo chiều kim_đồng_hồ để tìm chuỗi trên , ta kiểm_tra xem \\vecu \\times \\vecv có nhỏ hơn 0 hay_không .\nNếu có , ta xét tiếp_điểm tiếp_theo .\nNếu_không , ta loại_bỏ H_h-1 và quay_lại bước 2 .\nSau khi xét hết các điểm , H sẽ chứa toàn_bộ các điểm ở chuỗi trên .\nSau_đó , ta tìm chuỗi dưới bằng cách tương_tự , chỉ khác là ta xét các điểm theo thứ_tự ngược_lại (tức là ta xét điểm trái nhất trước) .\nLưu_ý không thêm điểm phải nhất hai lần .\nKhi thuật_toán kết_thúc , H sẽ chứa tất_cả các đỉnh của bao lồi , với điểm đầu được lặp_lại ở cuối .\nThuật_toán này cũng có độ phức_tạp O(n \\logn) .\nThuật_toán chuỗi đơn_điệu được khuyên dùng ở mọi bài_toán tìm bao lồi , do nó đơn_giản hơn thuật_toán Graham và nhanh hơn một_chút (do ta không_phải tính góc) .\nCài_đặt struct pt // Kiểu điểm double x , y ; ; bool cmp ( pt a , pt b ) // So_sánh theo tọa_độ x , trong trường_hợp bằng_nhau so_sánh theo y return a .\nx lt; b .\nx a .\nx == b .\nx amp;amp; a .\ny lt; b .\ny ; bool cw ( pt a , pt b , pt c ) // a -gt; b -gt; c đi_theo thứ_tự xuôi_chiều kim_đồng_hồ return a .\nx ( b .\ny - c .\ny ) + b .\nx ( c .\ny - a .\ny ) + c .\nx ( a .\ny - b .\ny ) lt; 0 ; bool ccw ( pt a , pt b , pt c ) // a -gt; b -gt; c đi_theo thứ_tự ngược_chiều kim_đồng_hồ return a .\nx ( b .\ny - c .\ny ) + b .\nx ( c .\ny - a .\ny ) + c .\nx ( a .\ny - b .\ny ) gt; 0 ; void convex_hull ( vector lt; pt gt; amp; a ) if ( a .\nsize () == 1 ) // chỉ_có 1 điểm return ; // Sắp_xếp các điểm theo tọa_độ x , nếu bằng_nhau sắp_xếp theo y sort ( a .\nbegin () , a .\nend () , amp; cmp ); pt p1 = a 0 , p2 = a .\nback (); vector lt; pt gt; up , down ; // chuỗi trên và chuỗi dưới up .\npush_back ( p1 ); down .\npush_back ( p1 ); for ( size_t i = 1 ; i lt; a .\nsize (); ++ i ) // xét lần_lượt các điểm // Thêm vào chuỗi trên if ( i == a .\nsize () - 1 cw ( p1 , a i , p2 )) while ( up .\nsize () gt;= 2 amp;amp; ! cw ( up up .\nsize () - 2 , up up .\nsize () - 1 , a i )) up .\npop_back (); up .\npush_back ( a i ); // Thêm vào chuỗi dưới if ( i == a .\nsize () - 1 ccw ( p1 , a i , p2 )) while ( down .\nsize () gt;= 2 amp;amp; ! ccw ( down down .\nsize () - 2 , down down .\nsize () - 1 , a i )) down .\npop_back (); down .\npush_back ( a i ); // Gộp 2 chuỗi trên và dưới để lấy bao lồi a .\nclear (); for ( size_t i = 0 ; i lt; up .\nsize (); ++ i ) a .\npush_back ( up i ); for ( size_t i = down .\nsize () - 2 ; i gt; 0 ; -- i ) a .\npush_back ( down i ); Bạn cũng có_thể tham_khảo thêm cài_đặt C++ ở đây Xử_lí trường_hợp suy_biến Các thuật_toán trên hoạt_động tốt trong trường_hợp lí_tưởng , tức_là không có hai điểm nào trùng nhau và không có ba điểm nào thẳng_hàng .\nTuy_nhiên , trong hầu_hết các bài_toán , ta sẽ phải xử_lí các điểm trùng nhau và các bộ_ba điểm thẳng_hàng .\nBiện_luận tất_cả các trường_hợp sẽ là một công_việc khó_nhằn và nhàm_chán .\nVì_vậy , hãy ghi_nhớ những điều sau : Đọc kĩ đề_bài để biết được dữ_liệu vào có bị suy_biến hay_không , nếu có thì rơi vào trường_hợp nào .\n(Lưu ý rằng không_phải đề_bài nào cũng nói_rõ rằng dữ_liệu bị suy biến) .\nNếu tồn_tại các điểm trùng nhau Thuật_toán bọc gói sẽ thực_hiện phép_chia cho số_không .\nTa cần tránh điều này để thuật_toán chạy đúng .\nNếu ta chỉ_cần tính chu_vi hoặc diện_tích của bao lồi , thuật_toán Graham và thuật_toán chuỗi đơn_điệu sẽ không gặp vấn_đề gì .\nNếu ta phải in ra các đỉnh của bao lồi , có ba thứ_tự in các đỉnh mà đề_bài có_thể hỏi : cùng chiều kim_đồng_hồ , ngược_chiều kim_đồng_hồ , hoặc theo thứ_tự xuất_hiện trong dữ_liệu vào .\nRõ_ràng hai thứ_tự in các đỉnh_đầu tiên không có_ý nghĩa gì khi có các điểm trùng nhau .\nNếu đề_bài yêu_cầu in các đỉnh theo thứ_tự xuất_hiện trong dữ_liệu vào , đề_bài có_thể yêu_cầu in ra đỉnh_đầu tiên xuất_hiện trong dữ_liệu vào nếu các đỉnh trùng nhau , hoặc in ra tất_cả các đỉnh .\nHãy đọc đề_bài thật kĩ .\nTrong mọi trường_hợp , ta đều có_thể dễ_dàng xử_lí kết_quả sau khi chạy thuật_toán tìm bao lồi để phù_hợp với yêu_cầu bài_toán , và ta nên làm như_vậy vì kết_hợp xử_lí kết_quả với thuật_toán tìm bao lồi không_những khó hơn mà có_thể tạo ra sai_sót không đáng có Nếu có các bộ_ba điểm thẳng_hàng Ta cần biết đề_bài yêu_cầu bao lồi có_số lượng đỉnh tối_đa hay tối_thiểu , từ_đó , ta suy ra ta có nên cho thêm các điểm thuộc cạnh của bao lồi hay_không .\nNếu chỉ_có các bộ_ba điểm thẳng_hàng mà không có các điểm trùng nhau , ta có_thể sửa dấu lt; thành dấu \\leq trong thuật_toán Graham và thuật_toán chuỗi đơn_điệu nếu bài_toán yêu_cầu bao lồi có_số lượng đỉnh tối_đa .\nCòn trong thuật_toán bọc gói , ta sẽ chọn điểm ở xa nhất hoặc điểm ở gần nhất nếu có hai điểm cùng có_số đo_góc nhỏ nhất tùy vào yêu_cầu bài_toán .\nThứ_tự các đỉnh không_phải là vấn_đề , trừ_khi đề_bài yêu_cầu in ra thứ_tự các đỉnh của bao lồi có_số đỉnh lớn nhất , trong đó các đỉnh thuộc cùng một cạnh được sắp_xếp theo thứ_tự xuất_hiện trong dữ_liệu vào .\nKhi đó , xử_lí kết_quả sau khi tìm bao lồi là lựa_chọn tốt nhất .\nTrường_hợp xấu nhất trên lí_thuyết là khi diện_tích bao lồi bằng 0 .\nCó hai trường_hợp như_vậy , và ta có_thể dễ_dàng xử_lí hai trường_hợp đó : tất_cả các điểm đều trùng nhau , hoặc tất_cả điểm đều thẳng_hàng .\nThuật_toán chuỗi đơn_điệu vẫn hoạt_động bình_thường nếu ta chỉ_cần biết diện_tích hoặc chu_vi bao lồi .\nNếu ta cần in ra các đỉnh của bao lồi , ta không nên chỉnh_sửa thuật_toán mà nên xét riêng hai trường_hợp trên .\nỨng_dụng Ngoại_trừ các ứng_dụng hiển_nhiên , tìm bao lồi còn giúp ta giải các bài_toán sau : Cặp điểm xa nhất (Bài toán trộn màu) : Bạn có_một số hộp sơn , mỗi hộp sơn có tỉ_lệ thành_phần ba màu_cơ_bản xanh : đỏ : vàng là x : d : v , với x , d , v dương .\nGiả_sử màu của hộp sơn chỉ phụ_thuộc vào tỉ_lệ ba màu_cơ_bản .\nBằng cách pha_trộn các loại sơn , liệu ta có_thể thu được màu mục_tiêu hay_không (màu mục_tiêu cũng được cho bằng tỉ_lệ ba màu cơ bản) , biết rằng lượng_sơn trong hộp là vô_tận .\nBài_toán này hóa ra lại có_thể giải bằng cách tìm bao lồi trên mặt_phẳng .\nBước_đầu tiên , ta chuẩn hóa dữ_liệu bằng cách chia tỉ_lệ ba màu_cơ_bản với lượng màu xanh (tức là nếu tỉ_lệ bằng x : d : v thì ta chuẩn hóa còn 1 : \\fracdx : \\fracvx) .\nTa làm tương_tự với màu mục_tiêu .\nSau_đó ta bỏ_qua lượng màu xanh do lượng màu xanh ở tất_cả các hộp lẫn_màu mục_tiêu đều bằng 1 , và tập_trung xử_lí hai màu kia .\nMỗi màu của hộp sơn đều có_thể biểu_diễn bằng một điểm trên mặt_phẳng .\nKhi đó , các màu mà các hộp sơn đó có_thể pha_trộn được sẽ nằm trong bao lồi .\nĐó là do khi trộn hai màu có điểm biểu_diễn trên mặt_phẳng lần_lượt là A và B , màu ta thu được sẽ có điểm biểu_diễn nằm trên đoạn AB , nên ta dễ_dàng tìm được một dãy các bước trộn màu để có được màu mục_tiêu nếu điểm biểu_diễn màu mục_tiêu nằm trong bao lồi .\nBao lồi 3D Tim bao lồi trong 3D thực_sự là một bài_toán khó .\nBài_toán này chắc_chắn sẽ không bao_giờ được ra trong IOI , và học_sinh trung_học không cần phải đi_sâu vào vấn_đề này .\nTuy_nhiên , có_một thuật_toán O(n2) khá là đơn_giản : đầu_tiên , ta tìm hình_chiếu của các điểm trên mặt_phẳng xy , và tìm một các chắc_chắn thuộc bao bằng cách lấy một điểm có tung_độ lớn nhất rồi tìm điểm kia bằng cách chạy vòng_lặp của thuật_toán bọc gói một_lần .\nĐây là phần đầu_tiên của bao lồi .\nSau_đó , xét cạnh vừa tìm được , tìm một điểm thứ_ba để tạo_thành một_mặt tam_giác của bao lồi .\nTa chọn điểm thứ_ba bằng cách tìm điểm để tất_cả các điểm khác nằm ở phía bên phải của mặt tam_giác đó (giống như thuật_toán bọc gói , ta tìm cạnh để tất_cả các điểm khác đều nằm về phía bên phải cạnh đó) .\nBây_giờ ta đã có ba cạnh trong bao lồi , ta chọn ngẫu_nhiên một trong ba cạnh đó , rồi tìm tiếp một tam_giác với cạnh này , rồi tiếp_tục cho_đến khi_không còn cạnh nào nữa (Khi ta tìm thêm một_mặt tam_giác , ta phải thêm hai cạnh vào bao , tuy_vậy hai cạnh này phải chưa có trong bao , nếu_không ta phải đi tìm hai cạnh khác) .\nCó tổng_cộng O(n) mặt , và mỗi lần duyệt các điểm ta mất thời_gian O(n) vì ta phải duyệt tất_cả các điểm còn_lại , do_đó độ phức_tạp của thuật_toán là O(n2) .\n(Nếu bạn nghĩ bạn có_thể cài_đặt được thuật_toán này , hãy nộp bài tại SPOJ - CH3D ) .\nTa có_thể tăng_tốc_độ thuật_toán này bằng các loại_bỏ các điểm chắc_chắn không_phải đỉnh của bao , bằng cách tìm các điểm cực theo các trục tọa_độ , rồi loại_bỏ các điểm nằm trong bát_diện mà các đỉnh đấy tạo ra .\nTa có_thể tìm bao lồi trong không_gian với độ phức_tạp O(n \\logn) bằng phương_pháp chia_để_trị , tuy_nhiên việc cài_đặt thuật_toán này là vô_cùng khó .\nBài_tập áp_dụng Kattis - convexhull ACM_ICPC_Vietnam_National 2017 - K_VOJ - MILITARY_VOJ - HEADQRT_VOJ - KMIX_USACO - Cow_Curling\n", "tagged": "Nguồn/N :/CH wcipeg/Np Table/Np of_Contents/Np Giải_thích/V trực_quan/Np về/E bao/N lồi/Np trên/E mặt_phẳng/N Thuật_toán/N tìm/V bao/N lồi/Np trên/E mặt_phẳng/N Thuật_toán/N bọc/V gói/V Thuật_toán/N Graham/Np Cài_đặt/V Thuật_toán/N chuỗi/N đơn_điệu/Np Cài_đặt/V Xử_lí/V trường_hợp/N suy_biến/Np Ứng_dụng/V Bao/N lồi/Np 3D/M Bài_tập/Np áp_dụng/V Trong/E hình_học/Np tính_toán/V (/CH computational/Np geometry/Np )/CH ,/CH bao/N lồi/Np (/CH convex_hull/Np )/CH của/E một_tập/Np điểm/N là/V tập/V lồi/Np nhỏ/A nhất/A (theo/Np diện_tích/N ,/CH thể_tích/N ,/CH ./CH ./CH ./CH )/CH mà/C tất_cả/P các/L điểm/N đều/R nằm/V trong/E tập/V đó/P ./CH\nGiải_thích/V trực_quan/Np về/E bao/N lồi/Np trên/E mặt_phẳng/N Nếu/C ta/P coi/V các/L điểm/N trong/E một_tập/Np hợp/V là/V các/L cái/Nc đinh/N đóng/V trên/E một/M tấm/Nc gỗ/N ,/CH bao/N lồi/Np của/E tập/V điểm/N đó/P có/V viền/N ngoài/E tạo/V bởi/E sợi/Nc dây_chun/Np mắc/V vào/E các/L cái/Nc đinh/N sau/E khi/N bị/V kéo_căng/Np về/E các/L phía/N ./CH\nNếu/C ta/P coi/V các/L điểm/N trong/E một_tập/Np hợp/V là/V các/L con/Nc cừu/N trên/E đồng_cỏ/N ,/CH bao/N lồi/Np của/E tập/V điểm/N đó/P có/V viền/N ngoài/E là/V hàng_rào/N có/V độ_dài/Np nhỏ/A nhất/A bao_quanh/Np tất_cả/P các/L con/Nc cừu/N Nếu/C ta/P coi/V các/L điểm/N trong/E một_tập/Np hợp/V là/V các/L đầu_mút/Np có_thể/R của/E các/L hàng_rào/N ,/CH bao/N lồi/Np của/E tập/V điểm/N đó/P có/V viền/N ngoài/E là/V các/L hàng_rào/N thẳng/A có/V điểm/N đầu/N và/Cc điểm/N cuối/N thuộc/V tập/V điểm/N đó/P và/Cc bao_quanh/Np diện_tích/N lớn/A nhất/A ./CH\nNếu/C ta/P coi/V các/L điểm/N trong/E một_tập/Np hợp/V là/V các/L cái/Nc cây/N ,/CH chu_vi/Np của/E bao/N lồi/Np là/V độ_dài/Np tối_thiểu/A của/E dải/N ruy_băng/Np bao_quanh/Np tất_cả/P các/L cây/N đó/P ./CH\nThuật_toán/N tìm/V bao/N lồi/Np trên/E mặt_phẳng/N Bài_toán/N tìm/V bao/N lồi/Np của/E một_tập/Np điểm/N trên/E mặt_phẳng/N là/V một/M trong/E những/L bài_toán/N được/V nghiên_cứu/V nhiều/A nhất/A trong/E hình_học/Np tính_toán/V và/Cc có/V rất/R nhiều/A thuật_toán/N để/E giải/N bài_toán/N này/P ./CH\nSau_đây/Np là/V ba/M thuật_toán/N phổ_biến/V nhất/A ,/CH được/V giới_thiệu/V theo/V thứ_tự/N tăng/V dần/R về/E độ/N khó/A ./CH\nThuật_toán/N bọc/V gói/V Thuật_toán/N bọc/V gói/V (/CH Gift/Np wrapping/Np algorithm/Np )/CH hay/Cc còn/R gọi_là/V thuật_toán/N Jarvis/Np march/Np là/V một/M trong/E những/L thuật_toán/N tìm/V bao/N lồi/Np đơn_giản/A và/Cc dễ_hiểu/Np nhất/A ./CH\nTên/N thuật_toán/N xuất_phát/V từ/E sự/N tương_tự/A của/E thuật_toán/N với/E việc/N đi_bộ/Np xung_quanh/N các/L điểm/N và/Cc cầm/V theo/V một/M dải_băng/Np gói/V quà/N ./CH\nBước_đầu/N tiên/N của/E thuật_toán/N là/V chọn/V một/M điểm/N chắc_chắn/A nằm/V trong/E bao/N lồi/Np ,/CH ví_dụ/C ,/CH điểm/N có/V tung_độ/Np lớn/A nhất/A (nếu/Np có/V nhiều/A điểm/N cùng/A có/V tung_độ/Np lớn/A nhất_thì/Np có_thể/R chọn/V điểm/N tung_độ/Np lớn/A nhất/A và/Cc hoành_độ/Np lớn/A nhất)/Np ./CH\nXuất_phát/V từ/E điểm/N này/P ,/CH mục_tiêu/N của/E ta/P là/V sẽ/R lần_lượt/R đi/V đến/E các/L điểm/N khác/A cho_đến/E khi/N quay/V trở_lại/V điểm/N ta/P chọn/V lúc/N đầu/N ./CH\nBan_đầu/N ,/CH ta/P nhìn/V về/E phía/N bên/N phải/V ./CH\nKhi/N đi/V đến/E các/L điểm/N khác/A ,/CH ta/P sẽ/R lưu/V lại/R :/CH Điểm_P/Np mà/C ta/P đang/R chọn/V vector/Np \\vecv/Np chỉ/R hướng/N ta/P đang/R nhìn/V ./CH\nTiếp_theo/V ,/CH thuật_toán/N sẽ/R lặp_lại/Np liên_tục/A các/L bước/V sau/E cho_đến/E khi/N tìm/V được/V bao/N lồi/Np ./CH\nTa/P quay/V mặt/N theo/V chiều/N kim_đồng_hồ/Np cho_đến/E khi/N ta/P nhìn_thấy/Np một/M điểm/N ,/CH gọi/V điểm/N đó/P là/V Q/Ny ./CH\nRồi/C ta/P cầm/V theo/V dải_băng/Np và/Cc đi/V đến/E điểm/N Q/Ny ./CH\nKhi/N ta/P đến/E điểm/N đấy/P ,/CH ta/P thay/V :/CH \\vecv/Np thành/V \\vecPQ/Np P/Ny thành/V Q/Ny ./CH\nThuật_toán/N kết_thúc/V ,/CH khi/N ta/P quay/V trở_về/V điểm/N ban_đầu/N ./CH\nLúc_này/Np ta/P đã/R đi/V đến/E tất_cả/P các/L đỉnh/N của/E bao/N lồi/Np theo/V chiều/N kim_đồng_hồ/Np ./CH\nĐể/E xác_định/V điểm/N ta/P nhìn_thấy/Np đầu_tiên/A khi/N ta/P quay/V mặt/N theo/V chiều/N kim_đồng_hồ/Np ,/CH ta/P duyệt/V tất_cả/P các/L điểm/N R/Np trong/E tập/V ,/CH ngoại_trừ/Np điểm/N P/Ny ./CH\nVới/E mỗi/L điểm/N ,/CH ta/P xét/V vector/Np \\vecu=\\vecPR;/Np \\vecu/Np tạo/V với/E \\vecv/Np một/M góc/N \\theta/Np nhỏ/A nhất/A sẽ/R tương_ứng/V với/E điểm/N Q/Ny (dễ/Np dàng/Np chứng_minh/V được/V điều/N này)/Np ./CH\nĐể/E tìm/V \\theta/Np nhỏ/A nhất/A ,/CH ta/P tìm/V \\cos\\theta/Np lớn/A nhất/A ,/CH mà/C ta/P lại/R dễ_dàng/A tính/V được/V \\cos\\theta/Np bằng/E công_thức/N \\frac\\vecu/Np ./CH \\vecv\\vecu\\vecv/Np ./CH\nVới/E mỗi/L lần/N tìm/V điểm/N tiếp_theo/V ,/CH ta/P cần/V duyệt/V qua/V tất_cả/P các/L điểm/N trong/E tập/V ,/CH vì_vậy/C độ/N phức_tạp/A của/E mỗi/L lần/N tìm/V điểm/N là/V O(n)/Np với/E n/Ny là/V số_lượng/N điểm/N trong/E tập/V ./CH\nSố/N lần/N tìm/V điểm/N tiếp_theo/V phụ_thuộc/V vào/E số_lượng/N điểm/N là/V đỉnh/N của/E bao/N lồi/Np ,/CH gọi/V số_lượng/N điểm/N đó/P là/V h/Ny ,/CH khi/N đó/P độ/N phức_tạp/A của/E cả/P thuật_toán/N là/V O(nh)/Np ./CH\nTrong/E trường_hợp/N xấu/A nhất/A ,/CH h=n/Np hay/Cc tất_cả/P các/L điểm/N trong/E dữ_liệu/N vào/E tạo_thành/Np một/M đa_giác/Np lồi/Np ,/CH độ/N phức_tạp/A của/E thuật_toán/N là/V O(n2)/Np ,/CH không/R đủ/A nhanh/A khi/N ngt;5000/Np ./CH\nThuật_toán/N Graham/Np Thuật_toán/N Graham/Np có/V độ/N phức_tạp/A trong/E trường_hợp/N xấu/A nhất/A nhỏ/A hơn/A thuật_toán/N bọc/V gói/V ,/CH song/C thuật_toán/N Graham/Np lại/R phức_tạp/A hơn/A ./CH\nĐầu_tiên/A ,/CH ta/P xác_định/V một/M điểm/N mà/C chắc_chắn/A thuộc/V bao/N lồi/Np ./CH\nThông_thường/A ,/CH khi/N cài_đặt/V người_ta/P chọn/V điểm/N có/V tung_độ/Np nhỏ/A nhất/A (nếu/Np có/V nhiều/A điểm/N như_vậy/X thì/C chọn/V điểm/N trái/Nc nhất)/Np ./CH\nGọi/V điểm/N này/P là/V điểm/N O/Nc ./CH\nChọn/V hệ/N trục/N tọa_độ/Np có/V gốc/N là/V điểm/N vừa/R chọn/V ,/CH đổi/V các/L tọa_độ/Np các/L điểm/N còn_lại/Np theo/V hệ/N trục/N tọa_độ/Np mới/R (chú/Np ý/N lúc/N cài_đặt/V thường_ta/Np không_đổi/Np trục/N tọa_độ/Np ,/CH nhưng/C khi/N tính/V góc/N hoặc/Cc sắp_xếp/V ở/E bước/V tiếp_theo/V cần/V chú_ý/V tránh/V nhầm/V lẫn)/Np ./CH\nTiếp_theo/V ,/CH ta/P sắp_xếp/V các/L điểm/N còn_lại/Np theo/V thứ_tự/N tăng/V dần/R của/E góc/N tạo/V bởi/E trục_hoành/Np theo/V chiều/N dương/A và/Cc \\vecOI/Np với/E I/M là/V một/M trong/E các/L điểm/N còn_lại/Np ./CH\nTa/P xét/V các/L điểm/N theo/V thứ_tự/N ta/P vừa/R sắp_xếp/V ,/CH với/E mỗi/L điểm/N ta/P sửa_lại/Np bao/N lồi/Np H/Ny ./CH\nGọi/V điểm/N đầu_tiên/A được/V cho/E vào/E bao/N lồi/Np H/Ny là/V H_1/Np ,/CH điểm/N cuối_cùng/A là/V H_h/Np (ban/Np đầu/N h/Ny =/CH 0)/Np ./CH\nKhi/N xét/V mỗi/L điểm/N ta/P làm/V như_sau/Np :/CH Thêm/V điểm/N P/Ny vào/E cuối/N bao/N lồi/Np H/Ny ./CH\nTức_là/V ta/P tăng/V h/Ny lên/V 1/M và/Cc đặt/V H_h=P/Np ./CH\nNếu/C hlt;3/Np ,/CH xét/V tiếp_điểm/Np tiếp_theo/V ,/CH ngược_lại/X làm/V bước/V 3/M ./CH\nXét/V 3/M điểm/N H_h/Np ,/CH H_h−1/Np và/Cc H_h−2/Np ./CH\nCó_thể/R sau/E khi/N cho/E thêm/V điểm/N H_h/Np ,/CH ta/P biết/V được/V điểm/N H_h−1/Np chắc_chắn/A không/R nằm/V trong/E bao/N ./CH\nGọi/V \\vecu/Np =\\overrightarrowH_h−2H_h−1/Np và/Cc \\vecv/Np =\\overrightarrowH_h−1H_h/Np ./CH\nNếu/C khi/N đi_theo/Np hướng/N \\vecv/Np rồi/C đi_theo/Np hướng/N \\vecu/Np là/V ta/P đã/R bẻ/V góc/N ngược_chiều/Np kim_đồng_hồ/Np ,/CH hay/Cc \\vecu/Np \\times/Np \\vecv/Np gt;/Np 0/M ,/CH thì/C cả/P ba/M điểm/N đều/R tạm/A thuộc/V bao/N ,/CH và/Cc ta/P xét/V tiếp_điểm/Np tiếp_theo/V ./CH\nNhưng/C nếu/C \\vecu/Np \\times/Np \\vecv/Np lt;/Np 0/M ,/CH thì/C góc/N \\widehatH_h−2H_h−1H_h/Np sẽ/R tạo/V ra_đa/Np giác/Np lõm/Np và/Cc điểm/N H_h−1/Np phải/V bị/V loại_bỏ/V ,/CH có_nghĩa/A là/V H_h−1/Np được/V đặt/V là/V H_h/Np và/Cc h/Ny giảm/V đi/V 1/M ./CH\nSau_đó/Np quay_lại/Np bước/V 2/M cho_đến/E khi/N xét/V hết/V các/L điểm/N ./CH\nHình/N minh_họa/V :/CH Ta/P đang/R xây_dựng/V bao/N lồi/Np ,/CH đến/E vị_trí/N h/Ny =/CH 4/M Góc/N \\widehatH_h−2H_h−1H_h/Np lõm/Np ,/CH nên/C ta/P cần/V bỏ/V điểm/N H_3/Np khỏi/V bao/N lồi/Np Sau/E quá_trình/N trên/E ,/CH ta/P đã/R có_một/Np bao/N lồi/Np H_1/Np ,/CH H_2/Np ,/CH ./CH ./CH ./CH ,/CH H_h/Np sắp_xếp/V ngược_chiều/Np kim_đồng_hồ/Np ./CH\nĐể/E đảm_bảo/V ta/P loại_bỏ/V điểm/N và/Cc thêm/V điểm/N với/E độ/N phức_tạp/A O(1)/Np ,/CH ta/P có_thể/R dùng/V cấu_trúc/N dữ_liệu/N stack/Np ./CH\nVề/E độ/N phức_tạp/A của/E thuật_toán/N ,/CH ta/P thấy/V bước/V sắp_xếp/V các/L điểm/N có/V độ/N phức_tạp/A O(n/Np \\logn)/Np ./CH\nMỗi/L điểm/N được/V cho/E vào/E bao/N nhiều/A nhất/A một_lần/Np nên/C tổng_độ/Np phức_tạp/A của/E các/L bước/V thêm/V điểm/N là/V O(n)/Np ,/CH và/Cc mỗi/L điểm/N bị/V loại/N ra/V khỏi/V bao/N nhiều/A nhất/A một_lần/Np nên/C tổng_độ/Np phức_tạp/A của/E các/L bước/V xóa/V điểm/N là/V O(n)/Np ,/CH do_đó/C độ/N phức_tạp/A của/E bước/V xét/V các/L điểm/N là/V O(n)/Np ./CH\nVậy/P ,/CH độ/N phức_tạp/A của/E thuật_toán/N Graham/Np là/V O(n/Np \\logn)/Np ,/CH phù_hợp/V cho/E hầu_hết/R các/L bài_toán/N ./CH\nCài_đặt/V type/Np Point/Np =/CH record/Np //CH Kiểu/N dữ_liệu/N điểm/N x/CH ,/CH y/N :/CH real/Np ;/CH ind/Np :/CH integer/Np ;/CH //CH chỉ_số/N trong/E mảng/N ban_đầu/N end/Np ;/CH var/Np n/Ny :/CH integer/Np ;/CH //CH số/N điểm/N a/Ni ,/CH b/Ni :/CH array/Np 1/M ./CH\n./CH\nmaxn/Np of/E Point/Np ;/CH //CH a/Ni :/CH mảng/N input/Np ,/CH b/Ni :/CH bao/N lồi/Np Procedure_Swap/Np (/CH var/Np p1/Np ,/CH p2/Np :/CH Point/Np );/CH //CH Hàm/Np đổi/V chỗ/N 2/M điểm/N Var/Np temp/Np :/CH Point/Np ;/CH Begin/Np temp/Np :/CH =/CH p1/Np ;/CH p1/Np :/CH =/CH p2/Np ;/CH p2/Np :/CH =/CH temp/Np ;/CH End/Np ;/CH Function_CCW/Np (/CH p1/Np ,/CH p2/Np ,/CH p3/Np :/CH Point/Np )/CH :/CH integer/Np ;/CH //CH Xem/V từ/E p1/Np --gt;/Np p2/Np --gt;/Np p3/Np là/V rẽ/V trái/Nc (1)/Np ,/CH đi_thẳng/Np (0)/Np hay/Cc rẽ/V phải/V (-1)/Np Var/Np t/Nu ,/CH a1/Np ,/CH a2/Np ,/CH b1/Ni ,/CH b2/Ni :/CH real/Np ;/CH Begin/Np a1/Np :/CH =/CH p2/Np ./CH\nx/CH -/CH p1/Np ./CH\nx/CH ;/CH b1/Ni :/CH =/CH p2/Np ./CH\ny/N -/CH p1/Np ./CH\ny/N ;/CH a2/Np :/CH =/CH p3/Np ./CH\nx/CH -/CH p2/Np ./CH\nx/CH ;/CH b2/Ni :/CH =/CH p3/Np ./CH\ny/N -/CH p2/Np ./CH\ny/N ;/CH t/Nu :/CH =/CH a1/Np b2/Ni -/CH a2/Np b1/Ni ;/CH If/Np abs/Np (/CH t/Nu )/CH lt;/Np esp/Np then/Np CCW/Np :/CH =/CH 0/M else/Np if/Np t/Nu lt;/Np 0/M then/Np CCW/Np :/CH =-/Np 1/M else/Np CCW/Np :/CH =/CH 1/M ;/CH End/Np ;/CH Function_Lower/Np (/CH p1/Np ,/CH p2/Np :/CH Point/Np )/CH :/CH boolean/Np ;/CH //CH So_sánh/V để/E sắp_xếp/V các/L điểm/N theo/V góc/N Var/Np c/Ni :/CH integer/Np ;/CH Begin/Np c/Ni :/CH =/CH CCW/Np (/CH a/Ni 1/M ,/CH p1/Np ,/CH p2/Np );/CH Lower/Np :/CH =/CH false/Np ;/CH If/Np (/CH c/Ni gt;/Np 0/M )/CH then/Np Lower/Np :/CH =/CH true/Np else/Np If/Np (/CH c/Ni =/CH 0/M )/CH and/Np ((/Np p1/Np ./CH\nx/CH lt;/Np p2/Np ./CH\nx/CH )/CH or/Np ((/Np p1/Np ./CH\nx/CH =/CH p2/Np ./CH\nx/CH )/CH and/Np (/CH p1/Np ./CH\ny/N lt;/Np p2/Np ./CH\ny/N )))/Np then/Np Lower/Np :/CH =/CH true/Np ;/CH End/Np ;/CH Procedure_QuickSort/Np ;/CH //CH Sắp_xếp/V các/L điểm/N của/E mảng/N a/Ni theo/V góc/N Procedure_Sort/Np (/CH l/Ny ,/CH r/Np :/CH integer/Np );/CH Var/Np i/M ,/CH j/Np :/CH integer/Np ;/CH x/CH :/CH Point/Np ;/CH Begin/Np i/M :/CH =/CH l/Ny ;/CH j/Np :/CH =/CH r/Np ;/CH x/CH :/CH =/CH a/Ni (/CH l/Ny +/CH r/Np )/CH div/Np 2/M ;/CH repeat/Np while/Np lower/Np (/CH a/Ni i/M ,/CH x/CH )/CH do/E inc/Np (/CH i/M );/CH while/Np lower/Np (/CH x/CH ,/CH a/Ni j/Np )/CH do/E dec/Np (/CH j/Np );/CH if/Np i/M lt;=/Np j/Np then/Np begin/Np Swap/Np (/CH a/Ni i/M ,/CH a/Ni j/Np );/CH inc/Np (/CH i/M );/CH dec/Np (/CH j/Np );/CH end/Np ;/CH until/Np i/M gt;/Np j/Np ;/CH if/Np i/M lt;/Np r/Np then/Np Sort/Np (/CH i/M ,/CH r/Np );/CH if/Np l/Ny lt;/Np j/Np then/Np Sort/Np (/CH l/Ny ,/CH j/Np );/CH End/Np ;/CH Begin_If/Np n/Ny gt;/Np 2/M then/Np Sort/Np (/CH 2/M ,/CH n/Ny );/CH End/Np ;/CH Procedure_Graham/Np ;/CH Var/Np i/M ,/CH c/Ni :/CH integer/Np ;/CH Begin/Np //CH Tìm/V điểm/N có/V tung_độ/Np nhỏ/A nhất/A c/Ni :/CH =/CH 1/M ;/CH For/Np i/M :/CH =/CH 2/M to/A n/Ny do/E If/Np (/CH a/Ni i/M ./CH\ny/N lt;/Np a/Ni c/Ni ./CH\ny/N )/CH or/Np ((/Np a/Ni i/M ./CH\ny/N =/CH a/Ni c/Ni ./CH\ny/N )/CH and/Np (/CH a/Ni i/M ./CH\nx/CH lt;/Np a/Ni c/Ni ./CH\nx/CH ))/Np then/Np c/Ni :/CH =/CH i/M ;/CH //CH Đổi/V chỗ/N điểm/N tung_độ/Np nhỏ/A nhất/A về/E a1/Np Swap/Np (/CH a/Ni c/Ni ,/CH a/Ni 1/M );/CH m/Nu :/CH =/CH 2/M ;/CH b/Ni 1/M :/CH =/CH a/Ni 1/M ;/CH b/Ni 2/M :/CH =/CH a/Ni 2/M ;/CH b/Ni 1/M ./CH\nind/Np :/CH =/CH 1/M ;/CH b/Ni 2/M ./CH\nind/Np :/CH =/CH 2/M ;/CH For/Np i/M :/CH =/CH 3/M to/A n/Ny do/E begin/Np //CH Loại_bỏ/V bm/Np nếu/C ta/P xác_định/V được/V nó/P không/R thuộc/V bao/N lồi/Np while/Np (/CH m/Nu gt;/Np 1/M )/CH and/Np (/CH CCW/Np (/CH b/Ni m/Nu -/CH 1/M ,/CH b/Ni m/Nu ,/CH a/Ni i/M )/CH =/CH -/CH 1/M )/CH do/E dec/Np (/CH m/Nu );/CH //CH Thêm/V điểm/N ai/P vào/E bao/N lồi/Np inc/Np (/CH m/Nu );/CH b/Ni m/Nu :/CH =/CH a/Ni i/M ;/CH b/Ni m/Nu ./CH\nind/Np :/CH =/CH i/M ;/CH end/Np ;/CH End/Np ;/CH Bạn/N cũng/R có_thể/R tham_khảo/V thêm/V cài_đặt/V C++/Np ở/E đây/P Thuật_toán/N chuỗi/N đơn_điệu/Np Thuật_toán/N chuỗi/N đơn_điệu/Np (/CH Monotone/Np chain/Np )/CH vừa/R dễ/A cài_đặt/V ,/CH vừa/R là/V thuật_toán/N nhanh/A nhất/A trong/E số/N 3/M thuật_toán/N được/V giới_thiệu/V trong/E bài/N viết/V này/P ./CH\nThuật_toán/N dựa/V trên/E việc/N tìm/V hai/M chuỗi/N đơn_điệu/Np của/E bao/N lồi/Np :/CH chuỗi/N trên/E và/Cc chuỗi/N dưới/E ./CH\nTa/P thấy/V điểm/N ở/E xa/A về/E phía/N bên/N phải/V nhất/A (từ/Np đây/P gọi_là/V điểm/N phải/V nhất)/Np và/Cc điểm/N ở/E xa/A về/E phía/N bên/N trái/Nc nhất/A (từ/Np đây/P gọi_là/V điểm/N trái/Nc nhất)/Np trong/E dữ_liệu/N vào/E luôn/R là/V hai/M đỉnh/N của/E bao/N lồi/Np ./CH\nPhần/N bao/N lồi/Np theo/V chiều/N kim_đồng_hồ/Np tính_từ/Np điểm/N trái/Nc nhất/A và/Cc ngược_chiều/Np kim_đồng_hồ/Np tính_từ/Np điểm/N phải/V nhất/A gọi_là/V chuỗi/N trên/E ,/CH phần/N còn_lại/Np của/E bao/N lồi/Np gọi_là/V chuỗi/N dưới/E ./CH\nTa/P sẽ/R tìm/V chuỗi/N trên/E và/Cc chuỗi/N dưới/E độc_lập/A với_nhau/Np ./CH\nBước_đầu/N tiên/N là/V sắp_xếp/V các/L điểm/N được/V cho/E theo/V thứ_tự/N tăng/V dần/R theo/V hoành_độ/Np ./CH\nNếu/C hai/M điểm/N có/V cùng/A hoành_độ/Np ,/CH điểm/N có/V tung_độ/Np nhỏ/A hơn/A sẽ/R đứng/V trước/E ./CH\nTa/P xét/V việc/N xây_dựng/V chuỗi/N trên/E ./CH\nGọi_H/Np là/V chuỗi/N trên/E hiện_tại/N và/Cc độ/N lớn/A của/E bao/N là/V h/Ny ./CH\nĐiểm/N đầu/N của/E chuỗi/N là/V H_1/Np và/Cc điểm/N cuối/N là/V H_h/Np ./CH\nVới/E mỗi/L điểm/N được/V xét/V :/CH Thêm/V điểm/N này/P vào/E H/Ny ./CH\nNếu/C hlt;3/Np ,/CH xét/V tiếp_điểm/Np tiếp_theo/V ./CH\nGọi/V \\vecu=\\overrightarrowH_h-2H_h-1/Np và/Cc \\vecv=\\overrightarrowH_h-1H_h/Np ./CH\nLần/N này/P ,/CH do/E ta/P đang/R di_chuyển/V theo/V chiều/N kim_đồng_hồ/Np để/E tìm/V chuỗi/N trên/E ,/CH ta/P kiểm_tra/V xem/V \\vecu/Np \\times/Np \\vecv/Np có/V nhỏ/A hơn/A 0/M hay_không/Np ./CH\nNếu/C có/V ,/CH ta/P xét/V tiếp_điểm/Np tiếp_theo/V ./CH\nNếu_không/Np ,/CH ta/P loại_bỏ/V H_h-1/Np và/Cc quay_lại/Np bước/V 2/M ./CH\nSau/E khi/N xét/V hết/V các/L điểm/N ,/CH H/Ny sẽ/R chứa/V toàn_bộ/L các/L điểm/N ở/E chuỗi/N trên/E ./CH\nSau_đó/Np ,/CH ta/P tìm/V chuỗi/N dưới/E bằng/E cách/N tương_tự/A ,/CH chỉ/R khác/A là/V ta/P xét/V các/L điểm/N theo/V thứ_tự/N ngược_lại/X (tức/Np là/V ta/P xét/V điểm/N trái/Nc nhất/A trước)/Np ./CH\nLưu_ý/V không/R thêm/V điểm/N phải/V nhất/A hai/M lần/N ./CH\nKhi/N thuật_toán/N kết_thúc/V ,/CH H/Ny sẽ/R chứa/V tất_cả/P các/L đỉnh/N của/E bao/N lồi/Np ,/CH với/E điểm/N đầu/N được/V lặp_lại/Np ở/E cuối/N ./CH\nThuật_toán/N này/P cũng/R có/V độ/N phức_tạp/A O(n/Np \\logn)/Np ./CH\nThuật_toán/N chuỗi/N đơn_điệu/Np được/V khuyên/V dùng/V ở/E mọi/L bài_toán/N tìm/V bao/N lồi/Np ,/CH do/E nó/P đơn_giản/A hơn/A thuật_toán/N Graham/Np và/Cc nhanh/A hơn/A một_chút/L (do/Np ta/P không_phải/Np tính/V góc)/Np ./CH\nCài_đặt/V struct/Np pt/Np //CH Kiểu/N điểm/N double/Np x/CH ,/CH y/N ;/CH ;/CH bool/Np cmp/Np (/CH pt/Np a/Ni ,/CH pt/Np b/Ni )/CH //CH So_sánh/V theo/V tọa_độ/Np x/CH ,/CH trong/E trường_hợp/N bằng_nhau/Np so_sánh/V theo/V y/N return/Np a/Ni ./CH\nx/CH lt;/Np b/Ni ./CH\nx/CH a/Ni ./CH\nx/CH ==/Np b/Ni ./CH\nx/CH amp;amp;/Np a/Ni ./CH\ny/N lt;/Np b/Ni ./CH\ny/N ;/CH bool/Np cw/Np (/CH pt/Np a/Ni ,/CH pt/Np b/Ni ,/CH pt/Np c/Ni )/CH //CH a/Ni -gt;/Np b/Ni -gt;/Np c/Ni đi_theo/Np thứ_tự/N xuôi_chiều/Np kim_đồng_hồ/Np return/Np a/Ni ./CH\nx/CH (/CH b/Ni ./CH\ny/N -/CH c/Ni ./CH\ny/N )/CH +/CH b/Ni ./CH\nx/CH (/CH c/Ni ./CH\ny/N -/CH a/Ni ./CH\ny/N )/CH +/CH c/Ni ./CH\nx/CH (/CH a/Ni ./CH\ny/N -/CH b/Ni ./CH\ny/N )/CH lt;/Np 0/M ;/CH bool/Np ccw/Np (/CH pt/Np a/Ni ,/CH pt/Np b/Ni ,/CH pt/Np c/Ni )/CH //CH a/Ni -gt;/Np b/Ni -gt;/Np c/Ni đi_theo/Np thứ_tự/N ngược_chiều/Np kim_đồng_hồ/Np return/Np a/Ni ./CH\nx/CH (/CH b/Ni ./CH\ny/N -/CH c/Ni ./CH\ny/N )/CH +/CH b/Ni ./CH\nx/CH (/CH c/Ni ./CH\ny/N -/CH a/Ni ./CH\ny/N )/CH +/CH c/Ni ./CH\nx/CH (/CH a/Ni ./CH\ny/N -/CH b/Ni ./CH\ny/N )/CH gt;/Np 0/M ;/CH void/Np convex_hull/Np (/CH vector/Np lt;/Np pt/Np gt;/Np amp;/Np a/Ni )/CH if/Np (/CH a/Ni ./CH\nsize/Nb ()/Np ==/Np 1/M )/CH //CH chỉ_có/Np 1/M điểm/N return/Np ;/CH //CH Sắp_xếp/V các/L điểm/N theo/V tọa_độ/Np x/CH ,/CH nếu/C bằng_nhau/Np sắp_xếp/V theo/V y/N sort/Np (/CH a/Ni ./CH\nbegin/Np ()/Np ,/CH a/Ni ./CH\nend/Np ()/Np ,/CH amp;/Np cmp/Np );/CH pt/Np p1/Np =/CH a/Ni 0/M ,/CH p2/Np =/CH a/Ni ./CH\nback/Np ();/Np vector/Np lt;/Np pt/Np gt;/Np up/Np ,/CH down/Np ;/CH //CH chuỗi/N trên/E và/Cc chuỗi/N dưới/E up/Np ./CH\npush_back/Np (/CH p1/Np );/CH down/Np ./CH\npush_back/Np (/CH p1/Np );/CH for/Np (/CH size_t/Np i/M =/CH 1/M ;/CH i/M lt;/Np a/Ni ./CH\nsize/Nb ();/Np ++/Np i/M )/CH //CH xét/V lần_lượt/R các/L điểm/N //CH Thêm/V vào/E chuỗi/N trên/E if/Np (/CH i/M ==/Np a/Ni ./CH\nsize/Nb ()/Np -/CH 1/M cw/Np (/CH p1/Np ,/CH a/Ni i/M ,/CH p2/Np ))/Np while/Np (/CH up/Np ./CH\nsize/Nb ()/Np gt;=/Np 2/M amp;amp;/Np !/CH cw/Np (/CH up/Np up/Np ./CH\nsize/Nb ()/Np -/CH 2/M ,/CH up/Np up/Np ./CH\nsize/Nb ()/Np -/CH 1/M ,/CH a/Ni i/M ))/Np up/Np ./CH\npop_back/Np ();/Np up/Np ./CH\npush_back/Np (/CH a/Ni i/M );/CH //CH Thêm/V vào/E chuỗi/N dưới/E if/Np (/CH i/M ==/Np a/Ni ./CH\nsize/Nb ()/Np -/CH 1/M ccw/Np (/CH p1/Np ,/CH a/Ni i/M ,/CH p2/Np ))/Np while/Np (/CH down/Np ./CH\nsize/Nb ()/Np gt;=/Np 2/M amp;amp;/Np !/CH ccw/Np (/CH down/Np down/Np ./CH\nsize/Nb ()/Np -/CH 2/M ,/CH down/Np down/Np ./CH\nsize/Nb ()/Np -/CH 1/M ,/CH a/Ni i/M ))/Np down/Np ./CH\npop_back/Np ();/Np down/Np ./CH\npush_back/Np (/CH a/Ni i/M );/CH //CH Gộp/V 2/M chuỗi/N trên/E và/Cc dưới/E để/E lấy/V bao/N lồi/Np a/Ni ./CH\nclear/Np ();/Np for/Np (/CH size_t/Np i/M =/CH 0/M ;/CH i/M lt;/Np up/Np ./CH\nsize/Nb ();/Np ++/Np i/M )/CH a/Ni ./CH\npush_back/Np (/CH up/Np i/M );/CH for/Np (/CH size_t/Np i/M =/CH down/Np ./CH\nsize/Nb ()/Np -/CH 2/M ;/CH i/M gt;/Np 0/M ;/CH --/Np i/M )/CH a/Ni ./CH\npush_back/Np (/CH down/Np i/M );/CH Bạn/N cũng/R có_thể/R tham_khảo/V thêm/V cài_đặt/V C++/Np ở/E đây/P Xử_lí/V trường_hợp/N suy_biến/Np Các/L thuật_toán/N trên/E hoạt_động/N tốt/A trong/E trường_hợp/N lí_tưởng/N ,/CH tức_là/V không/R có/V hai/M điểm/N nào/P trùng/V nhau/N và/Cc không/R có/V ba/M điểm/N nào/P thẳng_hàng/Np ./CH\nTuy_nhiên/C ,/CH trong/E hầu_hết/R các/L bài_toán/N ,/CH ta/P sẽ/R phải/V xử_lí/V các/L điểm/N trùng/V nhau/N và/Cc các/L bộ_ba/Np điểm/N thẳng_hàng/Np ./CH\nBiện_luận/Np tất_cả/P các/L trường_hợp/N sẽ/R là/V một/M công_việc/N khó_nhằn/Np và/Cc nhàm_chán/Np ./CH\nVì_vậy/C ,/CH hãy/R ghi_nhớ/V những/L điều/N sau/E :/CH Đọc/V kĩ/A đề_bài/Np để/E biết/V được/V dữ_liệu/N vào/E có/V bị/V suy_biến/Np hay_không/Np ,/CH nếu/C có/V thì/C rơi/V vào/E trường_hợp/N nào/P ./CH\n(Lưu/Np ý/N rằng/C không_phải/Np đề_bài/Np nào/P cũng/R nói_rõ/Np rằng/C dữ_liệu/N bị/V suy/V biến)/Np ./CH\nNếu/C tồn_tại/V các/L điểm/N trùng/V nhau/N Thuật_toán/N bọc/V gói/V sẽ/R thực_hiện/V phép_chia/Np cho/E số_không/Np ./CH\nTa/P cần/V tránh/V điều/N này/P để/E thuật_toán/N chạy/V đúng/A ./CH\nNếu/C ta/P chỉ_cần/Np tính/V chu_vi/Np hoặc/Cc diện_tích/N của/E bao/N lồi/Np ,/CH thuật_toán/N Graham/Np và/Cc thuật_toán/N chuỗi/N đơn_điệu/Np sẽ/R không/R gặp/V vấn_đề/N gì/P ./CH\nNếu/C ta/P phải/V in/V ra/V các/L đỉnh/N của/E bao/N lồi/Np ,/CH có/V ba/M thứ_tự/N in/V các/L đỉnh/N mà/C đề_bài/Np có_thể/R hỏi/V :/CH cùng/A chiều/N kim_đồng_hồ/Np ,/CH ngược_chiều/Np kim_đồng_hồ/Np ,/CH hoặc/Cc theo/V thứ_tự/N xuất_hiện/V trong/E dữ_liệu/N vào/E ./CH\nRõ_ràng/A hai/M thứ_tự/N in/V các/L đỉnh_đầu/Np tiên/N không/R có_ý/Np nghĩa/N gì/P khi/N có/V các/L điểm/N trùng/V nhau/N ./CH\nNếu/C đề_bài/Np yêu_cầu/V in/V các/L đỉnh/N theo/V thứ_tự/N xuất_hiện/V trong/E dữ_liệu/N vào/E ,/CH đề_bài/Np có_thể/R yêu_cầu/V in/V ra/V đỉnh_đầu/Np tiên/N xuất_hiện/V trong/E dữ_liệu/N vào/E nếu/C các/L đỉnh/N trùng/V nhau/N ,/CH hoặc/Cc in/V ra/V tất_cả/P các/L đỉnh/N ./CH\nHãy/R đọc/V đề_bài/Np thật/R kĩ/A ./CH\nTrong/E mọi/L trường_hợp/N ,/CH ta/P đều/R có_thể/R dễ_dàng/A xử_lí/V kết_quả/N sau/E khi/N chạy/V thuật_toán/N tìm/V bao/N lồi/Np để/E phù_hợp/V với/E yêu_cầu/V bài_toán/N ,/CH và/Cc ta/P nên/C làm/V như_vậy/X vì/E kết_hợp/V xử_lí/V kết_quả/N với/E thuật_toán/N tìm/V bao/N lồi/Np không_những/C khó/A hơn/A mà/C có_thể/R tạo/V ra/V sai_sót/N không/R đáng/V có/V Nếu/C có/V các/L bộ_ba/Np điểm/N thẳng_hàng/Np Ta/P cần/V biết/V đề_bài/Np yêu_cầu/V bao/N lồi/Np có_số/Np lượng/N đỉnh/N tối_đa/A hay/Cc tối_thiểu/A ,/CH từ_đó/Np ,/CH ta/P suy/V ra/V ta/P có/V nên/C cho/E thêm/V các/L điểm/N thuộc/V cạnh/N của/E bao/N lồi/Np hay_không/Np ./CH\nNếu/C chỉ_có/Np các/L bộ_ba/Np điểm/N thẳng_hàng/Np mà/C không/R có/V các/L điểm/N trùng/V nhau/N ,/CH ta/P có_thể/R sửa/V dấu/N lt;/Np thành/V dấu/N \\leq/Np trong/E thuật_toán/N Graham/Np và/Cc thuật_toán/N chuỗi/N đơn_điệu/Np nếu/C bài_toán/N yêu_cầu/V bao/N lồi/Np có_số/Np lượng/N đỉnh/N tối_đa/A ./CH\nCòn/R trong/E thuật_toán/N bọc/V gói/V ,/CH ta/P sẽ/R chọn/V điểm/N ở/E xa/A nhất/A hoặc/Cc điểm/N ở/E gần/A nhất/A nếu/C có/V hai/M điểm/N cùng/A có_số/Np đo_góc/Np nhỏ/A nhất/A tùy/V vào/E yêu_cầu/V bài_toán/N ./CH\nThứ_tự/N các/L đỉnh/N không_phải/Np là/V vấn_đề/N ,/CH trừ_khi/Np đề_bài/Np yêu_cầu/V in/V ra/V thứ_tự/N các/L đỉnh/N của/E bao/N lồi/Np có_số/Np đỉnh/N lớn/A nhất/A ,/CH trong/E đó/P các/L đỉnh/N thuộc/V cùng/A một/M cạnh/N được/V sắp_xếp/V theo/V thứ_tự/N xuất_hiện/V trong/E dữ_liệu/N vào/E ./CH\nKhi/N đó/P ,/CH xử_lí/V kết_quả/N sau/E khi/N tìm/V bao/N lồi/Np là/V lựa_chọn/V tốt/A nhất/A ./CH\nTrường_hợp/N xấu/A nhất/A trên/E lí_thuyết/Np là/V khi/N diện_tích/N bao/N lồi/Np bằng/E 0/M ./CH\nCó/V hai/M trường_hợp/N như_vậy/X ,/CH và/Cc ta/P có_thể/R dễ_dàng/A xử_lí/V hai/M trường_hợp/N đó/P :/CH tất_cả/P các/L điểm/N đều/R trùng/V nhau/N ,/CH hoặc/Cc tất_cả/P điểm/N đều/R thẳng_hàng/Np ./CH\nThuật_toán/N chuỗi/N đơn_điệu/Np vẫn/R hoạt_động/N bình_thường/A nếu/C ta/P chỉ_cần/Np biết/V diện_tích/N hoặc/Cc chu_vi/Np bao/N lồi/Np ./CH\nNếu/C ta/P cần/V in/V ra/V các/L đỉnh/N của/E bao/N lồi/Np ,/CH ta/P không/R nên/C chỉnh_sửa/V thuật_toán/N mà/C nên/C xét/V riêng/A hai/M trường_hợp/N trên/E ./CH\nỨng_dụng/V Ngoại_trừ/Np các/L ứng_dụng/V hiển_nhiên/Np ,/CH tìm/V bao/N lồi/Np còn/R giúp/V ta/P giải/N các/L bài_toán/N sau/E :/CH Cặp/N điểm/N xa/A nhất/A (Bài/Np toán/N trộn/V màu)/Np :/CH Bạn/N có_một/Np số/N hộp/N sơn/V ,/CH mỗi/L hộp/N sơn/V có/V tỉ_lệ/N thành_phần/N ba/M màu_cơ_bản/Np xanh/A :/CH đỏ/A :/CH vàng/N là/V x/CH :/CH d/Ny :/CH v/Nu ,/CH với/E x/CH ,/CH d/Ny ,/CH v/Nu dương/A ./CH\nGiả_sử/Np màu/N của/E hộp/N sơn/V chỉ/R phụ_thuộc/V vào/E tỉ_lệ/N ba/M màu_cơ_bản/Np ./CH\nBằng/E cách/N pha_trộn/Np các/L loại/N sơn/V ,/CH liệu/V ta/P có_thể/R thu/V được/V màu/N mục_tiêu/N hay_không/Np (màu/Np mục_tiêu/N cũng/R được/V cho/E bằng/E tỉ_lệ/N ba/M màu/N cơ/N bản)/Np ,/CH biết/V rằng/C lượng_sơn/Np trong/E hộp/N là/V vô_tận/Np ./CH\nBài_toán/N này/P hóa/Z ra/V lại/R có_thể/R giải/N bằng/E cách/N tìm/V bao/N lồi/Np trên/E mặt_phẳng/N ./CH\nBước_đầu/N tiên/N ,/CH ta/P chuẩn/N hóa/Z dữ_liệu/N bằng/E cách/N chia/V tỉ_lệ/N ba/M màu_cơ_bản/Np với/E lượng/N màu/N xanh/A (tức/Np là/V nếu/C tỉ_lệ/N bằng/E x/CH :/CH d/Ny :/CH v/Nu thì/C ta/P chuẩn/N hóa/Z còn/R 1/M :/CH \\fracdx/Np :/CH \\fracvx)/Np ./CH\nTa/P làm/V tương_tự/A với/E màu/N mục_tiêu/N ./CH\nSau_đó/Np ta/P bỏ_qua/V lượng/N màu/N xanh/A do/E lượng/N màu/N xanh/A ở/E tất_cả/P các/L hộp/N lẫn_màu/Np mục_tiêu/N đều/R bằng/E 1/M ,/CH và/Cc tập_trung/V xử_lí/V hai/M màu/N kia/P ./CH\nMỗi/L màu/N của/E hộp/N sơn/V đều/R có_thể/R biểu_diễn/V bằng/E một/M điểm/N trên/E mặt_phẳng/N ./CH\nKhi/N đó/P ,/CH các/L màu/N mà/C các/L hộp/N sơn/V đó/P có_thể/R pha_trộn/Np được/V sẽ/R nằm/V trong/E bao/N lồi/Np ./CH\nĐó/P là/V do/E khi/N trộn/V hai/M màu/N có/V điểm/N biểu_diễn/V trên/E mặt_phẳng/N lần_lượt/R là/V A/Ni và/Cc B/Ni ,/CH màu/N ta/P thu/V được/V sẽ/R có/V điểm/N biểu_diễn/V nằm/V trên/E đoạn/Nc AB/Np ,/CH nên/C ta/P dễ_dàng/A tìm/V được/V một/M dãy/Nc các/L bước/V trộn/V màu/N để/E có/V được/V màu/N mục_tiêu/N nếu/C điểm/N biểu_diễn/V màu/N mục_tiêu/N nằm/V trong/E bao/N lồi/Np ./CH\nBao/N lồi/Np 3D/M Tim/N bao/N lồi/Np trong/E 3D/M thực_sự/A là/V một/M bài_toán/N khó/A ./CH\nBài_toán/N này/P chắc_chắn/A sẽ/R không/R bao_giờ/P được/V ra/V trong/E IOI/Np ,/CH và/Cc học_sinh/N trung_học/N không/R cần/V phải/V đi_sâu/V vào/E vấn_đề/N này/P ./CH\nTuy_nhiên/C ,/CH có_một/Np thuật_toán/N O(n2)/Np khá/R là/V đơn_giản/A :/CH đầu_tiên/A ,/CH ta/P tìm/V hình_chiếu/Np của/E các/L điểm/N trên/E mặt_phẳng/N xy/Np ,/CH và/Cc tìm/V một/M các/L chắc_chắn/A thuộc/V bao/N bằng/E cách/N lấy/V một/M điểm/N có/V tung_độ/Np lớn/A nhất/A rồi/C tìm/V điểm/N kia/P bằng/E cách/N chạy/V vòng_lặp/Np của/E thuật_toán/N bọc/V gói/V một_lần/Np ./CH\nĐây/P là/V phần/N đầu_tiên/A của/E bao/N lồi/Np ./CH\nSau_đó/Np ,/CH xét/V cạnh/N vừa/R tìm/V được/V ,/CH tìm/V một/M điểm/N thứ_ba/N để/E tạo_thành/Np một_mặt/X tam_giác/N của/E bao/N lồi/Np ./CH\nTa/P chọn/V điểm/N thứ_ba/N bằng/E cách/N tìm/V điểm/N để/E tất_cả/P các/L điểm/N khác/A nằm/V ở/E phía/N bên/N phải/V của/E mặt/N tam_giác/N đó/P (giống/Np như/C thuật_toán/N bọc/V gói/V ,/CH ta/P tìm/V cạnh/N để/E tất_cả/P các/L điểm/N khác/A đều/R nằm/V về/E phía/N bên/N phải/V cạnh/N đó)/Np ./CH\nBây_giờ/P ta/P đã/R có/V ba/M cạnh/N trong/E bao/N lồi/Np ,/CH ta/P chọn/V ngẫu_nhiên/A một/M trong/E ba/M cạnh/N đó/P ,/CH rồi/C tìm/V tiếp/V một/M tam_giác/N với/E cạnh/N này/P ,/CH rồi/C tiếp_tục/V cho_đến/E khi_không/N còn/R cạnh/N nào/P nữa/R (Khi/Np ta/P tìm/V thêm/V một_mặt/X tam_giác/N ,/CH ta/P phải/V thêm/V hai/M cạnh/N vào/E bao/N ,/CH tuy_vậy/C hai/M cạnh/N này/P phải/V chưa/R có/V trong/E bao/N ,/CH nếu_không/Np ta/P phải/V đi/V tìm/V hai/M cạnh/N khác)/Np ./CH\nCó/V tổng_cộng/V O(n)/Np mặt/N ,/CH và/Cc mỗi/L lần/N duyệt/V các/L điểm/N ta/P mất/V thời_gian/N O(n)/Np vì/E ta/P phải/V duyệt/V tất_cả/P các/L điểm/N còn_lại/Np ,/CH do_đó/C độ/N phức_tạp/A của/E thuật_toán/N là/V O(n2)/Np ./CH\n(Nếu/Np bạn/N nghĩ/V bạn/N có_thể/R cài_đặt/V được/V thuật_toán/N này/P ,/CH hãy/R nộp/V bài/N tại/E SPOJ/Np -/CH CH3D/Np )/CH ./CH\nTa/P có_thể/R tăng_tốc_độ/Np thuật_toán/N này/P bằng/E các/L loại_bỏ/V các/L điểm/N chắc_chắn/A không_phải/Np đỉnh/N của/E bao/N ,/CH bằng/E cách/N tìm/V các/L điểm/N cực/A theo/V các/L trục/N tọa_độ/Np ,/CH rồi/C loại_bỏ/V các/L điểm/N nằm/V trong/E bát_diện/Np mà/C các/L đỉnh/N đấy/P tạo/V ra/V ./CH\nTa/P có_thể/R tìm/V bao/N lồi/Np trong/E không_gian/N với/E độ/N phức_tạp/A O(n/Np \\logn)/Np bằng/E phương_pháp/N chia_để_trị/Np ,/CH tuy_nhiên/C việc/N cài_đặt/V thuật_toán/N này/P là/V vô_cùng/R khó/A ./CH\nBài_tập/Np áp_dụng/V Kattis/Np -/CH convexhull/Np ACM_ICPC_Vietnam_National/Np 2017/Np -/CH K_VOJ/Np -/CH MILITARY_VOJ/Np -/CH HEADQRT_VOJ/Np -/CH KMIX_USACO/Np -/CH Cow_Curling/Np\n", "title": "Bao lồi (Convex Hull)\n", "link": "http://vnoi.info/wiki/translate/wcipeg/Convex-Hull\n"}